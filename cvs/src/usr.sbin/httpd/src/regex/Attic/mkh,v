head	1.3;
access;
symbols
	OPENBSD_3_9:1.2.0.18
	OPENBSD_3_9_BASE:1.2
	OPENBSD_3_8:1.2.0.16
	OPENBSD_3_8_BASE:1.2
	OPENBSD_3_7:1.2.0.14
	OPENBSD_3_7_BASE:1.2
	OPENBSD_3_6:1.2.0.12
	OPENBSD_3_6_BASE:1.2
	OPENBSD_3_5:1.2.0.10
	OPENBSD_3_5_BASE:1.2
	apache_1_3_29-mod_ssl_2_8_16:1.1.1.2
	OPENBSD_3_4:1.2.0.8
	OPENBSD_3_4_BASE:1.2
	apache_1_3_28-mod_ssl_2_8_15:1.1.1.2
	OPENBSD_3_3:1.2.0.6
	OPENBSD_3_3_BASE:1.2
	apache_1_3_27-mod_ssl_2_8_12:1.1.1.2
	apache_1_3_27:1.1.1.2
	OPENBSD_3_2:1.2.0.4
	OPENBSD_3_2_BASE:1.2
	apache_1_3_26:1.1.1.2
	OPENBSD_3_1:1.2.0.2
	OPENBSD_3_1_BASE:1.2
	OPENBSD_3_0:1.1.1.2.0.14
	OPENBSD_3_0_BASE:1.1.1.2
	OPENBSD_2_9_BASE:1.1.1.2
	OPENBSD_2_9:1.1.1.2.0.12
	OPENBSD_2_8:1.1.1.2.0.10
	OPENBSD_2_8_BASE:1.1.1.2
	OPENBSD_2_7:1.1.1.2.0.8
	OPENBSD_2_7_BASE:1.1.1.2
	OPENBSD_2_6:1.1.1.2.0.6
	OPENBSD_2_6_BASE:1.1.1.2
	OPENBSD_2_5:1.1.1.2.0.4
	OPENBSD_2_5_BASE:1.1.1.2
	OPENBSD_2_4:1.1.1.2.0.2
	OPENBSD_2_4_BASE:1.1.1.2
	apache_1_3_2:1.1.1.2
	OPENBSD_2_3:1.1.1.1.0.2
	OPENBSD_2_3_BASE:1.1.1.1
	apache:1.1.1
	apache_1_2_6:1.1.1;
locks; strict;
comment	@# @;


1.3
date	2006.04.04.11.39.28;	author henning;	state dead;
branches;
next	1.2;

1.2
date	2002.02.16.21.28.02;	author millert;	state Exp;
branches;
next	1.1;

1.1
date	98.03.25.07.08.51;	author beck;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	98.03.25.07.08.51;	author beck;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	98.10.01.17.19.49;	author beck;	state Exp;
branches;
next	;


desc
@@


1.3
log
@nuke bundled regex lib, we have and always used the OpenBSD one of course
From: Daniel Ouellet <daniel@@presscom.net>
@
text
@#! /bin/sh
# mkh - pull headers out of C source

# egrep pattern to pick out marked lines
egrep='^ =([ 	]|$)'

# Sed program to process marked lines into lines for the header file.
# The markers have already been removed.  Two things are done here:  removal
# of backslashed newlines, and some fudging of comments.  The first is done
# because -o needs to have prototypes on one line to strip them down.
# Getting comments into the output is tricky; we turn C++-style // comments
# into /* */ comments, after altering any existing */'s to avoid trouble.
peel='	/\\$/N
	/\\\n[ 	]*/s///g
	/\/\//s;\*/;* /;g
	/\/\//s;//\(.*\);/*\1 */;'

for a
do
	case "$a" in
	-o)	# old (pre-function-prototype) compiler
		# add code to comment out argument lists
		peel="$peel
			"'/^\([^#\/][^\/]*[a-zA-Z0-9_)]\)(\(.*\))/s;;\1(/*\2*/);'
		shift
		;;
	-b)	# funny Berkeley __P macro
		peel="$peel
			"'/^\([^#\/][^\/]*[a-zA-Z0-9_)]\)(\(.*\))/s;;\1(\2);'
		shift
		;;
	-s)	# compiler doesn't like `static foo();'
		# add code to get rid of the `static'
		peel="$peel
			"'/^static[ 	][^\/]*[a-zA-Z0-9_)](.*)/s;static.;;'
		shift
		;;
	-p)	# private declarations
		egrep='^ ==([ 	]|$)'
		shift
		;;
	-i)	# wrap in #ifndef, argument is name
		ifndef="$2"
		shift ; shift
		;;
	*)	break
		;;
	esac
done

echo "/* DON'T EVEN THINK ABOUT EDITING THIS, go see regex/Makefile,"
echo " * search for mkh */"
if test " $ifndef" != " "
then
	echo "#ifndef $ifndef"
	echo "#define	$ifndef	/* never again */"
fi
echo "/* ========= begin header generated by $0 ========= */"
echo '#ifdef __cplusplus'
echo 'extern "C" {'
echo '#endif'
for f
do
	echo
	echo "/* === $f === */"
	egrep "$egrep" $f | sed 's/^ ==*[ 	]//;s/^ ==*$//' | sed "$peel"
	echo
done
echo '#ifdef __cplusplus'
echo '}'
echo '#endif'
echo "/* ========= end header generated by $0 ========= */"
if test " $ifndef" != " "
then
	echo "#endif"
fi
exit 0
@


1.2
log
@Part one of userland __P removal.  Done with a simple regexp with some minor hand editing to make comments line up correctly.  Another pass is forthcoming that handles the cases that could not be done automatically.
@
text
@@


1.1
log
@Initial revision
@
text
@a2 1
PATH=/bin:/usr/bin ; export PATH
d29 1
a29 1
			"'/^\([^#\/][^\/]*[a-zA-Z0-9_)]\)(\(.*\))/s;;\1 __P((\2));'
d51 2
@


1.1.1.1
log
@Initial import from apache 1.2.6
@
text
@@


1.1.1.2
log
@Apache 1.3.2
@
text
@d3 1
a51 2
echo "/* DON'T EVEN THINK ABOUT EDITING THIS, go see regex/Makefile,"
echo " * search for mkh */"
@

