head	1.4;
access;
symbols
	OPENBSD_3_4:1.3.0.2
	OPENBSD_3_4_BASE:1.3
	OPENBSD_2_4:1.1.1.1.0.4
	OPENBSD_2_4_BASE:1.1.1.1
	OPENBSD_2_3:1.1.1.1.0.2
	OPENBSD_2_3_BASE:1.1.1.1
	apache:1.1.1.1
	apache_1_2_6:1.1.1;
locks; strict;
comment	@# @;


1.4
date	2004.02.03.10.47.20;	author henning;	state dead;
branches;
next	1.3;

1.3
date	2003.08.21.13.11.41;	author henning;	state Exp;
branches;
next	1.2;

1.2
date	99.03.01.02.03.21;	author beck;	state dead;
branches;
next	1.1;

1.1
date	98.03.25.07.08.52;	author beck;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	98.03.25.07.08.52;	author beck;	state Exp;
branches;
next	;


desc
@@


1.4
log
@somehow cvs revived this long dead directory, but fgs@@ noticed
@
text
@#!/usr/local/bin/perl

# This script can be used to detect people trying to abuse the security hole which
# existed in A CGI script direstributed with Apache 1.0.3 and earlier versions.
# You can redirect them to here using the "<Location /cgi-bin/phf*>" suggestion in
# httpd.conf.  
#
# The format logged to is "[date] remote_addr remote_host [date] referrer user_agent".

$LOG = "/var/log/phf_log";

require "ctime.pl";
$when = &ctime(time);
$when =~ s/\n//go;
$ENV{HTTP_USER_AGENT} .= " via $ENV{HTTP_VIA}" if($ENV{HTTP_VIA});

open(LOG, ">>$LOG") || die "boo hoo, phf_log $!";
print LOG "[$when] $ENV{REMOTE_ADDR} $ENV{REMOTE_HOST} $ENV{$HTTP_REFERER} $ENV{HTTP_USER_AGENT}\n";
close(LOG);

print "Content-type: text/html\r\n\r\n<BLINK>Smile, you're on Candid Camera.</BLINK>\n";
@


1.3
log
@merge
@
text
@@


1.2
log
@Not present in 1.3.4
@
text
@@


1.1
log
@Initial revision
@
text
@@


1.1.1.1
log
@Initial import from apache 1.2.6
@
text
@@
