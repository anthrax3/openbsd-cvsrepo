head	1.28;
access;
symbols
	OPENBSD_5_5:1.27.0.6
	OPENBSD_5_5_BASE:1.27
	OPENBSD_5_4:1.27.0.2
	OPENBSD_5_4_BASE:1.27
	OPENBSD_5_3:1.26.0.2
	OPENBSD_5_3_BASE:1.26
	OPENBSD_5_2:1.24.0.6
	OPENBSD_5_2_BASE:1.24
	OPENBSD_5_1_BASE:1.24
	OPENBSD_5_1:1.24.0.4
	OPENBSD_5_0:1.24.0.2
	OPENBSD_5_0_BASE:1.24
	OPENBSD_4_9:1.23.0.14
	OPENBSD_4_9_BASE:1.23
	OPENBSD_4_8:1.23.0.12
	OPENBSD_4_8_BASE:1.23
	OPENBSD_4_7:1.23.0.8
	OPENBSD_4_7_BASE:1.23
	OPENBSD_4_6:1.23.0.10
	OPENBSD_4_6_BASE:1.23
	OPENBSD_4_5:1.23.0.6
	OPENBSD_4_5_BASE:1.23
	OPENBSD_4_4:1.23.0.4
	OPENBSD_4_4_BASE:1.23
	OPENBSD_4_3:1.23.0.2
	OPENBSD_4_3_BASE:1.23
	OPENBSD_4_2:1.21.0.2
	OPENBSD_4_2_BASE:1.21
	OPENBSD_4_1:1.20.0.4
	OPENBSD_4_1_BASE:1.20
	OPENBSD_4_0:1.20.0.2
	OPENBSD_4_0_BASE:1.20
	OPENBSD_3_9:1.19.0.2
	OPENBSD_3_9_BASE:1.19
	OPENBSD_3_8:1.18.0.4
	OPENBSD_3_8_BASE:1.18
	OPENBSD_3_7:1.18.0.2
	OPENBSD_3_7_BASE:1.18
	OPENBSD_3_6:1.17.0.2
	OPENBSD_3_6_BASE:1.17
	OPENBSD_3_5:1.15.0.4
	OPENBSD_3_5_BASE:1.15
	OPENBSD_3_4:1.15.0.2
	OPENBSD_3_4_BASE:1.15
	OPENBSD_3_3:1.12.0.2
	OPENBSD_3_3_BASE:1.12
	OPENBSD_3_2:1.11.0.4
	OPENBSD_3_2_BASE:1.11
	OPENBSD_3_1:1.11.0.2
	OPENBSD_3_1_BASE:1.11
	OPENBSD_3_0:1.10.0.2
	OPENBSD_3_0_BASE:1.10
	OPENBSD_2_9_BASE:1.6
	OPENBSD_2_9:1.6.0.2
	OPENBSD_2_8:1.5.0.2
	OPENBSD_2_8_BASE:1.5
	PPPOE_USER:1.1.1.1
	PPPOE:1.1.1;
locks; strict;
comment	@.\" @;


1.28
date	2014.03.17.18.42.41;	author deraadt;	state dead;
branches;
next	1.27;

1.27
date	2013.07.16.11.13.34;	author schwarze;	state Exp;
branches;
next	1.26;

1.26
date	2012.09.26.16.19.44;	author jmc;	state Exp;
branches;
next	1.25;

1.25
date	2012.08.15.19.25.41;	author jmc;	state Exp;
branches;
next	1.24;

1.24
date	2011.04.20.12.53.50;	author jmc;	state Exp;
branches;
next	1.23;

1.23
date	2007.11.17.14.45.32;	author jmc;	state Exp;
branches;
next	1.22;

1.22
date	2007.11.16.22.44.20;	author jmc;	state Exp;
branches;
next	1.21;

1.21
date	2007.05.31.19.20.28;	author jmc;	state Exp;
branches;
next	1.20;

1.20
date	2006.05.18.19.38.54;	author ray;	state Exp;
branches;
next	1.19;

1.19
date	2005.09.30.20.34.26;	author jaredy;	state Exp;
branches;
next	1.18;

1.18
date	2005.02.18.12.19.22;	author jmc;	state Exp;
branches;
next	1.17;

1.17
date	2004.08.03.08.54.08;	author jmc;	state Exp;
branches;
next	1.16;

1.16
date	2004.05.06.12.15.20;	author jmc;	state Exp;
branches;
next	1.15;

1.15
date	2003.08.08.10.13.33;	author jmc;	state Exp;
branches;
next	1.14;

1.14
date	2003.06.04.04.32.55;	author jason;	state Exp;
branches;
next	1.13;

1.13
date	2003.05.10.22.11.28;	author jmc;	state Exp;
branches;
next	1.12;

1.12
date	2003.02.09.07.26.45;	author jmc;	state Exp;
branches;
next	1.11;

1.11
date	2002.01.10.18.21.38;	author jason;	state Exp;
branches;
next	1.10;

1.10
date	2001.09.12.19.37.12;	author brian;	state Exp;
branches;
next	1.9;

1.9
date	2001.08.22.16.24.09;	author jason;	state Exp;
branches;
next	1.8;

1.8
date	2001.08.20.05.57.55;	author mpech;	state Exp;
branches;
next	1.7;

1.7
date	2001.08.02.18.37.35;	author mpech;	state Exp;
branches;
next	1.6;

1.6
date	2001.01.17.22.40.40;	author jason;	state Exp;
branches;
next	1.5;

1.5
date	2000.08.18.18.06.07;	author jason;	state Exp;
branches;
next	1.4;

1.4
date	2000.06.20.05.11.43;	author jason;	state Exp;
branches;
next	1.3;

1.3
date	2000.06.20.05.09.16;	author jason;	state Exp;
branches;
next	1.2;

1.2
date	2000.06.20.05.06.26;	author jason;	state Exp;
branches;
next	1.1;

1.1
date	2000.06.18.07.30.41;	author jason;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2000.06.18.07.30.41;	author jason;	state Exp;
branches;
next	;


desc
@@


1.28
log
@to the great bit bucket in the sky...
@
text
@.\"	$OpenBSD: pppoe.8,v 1.27 2013/07/16 11:13:34 schwarze Exp $
.\"
.\" Copyright (c) 2000 Network Security Technologies, Inc.
.\" (http://www.netsec.net)
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
.\" WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
.\" DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT,
.\" INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
.\" (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR
.\" SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT,
.\" STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
.\" ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
.\" POSSIBILITY OF SUCH DAMAGE.
.\"
.\"
.Dd $Mdocdate: July 16 2013 $
.Dt PPPOE 8
.Os
.Sh NAME
.Nm pppoe
.Nd PPP Over Ethernet translator
.Sh SYNOPSIS
.Nm pppoe
.Op Fl sv
.Op Fl i Ar interface
.Op Fl n Ar service
.Op Fl p Ar system
.Sh DESCRIPTION
The
.Nm pppoe
program can, with the help of
.Xr ppp 8 ,
act as a server or client for running PPP Over Ethernet.
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl i Ar interface
Specify the interface that
.Nm
is to use, which should be a real Ethernet interface (not a virtual
device like
.Xr tun 4 ) .
If this option is not specified,
.Nm
will use the first Ethernet interface that is up and running.
.It Fl n Ar service
Use
.Ar service
as the service name when negotiating with the server.
By default, the client will ask for any service, and expect the server to
respond with the same.
.It Fl p Ar system
This argument is passed, uninterpreted, to
.Xr ppp 8 .
It can be used to specify the configuration data to be used for
PPP Over Ethernet connections.
This option is only used in server mode.
.It Fl s
If this option is specified,
.Nm
will run as a server.
Otherwise,
.Nm
runs as a client.
.It Fl v
For each use of the flag, the verbosity of
.Nm pppoe
increases.
.El
.Sh CLIENT SETUP
Configuring the client involves setting up the
configuration file for
.Xr ppp 8 .
The following statements must be included in the file for
the specified
.Ar system
(or
``default''
if no
.Ar system
is specified):
.Bd -literal -offset indent
set device "!/usr/sbin/pppoe"
set mtu max 1492
set mru max 1492
set speed sync
disable acfcomp protocomp
deny acfcomp
.Ed
.Pp
The
.Em "set device"
line tells
.Nm ppp
to use the
.Nm pppoe
program for input and output instead of using a serial port or other
network connection.
The
.Nm mtu
and
.Nm mru
must be set to 1492 to leave room in the outgoing Ethernet packet for
the
.Nm pppoe
headers.
The
.Em "set speed sync"
line tells
.Nm ppp
to use synchronous encoding for the packets sent between it and
.Nm pppoe .
According to RFC 2516, protocol compression,
.Em protocomp ,
is not recommended, so
it is disabled, but not denied.
On the other hand, address and control field compression,
.Em acfcomp ,
must be disabled and denied.
.Pp
Additionally, the authentication mechanism for the connection
must be specified as well as any other parameters.
.Sh EXAMPLE CONFIGURATION
Given a machine with one Ethernet interface,
.Em xl0 ,
the first thing that must be done is to bring the interface up:
.Bd -literal -offset indent
# ifconfig xl0 up
.Ed
.Pp
This can be done automatically during boot with a
.Pa /etc/hostname.xl0
file, see
.Xr hostname.if 5
for details.
.Pp
Next, a
.Pa /etc/ppp/ppp.conf
file must be created.
Below is a minimal PPPoE style configuration, see
.Xr ppp 8
for more options.
.Bd -literal -offset indent
default:
   set log Phase Chat LCP IPCP CCP tun command

pppoe:
   set device "!/usr/sbin/pppoe -i xl0"
   set mtu max 1492
   set mru max 1492
   set speed sync
   disable acfcomp protocomp
   deny acfcomp
   set authname "myUsername"
   set authkey "myPassword"
.Ed
.Pp
The
.Nm default
section sets up some helpful information to log while getting started,
and the
.Nm pppoe
section sets the required fields for a PPPoE connection as well as the
username and password to use to authenticate to the service provider.
.Pp
Once the
.Pa /etc/ppp/ppp.conf
file is set up, it is just a matter of setting
.Xr ppp 8
into action:
.Bd -literal -offset indent
# ppp pppoe
Working in interactive mode
Using interface: tun0
ppp ON deepthought> dial
Ppp ON deepthought>
PPp ON deepthought>
PPP ON deepthought>
.Ed
.Pp
The userland
.Xr ppp 8
daemon has many options for configuration, like adding default routes,
network address translation, automatically using remote DNS servers,
automatic dialing, etc.
Please see
.Xr ppp 8
for details.
.Pp
Several
.Xr ppp 8
options are particularly helpful when used with
.Nm pppoe .
.Bl -tag -width Ds
.It enable lqr / accept lqr
Enable and accept link quality requests, which can be used to detect
whether the link has gone down.
.It enable mssfixup
Allow
.Xr ppp 8
to adjust the maximum segment size on outgoing SYN packets.
.El
.Sh SEE ALSO
.Xr pppoe 4 ,
.Xr tun 4 ,
.Xr hostname.if 5 ,
.Xr ifconfig 8 ,
.Xr ppp 8
.Sh STANDARDS
.Rs
.%A L. Mamakos
.%A K. Lidl
.%A J. Evarts
.%A D. Carrel
.%A D. Simone
.%A R. Wheeler
.%D February 1999
.%R RFC 2516
.%T A Method for Transmitting PPP Over Ethernet (PPPoE)
.Re
.Sh HISTORY
This implementation of
.Nm pppoe
first appeared in
.Ox 2.8 .
.Sh AUTHORS
.An -nosplit
The
.Nm pppoe
program was written by
.An Jason L. Wright Aq Mt jason@@thought.net
of
.An Network Security Technologies, Inc.\&
.Aq Lk http://www.netsec.net .
.Sh BUGS
This software runs completely in user mode.
As such it will have much more overhead than a kernel implementation.
.Pp
The
.Ar service
is not currently used by the server code.
@


1.27
log
@use .Mt for email addresses; from Jan Stary <hans at stare dot cz>; ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.26 2012/09/26 16:19:44 jmc Exp $
d28 1
a28 1
.Dd $Mdocdate: September 26 2012 $
@


1.26
log
@last stage of rfc changes, using consistent Rs/Re blocks, and moving the
references into a STANDARDS section;
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.25 2012/08/15 19:25:41 jmc Exp $
d28 1
a28 1
.Dd $Mdocdate: August 15 2012 $
d243 1
a243 2
.An Jason L. Wright
.Aq jason@@thought.net
@


1.25
log
@use Lk for links;
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.24 2011/04/20 12:53:50 jmc Exp $
d28 1
a28 1
.Dd $Mdocdate: April 20 2011 $
d221 1
d223 7
a231 1
.%A L. Mamakos, et al.
@


1.24
log
@grammar fix; from Michael W. Bombardieri
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.23 2007/11/17 14:45:32 jmc Exp $
d28 1
a28 1
.Dd $Mdocdate: November 17 2007 $
d240 1
a240 1
.Aq http://www.netsec.net .
@


1.23
log
@avoid false double space;
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.22 2007/11/16 22:44:20 jmc Exp $
d28 1
a28 1
.Dd $Mdocdate: November 16 2007 $
d107 1
a107 1
to use
@


1.22
log
@fix formatting error as a result of having too many arguments to a macro;
problem reported by Tamas TEVESZ
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.21 2007/05/31 19:20:28 jmc Exp $
d28 1
a28 1
.Dd $Mdocdate: May 31 2007 $
d239 1
a239 1
.An Network Security Technologies, Inc.
@


1.21
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.20 2006/05/18 19:38:54 ray Exp $
d28 1
a28 1
.Dd $Mdocdate$
d222 2
a223 1
.%T RFC 2516 A Method for Transmitting PPP Over Ethernet (PPPoE)
@


1.20
log
@Reference pppoe(4).

``it makes sense'' jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.19 2005/09/30 20:34:26 jaredy Exp $
d28 1
a28 1
.Dd February 8, 2000
@


1.19
log
@deploy .An -nosplit; ok jmc
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.18 2005/02/18 12:19:22 jmc Exp $
d216 1
@


1.18
log
@grammatical blip, from jens ropers;
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.17 2004/08/03 08:54:08 jmc Exp $
d230 1
@


1.17
log
@add ifconfig(8) Xr and spacing;
from Alexey E. Suslikov;
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.16 2004/05/06 12:15:20 jmc Exp $
d176 1
a176 1
username and password to use to authenticated to the service provider.
@


1.16
log
@.Fl for flags, .Ar for arguments;
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.15 2003/08/08 10:13:33 jmc Exp $
d142 1
d218 1
@


1.15
log
@refer to RFCs consistently (RFC XXXX);
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.14 2003/06/04 04:32:55 jason Exp $
d36 4
a39 4
.Op Ar -sv
.Op Ar -i interface
.Op Ar -n service
.Op Ar -p system
@


1.14
log
@kill clause 3 & 4
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.13 2003/05/10 22:11:28 jmc Exp $
d125 1
a125 1
According to RFC2516, protocol compression,
d219 1
a219 1
.%T RFC2516 A Method for Transmitting PPP Over Ethernet (PPPoE)
@


1.13
log
@typos;
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.12 2003/02/09 07:26:45 jmc Exp $
a4 1
.\" All rights reserved.
a13 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by Jason L. Wright
.\" 4. The name of the author may not be used to endorse or promote products
.\"    derived from this software without specific prior written permission.
@


1.12
log
@typos;
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.11 2002/01/10 18:21:38 jason Exp $
d42 1
a42 1
.Op Ar -sv 
d67 2
a68 2
as the service name when negotiating with the server.  By default,
the client will ask for any service, and expect the server to
d79 2
a80 1
will run as a server.  Otherwise,
d116 2
a117 1
network connection.  The
d134 2
a135 2
it is disabled, but not denied.  On the other hand, address and control
field compression,
d156 2
a157 1
file must be created.  Below is a minimal PPPoE style configuration, see
d185 1
a185 1
file is setup, it is just a matter of setting
d243 2
a244 2
This software runs completely in user mode.  As such it will have much
more overhead than a kernel implementation.
@


1.11
log
@Use IFNAMSIZ for strlcpy() and also pretty the man page
(from PR2315; Jason Ackley <jason@@ackley.net>)
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.10 2001/09/12 19:37:12 brian Exp $
d240 1
a240 1
This is software runs completely in user mode.  As such it will have much
@


1.10
log
@s/set (mtu|mru)/set \1 max/
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.9 2001/08/22 16:24:09 jason Exp $
d42 1
a42 2
.Op Ar -s Op Ar -p system
.Op Ar -v
d45 1
@


1.9
log
@must quote set device line; mcbride@@countersiege.com (pr2020... I can patch clearly now the rej is gone...)
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.8 2001/08/20 05:57:55 mpech Exp $
d101 2
a102 2
set mtu 1492
set mru 1492
d163 2
a164 2
   set mtu 1492
   set mru 1492
@


1.8
log
@Powered by @@mantoya.
o) fix bogus .Xr usage;

millert@@ ok.
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.7 2001/08/02 18:37:35 mpech Exp $
d100 1
a100 1
set device !/usr/sbin/pppoe
d162 1
a162 1
   set device !/usr/sbin/pppoe
@


1.7
log
@o) .Sh AUTHOR -> .Sh AUTHORS;
o) .Sh EXAMPLE -> .Sh EXAMPLES;
o) Delete .Sh OPTIONS. Text moved to .Sh DESCRIPTION;

millert@@ ok
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.6 2001/01/17 22:40:40 jason Exp $
d60 1
a60 1
.Xr tun 4 ).
@


1.6
log
@point out a few non-obvious and helpful ppp(8) options
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.5 2000/08/18 18:06:07 jason Exp $
d230 1
a230 1
.Sh AUTHOR
@


1.5
log
@alot of fleshing out... more to come
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.4 2000/06/20 05:11:43 jason Exp $
d203 14
@


1.4
log
@pretty
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.3 2000/06/20 05:09:16 jason Exp $
d42 1
a42 1
.Op Ar -s
a45 1
.Op Ar -p system
d58 4
a61 1
is to use.  If this option is not specified,
d75 1
d100 1
d104 1
a104 1
disable acfcomp
a105 2
disable protocomp
set device !/usr/sbin/pppoe
d108 29
d139 64
d204 2
@


1.3
log
@include configuration for exec from ppp
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.2 2000/06/20 05:06:26 jason Exp $
d96 9
a104 9
.Bl -tag -width XXX -offset XXX
.It set mtu 1492
.It set mru 1492
.It set speed sync
.It disable acfcomp
.It deny acfcomp
.It disable protocomp
.It set device !/usr/sbin/pppoe
.El
@


1.2
log
@reorder sections as per mdoc.template
@
text
@d1 1
a1 1
.\"	$OpenBSD: pppoe.8,v 1.1.1.1 2000/06/18 07:30:41 jason Exp $
d103 1
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d109 4
a117 7
.Sh BUGS
This is software runs completely in user mode.  As such it will have much
more overhead than a kernel implementation.
.Pp
The
.Ar service
is not currently used by the server code.
d127 7
@


1.1.1.1
log
@import my pppoe code
@
text
@@
