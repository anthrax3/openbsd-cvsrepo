head	1.16;
access;
symbols
	OPENBSD_6_1:1.16.0.6
	OPENBSD_6_1_BASE:1.16
	OPENBSD_6_0:1.16.0.4
	OPENBSD_6_0_BASE:1.16
	OPENBSD_5_9:1.16.0.2
	OPENBSD_5_9_BASE:1.16
	OPENBSD_5_8:1.15.0.4
	OPENBSD_5_8_BASE:1.15
	OPENBSD_5_7:1.14.0.16
	OPENBSD_5_7_BASE:1.14
	OPENBSD_5_6:1.14.0.20
	OPENBSD_5_6_BASE:1.14
	OPENBSD_5_5:1.14.0.18
	OPENBSD_5_5_BASE:1.14
	OPENBSD_5_4:1.14.0.14
	OPENBSD_5_4_BASE:1.14
	OPENBSD_5_3:1.14.0.12
	OPENBSD_5_3_BASE:1.14
	OPENBSD_5_2:1.14.0.10
	OPENBSD_5_2_BASE:1.14
	OPENBSD_5_1_BASE:1.14
	OPENBSD_5_1:1.14.0.8
	OPENBSD_5_0:1.14.0.6
	OPENBSD_5_0_BASE:1.14
	OPENBSD_4_9:1.14.0.4
	OPENBSD_4_9_BASE:1.14
	OPENBSD_4_8:1.14.0.2
	OPENBSD_4_8_BASE:1.14
	OPENBSD_4_7:1.13.0.10
	OPENBSD_4_7_BASE:1.13
	OPENBSD_4_6:1.13.0.12
	OPENBSD_4_6_BASE:1.13
	OPENBSD_4_5:1.13.0.8
	OPENBSD_4_5_BASE:1.13
	OPENBSD_4_4:1.13.0.6
	OPENBSD_4_4_BASE:1.13
	OPENBSD_4_3:1.13.0.4
	OPENBSD_4_3_BASE:1.13
	OPENBSD_4_2:1.13.0.2
	OPENBSD_4_2_BASE:1.13
	OPENBSD_4_1:1.12.0.16
	OPENBSD_4_1_BASE:1.12
	OPENBSD_4_0:1.12.0.14
	OPENBSD_4_0_BASE:1.12
	OPENBSD_3_9:1.12.0.12
	OPENBSD_3_9_BASE:1.12
	OPENBSD_3_8:1.12.0.10
	OPENBSD_3_8_BASE:1.12
	OPENBSD_3_7:1.12.0.8
	OPENBSD_3_7_BASE:1.12
	OPENBSD_3_6:1.12.0.6
	OPENBSD_3_6_BASE:1.12
	OPENBSD_3_5:1.12.0.4
	OPENBSD_3_5_BASE:1.12
	OPENBSD_3_4:1.12.0.2
	OPENBSD_3_4_BASE:1.12
	OPENBSD_3_3:1.11.0.2
	OPENBSD_3_3_BASE:1.11
	OPENBSD_3_2:1.6.0.6
	OPENBSD_3_2_BASE:1.6
	OPENBSD_3_1:1.6.0.4
	OPENBSD_3_1_BASE:1.6
	OPENBSD_3_0:1.6.0.2
	OPENBSD_3_0_BASE:1.6
	OPENBSD_2_9_BASE:1.4
	OPENBSD_2_9:1.4.0.4
	OPENBSD_2_8:1.4.0.2
	OPENBSD_2_8_BASE:1.4
	OPENBSD_2_7:1.3.0.4
	OPENBSD_2_7_BASE:1.3
	OPENBSD_2_6:1.3.0.2
	OPENBSD_2_6_BASE:1.3
	OPENBSD_2_5:1.2.0.2
	OPENBSD_2_5_BASE:1.2
	OPENBSD_2_4:1.1.1.1.0.10
	OPENBSD_2_4_BASE:1.1.1.1
	OPENBSD_2_3:1.1.1.1.0.8
	OPENBSD_2_3_BASE:1.1.1.1
	OPENBSD_2_2:1.1.1.1.0.6
	OPENBSD_2_2_BASE:1.1.1.1
	OPENBSD_2_1:1.1.1.1.0.4
	OPENBSD_2_1_BASE:1.1.1.1
	OPENBSD_2_0:1.1.1.1.0.2
	OPENBSD_2_0_BASE:1.1.1.1
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@.\" @;


1.16
date	2015.09.12.15.52.37;	author schwarze;	state Exp;
branches;
next	1.15;
commitid	IJedeGcVUYpYuOi3;

1.15
date	2015.05.19.16.05.12;	author millert;	state Exp;
branches;
next	1.14;
commitid	THWxPIM21A49HdgX;

1.14
date	2010.07.08.06.52.30;	author jmc;	state Exp;
branches;
next	1.13;

1.13
date	2007.05.31.19.20.22;	author jmc;	state Exp;
branches;
next	1.12;

1.12
date	2003.06.02.23.36.52;	author millert;	state Exp;
branches;
next	1.11;

1.11
date	2003.02.11.18.29.17;	author mpech;	state Exp;
branches;
next	1.10;

1.10
date	2003.02.08.21.37.04;	author millert;	state Exp;
branches;
next	1.9;

1.9
date	2003.02.01.16.29.52;	author jmc;	state Exp;
branches;
next	1.8;

1.8
date	2002.10.29.23.12.06;	author millert;	state Exp;
branches;
next	1.7;

1.7
date	2002.10.25.19.23.48;	author millert;	state Exp;
branches;
next	1.6;

1.6
date	2001.05.28.15.26.55;	author aaron;	state Exp;
branches;
next	1.5;

1.5
date	2001.05.01.17.58.06;	author aaron;	state Exp;
branches;
next	1.4;

1.4
date	2000.08.17.15.28.36;	author mickey;	state Exp;
branches;
next	1.3;

1.3
date	99.05.23.14.11.32;	author aaron;	state Exp;
branches;
next	1.2;

1.2
date	98.11.08.00.21.28;	author aaron;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.47.29;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.47.29;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.16
log
@mark up arguments individually and drop redundant .Bk
@
text
@.\"	$OpenBSD: chroot.8,v 1.15 2015/05/19 16:05:12 millert Exp $
.\"
.\" Copyright (c) 1988, 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"     from: @@(#)chroot.8	8.1 (Berkeley) 6/9/93
.\"
.Dd $Mdocdate: May 19 2015 $
.Dt CHROOT 8
.Os
.Sh NAME
.Nm chroot
.Nd change root directory
.Sh SYNOPSIS
.Nm chroot
.Op Fl g Ar group Ns Op Pf , Ar group Ns Op Pf , Ar ...
.Op Fl u Ar user
.Ar newroot
.Op Ar command
.Sh DESCRIPTION
The
.Nm
command changes its root directory to the supplied directory
.Ar newroot
and executes
.Ar command ,
if supplied, or an interactive copy of the user's shell.
.Pp
The
.Nm
command is restricted to the superuser.
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl g Ar group Ns Op Pf , Ar group Ns Op Pf , Ar ...
Override the primary and supplemental group IDs.
The primary group ID is set to the first group in the list.
Any remaining groups are placed in the supplemental group ID vector.
Each group listed must exist in the
.Xr group 5
databases.
.It Fl u Ar user
Set user ID to
.Ar user
(which must exist in the
.Xr passwd 5
database).
The primary and supplemental group IDs will be set based on the user's
entries in the
.Xr passwd 5
and
.Xr group 5
databases unless overridden by the
.Fl g
option.
Additional settings may be applied as specified in
.Xr login.conf 5
depending on
.Ar user Ns 's
login class.
.El
.Sh ENVIRONMENT
.Bl -tag -width SHELL
.It Ev SHELL
If set,
the string specified by
.Ev SHELL
is interpreted as the name of
the shell to execute.
If the variable
.Ev SHELL
is not set,
.Pa /bin/sh
is used.
.El
.Sh SEE ALSO
.Xr ldd 1 ,
.Xr group 5 ,
.Xr login.conf 5 ,
.Xr passwd 5 ,
.Xr environ 7
.Sh HISTORY
The
.Nm
utility first appeared in
.Bx 4.3 Reno .
.Sh CAVEATS
.Nm
should never be installed setuid root, as it would then be possible
to exploit the program to gain root privileges.
@


1.15
log
@When a user is specified via the -u flag, use setusercontext() to
setup (most of) the execution environment.  We still have to defer
setting the actual uid until after we change root.  OK deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: chroot.8,v 1.14 2010/07/08 06:52:30 jmc Exp $
d32 1
a32 1
.Dd $Mdocdate: July 8 2010 $
d40 1
a40 1
.Op Fl g Ar group,group,...
d59 1
a59 1
.It Fl g Ar group,group,...
@


1.14
log
@- Xr ldd; from jochen keil, netbsd pr 30043
- knock out some unhelpful Xrs
- correct history entry; from millert

ok millert otto
@
text
@d1 1
a1 1
.\"	$OpenBSD: chroot.8,v 1.13 2007/05/31 19:20:22 jmc Exp $
d32 1
a32 1
.Dd $Mdocdate: May 31 2007 $
d80 5
d103 1
@


1.13
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: chroot.8,v 1.12 2003/06/02 23:36:52 millert Exp $
d32 1
a32 1
.Dd $Mdocdate$
d96 1
a96 5
.Xr chdir 2 ,
.Xr chroot 2 ,
.Xr setgid 2 ,
.Xr setgroups 2 ,
.Xr setuid 2 ,
d104 1
a104 1
.Bx 4.4 .
@


1.12
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
.\"	$OpenBSD: chroot.8,v 1.11 2003/02/11 18:29:17 mpech Exp $
d32 1
a32 1
.Dd February 7, 2003
@


1.11
log
@More -G/-U deletion + style(9) while millert@@ is here.
Make sence.

millert@@ ok
@
text
@d1 1
a1 1
.\"	$OpenBSD: chroot.8,v 1.10 2003/02/08 21:37:04 millert Exp $
d14 1
a14 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
@


1.10
log
@Make the -u and -g options more like the -U and -G options.  My intention
was to avoid needless incompatibilities with NetBSD's command line options
but this ended up causing too much confusion on the part of the user.

The -u option now also sets the group and group vector based on passwd(5)
and group(5) unless an alternate group list is specified via the -g option.
The -U and -G options have been removed.

The resulting code is much simpler and the behavior of chroot(8) seems
to better match users' expectations; OK deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: chroot.8,v 1.9 2003/02/01 16:29:52 jmc Exp $
d44 1
a45 1
.Op Fl g Ar group,group,...
d63 7
a83 7
.It Fl G Ar group,group,...
Override the primary and supplemental group IDs.
The primary group ID is set to the first group in the list.
Any remaining groups are placed in the supplemental group ID vector.
Each group listed must exist in the
.Xr group 5
databases.
@


1.9
log
@typos;
chat(8): removed reference to uucico(8)

ok deraadt@@
@
text
@d1 1
a1 2
.\"	$OpenBSD: chroot.8,v 1.8 2002/10/29 23:12:06 millert Exp $
.\"	$NetBSD: chroot.8,v 1.9 2000/08/17 12:36:32 mrg Exp $
d36 1
a36 1
.Dd October 25, 2002
d45 1
a45 3
.Op Fl U Ar user
.Op Fl g Ar group
.Op Fl G Ar group,group,...
d66 1
a66 3
(a user name or user ID).
.It Fl U Ar user
Set user, group and supplemental group IDs based on the
d68 9
a76 14
database entry for
.Ar user .
The
.Fl U
option may not be specified in conjunction with any other options.
.It Fl g Ar group
Set group ID to
.Ar group
(a group name or group ID).
If supplemental groups are specified via the
.Fl G
flag,
.Ar group
will be used as the first entry in the group vector.
d78 6
a83 7
Set the supplemental group IDs to a comma-separated list of
group names or group IDs.
If neither the
.Fl G
nor the
.Fl U
option is specified, the supplemental group list remains unchanged.
d105 2
a106 2
.Xr getgrnam 3 ,
.Xr getpwnam 3 ,
@


1.8
log
@Add -U option to set uid, gid, and group vector based on password database.
@
text
@d1 1
a1 1
.\"	$OpenBSD: chroot.8,v 1.7 2002/10/25 19:23:48 millert Exp $
d86 1
a86 1
will be the used as the first entry in the group vector.
@


1.7
log
@Add options to set the uid, gid, and group vector after the chroot;
adapted from NetBSD.  OK markus@@ and previously discussed with Theo.
@
text
@d1 1
a1 1
.\"	$OpenBSD: chroot.8,v 1.6 2001/05/28 15:26:55 aaron Exp $
d46 1
d70 8
d90 5
a95 6
.Pp
Note, the
.Ar command
or shell are run with the real user ID of the invoking user unless the
.Fl u
flag is specified.
@


1.6
log
@Remove unneeded .Nm argument; mpech@@prosoft.org.lv
@
text
@d1 2
a2 1
.\" $OpenBSD: chroot.8,v 1.5 2001/05/01 17:58:06 aaron Exp $
d4 2
a5 2
.\" Copyright (c) 1988, 1991 The Regents of the University of California.
.\" All rights reserved.
d35 1
a35 2
.\"     from: @@(#)chroot.8	5.3 (Berkeley) 3/16/91
.\"	$Id: chroot.8,v 1.5 2001/05/01 17:58:06 aaron Exp $
d37 1
a37 1
.Dd March 16, 1991
d45 3
d57 1
a57 1
if supplied, or an interactive copy of your shell.
d59 25
a83 1
Note,
d85 3
a87 1
or the shell are run as your real user ID.
d105 5
d114 6
a119 2
command is
.Ud
@


1.5
log
@Remove completely redundant introductory sentences in ENVIRONMENT sections.
@
text
@d1 1
a1 1
.\" $OpenBSD: chroot.8,v 1.4 2000/08/17 15:28:36 mickey Exp $
d35 1
a35 1
.\"	$Id: chroot.8,v 1.4 2000/08/17 15:28:36 mickey Exp $
d49 1
a49 1
.Nm chroot
@


1.4
log
@openbsd rcsdids
@
text
@d1 1
a1 1
.\" $OpenBSD$
d35 1
a35 1
.\"	$Id: chroot.8,v 1.3 1999/05/23 14:11:32 aaron Exp $
a59 2
The following environment variable is referenced by
.Nm chroot :
@


1.3
log
@remove argument from .Os macros so value in /usr/share/tmac/mdoc/doc-common
is used instead; kwesterback@@home.com
@
text
@d1 2
d35 1
a35 1
.\"	$Id: chroot.8,v 1.2 1998/11/08 00:21:28 aaron Exp $
@


1.2
log
@usr.sbin/ man page repairs, a-i
@
text
@d33 1
a33 1
.\"	$Id: chroot.8,v 1.1.1.1 1995/10/18 08:47:29 deraadt Exp $
d37 1
a37 1
.Os BSD 4.3
@


1.1
log
@Initial revision
@
text
@d33 1
a33 1
.\"	$Id: chroot.8,v 1.2 1993/08/01 07:25:26 mycroft Exp $
d50 1
a50 1
and exec's
d56 1
a56 1
or the shell are run as your real-user-id.
d66 1
a66 1
the shell to exec.
d80 1
a80 1
command
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
