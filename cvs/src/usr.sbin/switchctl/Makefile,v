head	1.5;
access;
symbols
	OPENBSD_6_1:1.4.0.4
	OPENBSD_6_1_BASE:1.4
	OPENBSD_6_0:1.2.0.2
	OPENBSD_6_0_BASE:1.2;
locks; strict;
comment	@# @;


1.5
date	2017.07.06.12.15.23;	author espie;	state Exp;
branches;
next	1.4;
commitid	VfLz648VOhc11puh;

1.4
date	2016.11.17.10.05.44;	author reyk;	state Exp;
branches;
next	1.3;
commitid	Vk3XSkkJHy7YnM1i;

1.3
date	2016.11.15.08.15.07;	author reyk;	state Exp;
branches;
next	1.2;
commitid	H5Z6OFhVOmsB5Woy;

1.2
date	2016.07.19.18.14.08;	author reyk;	state Exp;
branches;
next	1.1;
commitid	QaXohszP3qByKnvb;

1.1
date	2016.07.19.16.54.26;	author reyk;	state Exp;
branches;
next	;
commitid	NvD0Bp0qm4zs28YJ;


desc
@@


1.5
log
@/tmp/cvsa9y4jm
@
text
@# $OpenBSD: Makefile,v 1.4 2016/11/17 10:05:44 reyk Exp $

SWITCHD=	${.CURDIR}/../switchd

.PATH:		${SWITCHD}

PROG=		switchctl
MAN=		switchctl.8
SRCS=		log.c ofpclient.c parser.c util.c imsg_util.c switchctl.c
SRCS+=		ofp10.c ofp13.c ofp_common.c packet.c

LDADD=		-lutil
DPADD=		${LIBUTIL}

CFLAGS+=	-Wall -I${.CURDIR} -I${SWITCHD}
CFLAGS+=	-Wstrict-prototypes -Wmissing-prototypes
CFLAGS+=	-Wmissing-declarations
CFLAGS+=	-Wshadow -Wpointer-arith -Wcast-qual
CFLAGS+=	-Wsign-compare

GENERATED=	ofp_map.c ofp10_map.c
SRCS+=		${GENERATED}
CLEANFILES+=	${GENERATED}

ofp_map.c: genmap.sh ${SWITCHD}/ofp_map.h ${SWITCHD}/../../sys/net/ofp.h
	/bin/sh ${SWITCHD}/genmap.sh -i ${SWITCHD}/../../sys/net/ofp.h -t ofp \
	    -m ${SWITCHD}/ofp_map.h -h '<net/ofp.h>' > $@@
	@@touch $@@

ofp10_map.c: genmap.sh ${SWITCHD}/ofp_map.h ${SWITCHD}/ofp10.h
	/bin/sh ${SWITCHD}/genmap.sh -i ${SWITCHD}/ofp10.h -t ofp10 \
	    -m ${SWITCHD}/ofp_map.h -h '"ofp10.h"' > $@@
	@@touch $@@

.include <bsd.prog.mk>
@


1.4
log
@Add ofp_validate() for all supported versions. Will be used by switchctl,
no functional change.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.3 2016/11/15 08:15:07 reyk Exp $
d23 1
a23 1
CLEANFILES+=	${GENERATED} *~
@


1.3
log
@Add a simple openflow client to dump switch information.  The
implementation re-uses the openflow code from switchd. Not finished
yet, but it is better to continue working on it in the tree.  Later
versions will also include a way to add flows from the command line -
this is being worked on for switchd and some code of the
"ASCII-to-flow" parser will be shared here as well.

As discussed with and lightly tested by rzalamena@@
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.2 2016/07/19 18:14:08 reyk Exp $
d10 1
a10 1
SRCS+=		ofp13.c ofp_common.c packet.c
@


1.2
log
@The -DNAME=switch flag is an artifact from the PoC when I couldn't
decide on a name.  Remove it and fix the name to switchd now.
@
text
@d1 1
a1 1
# $OpenBSD: Makefile,v 1.1 2016/07/19 16:54:26 reyk Exp $
d3 3
a5 1
.PATH:		${.CURDIR}/../switchd
d9 2
a10 1
SRCS=		log.c switchctl.c parser.c util.c
d15 1
a15 1
CFLAGS+=	-Wall -I${.CURDIR} -I${.CURDIR}/../switchd
d20 14
@


1.1
log
@Import switchd(8), a basic WIP OpenFlow implementation for OpenBSD.

switchd consists of two parts:
1. switchd(8) and switchctl(8), an OpenFlow controller or "vswitch".
2. switch(4), an OpenFlow-aware kernel "bridge".

This the 1st part, the driver will be imported later.  The code will
remain disabled for a while, but it helps development to have it in
the tree.  switchd currently supports partial OpenFlow 1.0, but the
goal is to use OpenFlow 1.3.5 instead (switch(4) already does 1.3.5).

For more background information see:
http://www.openbsd.org/papers/bsdcan2016-switchd.pdf
https://youtu.be/Cuo0qT-lqig

With help from yasuoka@@ goda@@
Import discussed with deraadt@@
@
text
@d1 1
a1 1
# $OpenBSD$
d3 1
a3 1
NAME=		switch
d5 3
a7 5
.PATH:		${.CURDIR}/../${NAME}d

PROG=		${NAME}ctl
MAN=		${NAME}ctl.8
SRCS=		log.c ${NAME}ctl.c parser.c util.c
d12 1
a12 2
CFLAGS+=	-DOFD_NAME=\"${NAME}\"
CFLAGS+=	-Wall -I${.CURDIR} -I${.CURDIR}/../${NAME}d
@

