head	1.55;
access;
symbols
	OPENBSD_6_1:1.53.0.4
	OPENBSD_6_1_BASE:1.53
	OPENBSD_6_0:1.42.0.2
	OPENBSD_6_0_BASE:1.42
	OPENBSD_5_9:1.39.0.2
	OPENBSD_5_9_BASE:1.39
	OPENBSD_5_8:1.38.0.4
	OPENBSD_5_8_BASE:1.38
	OPENBSD_5_7:1.33.0.2
	OPENBSD_5_7_BASE:1.33
	OPENBSD_5_6:1.29.0.4
	OPENBSD_5_6_BASE:1.29
	OPENBSD_5_5:1.28.0.4
	OPENBSD_5_5_BASE:1.28
	OPENBSD_5_4:1.27.0.4
	OPENBSD_5_4_BASE:1.27
	OPENBSD_5_3:1.27.0.2
	OPENBSD_5_3_BASE:1.27
	OPENBSD_5_2:1.26.0.12
	OPENBSD_5_2_BASE:1.26
	OPENBSD_5_1_BASE:1.26
	OPENBSD_5_1:1.26.0.10
	OPENBSD_5_0:1.26.0.8
	OPENBSD_5_0_BASE:1.26
	OPENBSD_4_9:1.26.0.6
	OPENBSD_4_9_BASE:1.26
	OPENBSD_4_8:1.26.0.4
	OPENBSD_4_8_BASE:1.26
	OPENBSD_4_7:1.26.0.2
	OPENBSD_4_7_BASE:1.26
	OPENBSD_4_6:1.24.0.12
	OPENBSD_4_6_BASE:1.24
	OPENBSD_4_5:1.24.0.8
	OPENBSD_4_5_BASE:1.24
	OPENBSD_4_4:1.24.0.6
	OPENBSD_4_4_BASE:1.24
	OPENBSD_4_3:1.24.0.4
	OPENBSD_4_3_BASE:1.24
	OPENBSD_4_2:1.24.0.2
	OPENBSD_4_2_BASE:1.24
	OPENBSD_4_1:1.23.0.2
	OPENBSD_4_1_BASE:1.23
	OPENBSD_4_0:1.22.0.2
	OPENBSD_4_0_BASE:1.22
	OPENBSD_3_9:1.21.0.6
	OPENBSD_3_9_BASE:1.21
	OPENBSD_3_8:1.21.0.4
	OPENBSD_3_8_BASE:1.21
	OPENBSD_3_7:1.21.0.2
	OPENBSD_3_7_BASE:1.21
	OPENBSD_3_6:1.20.0.4
	OPENBSD_3_6_BASE:1.20
	OPENBSD_3_5:1.20.0.2
	OPENBSD_3_5_BASE:1.20
	OPENBSD_3_4:1.18.0.2
	OPENBSD_3_4_BASE:1.18
	OPENBSD_3_3:1.15.0.2
	OPENBSD_3_3_BASE:1.15
	OPENBSD_3_2:1.13.0.6
	OPENBSD_3_2_BASE:1.13
	OPENBSD_3_1:1.13.0.4
	OPENBSD_3_1_BASE:1.13
	OPENBSD_3_0:1.13.0.2
	OPENBSD_3_0_BASE:1.13
	OPENBSD_2_9_BASE:1.12
	OPENBSD_2_9:1.12.0.6
	OPENBSD_2_8:1.12.0.4
	OPENBSD_2_8_BASE:1.12
	OPENBSD_2_7:1.12.0.2
	OPENBSD_2_7_BASE:1.12
	OPENBSD_2_6:1.10.0.2
	OPENBSD_2_6_BASE:1.10
	OPENBSD_2_5:1.9.0.2
	OPENBSD_2_5_BASE:1.9
	OPENBSD_2_4:1.7.0.4
	OPENBSD_2_4_BASE:1.7
	OPENBSD_2_3:1.7.0.2
	OPENBSD_2_3_BASE:1.7
	OPENBSD_2_2:1.6.0.4
	OPENBSD_2_2_BASE:1.6
	OPENBSD_2_1:1.6.0.2
	OPENBSD_2_1_BASE:1.6
	OPENBSD_2_0:1.5.0.2
	OPENBSD_2_0_BASE:1.5
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@.\" @;


1.55
date	2017.04.25.17.45.50;	author bluhm;	state Exp;
branches;
next	1.54;
commitid	hzP8oSrMMFTYEtQc;

1.54
date	2017.04.17.14.18.44;	author bluhm;	state Exp;
branches;
next	1.53;
commitid	2xBS0pNtTszNKd2I;

1.53
date	2017.01.02.15.58.02;	author bluhm;	state Exp;
branches;
next	1.52;
commitid	t1Y67IRsoE20izgW;

1.52
date	2016.10.17.11.19.55;	author bluhm;	state Exp;
branches;
next	1.51;
commitid	yoeynjilxfuZwQte;

1.51
date	2016.10.04.22.09.21;	author bluhm;	state Exp;
branches;
next	1.50;
commitid	725PbGhv3Csdcx8f;

1.50
date	2016.09.24.11.32.25;	author jmc;	state Exp;
branches;
next	1.49;
commitid	nGAhV0LKsLPUL3VA;

1.49
date	2016.09.24.11.30.59;	author jmc;	state Exp;
branches;
next	1.48;
commitid	7FvliHHaGOPwiCvb;

1.48
date	2016.09.23.19.05.55;	author bluhm;	state Exp;
branches;
next	1.47;
commitid	yRvGTs0UHBLJJ878;

1.47
date	2016.09.23.16.29.28;	author bluhm;	state Exp;
branches;
next	1.46;
commitid	tmQCd1Jma5tnJzqt;

1.46
date	2016.09.23.15.46.39;	author bluhm;	state Exp;
branches;
next	1.45;
commitid	BsK1o1gnlxoV4poE;

1.45
date	2016.09.23.12.04.25;	author bluhm;	state Exp;
branches;
next	1.44;
commitid	cmblfqi2punyV2wZ;

1.44
date	2016.09.21.16.42.09;	author jmc;	state Exp;
branches;
next	1.43;
commitid	7cwpPyjFCdxp6QTU;

1.43
date	2016.09.21.11.54.57;	author bluhm;	state Exp;
branches;
next	1.42;
commitid	ARdk8JLFaffOFxtQ;

1.42
date	2016.07.12.23.04.30;	author bluhm;	state Exp;
branches;
next	1.41;
commitid	Kkyjxtj7DZ1vbZsv;

1.41
date	2016.07.12.09.47.25;	author bluhm;	state Exp;
branches;
next	1.40;
commitid	mzm4qhzHBbegj47E;

1.40
date	2016.03.31.15.53.25;	author schwarze;	state Exp;
branches;
next	1.39;
commitid	5hB8ToRx5zcMZQDO;

1.39
date	2015.10.09.16.58.25;	author bluhm;	state Exp;
branches;
next	1.38;
commitid	5A0tNEXnHGGgWpGX;

1.38
date	2015.07.07.21.43.35;	author bluhm;	state Exp;
branches;
next	1.37;
commitid	3vdtQUeXlewqOUow;

1.37
date	2015.07.07.17.53.04;	author bluhm;	state Exp;
branches;
next	1.36;
commitid	Ygwih79fAl6T0IdE;

1.36
date	2015.06.30.12.03.32;	author bluhm;	state Exp;
branches;
next	1.35;
commitid	Zc7oLXwqGtUJdHot;

1.35
date	2015.06.15.22.39.14;	author jmc;	state Exp;
branches;
next	1.34;
commitid	l3KgrpXw2PWbyYXP;

1.34
date	2015.06.15.21.42.15;	author bluhm;	state Exp;
branches;
next	1.33;
commitid	YANAvbNvMccX42N2;

1.33
date	2015.01.30.14.09.49;	author bluhm;	state Exp;
branches;
next	1.32;
commitid	Ke8BSNq3ewXz3XoS;

1.32
date	2015.01.20.22.10.37;	author bluhm;	state Exp;
branches;
next	1.31;
commitid	CNRKA66CGF1WqyW7;

1.31
date	2014.09.08.00.43.42;	author doug;	state Exp;
branches;
next	1.30;
commitid	gbKO3ZNYXDnVBGv2;

1.30
date	2014.08.25.20.25.46;	author bluhm;	state Exp;
branches;
next	1.29;
commitid	nP7Albt9fcePo67Y;

1.29
date	2014.07.23.05.57.36;	author deraadt;	state Exp;
branches;
next	1.28;
commitid	f77ZqgIn2HNXKZDp;

1.28
date	2014.01.21.03.15.46;	author schwarze;	state Exp;
branches;
next	1.27;

1.27
date	2013.02.10.10.47.08;	author markus;	state Exp;
branches;
next	1.26;

1.26
date	2009.10.22.15.02.13;	author sobrado;	state Exp;
branches;
next	1.25;

1.25
date	2009.10.22.12.35.53;	author sobrado;	state Exp;
branches;
next	1.24;

1.24
date	2007.05.31.19.20.29;	author jmc;	state Exp;
branches;
next	1.23;

1.23
date	2007.03.06.13.51.58;	author henning;	state Exp;
branches;
next	1.22;

1.22
date	2006.06.22.20.35.20;	author ray;	state Exp;
branches;
next	1.21;

1.21
date	2004.12.02.21.58.57;	author jmc;	state Exp;
branches;
next	1.20;

1.20
date	2004.01.05.09.45.49;	author jmc;	state Exp;
branches;
next	1.19;

1.19
date	2004.01.04.08.28.49;	author djm;	state Exp;
branches;
next	1.18;

1.18
date	2003.06.12.12.59.53;	author jmc;	state Exp;
branches;
next	1.17;

1.17
date	2003.06.04.16.08.08;	author deraadt;	state Exp;
branches;
next	1.16;

1.16
date	2003.05.08.05.05.27;	author millert;	state Exp;
branches;
next	1.15;

1.15
date	2003.02.14.23.20.36;	author jmc;	state Exp;
branches;
next	1.14;

1.14
date	2002.11.21.07.46.48;	author cloder;	state Exp;
branches;
next	1.13;

1.13
date	2001.05.03.21.12.25;	author deraadt;	state Exp;
branches;
next	1.12;

1.12
date	2000.04.16.01.53.15;	author deraadt;	state Exp;
branches;
next	1.11;

1.11
date	2000.03.19.17.57.16;	author aaron;	state Exp;
branches;
next	1.10;

1.10
date	99.05.23.14.11.38;	author aaron;	state Exp;
branches;
next	1.9;

1.9
date	99.04.02.15.12.21;	author aaron;	state Exp;
branches;
next	1.8;

1.8
date	99.03.11.21.08.03;	author aaron;	state Exp;
branches;
next	1.7;

1.7
date	98.02.11.02.28.32;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	96.12.20.08.18.36;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	96.07.27.01.38.07;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	96.05.10.13.03.55;	author deraadt;	state Exp;
branches;
next	1.3;

1.3
date	96.01.05.14.00.22;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	95.12.15.18.19.23;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.48.22;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.48.22;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.55
log
@Allow syslogd(8) to listen on multiple addresses for incomming TLS
connections.  This expands the feature from UDP and TCP to syslog
over TLS.
input jmc@@; OK millert@@
@
text
@.\"	$OpenBSD: syslogd.8,v 1.54 2017/04/17 14:18:44 bluhm Exp $
.\"
.\" Copyright (c) 1983, 1986, 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"     from: @@(#)syslogd.8	8.1 (Berkeley) 6/6/93
.\"	$NetBSD: syslogd.8,v 1.3 1996/01/02 17:41:48 perry Exp $
.\"
.Dd $Mdocdate: April 17 2017 $
.Dt SYSLOGD 8
.Os
.Sh NAME
.Nm syslogd
.Nd log system messages
.Sh SYNOPSIS
.Nm syslogd
.Bk -words
.Op Fl 46dFhnruVZ
.Op Fl a Ar path
.Op Fl C Ar CAfile
.Op Fl c Ar cert_file
.Op Fl f Ar config_file
.Op Fl K Ar CAfile
.Op Fl k Ar key_file
.Op Fl m Ar mark_interval
.Op Fl p Ar log_socket
.Op Fl S Ar listen_address
.Op Fl s Ar reporting_socket
.Op Fl T Ar listen_address
.Op Fl U Ar bind_address
.Ek
.Sh DESCRIPTION
.Nm
writes system messages to log files or a user's terminal.
Output can be sent to other programs
for further processing.
It can also securely send and receive log messages
to and from remote hosts.
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl 4
Forces
.Nm
to use only IPv4 addresses for UDP.
.It Fl 6
Forces
.Nm
to use only IPv6 addresses for UDP.
.It Fl a Ar path
Specify a location where
.Nm
should place an additional log socket.
The primary use for this is to place additional log sockets in
.Pa /dev/log
of various chroot filespaces, though the need for these is
less urgent after the introduction of
.Xr sendsyslog 2 .
.It Fl C Ar CAfile
PEM encoded file containing CA certificates used for certificate
validation of a remote loghost;
the default is
.Pa /etc/ssl/cert.pem .
.It Fl c Ar cert_file
PEM encoded file containing the client certificate for TLS connections
to a remote host.
The default is not to use a client certificate for the connection
to a syslog server.
This option has to be used together with
.Fl k Ar key_file .
.It Fl d
Enable debugging to the standard output,
and do not disassociate from the controlling terminal.
.It Fl F
Run in the foreground instead of disassociating from the controlling
terminal and running as a background daemon.
.It Fl f Ar config_file
Specify the pathname of an alternate configuration file;
the default is
.Pa /etc/syslog.conf .
.It Fl h
Include the hostname when forwarding messages to a remote host.
.It Fl K Ar CAfile
PEM encoded file containing CA certificates used for client certificate
validation on the local server socket.
By default incoming connections from any TLS server are allowed.
.It Fl k Ar key_file
PEM encoded file containing the client private key for TLS connections
to a remote host.
This option has to be used together with
.Fl c Ar cert_file .
.It Fl m Ar mark_interval
Select the number of minutes between
.Dq mark
messages; the default is 20 minutes.
.It Fl n
Print source addresses numerically rather than symbolically.
This saves an address-to-name lookup for each incoming message,
which can be useful when combined with the
.Fl u
option on a loghost with no DNS cache.
Messages from the local host will still be logged with
the symbolic local host name.
.It Fl p Ar log_socket
Specify the pathname of an alternate log socket to be used instead;
the default is
.Pa /dev/log .
.It Fl r
Print duplicate lines immediately and suppress the "last message
repeated" summary when piping to another program or forwarding to
a remote loghost.
If given twice, this is done for all log actions.
.It Fl S Ar listen_address
Create a TLS listen socket for receiving encrypted messages and
bind it to the specified address.
A port number may be specified using the
.Ar host : Ns Ar port
syntax.
The first
.Ar listen_address
is also used to find a suitable server key and certificate in
.Pa /etc/ssl/ .
.It Fl s Ar reporting_socket
Specify path to an
.Dv AF_LOCAL
socket for use in reporting logs stored in memory buffers using
.Xr syslogc 8 .
.It Fl T Ar listen_address
Create a TCP listen socket for receiving messages and bind it to
the specified address.
There is no well-known port for syslog over TCP, so a port number
must be specified using the
.Ar host : Ns Ar port
syntax.
.It Fl U Ar bind_address
Create a UDP socket for receiving messages and bind it to the
specified address.
This can be used, for example, with a pf divert-to rule to receive
packets when syslogd is bound to localhost.
A port number may be specified using the
.Ar host : Ns Ar port
syntax.
.It Fl u
Select the historical
.Dq insecure
mode, in which syslogd will
accept input from the UDP port.
Some software wants this, but you can be subjected to a variety of
attacks over the network, including attackers remotely filling logs.
.It Fl V
Do not perform remote server certificate and hostname validation
when sending messages.
.It Fl Z
Generate timestamps in ISO format.
This includes the year and the timezone, and all logging is done
in UTC.
.El
.Pp
The options
.Fl a , S , T ,
and
.Fl U
can be given more than once to specify multiple input sources.
.Pp
.Nm
reads its configuration file,
.Xr syslog.conf 5 ,
when it starts up and whenever it
receives a hangup signal.
It creates the file
.Pa /var/run/syslog.pid
and stores its process ID there.
The PID can be used to kill or reconfigure
.Nm .
.Pp
.Nm
opens a UDP socket, as specified
in
.Pa /etc/services ,
for sending forwarded messages.
By default all incoming data on this socket is discarded.
If insecure mode is switched on with
.Fl u ,
it will also read messages from the socket.
.Nm
also opens and reads messages from the
.Ux Ns -domain
socket
.Pa /dev/log ,
and from the special device
.Pa /dev/klog
(to read kernel messages),
and from
.Xr sendsyslog 2
(to read messages from userland processes).
.Pp
The message sent to
.Nm
should consist of a single line.
The message can contain a priority code, which should be a preceding
decimal number in angle braces, for example,
.Dq <5> .
This priority code should map into the priorities defined in the
include file
.In sys/syslog.h .
.Pp
When sending syslog messages to a remote loghost via TLS, the
server's certificate and hostname are validated to prevent malicious
servers from reading messages.
If the server has a certificate with a matching hostname signed by
a CA in
.Pa /etc/ssl/cert.pem ,
it is verified with that by default.
If the server has a certificate with a matching hostname signed by
a private CA, use the
.Fl C
option and put that CA into
.Ar CAfile .
Validation can be explicitly turned off using the
.Fl V
option.
If the server is accepting messages only from clients with a trusted
client certificate, use the
.Fl k
and
.Fl c
options to authenticate
.Nm
with this certificate.
.Pp
When receiving syslog messages from a TLS client, there must be
a server key and certificate in
.Pa /etc/ssl/private/host Ns Oo : Ns Ar port Oc Ns Ar .key
and
.Pa /etc/ssl/host Ns Oo : Ns Ar port Oc Ns Ar .crt .
If the client uses certificates to authenticate, the CA of the
client's certificate may be added to
.Ar CAfile
using the
.Fl K
option to protect from messages being spoofed by malicious clients.
.Sh FILES
.Bl -tag -width /var/run/syslog.pid -compact
.It Pa /dev/log
Name of the
.Ux Ns -domain
datagram log socket.
.It Pa /dev/klog
Kernel log device.
.It Pa /etc/ssl/
Private keys and public certificates.
.It Pa /etc/syslog.conf
Configuration file.
.It Pa /var/run/syslog.pid
Process ID of current
.Nm .
.El
.Sh SEE ALSO
.Xr logger 1 ,
.Xr syslog 3 ,
.Xr services 5 ,
.Xr syslog.conf 5 ,
.Xr newsyslog 8 ,
.Xr syslogc 8
.Sh HISTORY
The
.Nm
command appeared in
.Bx 4.3 .
.Sh CAVEATS
.Nm
does not create files,
it only logs to existing ones.
@


1.54
log
@Add syslogd(8) option -r to suppress the summary line for pipe and
remote loghost as they are most commonly used for automated log
processing.  With -rr the "last message repeated" feature can be
disabled completely.
OK sthen@@ deraadt@@ jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.53 2017/01/02 15:58:02 bluhm Exp $
d33 1
a33 1
.Dd $Mdocdate: January 2 2017 $
d143 3
a145 2
The parameter is also used to find a suitable server key and
certificate in
d184 1
a184 1
.Fl a , T ,
@


1.53
log
@Syslogd accepted network input only for either IPv4 or IPv6.  To
overcome this limitation, allow to specify more than one listen
address for UDP and TCP.
input jmc@@; OK deraadt@@ millert@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.52 2016/10/17 11:19:55 bluhm Exp $
d33 1
a33 1
.Dd $Mdocdate: October 17 2016 $
d42 1
a42 1
.Op Fl 46dFhnuVZ
d132 5
@


1.52
log
@Remove the artificial maximum number of unix domain sockets in
syslogd(8).  Just malloc(3) them dynamically which also gives a
more random address space layout.
OK deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.51 2016/10/04 22:09:21 bluhm Exp $
d33 1
a33 1
.Dd $Mdocdate: October 4 2016 $
d176 6
@


1.51
log
@When doing global remote logging and archiving, it is inconvenient
that the syslog timestamp does not contain the year and the timezone,
but has local time with daylight saving time.
Now with -Z syslogd(8) switches to RFC 5424 ISO format for timestamps.
Then all logging is also done in UTC.  Default is to keep local
time and BSD syslog RFC 3164 format.
BIG BIG BIG OK for the feature ajacoutot@@; OK deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.50 2016/09/24 11:32:25 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: September 24 2016 $
a77 1
Up to 20 additional logging sockets can be specified.
@


1.50
log
@sort FILES;
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.49 2016/09/24 11:30:59 jmc Exp $
d42 1
a42 1
.Op Fl 46dFhnuV
d172 4
@


1.49
log
@improve DESCRIPTION;
from bluhm and myself
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.48 2016/09/23 19:05:55 bluhm Exp $
d33 1
a33 1
.Dd $Mdocdate: September 23 2016 $
a252 5
.It Pa /etc/syslog.conf
Configuration file.
.It Pa /var/run/syslog.pid
Process ID of current
.Nm .
d261 5
@


1.48
log
@Revert a wording change.  Requested by jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.47 2016/09/23 16:29:28 bluhm Exp $
d58 5
a62 3
reads and logs messages to the system console, log files, pipes to
other programs, other machines and/or users as specified by its
configuration file.
@


1.47
log
@Add some more improvements from jmc@@ to syslogd(8).
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.46 2016/09/23 15:46:39 bluhm Exp $
d214 1
a214 1
When sending syslog messages to a remote loghost via TLS, this
@


1.46
log
@Document certificate handling in syslogd(8) man page.
Written together with jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.45 2016/09/23 12:04:25 bluhm Exp $
d214 1
a214 1
When sending syslog messages to a remote loghost via TLS, the
d229 2
a230 1
If the server is not accepting messages from anybody, use the
d234 1
a234 1
options to to authenticate
d236 1
a236 1
with a client certificate.
@


1.45
log
@Improve syslogd(8) man page.
Written together with jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.44 2016/09/21 16:42:09 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: September 21 2016 $
d38 1
a38 1
.Nd log systems messages
d47 1
a47 1
.Op Fl K Ar server_CAfile
d83 2
a84 1
PEM encoded file containing CA certificates used for certificate validation;
a86 5
Remote server certificates and their hostnames are validated with this
CA to prevent malicious servers from reading messages.
Validation can be explicitly turned off using the
.Fl V
option.
d106 2
a107 2
.It Fl K Ar server_CAfile
PEM encoded file containing CA certificates used for certificate
a109 2
Enforce client certificates and validate them with this CA to prevent
malicious clients from sending fake messages.
d137 3
a139 13
The syslog server will attempt to look up a private key in
.Pa /etc/ssl/private/host:port.key
and a public certificate in
.Pa /etc/ssl/host:port.crt ,
where
.Ar host
is the specified host name or IP address and
.Ar port
is the specified port if given on the command line.
If these files are not present, syslogd will continue to look in
.Pa /etc/ssl/private/host.key
and
.Pa /etc/ssl/host.crt .
d213 35
@


1.44
log
@tweak previous;
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.43 2016/09/21 11:54:57 bluhm Exp $
d141 1
a141 1
.Ar host:port
d166 1
a166 1
.Ar host:port
d174 1
a174 1
.Ar host:port
d189 3
a191 1
reads its configuration file when it starts up and whenever it
d193 2
a194 7
For information on the format of the configuration file,
see
.Xr syslog.conf 5 .
.Pp
.Nm
creates the file
.Pa /var/run/syslog.pid ,
d196 2
a197 2
This can be used to kill or reconfigure
.Nm syslogd .
d200 1
a200 1
opens an Internet domain socket as specified
d202 6
a207 6
.Pa /etc/services .
Normally
.Nm
will only use this socket to send messages outwards, but in
.Dq insecure
mode it will also read messages from this socket.
d215 4
a218 9
(to read kernel messages).
.Pp
.Nm
opens the above described socket whether or not it is
running in secure mode.
If
.Nm
is running in secure mode, all incoming data on this socket is discarded.
The socket is required for sending forwarded messages.
d232 1
a232 1
configuration file
d234 2
a235 2
process ID of current
.Nm syslogd
d237 1
a237 1
name of the
d239 1
a239 1
datagram log socket
d241 3
a243 1
kernel log device
@


1.43
log
@Add an option to give syslogd a server CA that is used to validate
client certificates.  This prevent that malicious clients can send
fake messages.
OK deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.42 2016/07/12 23:04:30 bluhm Exp $
d33 1
a33 1
.Dd $Mdocdate: July 12 2016 $
d83 1
a83 2
PEM encoded file containing CA certificates used for certificate
validation;
d86 3
a88 3
Validate remote server certificates and their hostnames with this
CA to prevent that malicious servers read messages.
This validation can be explicitly turned off using the
d90 1
a90 1
switch.
d112 2
a113 2
valitation on the local server socket.
By default incomming connections from any TLS server are allowed.
d115 1
a115 1
that malicious clients send fake messages.
@


1.42
log
@Document that the syslogd options -c and -k must be used together.
OK jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.41 2016/07/12 09:47:25 bluhm Exp $
d47 1
d87 5
d111 6
d185 2
a186 1
Do not perform server certificate and hostname validation.
@


1.41
log
@Add support for TLS client certificates in syslogd.  This allows a
remote server to verify that the log messages from our syslogd are
authentic.
From Kapetanakis Giannis; man page input jmc@@; OK jung@@ deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.40 2016/03/31 15:53:25 schwarze Exp $
d33 1
a33 1
.Dd $Mdocdate: March 31 2016 $
d91 2
@


1.40
log
@Don't use .Aq for syntax elements that require ASCII "<>".
Patch from Christian Heckendorf <mbie at ulmus dot me>.
OK jmc@@ bentley@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.39 2015/10/09 16:58:25 bluhm Exp $
d33 1
a33 1
.Dd $Mdocdate: October 9 2015 $
d45 1
d47 1
d86 5
d103 5
@


1.39
log
@If syslogd is started with -S, it accepts TLS connections to receive
encrypted messages.  The server certificates are taken from /etc/ssl
like relayd does.
OK benno@@ beck@@ deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.38 2015/07/07 21:43:35 bluhm Exp $
d33 1
a33 1
.Dd $Mdocdate: July 7 2015 $
d207 1
a207 1
.Dq Aq 5 .
@


1.38
log
@Do not explain multiple times how to put brackets around IPv6
addresses in syslogd(8).  Using brackets to separate an IPv6 address
from the port number is common practice and we keep the text in
syslog.conf(5).
OK jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.37 2015/07/07 17:53:04 bluhm Exp $
d48 1
d112 19
@


1.37
log
@When syslogd is invoked with -T listen_address, it creates a TCP
socket and accepts incomming messages.  At the moment, only RFC
6587 3.4.2. Non-Transparent-Framing format with new-line separator
is supprted for incomming messsages.  Outgoing messages are encoded
as 3.4.1. Octet Counting.  Autodetection of incomming format will
be implemented later.
OK deraadt@@ jmc@@ millert@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.36 2015/06/30 12:03:32 bluhm Exp $
d33 1
a33 1
.Dd $Mdocdate: June 30 2015 $
a122 7
IPv6 addresses can be used by surrounding the address portion with
square brackets
.Po
.Ql [\&
and
.Ql ]\&
.Pc .
a130 7
IPv6 addresses can be used by surrounding the address portion with
square brackets
.Po
.Ql [\&
and
.Ql ]\&
.Pc .
@


1.36
log
@Add a -U command line switch for syslogd to specify an explict bind
address to receive UDP packets.  One advantge over -u and the *
sockets is that you can bind to localhost and divert the packets
with pf.  It is also possible to use a non standard port.
OK jung@@ jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.35 2015/06/15 22:39:14 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: June 15 2015 $
d49 1
d116 14
@


1.35
log
@put -F before -f in the options list;
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.34 2015/06/15 21:42:15 bluhm Exp $
d49 1
d115 15
@


1.34
log
@Implement a -F switch, that tells syslogd to stay in foreground.
OK benno@@; input millert@@; no objections deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.33 2015/01/30 14:09:49 bluhm Exp $
d33 1
a33 1
.Dd $Mdocdate: January 30 2015 $
d84 3
a90 3
.It Fl F
Run in the foreground instead of disassociating from the controlling
terminal and running as a background daemon.
@


1.33
log
@Document the syslogd certificate validation options.
OK jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.32 2015/01/20 22:10:37 bluhm Exp $
d33 1
a33 1
.Dd $Mdocdate: January 20 2015 $
d42 1
a42 1
.Op Fl 46dhnuV
d88 3
@


1.32
log
@Document how to send syslog messages over TCP or TLS.
OK jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.31 2014/09/08 00:43:42 doug Exp $
d33 1
a33 1
.Dd $Mdocdate: September 8 2014 $
d42 1
a42 1
.Op Fl 46dhnu
d44 1
d76 5
d118 2
@


1.31
log
@Fix a syslogd regression when specifying all 20 additional log paths

bluhm@@ found and fixed this bug.  This is a modified version of his
patch which makes the intention a little clearer.

ok bluhm@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.30 2014/08/25 20:25:46 bluhm Exp $
d33 1
a33 1
.Dd $Mdocdate: August 25 2014 $
d60 1
a60 1
to use IPv4 addresses only.
d64 1
a64 1
to use IPv6 addresses only.
@


1.30
log
@Document the IPv4/IPv6 command line switches and protocol loghost
prefixes.
OK jmc@@ henning@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.29 2014/07/23 05:57:36 deraadt Exp $
d33 1
a33 1
.Dd $Mdocdate: July 23 2014 $
d69 1
a69 1
Up to about 20 additional logging sockets can be specified.
@


1.29
log
@document that sendsyslog saves the day
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.28 2014/01/21 03:15:46 schwarze Exp $
d33 1
a33 1
.Dd $Mdocdate: January 21 2014 $
d42 1
a42 1
.Op Fl dhnu
d57 8
@


1.28
log
@obvious .Pa fixes; found with mandocdb(8)
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.27 2013/02/10 10:47:08 markus Exp $
d33 1
a33 1
.Dd $Mdocdate: February 10 2013 $
d64 3
a66 1
of various chroot filespaces.
@


1.27
log
@-h includes RFC 3164 style hostnames when forwarding;
feedback and ok sthen@@, mpf@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.26 2009/10/22 15:02:13 sobrado Exp $
d33 1
a33 1
.Dd $Mdocdate: October 22 2009 $
d57 1
a57 1
.It Fl a Pa path
d152 1
a152 1
.Aq Pa sys/syslog.h .
@


1.26
log
@write UNIX-domain in a more consistent way; while here, replace a
few remaining ".Tn UNIX" macros with ".Ux" ones.

pointed out by ratchov@@, thanks!

ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.25 2009/10/22 12:35:53 sobrado Exp $
d42 1
a42 1
.Op Fl dnu
d72 2
@


1.25
log
@use the UNIX-related macros (.At and .Ux) where appropriate.

ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.24 2007/05/31 19:20:29 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: May 31 2007 $
d127 2
a128 2
.Ux
domain socket
d160 2
a161 2
.Ux
domain datagram log socket
@


1.24
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.23 2007/03/06 13:51:58 henning Exp $
d33 1
a33 1
.Dd $Mdocdate$
d127 1
a127 1
.Tn UNIX
d160 1
a160 1
.Tn UNIX
@


1.23
log
@mention log to pipe in the blurb here. the details are all in syslog.conf.5,
the syslogd.8 blurb has just a list.
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.22 2006/06/22 20:35:20 ray Exp $
d33 1
a33 1
.Dd June 6, 1993
@


1.22
log
@CAVEATS
syslogd does not create files, it only logs to existing ones.

From millert@@: http://marc.theaimsgroup.com/?m=106329875409953

``Good idea'' millert@@, ``fine by me too'' jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.21 2004/12/02 21:58:57 jmc Exp $
d51 3
a53 2
reads and logs messages to the system console, log files, other
machines and/or users as specified by its configuration file.
@


1.21
log
@group paragraphs more logically;
suggested by michael knudsen;
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.20 2004/01/05 09:45:49 jmc Exp $
d176 4
@


1.20
log
@sort options and SYNOPSIS;
sync usage();
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.19 2004/01/04 08:28:49 djm Exp $
d109 7
a139 7
.Pp
.Nm
creates the file
.Pa /var/run/syslog.pid ,
and stores its process ID there.
This can be used to kill or reconfigure
.Nm syslogd .
@


1.19
log
@Buffered logging for syslogd. Logs may be stored in memory buffers and
extracted using a small client. Useful for diskless systems.
much feedback from deraadt@@, canacar@@, jmc@@, jakob@@ ; ok deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.18 2003/06/12 12:59:53 jmc Exp $
d43 1
a45 1
.Op Fl a Ar path
d56 8
a82 7
.It Fl u
Select the historical
.Dq insecure
mode, in which syslogd will
accept input from the UDP port.
Some software wants this, but you can be subjected to a variety of
attacks over the network, including attackers remotely filling logs.
a86 8
.It Fl a Pa path
Specify a location where
.Nm
should place an additional log socket.
Up to about 20 additional logging sockets can be specified.
The primary use for this is to place additional log sockets in
.Pa /dev/log
of various chroot filespaces.
d92 7
@


1.18
log
@- section reorder
- macro fixes
- kill whitespace at EOL
- new sentence, new line
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.17 2003/06/04 16:08:08 deraadt Exp $
d47 1
d94 5
d169 2
a170 1
.Xr newsyslog 8
@


1.17
log
@fix some more UCB term 3
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.16 2003/05/08 05:05:27 millert Exp $
d71 3
a73 2
option on a loghost with no DNS cache.  Messages from the local
host will still be logged with the symbolic local host name.
a168 1

@


1.16
log
@.Xr newsyslog
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.15 2003/02/14 23:20:36 jmc Exp $
d14 1
a14 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgment:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
@


1.15
log
@typos;

tftpd(8): tweak and ok millert@@
tokenadm(8): tweak and ok millert@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.14 2002/11/21 07:46:48 cloder Exp $
d165 2
a166 1
.Xr syslog.conf 5
@


1.14
log
@Add -n option to print message source addresses numerically rather than
symbolically.  This saves address->name lookups, which is nice on log
servers without a DNS cache.

millert@@, jakob@@ ok
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.13 2001/05/03 21:12:25 deraadt Exp $
d45 1
d51 1
d73 1
a73 1
which can useful when combined with the
@


1.13
log
@fix typo; isaki@@par.odn.ne.jp
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.12 2000/04/16 01:53:15 deraadt Exp $
d45 1
a45 1
.Op Fl du
d68 7
@


1.12
log
@for the Nth time, the damn syslog socket is required
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.11 2000/03/19 17:57:16 aaron Exp $
d134 1
a134 1
.Dq Aq 5. .
@


1.11
log
@Remove hard sentence breaks. Add $OpenBSD$ tags where appropriate. Some other
cleanup along the way.
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.10 1999/05/23 14:11:38 aaron Exp $
d113 8
@


1.10
log
@remove argument from .Os macros so value in /usr/share/tmac/mdoc/doc-common
is used instead; kwesterback@@home.com
@
text
@d1 2
a2 1
.\"	$OpenBSD: syslogd.8,v 1.9 1999/04/02 15:12:21 aaron Exp $
@


1.9
log
@all .Nm macros should have an argument in SYNOPSIS; also misc cleanup
@
text
@d1 1
a1 1
.\"	$OpenBSD: syslogd.8,v 1.8 1999/03/11 21:08:03 aaron Exp $
d38 1
a38 1
.Os BSD 4.2
@


1.8
log
@cleanup
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d43 1
a43 1
.Nm
@


1.7
log
@syslogd gets a new -a argument: specify additional AF_UNIX log devices
syslogd should create & listen to. As in "syslogd -a /chroot/dev/log",
I'm sure you get the idea.
@
text
@d1 1
d43 1
a43 1
.Nm syslogd
d50 1
a50 1
.Nm Syslogd
d53 1
d64 3
a66 2
Select the number of minutes between ``mark'' messages;
the default is 20 minutes.
d68 3
a70 1
Select the historical ``insecure'' mode, in which syslogd will
d80 1
a80 1
.Nm syslogd
d88 1
a88 1
.Nm Syslogd
d95 1
a95 1
.Nm Syslogd
d100 1
a100 1
.Nm syslogd
d102 3
a104 2
`insecure'' mode it will also read messages from this socket.
.Nm Syslogd
d113 1
a113 1
.Nm Syslogd
d116 1
a116 2
and stores its process
id there.
d121 1
a121 1
.Nm syslogd
d125 1
a125 1
.Sq Aq 5.
d132 1
a132 1
The configuration file.
d134 2
a135 2
The process id of current
.Nm syslogd .
d137 1
a137 1
Name of the
d139 1
a139 1
domain datagram log socket.
d141 1
a141 1
The kernel log device.
d153 1
@


1.6
log
@actually explain what -u does
@
text
@d43 1
a43 1
.Op Fl d
d46 1
a47 1
.Op Fl u
d57 1
a57 1
.It Fl f
d61 1
a61 1
.It Fl m
d69 2
a70 2
.It Fl p
Specify the pathname of an alternate log socket;
d73 8
@


1.5
log
@snprintf some more; also change -s to -u (-u is insecure mode, opens udp port)
@
text
@d66 1
a66 1
open a UDP socket and accept input over it as well.
d83 9
a91 1
reads messages from the
a94 2
from an Internet domain socket specified in
.Pa /etc/services ,
@


1.4
log
@doc flags better
@
text
@d47 1
a47 1
.Op Fl s
d64 5
a68 7
.It Fl s
Select ``secure'' mode, in which syslogd does not open a UDP socket but
only communicates over a UNIX domain socket.
This is valuable when the machine on
which syslogd runs is subject to attack over the network and it is desired
that the machine be protected from attempts to remotely fill logs
and similar attacks.
@


1.3
log
@sync with 4.4lite2 version, as well as netbsd changes merged by perry.
retain openbsd changes too.
@
text
@d13 1
a13 1
.\"    must display the following acknowledgement:
d43 1
d47 1
d54 3
@


1.2
log
@-s option prevents opening of UDP port; from perry@@piermont.com; netbsd pr#1761
@
text
@d1 2
a2 2
.\" Copyright (c) 1983, 1986, 1991 The Regents of the University of California.
.\" All rights reserved.
d32 2
a33 2
.\"     from: @@(#)syslogd.8	6.10 (Berkeley) 3/16/91
.\"	$Id: syslogd.8,v 1.1.1.1 1995/10/18 08:48:22 deraadt Exp $
d35 1
a35 1
.Dd March 16, 1991
@


1.1
log
@Initial revision
@
text
@d33 1
a33 1
.\"	$Id: syslogd.8,v 1.2 1993/08/01 07:23:26 mycroft Exp $
d59 7
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
