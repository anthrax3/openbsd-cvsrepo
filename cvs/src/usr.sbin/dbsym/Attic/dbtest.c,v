head	1.2;
access;
symbols
	OPENBSD_2_2:1.1.1.1.0.6
	OPENBSD_2_2_BASE:1.1.1.1
	OPENBSD_2_1:1.1.1.1.0.4
	OPENBSD_2_1_BASE:1.1.1.1
	OPENBSD_2_0:1.1.1.1.0.2
	OPENBSD_2_0_BASE:1.1.1.1
	netbsd_1_1:1.1.1.1
	netbsd_1_1:1.1.1;
locks; strict;
comment	@ * @;


1.2
date	97.11.17.17.34.55;	author kstailey;	state dead;
branches;
next	1.1;

1.1
date	95.10.18.08.47.31;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.47.31;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.2
log
@remove parts of dbsym
@
text
@
#include <stdio.h>
#include <a.out.h>

#define		SYMTAB_SPACE  0x8000
int db_symtabsize = SYMTAB_SPACE;
char db_symtab[SYMTAB_SPACE] = { 0,0,0,0,1 };
/*
 * The actual format of the above is:
 *	int symtab_length = NSYMS;
 *	struct nlist[NSYMS];
 *	int strtab_length;
 *	char strtab[];
 */

/* Print out our symbol table. */
main()
{
	struct nlist *nl;
	int symtab_len, strtab_len;
	char *strtab;
	char *p;
	int *ip;
	int st, sc, x;

	/* symbol table */
	ip = (int*) db_symtab;
	symtab_len = *ip++;
	if (symtab_len < 4) {
		printf("no symbol table\n");
		exit(1);
	}
	nl = (struct nlist *) ip;

	/* string table pointer and length */
	ip = (int*) ((char*)ip + symtab_len);
	strtab =  (char*)ip;
	strtab_len = *ip;

	if (strtab_len > (SYMTAB_SPACE - symtab_len))
		strtab_len = (SYMTAB_SPACE - symtab_len);

	/* print symbol table */
	while ((x=nl->n_un.n_strx) != 0) {
		if (x < 0 || x >= strtab_len) p = "?";
		else p = strtab + x;
		st = nl->n_type & 0x1F;
		sc = "uatdbxxxxcxxxxxxx"[st>1];
		if (st & 1) sc &= ~0x20;	/* to upper */
		printf("%08X %c %s\n", nl->n_value, sc, p);
		nl++;
		if ((char*)nl >= strtab) {
			printf("symbol table missing null terminator\n");
			break;
		}
	}
	exit(0);
}
@


1.1
log
@Initial revision
@
text
@@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
