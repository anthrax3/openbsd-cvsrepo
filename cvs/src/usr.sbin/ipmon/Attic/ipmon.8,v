head	1.12;
access;
symbols
	OPENBSD_2_9_BASE:1.11
	OPENBSD_2_9:1.11.0.8
	OPENBSD_2_8:1.11.0.6
	OPENBSD_2_8_BASE:1.11
	OPENBSD_2_7:1.11.0.4
	OPENBSD_2_7_BASE:1.11
	OPENBSD_2_6:1.11.0.2
	OPENBSD_2_6_BASE:1.11
	OPENBSD_2_5:1.10.0.2
	OPENBSD_2_5_BASE:1.10
	OPENBSD_2_4:1.5.0.2
	OPENBSD_2_4_BASE:1.5
	OPENBSD_2_3:1.4.0.2
	OPENBSD_2_3_BASE:1.4
	OPENBSD_2_2:1.3.0.4
	OPENBSD_2_2_BASE:1.3
	OPENBSD_2_1:1.3.0.2
	OPENBSD_2_1_BASE:1.3
	OPENBSD_2_0:1.1.0.2
	OPENBSD_2_0_BASE:1.1;
locks; strict;
comment	@# @;


1.12
date	2001.05.30.02.14.07;	author deraadt;	state dead;
branches;
next	1.11;

1.11
date	99.06.05.22.17.06;	author aaron;	state Exp;
branches;
next	1.10;

1.10
date	99.03.10.21.25.30;	author pjanzen;	state Exp;
branches;
next	1.9;

1.9
date	99.02.10.22.12.54;	author deraadt;	state Exp;
branches;
next	1.8;

1.8
date	99.02.05.05.58.48;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	98.12.28.10.08.42;	author hugh;	state Exp;
branches;
next	1.6;

1.6
date	98.11.18.01.41.08;	author aaron;	state Exp;
branches;
next	1.5;

1.5
date	98.09.15.10.01.39;	author pattonme;	state Exp;
branches;
next	1.4;

1.4
date	98.01.26.04.16.46;	author dgregor;	state Exp;
branches;
next	1.3;

1.3
date	97.04.09.11.24.38;	author kstailey;	state Exp;
branches;
next	1.2;

1.2
date	97.02.11.22.24.08;	author kstailey;	state Exp;
branches;
next	1.1;

1.1
date	96.01.07.02.34.31;	author dm;	state Exp;
branches;
next	;


desc
@@


1.12
log
@Remove ipf.  Darren Reed has interpreted his (old, new, whichever)
licence in a way that makes ipf not free according to the rules we
established over 5 years ago, at www.openbsd.org/goals.html (and those
same basic rules govern the other *BSD projects too).  Specifically,
Darren says that modified versions are not permitted.  But software
which OpenBSD uses and redistributes must be free to all (be they
people or companies), for any purpose they wish to use it, including
modification, use, peeing on, or even integration into baby mulching
machines or atomic bombs to be dropped on Australia.  Furthermore, we
know of a number of companies using ipf with modification like us, who
are now in the same situation, and we hope that some of them will work
with us to fill this gap that now exists in OpenBSD (temporarily, we
hope).
@
text
@.\"     $OpenBSD: ipmon.8,v 1.11 1999/06/05 22:17:06 aaron Exp $
.TH ipmon 8
.SH NAME
ipmon \- monitors /dev/ipl for logged packets
.SH SYNOPSIS
.B ipmon
[
.B \-aDFhnstvxX
] [
.B "\-o [NSI]"
] [
.B "\-O [NSI]"
] [
.B "\-N <device>"
] [
.B "\-S <device>"
] [
.B "\-f <device>"
] [
.B <filename>
]
.SH DESCRIPTION
.LP
\fBipmon\fP opens \fB/dev/ipl\fP for reading and awaits data to be saved from
the packet filter.  The binary data read from the device is reprinted in
human readable form; however, IP#'s are not mapped back to hostnames, nor are
ports mapped back to service names.  The output goes to standard output by
default or a filename, if given on the command line.  Should the \fB\-s\fP
option be used, output is instead sent to \fBsyslogd(8)\fP.  Messages sent
via syslog have the day, month and year removed from the message, but the
time (including microseconds), as recorded in the log, is still included.
.SH OPTIONS
.TP
.B \-a
Open all of the device logfiles for reading log entries from.  All entries
are displayed to the same output 'device' (stderr or syslog).
.TP
.B "\-f <device>"
specify an alternative device/file from which to read the log information
for normal IP Filter log records.
.TP
.B \-D
When set ipmon will fork and become a daemon.
.TP
.B \-F
Flush the current packet log buffer.  The number of bytes flushed is displayed,
even should the result be zero.
.TP
.B "\-N <device>"
Set the logfile to be opened for reading NAT log records from to <device>.
.TP
.B \-n
IP addresses and port numbers will be mapped, where possible, back into
hostnames and service names.
.TP
.B \-o
Specify which log files to actually read data from.  N - NAT logfile,
S - State logfile, I - normal IP Filter logfile.  The \fB-a\fP option is
equivalent to using \fB-o NSI\fP.
.TP
.B \-O
Specify which log files you do not wish to read from.  This is most sensibly
used with the \fB-a\fP.  Letters available as parameters to this are the same
as for \fB-o\fP.
.TP
.B \-s
Packet information read in will be sent through syslogd rather than
saved to a file.  The default facility when compiled and installed is
\fBlocal0\fP.  The following levels are used:
.IP
.B LOG_INFO
\- packets logged using the "log" keyword as the action rather
than pass or block.
.IP
.B LOG_NOTICE
\- packets logged which are also passed
.IP
.B LOG_WARNING
\- packets logged which are also blocked
.IP
.B LOG_ERR
\- packets which have been logged and which can be considered
"short".
.TP
.B \-S
Treat the logfile as being composed of state log records.
.TP
.B "\-S <device>"
Set the logfile to be opened for reading state log records from to <device>.
.IP
.B \-t
read the input file/device in a manner akin to tail(1).
.TP
.B \-v
show tcp window, ack and sequence fields.
.TP
.B \-x
show the packet data in hex.
.TP
.B \-X
show the log header record data in hex.
.SH DIAGNOSTICS
\fBipmon\fP expects data that it reads to be consistent with how it should be
saved and will abort if it fails an assertion which detects an anomaly in the
recorded data.
.SH FILES
/dev/ipl
.br
/dev/ipnat
.br
/dev/ipstate
.SH SEE ALSO
ipf(8), ipftest(1), ipnat(8), ipf(4), ipl(4), ipnat(4), ipf(5), ipnat(5), ipfstat(8)
.br
http://coombs.anu.edu.au/ipfilter/
.SH BUGS
@


1.11
log
@remove trailing whitespace, some Nm cleanup
@
text
@d1 1
a1 1
.\"     $OpenBSD: ipmon.8,v 1.10 1999/03/10 21:25:30 pjanzen Exp $
@


1.10
log
@fix comma splices involving 'however'
@
text
@d1 1
a1 1
.\"     $OpenBSD: ipmon.8,v 1.9 1999/02/10 22:12:54 deraadt Exp $          
@


1.9
log
@Xr repairs
@
text
@d1 1
a1 1
.\"     $OpenBSD: ipmon.8,v 1.8 1999/02/05 05:58:48 deraadt Exp $          
d26 1
a26 1
human readable for, however, IP#'s are not mapped back to hostnames, nor are
@


1.8
log
@ipf 3.2.10; work by kjell
@
text
@d1 1
a1 1
.\"     $OpenBSD: ipmon.8,v 1.7 1998/12/28 10:08:42 hugh Exp $          
d113 1
a113 1
ipf(1), ipftest(1), ipnat(1), ipf(4), ipl(4), ipnat(4), ipf(5), ipnat(5), ipfstat(8)
@


1.7
log
@document -D
@
text
@d1 1
a1 1
.\"     $OpenBSD: ipmon.8,v 1.6 1998/11/18 01:41:08 aaron Exp $          
d68 2
a69 1
saved to a file.  The following levels are used:
d93 3
@


1.6
log
@paramters -> parameters (but this whole page needs to be redone, hopefully soon)
@
text
@d1 1
a1 1
.\"     $OpenBSD: ipmon.8,v 1.5 1998/09/15 10:01:39 pattonme Exp $          
d8 1
a8 1
.B \-aFhnstvxX
d41 3
@


1.5
log
@updated to v3.2.9 of Darren's codebase. His code reimplements variable
locking, replaces u_long's with u_32_t to properly handle 64bit archs.
Wrapped OpenBSD specific preprocessor logic.
@
text
@d1 1
a1 1
.\"     $OpenBSD: ipmon.8,v 1.4 1998/01/26 04:16:46 dgregor Exp $          
d60 1
a60 1
used with the \fB-a\fP.  Letters available as paramters to this are the same
@


1.4
log
@IPF 3.2.3
@
text
@d1 1
a1 1
.\"     $OpenBSD: ipf.1,v 1.11 1997/04/09 11:44:25 kstailey Exp $          
a52 3
.B "\-N <device>"
Set the logfile to be opened for reading NAT log records from to <device>.
.TP
a65 4
.TP
.B "\-S <device>"
Set the logfile to be opened for reading state log records from to <device>.
.TP
d84 3
d101 4
d106 3
a108 1
ipf(8), ipfstat(8)
@


1.3
log
@spelling
@
text
@d1 1
d8 1
a8 1
.B \-sfN
d10 11
a20 1
<filename>
d34 32
d69 4
d88 8
a95 3
.B \-f
Flush the current packet log buffer.  The number of bytes flushed is displayed,
even should the result be zero.
d97 2
a98 3
.B \-N
IP addresses and port numbers will be mapped, where possible, back into
hostnames and service names.
d106 1
a106 1
ipf(1), ipfstat(1)
@


1.2
log
@IPF 1.3.7
@
text
@d49 2
a50 2
\fBipmon\fP expects data that it reads to be consistant with how it should be
saved and will abort if it fails an assertion which detects an anomoly in the
@


1.1
log
@from beurton@@fnet.fr:  Darren Reed's IP filter
@
text
@a0 1
.LP
d3 1
a3 1
ipmon - monitors /dev/ipl for logged packets
d5 6
a10 1
ipmon [-sfN] [<filename>]
d17 1
a17 1
default or a filename, if given on the command line.  Should the \fB-s\fP
d23 1
a23 1
.B -s
a25 1
.TP
d27 2
a28 2
.RS
.B LOG_INFO - packets logged using the "log" keyword as the action rather
d30 9
a38 6
.TP 3
.B LOG_NOTICE - packets logged which are also passed
.TP 3
.B LOG_WARNING - packets logged which are also blocked
.TP 3
.B LOG_ERR - packets which have been logged and which can be considered
a39 1
.RE
d41 1
a41 1
.B -f
d45 1
a45 1
.B -N
@
