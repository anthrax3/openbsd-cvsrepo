head	1.6;
access;
symbols
	OPENBSD_2_6:1.5.0.6
	OPENBSD_2_6_BASE:1.5
	OPENBSD_2_5:1.5.0.4
	OPENBSD_2_5_BASE:1.5
	OPENBSD_2_4:1.5.0.2
	OPENBSD_2_4_BASE:1.5
	sendmail_8_9_1:1.1.1.1
	UCB:1.1.1
	OPENBSD_2_3:1.2.0.6
	OPENBSD_2_3_BASE:1.2
	OPENBSD_2_2:1.2.0.4
	OPENBSD_2_2_BASE:1.2
	OPENBSD_2_1:1.2.0.2
	OPENBSD_2_1_BASE:1.2
	OPENBSD_2_0:1.1.0.2
	OPENBSD_2_0_BASE:1.1;
locks; strict;
comment	@# @;


1.6
date	2000.04.18.04.56.50;	author millert;	state dead;
branches;
next	1.5;

1.5
date	98.10.17.06.00.05;	author tholo;	state Exp;
branches;
next	1.4;

1.4
date	98.08.15.18.17.14;	author millert;	state Exp;
branches;
next	1.3;

1.3
date	98.08.02.06.50.22;	author tholo;	state Exp;
branches;
next	1.2;

1.2
date	96.11.11.04.25.30;	author tholo;	state Exp;
branches;
next	1.1;

1.1
date	96.06.02.05.02.45;	author tholo;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	98.07.12.17.11.53;	author millert;	state Exp;
branches;
next	;


desc
@@


1.6
log
@remove sendmail 8.9.3
@
text
@divert(-1)
#
# Copyright (c) 1996 SigmaSoft, Th. Lockert
# All rights reserved.
#
# Redistribution and use in source and binary forms, with or without
# modification, are permitted provided that the following conditions
# are met:
# 1. Redistributions of source code must retain the above copyright
#    notice, this list of conditions and the following disclaimer.
# 2. Redistributions in binary form must reproduce the above copyright
#    notice, this list of conditions and the following disclaimer in the
#    documentation and/or other materials provided with the distribution.
# 3. All advertising materials mentioning features or use of this software
#    must display the following acknowledgement:
#	This product includes software developed by SigmaSoft, Th. Lockert
# 4. The name of the author may not be used to endorse or promote products
#    derived from this software without specific prior written permission.
#
# THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR IMPLIED
# WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
# MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO
# EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
# SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
# PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS;
# OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
# WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR
# OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF
# ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
#

include(`../m4/cf.m4')dnl
VERSIONID(`$OpenBSD: gandalf.mc,v 1.5 1998/10/17 06:00:05 tholo Exp $')dnl
OSTYPE(openbsd)dnl
DOMAIN(sigmasoft)dnl
MASQUERADE_AS(SigmaSoft.COM)dnl
FEATURE(allmasquerade)dnl
FEATURE(local_procmail)dnl
FEATURE(access_db)dnl
define(`confAUTO_REBUILD', True)dnl
MAILER(local)dnl
MAILER(procmail)dnl
MAILER(smtp)dnl

Cw SigmaSoft.COM

LOCAL_CONFIG
#
#  Regular expression to reject:
#    * numeric-only localparts from aol.com and msn.com
#    * localparts starting with a digit from juno.com
#    * localparts longer than 10 characters from aol.com
#
Kcheckaddress regex -a@@MATCH
   ^([0-9]+<@@(aol|msn)\.com|[0-9][^<]*<@@juno\.com|.{10}[^<]+<@@aol\.com)\.?>

#
#  Names that won't be allowed in a To: line (local-part and domains)
#
C{RejectToLocalparts}	friend you
C{RejectToDomains}	public.com

LOCAL_RULESETS
HTo: $>CheckTo

SCheckTo
R$={RejectToLocalparts}@@$*	$#error $: "553 Header error"
R$*@@$={RejectToDomains}		$#error $: "553 Header error"

HMessage-Id: $>CheckMessageId

SCheckMessageId
R< $+ @@ $+ >			$@@ OK
R$*				$#error $: "553 Header error"

LOCAL_RULESETS
SLocal_check_mail
# check address against various regex checks
R$*				$: $>Parse0 $>3 $1
R$+				$: $(checkaddress $1 $)
R@@MATCH				$#error $: "553 Header error"
@


1.5
log
@Stricter anti-spam measures; mostly from Eric's knecht.mc
@
text
@d33 1
a33 1
VERSIONID(`$OpenBSD: gandalf.mc,v 1.4 1998/08/15 18:17:14 millert Exp $')dnl
@


1.4
log
@add openbsd OSTYPE (with additional mailer flag 'S') and use it
@
text
@d33 1
a33 1
VERSIONID(`$OpenBSD: gandalf.mc,v 1.3 1998/08/02 06:50:22 tholo Exp $')dnl
d46 36
@


1.3
log
@Enable built-in spam protection
@
text
@d33 2
a34 2
VERSIONID(`$OpenBSD: gandalf.mc,v 1.2 1996/11/11 04:25:30 tholo Exp $')dnl
OSTYPE(bsd4.4)dnl
@


1.2
log
@Add another Cw
@
text
@d33 1
a33 1
VERSIONID(`$OpenBSD: gandalf.mc,v 1.1 1996/06/02 05:02:45 tholo Exp $')dnl
d39 1
a45 1
Cw saruman.SigmaSoft.COM
@


1.1
log
@Add sample configuration; incidentally the configuration used on my system
@
text
@d33 1
a33 1
VERSIONID(`$OpenBSD$')dnl
d45 1
@


1.1.1.1
log
@sendmail 8.9.1
@
text
@d33 1
a33 1
VERSIONID(`$OpenBSD: gandalf.mc,v 1.2 1996/11/11 04:25:30 tholo Exp $')dnl
a44 1
Cw saruman.SigmaSoft.COM
@

