head	1.66;
access;
symbols
	OPENBSD_6_1_BASE:1.66
	OPENBSD_6_0:1.63.0.4
	OPENBSD_6_0_BASE:1.63
	OPENBSD_5_9:1.63.0.2
	OPENBSD_5_9_BASE:1.63
	OPENBSD_5_8:1.62.0.6
	OPENBSD_5_8_BASE:1.62
	OPENBSD_5_7:1.62.0.2
	OPENBSD_5_7_BASE:1.62
	OPENBSD_5_6:1.61.0.4
	OPENBSD_5_6_BASE:1.61
	OPENBSD_5_5:1.52.0.4
	OPENBSD_5_5_BASE:1.52
	OPENBSD_5_4:1.51.0.4
	OPENBSD_5_4_BASE:1.51
	OPENBSD_5_3:1.51.0.2
	OPENBSD_5_3_BASE:1.51
	OPENBSD_5_2:1.50.0.4
	OPENBSD_5_2_BASE:1.50
	OPENBSD_5_1_BASE:1.50
	OPENBSD_5_1:1.50.0.2
	OPENBSD_5_0:1.45.0.2
	OPENBSD_5_0_BASE:1.45
	OPENBSD_4_9:1.44.0.4
	OPENBSD_4_9_BASE:1.44
	OPENBSD_4_8:1.44.0.2
	OPENBSD_4_8_BASE:1.44
	OPENBSD_4_7:1.42.0.2
	OPENBSD_4_7_BASE:1.42
	OPENBSD_4_6:1.41.0.4
	OPENBSD_4_6_BASE:1.41
	OPENBSD_4_5:1.39.0.8
	OPENBSD_4_5_BASE:1.39
	OPENBSD_4_4:1.39.0.6
	OPENBSD_4_4_BASE:1.39
	OPENBSD_4_3:1.39.0.4
	OPENBSD_4_3_BASE:1.39
	OPENBSD_4_2:1.39.0.2
	OPENBSD_4_2_BASE:1.39
	OPENBSD_4_1:1.38.0.6
	OPENBSD_4_1_BASE:1.38
	OPENBSD_4_0:1.38.0.4
	OPENBSD_4_0_BASE:1.38
	OPENBSD_3_9:1.38.0.2
	OPENBSD_3_9_BASE:1.38
	OPENBSD_3_8:1.36.0.10
	OPENBSD_3_8_BASE:1.36
	OPENBSD_3_7:1.36.0.8
	OPENBSD_3_7_BASE:1.36
	OPENBSD_3_6:1.36.0.6
	OPENBSD_3_6_BASE:1.36
	OPENBSD_3_5:1.36.0.4
	OPENBSD_3_5_BASE:1.36
	OPENBSD_3_4:1.36.0.2
	OPENBSD_3_4_BASE:1.36
	OPENBSD_3_3:1.32.0.2
	OPENBSD_3_3_BASE:1.32
	OPENBSD_3_2:1.30.0.2
	OPENBSD_3_2_BASE:1.30
	OPENBSD_3_1:1.25.0.2
	OPENBSD_3_1_BASE:1.25
	OPENBSD_3_0:1.24.0.2
	OPENBSD_3_0_BASE:1.24
	OPENBSD_2_9_BASE:1.22
	OPENBSD_2_9:1.22.0.6
	OPENBSD_2_8:1.22.0.4
	OPENBSD_2_8_BASE:1.22
	OPENBSD_2_7:1.22.0.2
	OPENBSD_2_7_BASE:1.22
	OPENBSD_2_6:1.14.0.2
	OPENBSD_2_6_BASE:1.14
	OPENBSD_2_5:1.11.0.2
	OPENBSD_2_5_BASE:1.11
	OPENBSD_2_4:1.8.0.2
	OPENBSD_2_4_BASE:1.8
	OPENBSD_2_3:1.7.0.4
	OPENBSD_2_3_BASE:1.7
	OPENBSD_2_2:1.7.0.2
	OPENBSD_2_2_BASE:1.7
	OPENBSD_2_1:1.4.0.2
	OPENBSD_2_1_BASE:1.4
	OPENBSD_2_0:1.3.0.2
	OPENBSD_2_0_BASE:1.3
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@.\" @;


1.66
date	2016.10.21.09.26.36;	author jmc;	state Exp;
branches;
next	1.65;
commitid	NFWOHXvb9emdr8Zm;

1.65
date	2016.10.20.20.15.09;	author jmc;	state Exp;
branches;
next	1.64;
commitid	teXe3bWszHYNSGsl;

1.64
date	2016.10.20.20.00.01;	author jmc;	state Exp;
branches;
next	1.63;
commitid	POH1qYSSWl8soZEB;

1.63
date	2015.09.14.20.06.59;	author schwarze;	state Exp;
branches;
next	1.62;
commitid	r87YNrjEWwl7OkJ0;

1.62
date	2014.09.08.01.27.55;	author schwarze;	state Exp;
branches;
next	1.61;
commitid	cPoapLAXYNe1fcgV;

1.61
date	2014.06.06.17.42.59;	author florian;	state Exp;
branches;
next	1.60;
commitid	5hq1b9itxxZJ8gbw;

1.60
date	2014.05.01.18.46.01;	author jmc;	state Exp;
branches;
next	1.59;

1.59
date	2014.04.29.17.35.29;	author jmc;	state Exp;
branches;
next	1.58;

1.58
date	2014.04.27.15.30.16;	author jmc;	state Exp;
branches;
next	1.57;

1.57
date	2014.04.25.15.09.56;	author jmc;	state Exp;
branches;
next	1.56;

1.56
date	2014.04.25.12.10.14;	author florian;	state Exp;
branches;
next	1.55;

1.55
date	2014.04.21.14.26.10;	author florian;	state Exp;
branches;
next	1.54;

1.54
date	2014.04.18.16.19.11;	author florian;	state Exp;
branches;
next	1.53;

1.53
date	2014.03.24.11.11.49;	author mpi;	state Exp;
branches;
next	1.52;

1.52
date	2014.02.26.20.52.29;	author claudio;	state Exp;
branches;
next	1.51;

1.51
date	2012.08.15.19.25.41;	author jmc;	state Exp;
branches;
next	1.50;

1.50
date	2012.01.12.11.25.40;	author sthen;	state Exp;
branches;
next	1.49;

1.49
date	2011.11.08.16.44.46;	author jmc;	state Exp;
branches;
next	1.48;

1.48
date	2011.11.08.12.16.54;	author sthen;	state Exp;
branches;
next	1.47;

1.47
date	2011.09.17.16.03.28;	author jmc;	state Exp;
branches;
next	1.46;

1.46
date	2011.09.17.14.10.05;	author haesbaert;	state Exp;
branches;
next	1.45;

1.45
date	2011.04.06.12.05.00;	author sthen;	state Exp;
branches;
next	1.44;

1.44
date	2010.07.08.20.23.03;	author claudio;	state Exp;
branches;
next	1.43;

1.43
date	2010.07.03.04.44.52;	author guenther;	state Exp;
branches;
next	1.42;

1.42
date	2009.07.06.06.50.03;	author jmc;	state Exp;
branches;
next	1.41;

1.41
date	2009.06.05.06.47.12;	author jmc;	state Exp;
branches;
next	1.40;

1.40
date	2009.06.05.00.10.01;	author claudio;	state Exp;
branches;
next	1.39;

1.39
date	2007.05.31.19.20.30;	author jmc;	state Exp;
branches;
next	1.38;

1.38
date	2005.12.23.14.58.35;	author jmc;	state Exp;
branches;
next	1.37;

1.37
date	2005.11.02.11.35.54;	author jmc;	state Exp;
branches;
next	1.36;

1.36
date	2003.08.27.08.17.33;	author jmc;	state Exp;
branches;
next	1.35;

1.35
date	2003.06.12.12.59.53;	author jmc;	state Exp;
branches;
next	1.34;

1.34
date	2003.06.02.23.36.55;	author millert;	state Exp;
branches;
next	1.33;

1.33
date	2003.04.03.06.47.59;	author jmc;	state Exp;
branches;
next	1.32;

1.32
date	2003.03.18.11.18.55;	author jmc;	state Exp;
branches;
next	1.31;

1.31
date	2002.11.14.02.57.28;	author deraadt;	state Exp;
branches;
next	1.30;

1.30
date	2002.08.30.02.17.34;	author stevesk;	state Exp;
branches;
next	1.29;

1.29
date	2002.08.12.20.43.13;	author stevesk;	state Exp;
branches;
next	1.28;

1.28
date	2002.08.12.02.40.52;	author stevesk;	state Exp;
branches;
next	1.27;

1.27
date	2002.08.11.18.17.32;	author stevesk;	state Exp;
branches;
next	1.26;

1.26
date	2002.08.11.01.34.31;	author stevesk;	state Exp;
branches;
next	1.25;

1.25
date	2002.03.31.19.12.32;	author stevesk;	state Exp;
branches;
next	1.24;

1.24
date	2001.08.02.18.37.35;	author mpech;	state Exp;
branches;
next	1.23;

1.23
date	2001.06.09.21.09.05;	author pvalchev;	state Exp;
branches;
next	1.22;

1.22
date	2000.04.20.17.26.37;	author angelos;	state Exp;
branches;
next	1.21;

1.21
date	2000.04.20.07.47.11;	author angelos;	state Exp;
branches;
next	1.20;

1.20
date	2000.04.15.02.15.21;	author aaron;	state Exp;
branches;
next	1.19;

1.19
date	2000.04.11.13.20.32;	author aaron;	state Exp;
branches;
next	1.18;

1.18
date	2000.03.23.21.39.57;	author aaron;	state Exp;
branches;
next	1.17;

1.17
date	2000.03.19.17.57.16;	author aaron;	state Exp;
branches;
next	1.16;

1.16
date	99.12.23.16.17.05;	author angelos;	state Exp;
branches;
next	1.15;

1.15
date	99.12.18.21.34.35;	author angelos;	state Exp;
branches;
next	1.14;

1.14
date	99.09.23.04.12.12;	author alex;	state Exp;
branches;
next	1.13;

1.13
date	99.05.23.14.11.38;	author aaron;	state Exp;
branches;
next	1.12;

1.12
date	99.05.12.13.26.53;	author aaron;	state Exp;
branches;
next	1.11;

1.11
date	99.04.02.15.12.22;	author aaron;	state Exp;
branches;
next	1.10;

1.10
date	99.03.01.06.20.00;	author aaron;	state Exp;
branches;
next	1.9;

1.9
date	99.02.17.00.20.44;	author millert;	state Exp;
branches;
next	1.8;

1.8
date	98.04.25.20.21.41;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	97.07.24.14.30.10;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	97.06.11.00.34.55;	author deraadt;	state Exp;
branches;
next	1.5;

1.5
date	97.06.09.21.31.01;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	97.02.22.20.39.19;	author kstailey;	state Exp;
branches;
next	1.3;

1.3
date	96.05.19.15.23.24;	author mickey;	state Exp;
branches;
next	1.2;

1.2
date	95.12.14.01.57.37;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.48.29;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.48.29;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.66
log
@some text cleanup and remove an irrelevant note; ok florian
@
text
@.\"	$OpenBSD: traceroute.8,v 1.65 2016/10/20 20:15:09 jmc Exp $
.\"	$NetBSD: traceroute.8,v 1.6 1995/10/12 03:05:50 mycroft Exp $
.\"
.\" Copyright (c) 1990, 1991, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" This code is derived from software contributed to Berkeley by
.\" Van Jacobson.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"	@@(#)traceroute.8	8.1 (Berkeley) 6/6/93
.\"
.Dd $Mdocdate: October 20 2016 $
.Dt TRACEROUTE 8
.Os
.Sh NAME
.Nm traceroute ,
.Nm traceroute6
.Nd print the route packets take to network host
.Sh SYNOPSIS
.Nm traceroute\ \&
.Op Fl AcDdIlnSvx
.Op Fl f Ar first_ttl
.Op Fl g Ar gateway_addr
.Op Fl m Ar max_ttl
.Op Fl P Ar proto
.Op Fl p Ar port
.Op Fl q Ar nqueries
.Op Fl s Ar src_addr
.Op Fl t Ar toskeyword
.Op Fl V Ar rtable
.Op Fl w Ar waittime
.Ar host
.Op Ar datalen
.Nm traceroute6
.Op Fl AcDdIlnSv
.Op Fl f Ar first_hop
.Op Fl m Ar max_hop
.Op Fl p Ar port
.Op Fl q Ar nqueries
.Op Fl s Ar src_addr
.Op Fl V Ar rtable
.Op Fl w Ar waittime
.Ar host
.Op Ar datalen
.Sh DESCRIPTION
The Internet is a large and complex aggregation of
network hardware, connected together by gateways.
Tracking the route packets follow (or finding the miscreant
gateway that's discarding packets) can be difficult.
.Nm
and
.Nm traceroute6
attempt to elicit
.Dv TIME_EXCEEDED
responses from each gateway along the path to
.Ar host ,
in order to determine their route.
.Nm
is used for IPv4 networks and
.Nm traceroute6
for IPv6.
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl A
Look up the AS number for each hop address.
Uses the DNS service described at
.Lk http://www.team-cymru.org/Services/ip-to-asn.html .
.It Fl c
Do not increment the destination port number in successive UDP packets.
Rather, all UDP packets will have the same destination port, as set via the
.Fl p
flag (or 33434 if none is specified).
.It Fl D
Dump the packet data to standard error before transmitting it.
.It Fl d
Turn on socket-level debugging.
.It Fl f Ar first_ttl
Set the first TTL or hop limit used in outgoing probe packets.
The effect is that the first first_ttl \- 1 hosts will be skipped
in the output of
.Nm traceroute .
The default is 1 (skip no hosts).
.It Fl g Ar gateway_addr
Add
.Ar gateway_addr
to the list of addresses in the IP Loose Source Record Route (LSRR)
option.
If no gateways are specified, the LSRR option is omitted.
This option is not available for IPv6.
.It Fl I
Use ICMP or ICMP6 ECHO instead of UDP datagrams.
.It Fl l
Display the TTL or hop limit value of the returned packet.
This is useful for checking for asymmetric routing.
.It Fl m Ar max_ttl
Set the maximum TTL or hop limit.
The default is the value of the system's
.Va net.inet.ip.ttl
or
.Va net.inet6.ip6.hlim
.Xr sysctl 8
variable, which defaults to 64.
.It Fl n
Print hop addresses numerically rather than symbolically and numerically
(saves a nameserver address-to-name lookup for each gateway found on the
path).
.It Fl P Ar proto
Change the protocol being used from UDP
to a numeric protocol or a name as specified in
.Pa /etc/protocols .
This will not work reliably for most protocols.
If set to 1 (ICMP), then
ICMP Echo Request messages will be used (same as
.Xr ping 8 ) .
This option is not available for IPv6.
.It Fl p Ar port
Set the base UDP
.Ar port
number used in probes.
The default is 33434.
.Nm
hopes that nothing is listening on UDP ports
.Ar base
to
.Ar base Ns + Ns Ar nhops Ns * Ns Ar nqueries Ns -1
at the destination host (so an ICMP
.Dv PORT_UNREACHABLE
message will
be returned to terminate the route tracing).
If something is
listening on a port in the default range, this option can be used
to pick an unused port range.
.It Fl q Ar nqueries
Set the number of probes per TTL to
.Ar nqueries .
The default is three probes.
.It Fl S
Print how many probes were not answered for each hop.
.It Fl s Ar src_addr
Use the following IP address
(which must be given as an IP number, not
a hostname) as the source address in outgoing probe packets.
On hosts with more than one IP address, this option can be used to
force the source address to be something other than the IP address
of the interface the probe packet is sent on.
If the IP address
is not one of this machine's interface addresses and the user is
not the superuser, an error is returned and nothing is sent.
.It Fl t Ar toskeyword
Set the type-of-service (TOS) in probe packets.
The value may be one of
.Cm critical ,
.Cm inetcontrol ,
.Cm lowdelay ,
.Cm netcontrol ,
.Cm throughput ,
.Cm reliability ,
or one of the DiffServ Code Points:
.Cm ef ,
.Cm af11 ... af43 ,
.Cm cs0 ... cs7 ;
or a number in either hex or decimal.
The default is zero.
This option can be used to
see if different types-of-service result in different paths.
If this option is used, changes to the type-of-service in the
returned packets are displayed.
Not all values of TOS are legal or meaningful \-
see the IP spec for definitions.
Useful values are probably
.Cm lowdelay
and
.Cm throughput .
This option is not available for IPv6.
.It Fl V Ar rtable
Set the routing table to be used.
.It Fl v
Verbose output.
Received ICMP packets other than
.Dv TIME_EXCEEDED
and
.Dv UNREACHABLE Ns s
are listed.
.It Fl w Ar waittime
Set the time, in seconds, to wait for a response to a probe.
The default is 5.
.It Fl x
Print the ICMP extended headers if available.
This option is not available for IPv6.
.It Ar host
The destination host,
specified as a host name or numeric IP address.
.It Ar datalen
The probe datagram length.
The default is 40 bytes for IPv4 UDP
and 60 bytes for ICMP, IPv6 UDP and ICMP6.
.El
.Pp
The program attempts to trace the route an IP packet would follow to a
host by launching UDP probe packets with a small TTL or hop limit,
then listening for an ICMP "time exceeded" reply from a gateway.
It starts using probes with a TTL/hop limit of one
and increases by one until it gets an ICMP "port unreachable"
(which means it reached the host) or hits a maximum limit
(which defaults to 64, but can be changed using the
.Fl m
option).
Three probes (the exact number can be changed using the
.Fl q
option) are sent and a line is printed
showing the TTL or hop limit, address of the gateway,
and round trip time of each probe.
If the probe answers come from different gateways,
the address of each responding system will be printed.
If there is no response within a 5 second timeout
interval (which can be changed using the
.Fl w
option), a "*" is printed for that
probe.
.Pp
We don't want the destination
host to process the UDP
probe packets so the destination port is set to an
unlikely value (if some clod on the destination is using that
value, it can be changed using the
.Fl p
option).
.Pp
A sample use and output might be:
.Bd -literal -offset indent
$ traceroute nis.nsf.net.
traceroute to nis.nsf.net (35.1.1.48), 64 hops max, 56 byte packet
1  helios.ee.lbl.gov (128.3.112.1)  19 ms  19 ms  0 ms
2  lilac-dmc.Berkeley.EDU (128.32.216.1)  39 ms  39 ms  19 ms
3  lilac-dmc.Berkeley.EDU (128.32.216.1)  39 ms  39 ms  19 ms
4  ccngw-ner-cc.Berkeley.EDU (128.32.136.23)  39 ms  40 ms  39 ms
5  ccn-nerif22.Berkeley.EDU (128.32.168.22)  39 ms  39 ms  39 ms
6  128.32.197.4 (128.32.197.4)  40 ms  59 ms  59 ms
7  131.119.2.5 (131.119.2.5)  59 ms  59 ms  59 ms
8  129.140.70.13 (129.140.70.13)  99 ms  99 ms  80 ms
9  129.140.71.6 (129.140.71.6)  139 ms  239 ms  319 ms
10  129.140.81.7 (129.140.81.7)  220 ms  199 ms  199 ms
11  nic.merit.edu (35.1.1.48)  239 ms  239 ms  239 ms
.Ed
.Pp
Note that lines 2 & 3 are the same.
This is due to a buggy
kernel on the 2nd hop system \- lbl-csam.arpa \- that forwards
packets with a zero TTL (a bug in the distributed version of
.Bx 4.3 ) .
Note that you have to guess what path
the packets are taking cross-country since the NSFNET (129.140)
doesn't supply address-to-name translations for its NSSes.
.Pp
A more interesting example is:
.Bd -literal -offset indent
$ traceroute allspice.lcs.mit.edu.
traceroute to allspice.lcs.mit.edu (18.26.0.115), 64 hops max
1  helios.ee.lbl.gov (128.3.112.1)  0 ms  0 ms  0 ms
2  lilac-dmc.Berkeley.EDU (128.32.216.1)  19 ms  19 ms  19 ms
3  lilac-dmc.Berkeley.EDU (128.32.216.1)  39 ms  19 ms  19 ms
4  ccngw-ner-cc.Berkeley.EDU (128.32.136.23)  19 ms  39 ms  39 ms
5  ccn-nerif22.Berkeley.EDU (128.32.168.22)  20 ms  39 ms  39 ms
6  128.32.197.4 (128.32.197.4)  59 ms  119 ms  39 ms
7  131.119.2.5 (131.119.2.5)  59 ms  59 ms  39 ms
8  129.140.70.13 (129.140.70.13)  80 ms  79 ms  99 ms
9  129.140.71.6 (129.140.71.6)  139 ms  139 ms  159 ms
10  129.140.81.7 (129.140.81.7)  199 ms  180 ms  300 ms
11  129.140.72.17 (129.140.72.17)  300 ms  239 ms  239 ms
12  * * *
13  128.121.54.72 (128.121.54.72)  259 ms  499 ms  279 ms
14  * * *
15  * * *
16  * * *
17  * * *
18  ALLSPICE.LCS.MIT.EDU (18.26.0.115)  339 ms  279 ms  279 ms
.Ed
.Pp
Note that the gateways 12, 14, 15, 16 & 17 hops away
either don't send ICMP "time exceeded" messages or send them
with a TTL too small to reach us.
14 \- 17 are running the MIT
C Gateway code that doesn't send "time exceeded"s.
God only knows what's going on with 12.
.Pp
The silent gateway 12 in the above may be the result of a bug in
the 4.[23]
.Bx
network code (and its derivatives):  4.x (x <= 3)
sends an unreachable message using whatever TTL remains in the
original datagram.
Since, for gateways, the remaining TTL is zero, the ICMP
"time exceeded" is guaranteed to not make it back to us.
The behavior of this bug is slightly more interesting
when it appears on the destination system:
.Bd -literal -offset indent
1  helios.ee.lbl.gov (128.3.112.1)  0 ms  0 ms  0 ms
2  lilac-dmc.Berkeley.EDU (128.32.216.1)  39 ms  19 ms  39 ms
3  lilac-dmc.Berkeley.EDU (128.32.216.1)  19 ms  39 ms  19 ms
4  ccngw-ner-cc.Berkeley.EDU (128.32.136.23)  39 ms  40 ms  19 ms
5  ccn-nerif35.Berkeley.EDU (128.32.168.35)  39 ms  39 ms  39 ms
6  csgw.Berkeley.EDU (128.32.133.254)  39 ms  59 ms  39 ms
7  * * *
8  * * *
9  * * *
10  * * *
11  * * *
12  * * *
13  rip.Berkeley.EDU (128.32.131.22)  59 ms !  39 ms !  39 ms !
.Ed
.Pp
Notice that there are 12 "gateways" (13 is the final
destination) and exactly the last half of them are "missing".
What's really happening is that rip (a Sun-3 running Sun OS3.5)
is using the TTL from our arriving datagram as the TTL in its
ICMP reply.
So, the reply will time out on the return path
(with no notice sent to anyone since ICMPs aren't sent for ICMPs)
until we probe with a TTL that's at least twice the path
length.
That is, rip is really only 7 hops away.
A reply that returns with a TTL of 1 is a clue this problem exists.
.Nm
prints a "!" after the time if the TTL is <= 1.
Since vendors ship a lot of obsolete (DEC's Ultrix, Sun 3.x) or
non-standard (HP-UX) software, expect to see this problem
frequently and/or take care picking the target host of your
probes.
.Pp
Other possible annotations after the time are
.Sy !H ,
.Sy !N ,
.Sy !P
(got a host, network or protocol unreachable, respectively),
.Sy !A ,
.Sy !C
(access to the network or host, respectively, is prohibited),
.Sy !X
(communication administratively prohibited by filtering),
.Sy !S
or
.Sy !F
(source route failed or fragmentation needed \- neither of these should
ever occur and the associated gateway is busted if you see one),
.Sy !U
(destination network or host unknown),
.Sy !T
(destination network or host unreachable for TOS),
.Sy !<code>
(other ICMP unreachable code).
.Sy TOS=xxx!
(TOS bit in returned packet differs from last hop).
If almost all the probes result in some kind of unreachable,
.Nm
will give up and exit.
.Pp
.Dl $ traceroute -g 10.3.0.5 128.182.0.0
.Pp
will show the path from the Cambridge Mailbridge to PSC, while
.Pp
.Dl $ traceroute -g 192.5.146.4 -g 10.3.0.5 35.0.0.0
.Pp
will show the path from the Cambridge Mailbridge to Merit, using PSC to
reach the Mailbridge.
.Pp
This program is intended for use in network testing, measurement
and management.
It should be used primarily for manual fault isolation.
Because of the load it could impose on the network, it is unwise to use
.Nm
during normal operations or from automated scripts.
.Sh SEE ALSO
.Xr netstat 1 ,
.Xr ping 8
.Sh HISTORY
The very first
.Nm
(never released) used ICMP ECHO_REQUEST
datagrams as probe packets.
During the first night of testing it was
discovered that more than half the router vendors of the time would
not return an ICMP TIME_EXCEEDED for an ECHO_REQUEST.
.Nm
was then changed to use UDP probe packets.
Most modern TCP/IP implementations will now generate an ICMP error
message to ICMP query messages, and the option to use ECHO_REQUEST probes
was re-implemented.
.Pp
The
.Nm
command first appeared in
.Bx 4.4 .
The
.Nm traceroute6
command first appeared in the WIDE Hydrangea IPv6 protocol stack kit.
.Sh AUTHORS
.An -nosplit
Implemented by
.An Van Jacobson
from a suggestion by
.An Steve Deering .
Debugged
by a cast of thousands with particularly cogent suggestions or fixes from
.An C. Philip Wood ,
.An Tim Seaver ,
and
.An Ken Adelman .
@


1.65
log
@some macro fixes for the options list;
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.64 2016/10/20 20:00:01 jmc Exp $
a192 4
(If you are not running a
.Bx 4.3 tahoe
or later system, this may be academic since the normal network
services like telnet and ftp don't let you control the TOS).
d224 2
a225 2
This program attempts to trace the route an IP packet would follow to some
internet host by launching UDP probe packets with a small TTL
d227 4
a230 4
We start out probes with a TTL of one and increase by one until we get an
ICMP "port unreachable"
(which means we got to "host") or hit a max (which
defaults to 64 hops and can be changed with the
d232 2
a233 2
flag).
Three probes (changed with
d235 5
a239 6
flag) are sent at each TTL setting and a
line is printed showing the TTL, address of the gateway and
round trip time of each probe.
If the probe answers come from
different gateways, the address of each responding system will
be printed.
d241 1
a241 1
interval (changed with the
d243 1
a243 1
flag), a "*" is printed for that
d250 1
a250 1
value, it can be changed with the
d252 1
a252 1
flag).
@


1.64
log
@try to make DESCRIPTION read like it was written for one program, not two;
ok florian
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.63 2015/09/14 20:06:59 schwarze Exp $
d36 1
a36 1
.Dd $Mdocdate: September 14 2015 $
d107 1
a107 1
The default value is 1 (skip no hosts).
d123 1
a123 1
.Cm net.inet.ip.ttl
d125 3
a127 2
.Cm net.inet6.ip6.hlim
MIB variable, which defaults to 64.
d144 2
a145 1
number used in probes (default is 33434).
d148 1
a148 1
.Em base
d150 1
a150 1
.Em base+nhops*nqueries-1
d160 2
a161 2
.Ar nqueries
(default is three probes).
d175 1
a175 3
Set the
.Em type-of-service
in probe packets to the following value (default zero).
d177 6
a182 6
.Ar critical ,
.Ar inetcontrol ,
.Ar lowdelay ,
.Ar netcontrol ,
.Ar throughput ,
.Ar reliability ,
d184 3
a186 3
.Ar ef ,
.Ar af11 ... af43 ,
.Ar cs0 ... cs7 ;
d188 1
d196 3
a198 6
services like telnet and ftp don't let you control the
.Dv TOS ) .
Not all values of
.Dv TOS
are legal or
meaningful \- see the IP spec for definitions.
d200 1
a200 1
.Ar lowdelay
d202 1
a202 1
.Ar throughput .
d214 2
a215 1
Set the time (in seconds) to wait for a response to a probe (default 5).
@


1.63
log
@Avoid .Ns right after .Pf, it's pointless.
In some cases, do additional cleanup in the immediate vicinity.
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.62 2014/09/08 01:27:55 schwarze Exp $
d36 1
a36 1
.Dd $Mdocdate: September 8 2014 $
d75 3
a77 2
utilizes the IPv4 protocol time to live (TTL) field
and attempts to elicit an ICMP
d79 5
a83 2
response from each gateway along the path to some
host.
d85 1
a85 11
does the same for the IPv6 protocol,
instead using hop limits and ICMPv6
.Dv TIME_EXCEEDED
responses.
.Pp
The only mandatory parameter is the destination host name or IP number.
The default probe datagram length is 40 bytes for IPv4 UDP and 60
bytes for ICMP, IPv6 UDP and ICMP6.
This may be increased by
.Ar datalen
bytes.
d220 7
@


1.62
log
@obvious cases of missing .An;
found with the new mandoc(1) MANDOCERR_AN_MISSING warning;
no text changes
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.61 2014/06/06 17:42:59 florian Exp $
d36 1
a36 1
.Dd $Mdocdate: June 6 2014 $
d355 2
a356 6
Since vendors ship a lot of obsolete
.Pf ( Tn DEC Ns \'s
Ultrix, Sun 3.x) or
non-standard
.Pq Tn HP-UX
software, expect to see this problem
@


1.61
log
@Update description of optional argument "datalen" to reality.
Issue pointed out by, tweak and "looks ok" jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.60 2014/05/01 18:46:01 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: May 1 2014 $
d431 5
a435 1
Implemented by Van Jacobson from a suggestion by Steve Deering.
d438 4
a441 1
C. Philip Wood, Tim Seaver and Ken Adelman.
@


1.60
log
@change some argument names in order to give some consistency between traceroute
and traceroute6; i also fudged the formatting to allow SYNOPSIS to display a
bit nicer, and for usage() to look like SYNOPSIS;

ok florian
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.59 2014/04/29 17:35:29 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: April 29 2014 $
d87 5
a91 3
The default probe datagram length is 38 bytes, but this may be increased
by specifying a packet size (in bytes) after the destination host
name.
@


1.59
log
@a bit more merge for traceroute6 stuff, and some consistency fixes;
help/ok florian
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.58 2014/04/27 15:30:16 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: April 27 2014 $
d44 1
a44 1
.Nm traceroute
d57 1
a57 1
.Op Ar packetsize
d60 2
a61 2
.Op Fl f Ar firsthop
.Op Fl m Ar hoplimit
d63 2
a64 2
.Op Fl q Ar probes
.Op Fl s Ar src
@


1.58
log
@zap a ton of silly Tn, and uppercase TTL; a few other minor tweaks along the
way;
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.57 2014/04/25 15:09:56 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: April 25 2014 $
d72 2
a73 2
Tracking the route one's packets follow (or finding the miscreant
gateway that's discarding your packets) can be difficult.
d75 2
a76 1
utilizes the IP protocol `time to live' field and attempts to elicit an ICMP
d80 5
d107 1
a107 1
Set the first time-to-live or hoplimit used in outgoing probe packets.
d122 1
a122 1
Display the TTL or hoplimit value of the returned packet.
d125 1
a125 2
Set the max time-to-live (max number of hops) used in outgoing probe
packets.
d227 1
a227 1
internet host by launching UDP probe packets with a small TTL (time to live)
@


1.57
log
@add traceroute6 to NAME, and knock out some unneeded Bk/Ek;
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.56 2014/04/25 12:10:14 florian Exp $
d75 1
a75 2
utilizes the IP protocol `time to live' field and attempts to elicit an
.Tn ICMP
d116 1
a116 1
Display the ttl or hoplimit value of the returned packet.
d131 1
a131 2
Change the protocol being used from
.Tn UDP
d140 1
a140 2
Set the base
.Tn UDP
d144 1
a144 3
hopes that nothing is listening on
.Tn UDP
ports
d148 1
a148 2
at the destination host (so an
.Tn ICMP
d156 1
a156 1
Set the number of probes per ``ttl'' to
d209 1
a209 3
Received
.Tn ICMP
packets other than
d222 4
a225 9
internet host by launching
.Tn UDP
probe
packets with a small ttl (time to live) then listening for an
.Tn ICMP
"time exceeded" reply from a gateway.
We start out probes with a ttl of one and increase by one until we get an
.Tn ICMP
"port unreachable"
d232 2
a233 2
flag) are sent at each ttl setting and a
line is printed showing the ttl, address of the gateway and
d245 1
a245 2
host to process the
.Tn UDP
d272 2
a273 3
packets with a zero ttl (a bug in the distributed version
of 4.3
.Tn BSD ) .
d275 2
a276 5
the packets are taking cross-country since the
.Tn NSFNET
(129.140)
doesn't supply address-to-name translations for its
.Tn NSS Ns es .
d303 3
a305 6
either don't send
.Tn ICMP
"time exceeded" messages or send them
with a ttl too small to reach us.
14 \- 17 are running the
.Tn MIT
d311 1
a311 1
.Tn BSD
d313 1
a313 1
sends an unreachable message using whatever ttl remains in the
d315 1
a315 2
Since, for gateways, the remaining ttl is zero, the
.Tn ICMP
d338 2
a339 3
is using the ttl from our arriving datagram as the ttl in its
.Tn ICMP
reply.
d341 2
a342 5
(with no notice sent to anyone since
.Tn ICMP's
aren't sent for
.Tn ICMP's )
until we probe with a ttl that's at least twice the path
d344 2
a345 2
i.e., rip is really only 7 hops away.
A reply that returns with a ttl of 1 is a clue this problem exists.
d347 1
a347 1
prints a "!" after the time if the ttl is <= 1.
@


1.56
log
@Merge traceroute6 man page with traceroute.
"sure" jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.55 2014/04/21 14:26:10 florian Exp $
d36 1
a36 1
.Dd $Mdocdate: April 21 2014 $
d40 2
a41 1
.Nm traceroute
a44 1
.Bk -words
a57 1
.Ek
@


1.55
log
@Revert 1.101 as it breaks source port selection. This needs more
thought / code shuffling.
Reported by deraadt@@ and sthen@@, thanks!
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.54 2014/04/18 16:19:11 florian Exp $
d36 1
a36 1
.Dd $Mdocdate: April 18 2014 $
d59 11
d103 1
a103 1
Set the first time-to-live used in outgoing probe packets.
d114 1
d116 1
a116 4
Equivalent to
.Fl P
1.
Used for compatibility with other OSes.
d118 1
a118 1
Display the ttl value of the returned packet.
d125 2
d141 1
d211 1
d227 1
d447 3
@


1.54
log
@If -s is not given do a dummy connect to get outgoing ip,
unconditionally try to bind to this ip and get a source port for udp
this way, like traceroute6 is doing.  This means you can no longer
traceroute from IPs not present on the system. (There are probably
better tools if you want to send traffic from spoofed IPs.)
OK benno@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.53 2014/03/24 11:11:49 mpi Exp $
d36 1
a36 1
.Dd $Mdocdate: March 24 2014 $
d163 3
a165 2
If the IP address is not one of this machine's interface addresses an error is
returned and nothing is sent.
@


1.53
log
@Remove "-r" option from ping(8) and traceroute{,6}(8).  You've probably
never heard about it, it was to bypass the routing tables, not available
for IPv6 and we're going to always use the routing tables soon.

ok florian@@, man pages ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.52 2014/02/26 20:52:29 claudio Exp $
d36 1
a36 1
.Dd $Mdocdate: February 26 2014 $
d163 2
a164 3
If the IP address
is not one of this machine's interface addresses and the user is
not the superuser, an error is returned and nothing is sent.
@


1.52
log
@Again the default is not 0.
Ok many
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.51 2012/08/15 19:25:41 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: August 15 2012 $
d45 1
a45 1
.Op Fl AcDdIlnrSvx
a153 11
.It Fl r
Bypass the normal routing tables and send directly to a host on an attached
network.
If the host is not on a directly attached network,
an error is returned.
This option corresponds to the
.Dv SO_DONTROUTE
socket option;
it can be used to ping a local host through an interface
that has no route through it
(e.g., after the interface was dropped by a routing daemon).
@


1.51
log
@use Lk for links;
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.50 2012/01/12 11:25:40 sthen Exp $
d36 1
a36 1
.Dd $Mdocdate: January 12 2012 $
a211 1
The default is 0.
@


1.50
log
@Mention the information source used for the ASN lookup.
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.49 2011/11/08 16:44:46 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: November 8 2011 $
d81 1
a81 1
http://www.team-cymru.org/Services/ip-to-asn.html.
@


1.49
log
@lookup (n.) -> look up (v.) (i.e. to look sth up);
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.48 2011/11/08 12:16:54 sthen Exp $
d80 2
@


1.48
log
@Add -A option to display AS for each hop address, using origin.asn.cymru.com
DNS lookups. ok deraadt@@, henning likes it but would like some changes which
can be done after commit.
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.47 2011/09/17 16:03:28 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: September 17 2011 $
d79 1
a79 1
Lookup the AS number for each hop address.
@


1.47
log
@tweak previous;
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.46 2011/09/17 14:10:05 haesbaert Exp $
d45 1
a45 1
.Op Fl cDdIlnrSvx
d78 2
@


1.46
log
@Standarize the ToS option across nc/ping/traceroute so that they'll
accept the same values as pf.conf. It accepts decimal, hexadecimal and
the dscp/tos keywords. The ping option was ripped of in SMALL.

ok mcbride@@ sthen@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.45 2011/04/06 12:05:00 sthen Exp $
d36 1
a36 1
.Dd $Mdocdate: April 6 2011 $
d205 1
a205 1
.Ar throughput.
@


1.45
log
@When specifying tos with -t, display a message if the returned packet
has a different tos type. ok claudio@@ phessler@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.44 2010/07/08 20:23:03 claudio Exp $
d36 1
a36 1
.Dd $Mdocdate: July 8 2010 $
d53 1
a53 1
.Op Fl t Ar tos
d173 1
a173 1
.It Fl t Ar tos
d177 12
a188 1
The value must be a decimal integer in the range 0 to 255.
d203 3
a205 4
.Ql -t 16
(low delay) and
.Ql -t 8
(high throughput).
@


1.44
log
@Let traceroute parse extended ICMP messages as defined by RFC 4884.
Currently only the MPLS label can be shown (RFC 4950). The extended
information is only printed if either -x or -v was used.
Initialy based on a port from NetBSD done by dhill@@ but mostly rewritten now.
OK deraadt@@, dhill@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.43 2010/07/03 04:44:52 guenther Exp $
d36 1
a36 1
.Dd $Mdocdate: July 3 2010 $
d180 2
d389 2
@


1.43
log
@Fix the naming of interfaces and variables for rdomains and rtables
and make it possible to bind sockets (including listening sockets!)
to rtables and not just rdomains.  This changes the name of the
system calls, socket option, and ioctl.  After building with this
you should remove the files /usr/share/man/cat2/[gs]etrdomain.0.

Since this removes the existing [gs]etrdomain() system calls, the
libc major is bumped.

Written by claudio@@, criticized^Wcritiqued by me
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.42 2009/07/06 06:50:03 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: July 6 2009 $
d45 1
a45 1
.Op Fl cDdIlnrSv
d208 2
@


1.42
log
@default waittime is 5, not 3;
from Paul Stoeber
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.41 2009/06/05 06:47:12 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: June 5 2009 $
d54 1
a54 1
.Op Fl V Ar rdomain
d194 2
a195 2
.It Fl V Ar rdomain
Set the routing domain.
@


1.41
log
@tweak -V;
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.40 2009/06/05 00:10:01 claudio Exp $
d207 1
a207 1
Set the time (in seconds) to wait for a response to a probe (default 3).
@


1.40
log
@Use -V to specify an alternate routing domain.
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.39 2007/05/31 19:20:30 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate: May 31 2007 $
d195 2
a196 1
Set the routing domain, the default is 0.
@


1.39
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.38 2005/12/23 14:58:35 jmc Exp $
d36 1
a36 1
.Dd $Mdocdate$
d54 1
d194 2
@


1.38
log
@adjust the description of -r to that in freebsd's traceroute6(8),
since it's more informative;

ok djm claudio
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.37 2005/11/02 11:35:54 jmc Exp $
d36 1
a36 1
.Dd June 6, 1993
@


1.37
log
@- sort options and sync usage()
- new sentence, new line
- a few other minor tweaks
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.36 2003/08/27 08:17:33 jmc Exp $
d154 6
a159 3
This option can be used to ping a local host through an interface
that has no route through it (e.g., after the interface was dropped by
.Xr routed 8 ) .
@


1.36
log
@- sort SYNOPSIS and DESCRIPTION
- add -v to SYNOPSIS
from Andrey Matveev;

- indent examples
- sync usage() with man page

ok deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.35 2003/06/12 12:59:53 jmc Exp $
d45 1
a45 1
.Op Fl cdDIlnrSv
d49 1
a50 1
.Op Fl P Ar proto
d82 2
a85 2
.It Fl D
Dump the packet data to standard error before transmitting it.
d87 3
a89 2
Set the first time-to-live used in outgoing probe packets. The effect is that
the first first_ttl - 1 hosts will be skipped in the output of
d116 9
a144 9
.It Fl P Ar proto
Change the protocol being used from
.Tn UDP
to a numeric protocol or a name as specified in
.Pa /etc/protocols .
This will not work reliably for most protocols.
If set to 1 (ICMP), then
ICMP Echo Request messages will be used (same as
.Xr ping 8 ) .
d157 2
a168 2
.It Fl S
Print how many probes were not answered for each hop.
d225 1
a225 1
If there is no response within a 5 sec. timeout
d404 2
a405 1
datagrams as probe packets.  During the first night of testing it was
@


1.35
log
@- section reorder
- macro fixes
- kill whitespace at EOL
- new sentence, new line
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.34 2003/06/02 23:36:55 millert Exp $
d44 2
a45 5
.Op Fl S
.Op Fl D
.Op Fl I
.Op Fl c
.Op Fl d
a47 1
.Op Fl l
a48 1
.Op Fl n
a51 2
.Op Fl r
.Bk -words
a52 1
.Ek
d57 1
d77 7
a83 2
.It Fl S
Print how many probes were not answered for each hop.
a85 2
.It Fl d
Turn on socket-level debugging.
d97 5
a114 14
.It Fl P Ar proto
Change the protocol being used from
.Tn UDP
to a numeric protocol or a name as specified in
.Pa /etc/protocols .
This will not work reliably for most protocols.
If set to 1 (ICMP), then
ICMP Echo Request messages will be used (same as
.Xr ping 8 ) .
.It Fl I
Equivalent to
.Fl P
1.
Used for compatibility with other OSes.
d135 9
a143 5
.It Fl c
Do not increment the destination port number in successive UDP packets.
Rather, all UDP packets will have the same destination port, as set via the
.Fl p
flag (or 33434 if none is specified).
d166 2
d185 1
a185 1
.Ql \-t 16
d187 1
a187 1
.Ql \-t 8
d240 1
a240 1
.Bd -literal
a253 1

d255 1
d270 1
a270 1
.Bd -literal
a290 1

d292 1
d314 1
a314 1
.Bd -literal
a327 1

d329 1
d381 2
a382 4
.Bd -literal
$ traceroute \-g 10.3.0.5 128.182.0.0

.Ed
d384 3
a386 4
.Bd -literal
$ traceroute \-g 192.5.146.4 \-g 10.3.0.5 35.0.0.0

.Ed
@


1.34
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.33 2003/04/03 06:47:59 jmc Exp $
a405 5
.Sh AUTHORS
Implemented by Van Jacobson from a suggestion by Steve Deering.
Debugged
by a cast of thousands with particularly cogent suggestions or fixes from
C. Philip Wood, Tim Seaver and Ken Adelman.
d426 5
@


1.33
log
@HPUX, HP/UX -> HP-UX

ok mickey@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.32 2003/03/18 11:18:55 jmc Exp $
d18 1
a18 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
@


1.32
log
@xon/xoff -> Xon/Xoff;
IETF ipng -> IETF IPng;
NSFNet -> NSFNET;

courtesy NetBSD (Igor Sobrado)
ok miod@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.31 2002/11/14 02:57:28 deraadt Exp $
d362 1
a362 1
.Pq Tn HPUX
@


1.31
log
@use $ or # before commands in examples
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.30 2002/08/30 02:17:34 stevesk Exp $
d275 1
a275 1
.Tn NSFNet
@


1.30
log
@add some history regarding use of UDP probe packets vs. ICMP.
from: http://www.kohala.com/start/papers.others/vanj.99feb08.txt
ok deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.29 2002/08/12 20:43:13 stevesk Exp $
d252 1
a252 1
[yak 71]% traceroute nis.nsf.net.
d282 1
a282 1
[yak 72]% traceroute allspice.lcs.mit.edu.
d393 1
a393 1
traceroute \-g 10.3.0.5 128.182.0.0
d398 1
a398 1
traceroute \-g 192.5.146.4 \-g 10.3.0.5 35.0.0.0
@


1.29
log
@missing period
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.28 2002/08/12 02:40:52 stevesk Exp $
d419 12
@


1.28
log
@!X for 3/13 (administratively prohibited); ok itojun@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.27 2002/08/11 18:17:32 stevesk Exp $
d97 1
a97 1
.Nm
@


1.27
log
@document other ICMP redirect code strings; ok millert@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.26 2002/08/11 01:34:31 stevesk Exp $
d375 2
@


1.26
log
@-m default from net.inet.ip.ttl MIB variable now; ok millert@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.25 2002/03/31 19:12:32 stevesk Exp $
d366 1
d379 7
a385 1
ever occur and the associated gateway is busted if you see one).
@


1.25
log
@max_ttl default was changed to IPDEFTTL (64) several years
ago so catch up documentation; ok millert@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.24 2001/08/02 18:37:35 mpech Exp $
d111 3
a113 3
The default is 64 hops (the same default used for
.Tn TCP
connections).
@


1.24
log
@o) .Sh AUTHOR -> .Sh AUTHORS;
o) .Sh EXAMPLE -> .Sh EXAMPLES;
o) Delete .Sh OPTIONS. Text moved to .Sh DESCRIPTION;

millert@@ ok
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.23 2001/06/09 21:09:05 pvalchev Exp $
d111 1
a111 1
The default is 30 hops (the same default used for
d224 1
a224 1
defaults to 30 hops & can be changed with the
d253 1
a253 1
traceroute to nis.nsf.net (35.1.1.48), 30 hops max, 56 byte packet
d283 1
a283 1
traceroute to allspice.lcs.mit.edu (18.26.0.115), 30 hops max
@


1.23
log
@Document -S option to print the data loss in each hop in percents; freebsd
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.22 2000/04/20 17:26:37 angelos Exp $
d401 1
a401 1
.Sh AUTHOR
@


1.22
log
@Change the flag to -f, similar to Solaris.
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.21 2000/04/20 07:47:11 angelos Exp $
d48 3
a52 2
.Op Fl D
.Op Fl I
d88 4
a93 2
.It Fl D
Dump the packet data to standard error before transmitting it.
@


1.21
log
@Add a "minimum ttl" option (starting point). Useful for skipping over
local-ISP routers that don't generate ICMP time exceeded.
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.20 2000/04/15 02:15:21 aaron Exp $
a47 1
.Op Fl b Ar min_ttl
d52 1
a86 5
.It Fl b Ar min_ttl
Set the first time-to-live used in outgoing probe packets. The effect is that
the first min_ttl - 1 hosts will be skipped in the output of
.Nm
The default value is 1 (skip no hosts).
d91 5
@


1.20
log
@Mostly punctuation fixes.
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.19 2000/04/11 13:20:32 aaron Exp $
d48 1
d87 5
@


1.19
log
@Fix HISTORY section; ian@@darwinsys.com
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.18 2000/03/23 21:39:57 aaron Exp $
d117 1
a117 2
.Xr ping 8
).
d120 2
a121 1
.Fl P 1.
@


1.18
log
@More pedantic man page formatting insanity, lalala
@
text
@d1 1
a1 1
.\"	$OpenBSD: traceroute.8,v 1.17 2000/03/19 17:57:16 aaron Exp $
d403 2
a404 2
command
.Bt
@


1.17
log
@Remove hard sentence breaks. Add $OpenBSD$ tags where appropriate. Some other
cleanup along the way.
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d114 2
a115 1
This will not work reliably for most protocols. If set to 1 (ICMP), then
d144 2
a145 3
Do not increment the destination port number in successive UDP
packets. Rather, all UDP packets will have the same destination port,
as set via the
@


1.16
log
@Add -I flag for compatibility.
@
text
@d1 1
d84 1
a84 1
Other options are:
d94 2
a95 1
option.  If no gateways are specified, the LSRR option is omitted.
d97 2
a98 2
Display the ttl value of the returned packet.  This is useful for
checking for asymmetric routing.
d101 2
a102 1
packets.  The default is 30 hops (the same default used for
d138 2
a139 1
be returned to terminate the route tracing).  If something is
d163 2
a164 2
a hostname) as the source address in outgoing probe packets.  On
hosts with more than one IP address, this option can be used to
d166 2
a167 1
of the interface the probe packet is sent on.  If the IP address
d173 5
a177 4
in probe packets to the following value (default zero).  The value must be
a decimal integer in the range 0 to 255.  This option can be used to
see if different types-of-service result in different paths.  (If you
are not running a
d185 2
a186 2
meaningful \- see the IP spec for definitions.  Useful values are
probably
d192 2
a193 1
Verbose output.  Received
d210 2
a211 2
"time exceeded" reply from a gateway.  We start our probes
with a ttl of one and increase by one until we get an
d217 2
a218 2
flag).  Three
probes (changed with
d222 2
a223 1
round trip time of each probe.  If the probe answers come from
d225 2
a226 1
be printed.  If there is no response within a 5 sec. timeout
d258 2
a259 1
Note that lines 2 & 3 are the same.  This is due to a buggy
d299 2
a300 1
with a ttl too small to reach us.  14 \- 17 are running the
d302 2
a303 2
C Gateway code that doesn't send "time exceeded"s.  God
only knows what's going on with 12.
d310 2
a311 2
original datagram.  Since, for gateways, the remaining ttl is
zero, the
d313 2
a314 2
"time exceeded" is guaranteed to not make it back
to us.  The behavior of this bug is slightly more interesting
d337 2
a338 1
reply.  So, the reply will time out on the return path
d344 3
a346 2
length.  I.e., rip is really only 7 hops away.  A reply that
returns with a ttl of 1 is a clue this problem exists.
d369 2
a370 2
ever occur and the associated gateway is busted if you see one).  If
almost all the probes result in some kind of unreachable,
d393 2
a394 1
Implemented by Van Jacobson from a suggestion by Steve Deering.  Debugged
@


1.15
log
@If the protocol specified via the -P flag is 1 (IPPROTO_ICMP), use
ICMP Echo Request packets (rather than UDP packets) for the traceroute
(mlists@@gizmo.kyrnet.kg)

Also, if the -c flag is specified, the UDP destination port is not
incremented; rather, the base port is used for all packets (33434 or
as set via the -p flag).
@
text
@d50 1
d115 4
@


1.14
log
@Typo fixes.
@
text
@d47 1
d110 4
a113 2
This will not work reliably for most protocols, and is only intended
for testing certain things, like sipp-esp and sipp-ah.
d133 6
@


1.13
log
@remove argument from .Os macros so value in /usr/share/tmac/mdoc/doc-common
is used instead; kwesterback@@home.com
@
text
@d94 1
a94 1
checking for assymetric routing.
@


1.12
log
@grammar police: do not hyphenate compound words that act as adjectives if the
first word ends in -ly

i.e., fully-qualified, newly-created, globally-visible, etc. are wrong
@
text
@d41 1
a41 1
.Os BSD 4.3
@


1.11
log
@all .Nm macros should have an argument in SYNOPSIS; also misc cleanup
@
text
@d137 1
a137 1
If the host is not on a directly-attached network,
@


1.10
log
@insert a missing .Ar; d@@
@
text
@d46 1
a46 1
.Nm
@


1.9
log
@re-enable the bind() for non-superusers so normal users cannot set the source address to be a non-local address
@
text
@d46 1
a46 1
.Nm traceroute
d69 1
a69 1
.Nm Traceroute
d116 1
a116 1
.Nm Traceroute
d179 2
a180 3
.It Fl w
Set the time (in seconds) to wait for a response to a probe (default 3
sec.).
d320 1
a320 1
.Nm Traceroute
d344 1
a344 1
.Nm traceroute
d363 1
a363 1
.Nm traceroute
@


1.8
log
@ports used are base to base+nhops*nqueries-1; henry@@zoo.utoronto.ca
@
text
@d149 2
a150 2
is not one of this machine's interface addresses, an error is
returned and nothing is sent.
@


1.7
log
@doc that -P exists for sipp-* debugging, mostly
@
text
@d122 1
a122 1
.Em base+nhops-1
@


1.6
log
@angelos made me say this
@
text
@d110 1
a110 1
for testing certain things.
@


1.5
log
@permit changing protocol, useful for debugging sipp-esp/sipp-ah/ipencap; angelos/niklas/me
@
text
@d109 2
@


1.4
log
@add "-l" flag see NetBSD PR #3227
@
text
@d54 1
d104 5
@


1.3
log
@Recognize "{net,host} access prohibited" icmp reply.
@
text
@d50 1
d91 3
@


1.2
log
@from netbsd:
traceroute waits 5 seconds, not 3 seconds, before printing a *
@
text
@d324 3
@


1.1
log
@Initial revision
@
text
@d1 1
a1 1
.\"	$NetBSD: traceroute.8,v 1.5 1995/03/26 21:45:22 glass Exp $
d192 1
a192 1
be printed.  If there is no response within a 3 sec. timeout
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
