head	1.34;
access;
symbols
	OPENBSD_6_2_BASE:1.34
	OPENBSD_6_1:1.34.0.4
	OPENBSD_6_1_BASE:1.34
	OPENBSD_6_0:1.33.0.2
	OPENBSD_6_0_BASE:1.33
	OPENBSD_5_9:1.18.0.2
	OPENBSD_5_9_BASE:1.18
	OPENBSD_5_8:1.18.0.4
	OPENBSD_5_8_BASE:1.18
	OPENBSD_5_7:1.14.0.4
	OPENBSD_5_7_BASE:1.14
	OPENBSD_5_6:1.14.0.8
	OPENBSD_5_6_BASE:1.14
	OPENBSD_5_5:1.14.0.6
	OPENBSD_5_5_BASE:1.14
	OPENBSD_5_4:1.14.0.2
	OPENBSD_5_4_BASE:1.14
	OPENBSD_5_3:1.8.0.2
	OPENBSD_5_3_BASE:1.8
	OPENBSD_5_2:1.7.0.2
	OPENBSD_5_2_BASE:1.7
	OPENBSD_5_1_BASE:1.6
	OPENBSD_5_1:1.6.0.4
	OPENBSD_5_0:1.6.0.2
	OPENBSD_5_0_BASE:1.6
	OPENBSD_4_9:1.5.0.2
	OPENBSD_4_9_BASE:1.5
	OPENBSD_4_8:1.4.0.4
	OPENBSD_4_8_BASE:1.4
	OPENBSD_4_7:1.4.0.2
	OPENBSD_4_7_BASE:1.4
	OPENBSD_4_6:1.2.0.4
	OPENBSD_4_6_BASE:1.2;
locks; strict;
comment	@.\" @;


1.34
date	2017.03.03.23.36.06;	author renato;	state Exp;
branches;
next	1.33;
commitid	nsyffCkbHeLwduqi;

1.33
date	2016.07.07.19.56.27;	author rzalamena;	state Exp;
branches;
next	1.32;
commitid	hq0jdmI1jA0jwOVW;

1.32
date	2016.07.02.05.58.00;	author jmc;	state Exp;
branches;
next	1.31;
commitid	SyD8znKRbhb6ElSh;

1.31
date	2016.07.01.23.29.55;	author renato;	state Exp;
branches;
next	1.30;
commitid	OkOx7tFZtmlIlivU;

1.30
date	2016.07.01.23.14.31;	author renato;	state Exp;
branches;
next	1.29;
commitid	DKNC9fIizmSRxKR1;

1.29
date	2016.05.23.21.05.07;	author jmc;	state Exp;
branches;
next	1.28;
commitid	tGtwm5EXTdmBjD86;

1.28
date	2016.05.23.19.14.03;	author renato;	state Exp;
branches;
next	1.27;
commitid	TLlfi1Pk0Z97z8HM;

1.27
date	2016.05.23.18.58.48;	author renato;	state Exp;
branches;
next	1.26;
commitid	D7VvXbswyzx5Ahb2;

1.26
date	2016.05.23.18.49.22;	author renato;	state Exp;
branches;
next	1.25;
commitid	YknY3oNnRO7uAabk;

1.25
date	2016.05.23.17.43.42;	author renato;	state Exp;
branches;
next	1.24;
commitid	VpAym8dVR6eY4drQ;

1.24
date	2016.05.23.16.18.51;	author renato;	state Exp;
branches;
next	1.23;
commitid	0IKOnhMGNkMbV1lE;

1.23
date	2016.05.23.15.53.40;	author renato;	state Exp;
branches;
next	1.22;
commitid	1oKfyTeVVyhfWeTI;

1.22
date	2016.05.23.15.43.11;	author renato;	state Exp;
branches;
next	1.21;
commitid	weS0xzAgWBV4f0dh;

1.21
date	2016.05.23.15.41.04;	author renato;	state Exp;
branches;
next	1.20;
commitid	GWVZlQK3ZbMPg5pq;

1.20
date	2016.05.23.15.36.53;	author renato;	state Exp;
branches;
next	1.19;
commitid	b5v1HDJMqnmmtr2V;

1.19
date	2016.05.23.15.32.48;	author renato;	state Exp;
branches;
next	1.18;
commitid	XVU4bpPKZtnBxFvS;

1.18
date	2015.07.21.04.52.29;	author renato;	state Exp;
branches;
next	1.17;
commitid	puLLDX1XPNc3GxB9;

1.17
date	2015.07.19.22.36.30;	author jmc;	state Exp;
branches;
next	1.16;
commitid	5slaS91ZRsuoKwRM;

1.16
date	2015.07.19.21.01.56;	author renato;	state Exp;
branches;
next	1.15;
commitid	3CZZKtMxWnvDQhpO;

1.15
date	2015.07.19.20.50.03;	author renato;	state Exp;
branches;
next	1.14;
commitid	HQ4RevpYoLNvLRj2;

1.14
date	2013.06.04.06.41.35;	author jmc;	state Exp;
branches;
next	1.13;

1.13
date	2013.06.04.02.25.28;	author claudio;	state Exp;
branches;
next	1.12;

1.12
date	2013.06.01.20.07.07;	author jmc;	state Exp;
branches;
next	1.11;

1.11
date	2013.06.01.19.28.55;	author claudio;	state Exp;
branches;
next	1.10;

1.10
date	2013.06.01.18.47.07;	author claudio;	state Exp;
branches;
next	1.9;

1.9
date	2013.06.01.18.35.02;	author claudio;	state Exp;
branches;
next	1.8;

1.8
date	2012.08.29.20.15.19;	author jmc;	state Exp;
branches;
next	1.7;

1.7
date	2012.04.24.14.56.09;	author jmc;	state Exp;
branches;
next	1.6;

1.6
date	2011.04.30.07.52.33;	author sthen;	state Exp;
branches;
next	1.5;

1.5
date	2010.09.01.13.54.54;	author claudio;	state Exp;
branches;
next	1.4;

1.4
date	2010.01.02.21.29.56;	author jmc;	state Exp;
branches;
next	1.3;

1.3
date	2010.01.02.19.44.53;	author schwarze;	state Exp;
branches;
next	1.2;

1.2
date	2009.06.02.16.17.14;	author michele;	state Exp;
branches;
next	1.1;

1.1
date	2009.06.01.20.59.45;	author michele;	state Exp;
branches;
next	;


desc
@@


1.34
log
@Allow to run on a non-default rdomain.

OK claudio@@
@
text
@.\"	$OpenBSD: ldpd.conf.5,v 1.33 2016/07/07 19:56:27 rzalamena Exp $
.\"
.\" Copyright (c) 2013, 2016 Renato Westphal <renato@@openbsd.org>
.\" Copyright (c) 2009 Michele Marchetto <michele@@openbsd.org>
.\" Copyright (c) 2005, 2006 Esben Norby <norby@@openbsd.org>
.\" Copyright (c) 2004 Claudio Jeker <claudio@@openbsd.org>
.\" Copyright (c) 2003, 2004 Henning Brauer <henning@@openbsd.org>
.\" Copyright (c) 2002 Daniel Hartmeier <dhartmei@@openbsd.org>
.\"
.\" Permission to use, copy, modify, and distribute this software for any
.\" purpose with or without fee is hereby granted, provided that the above
.\" copyright notice and this permission notice appear in all copies.
.\"
.\" THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
.\" WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
.\" MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
.\" ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
.\" WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
.\" ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
.\" OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
.\"
.Dd $Mdocdate: July 7 2016 $
.Dt LDPD.CONF 5
.Os
.Sh NAME
.Nm ldpd.conf
.Nd Label Distribution Protocol daemon configuration file
.Sh DESCRIPTION
The
.Xr ldpd 8
daemon implements the Label Distribution Protocol as described in RFC 5036.
.Sh SECTIONS
The
.Nm
config file is divided into seven main sections.
.Bl -tag -width xxxx
.It Sy Macros
User-defined variables may be defined and used later, simplifying the
configuration file.
.It Sy Global Configuration
Global settings for
.Xr ldpd 8 .
.It Sy Address-Family Configuration
Address-family specific parameters.
.It Sy Interfaces Configuration
Interface-specific parameters.
.It Sy Targeted Neighbors Configuration
Targeted neighbor specific parameters.
.It Sy Neighbors Configuration
Neighbor-specific parameters.
.It Sy Layer 2 VPNs Configuration
Layer 2 VPNs parameters as per RFC 4447.
.El
.Pp
Argument names not beginning with a letter, digit, or underscore
must be quoted.
.Pp
Additional configuration files can be included with the
.Ic include
keyword, for example:
.Bd -literal -offset indent
include "/etc/ldpd.sub.conf"
.Ed
.Sh MACROS
Much like
.Xr cpp 1
or
.Xr m4 1 ,
macros can be defined that will later be expanded in context.
Macro names must start with a letter, digit, or underscore,
and may contain any of those characters.
Macro names may not be reserved words (for example,
.Ic password ) .
Macros are not expanded inside quotes.
.Pp
For example:
.Bd -literal -offset indent
secret="openbsd"
neighbor 10.0.1.5 {
	password $secret
}
.Ed
.Sh GLOBAL CONFIGURATION
Several settings can be configured globally or within a more restricted scope,
like per address-family or per interface.
The only settings that can be set globally and not overruled are listed below.
.Pp
.Bl -tag -width Ds -compact
.It Xo
.Ic ds-cisco-interop
.Pq Ic yes Ns | Ns Ic no
.Xc
If set to
.Ic yes ,
Cisco non-compliant format will be used to send and interpret the Dual-Stack
capability TLV.
The default is
.Ic no .
.Pp
.It Xo
.Ic fib-update
.Pq Ic yes Ns | Ns Ic no
.Xc
If set to
.Ic no ,
do not update the Label Forwarding Information Base, a.k.a. the kernel routing
table.
The default is
.Ic yes .
.Pp
.It Ic rdomain Ar tableid
Specifies the routing table
.Xr ldpd 8
should modify.
Table 0 is the default table.
.Pp
.It Ic router-id Ar address
Set the router ID; in combination with labelspace it forms the LSR-ID.
If not specified, the numerically lowest IP address of the router will be used.
.Pp
.It Xo
.Ic transport-preference
.Pq Ic ipv4 Ns | Ns Ic ipv6
.Xc
Specify the preferred address-family for TCP transport connections.
If two dual-stack LSRs preferences does not match, no LDP session will
be established.
The default is
.Ic ipv6 .
.El
.Sh ADDRESS-FAMILY CONFIGURATION
Each address-family can have several parameters configured
individually, otherwise they are inherited.
.Bd -literal -offset indent
address-family ipv6 {
	explicit-null yes
	transport-address 2001:db8::50
	interface em0
}
.Ed
.Pp
.Bl -tag -width Ds -compact
.It Xo
.Ic explicit-null
.Pq Ic yes Ns | Ns Ic no
.Xc
If set to
.Ic yes ,
advertise explicit-null labels in place of implicit-null labels for directly
connected prefixes.
The default is
.Ic no .
.Pp
.It Xo
.Ic gtsm-enable
.Pq Ic yes Ns | Ns Ic no
.Xc
If set to
.Ic yes ,
.Xr ldpd 8
will use the GTSM procedures described in RFC 6720 (for the IPv4 address-family)
and RFC 7552 (for the IPv6 address-family).
.Pp
Since GTSM is mandatory for LDPv6, the only effect of disabling GTSM for the
IPv6 address-family is that
.Xr ldpd 8
will not check the incoming packets' hop limit.
Outgoing packets will still be sent using a hop limit of 255 to guarantee
interoperability.
.Pp
If GTSM is enabled, multi-hop neighbors should have either GTSM disabled
individually or configured with an appropriate gtsm-hops distance.
The default is
.Ic yes .
.Pp
.It Ic keepalive Ar seconds
Set the keepalive timeout in seconds.
The default value is 180; valid range is 3\-65535.
.Pp
.It Xo
.Ic targeted-hello-accept
.Pq Ic yes Ns | Ns Ic no
.Xc
If set to
.Ic yes ,
allow LDP sessions to be established with remote neighbors that have not been
specifically configured.
The default is
.Ic no .
.Pp
.It Ic transport-address Ar address
Set the local address to be used in the TCP sessions.
For the IPv4 address-family, the router-id will be used if this option is not specified.
For the IPv6 address-family, this option must be specified.
.El
.Sh INTERFACES
Each interface can have several parameters configured individually, otherwise
they are inherited.
.Bd -literal -offset indent
address-family ipv4 {
	interface em0 {
		link-hello-holdtime 9
		link-hello-interval 3
	}
}
.Ed
.Pp
Interface-specific parameters are listed below.
.Bl -tag -width Ds
.It Ic link-hello-holdtime Ar seconds
Set the hello holdtime in seconds.
The maximum time
.Xr ldpd 8
will wait between two consecutive hello messages from a peer before it is
marked as being down.
The default value is 15; valid range is 3\-65535.
.It Ic link-hello-interval Ar seconds
Set the hello interval in seconds.
The default value is 5; valid range is 1\-65535.
.El
.Sh TARGETED NEIGHBORS
Each targeted neighbor can have several parameters configured individually,
otherwise they are inherited.
.Bd -literal -offset indent
address-family ipv4 {
	targeted-neighbor A.B.C.D {
		targeted-hello-holdtime 90
		targeted-hello-interval 10
	}
}
address-family ipv6 {
	targeted-neighbor 2001:db8::1
}
.Ed
.Pp
Targeted-neighbor specific parameters are listed below.
.Bl -tag -width Ds
.It Ic targeted-hello-holdtime Ar seconds
Set the hello holdtime in seconds.
The maximum time
.Xr ldpd 8
will wait between two consecutive hello messages from a peer before it is
marked as being down.
The default value is 45.
.It Ic targeted-hello-interval Ar seconds
Set the hello interval in seconds.
The default value is 5; valid range is 1\-65535.
.El
.Sh NEIGHBORS
The
.Ic neighbor
section allows for the configuration of neighbor-specific parameters.
Note, however, that
.Xr ldpd 8
uses the hello discovery mechanism to discover its neighbors.
Without an underlying adjacency these commands have no effect.
A neighbor is identified by its LSR-ID, not by its remote address.
The neighbor-specific parameters apply for both LDPoIPv4 and LDPoIPv6 sessions.
.Bd -literal -offset indent
neighbor A.B.C.D {
}
.Ed
.Pp
Neighbor-specific parameters are listed below.
.Bl -tag -width Ds
.It Ic keepalive Ar seconds
Set the keepalive timeout in seconds.
Inherited from the global configuration if not given.
Valid range is 3\-65535.
.It Xo
.Ic gtsm-enable
.Pq Ic yes Ns | Ns Ic no
.Xc
Override the inherited configuration and enable/disable GTSM for this neighbor.
.It Ic gtsm-hops Ar hops
Set the maximum number of hops the neighbor may be away.
When GTSM is enabled for this neighbor, incoming packets are required to have
a TTL/hop limit of 256 minus this value, ensuring they have not passed
through more than the expected number of hops.
The default value is 1; valid range is 1\-255.
.It Ic password Ar secret
Enable TCP MD5 signatures per RFC 5036.
.El
.Sh LAYER 2 VPNS
.Xr ldpd 8
implements the signaling of pseudowires which can be used to
implement either the VPWS solution (also known as PWE3) or the VPLS
solution.
Currently only the VPLS solution is supported.
.Bd -literal -offset indent
l2vpn name type vpls {
        bridge bridge0
        interface em1
        pseudowire mpw1 {
                pw-id 100
                neighbor-id 192.168.1.10
        }
        pseudowire mpw2 {
                pw-id 200
                neighbor-id 10.0.1.5
        }
}
.Ed
.Pp
Layer 2 VPN specific parameters are listed below.
.Bl -tag -width Ds
.It Ic bridge Ar interface
Set the bridge interface the VPLS is associated with.
This parameter is optional and is only used to remove MAC addresses received
from MAC address withdrawal messages.
Only one bridge interface can be set.
.It Ic interface Ar interface
Configure a non pseudowire interface pertaining to the VPLS.
This parameter is optional and is only used to send MAC address withdrawal
messages when the specified interface is shutdown.
Multiple interfaces can be configured.
.It Ic mtu Ar number
Set the MTU advertised in the pseudowires.
Local and remote MTUs must match for a pseudowire to be set up.
The default value is 1500.
.It Xo
.Ic type
.Pq Ic ethernet Ns | Ns Ic ethernet-tagged
.Xc
Specify the type of the configured pseudowires.
The type must be the same at both endpoints.
The default is
.Ic ethernet .
.El
.Sh PSEUDOWIRES
Each
.Xr mpw 4
pseudowire interface can have several parameters configured individually,
otherwise they are inherited.
A pseudowire interface is specified by its name.
.Bd -literal -offset indent
pseudowire mpw5 {
	pw-id 5000
	neighbor-id 172.16.1.50
}
.Ed
.Pp
Pseudowire-specific parameters are listed below.
.Bl -tag -width Ds
.It Xo
.Ic control-word
.Pq Ic yes Ns | Ns Ic no
.Xc
Specify whether the use of the control word is preferred or not
preferred.
The default is
.Ic yes .
.It Ic neighbor-addr Ar address
Specify the IPv4 or IPv6 address of the remote endpoint of the pseudowire.
A targeted neighbor will automatically be created for this address.
By default, the LSR-ID of the remote endpoint of the pseudowire will be used.
.It Ic neighbor-id Ar address
Specify the LSR-ID of the remote endpoint of the pseudowire.
.It Ic pw-id Ar number
Set the PW ID used to identify the pseudowire.
The PW ID must be the same at both endpoints.
Valid range is 1\-4294967295.
.It Xo
.Ic status-tlv
.Pq Ic yes Ns | Ns Ic no
.Xc
Specify whether the use of the Status TLV is preferred or not
preferred.
The default is
.Ic yes .
.El
.Sh FILES
.Bl -tag -width "/etc/ldpd.conf" -compact
.It Pa /etc/ldpd.conf
.Xr ldpd 8
configuration file
.El
.Sh SEE ALSO
.Xr ldpctl 8 ,
.Xr ldpd 8 ,
.Xr rc.conf.local 8
.Sh HISTORY
The
.Nm
file format first appeared in
.Ox 4.6 .
@


1.33
log
@Updated the ldpd.conf man page examples

The man page already contains the definition of the new neighbor-addr and
neighbor-id, but the examples were outdated. Now we may have an LSR-ID that
is different from its address.

ok renato@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.32 2016/07/02 05:58:00 jmc Exp $
d22 1
a22 1
.Dd $Mdocdate: July 2 2016 $
d110 6
@


1.32
log
@do not uppercase "hop limit";
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.31 2016/07/01 23:29:55 renato Exp $
d22 1
a22 1
.Dd $Mdocdate: July 1 2016 $
d290 1
a290 1
                neighbor 192.168.1.10
d294 1
a294 1
                neighbor 10.0.1.5
d333 1
a333 1
	neighbor 172.16.1.50
@


1.31
log
@Several minor tweaks.
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.30 2016/07/01 23:14:31 renato Exp $
d161 2
a162 2
will not check the incoming packets' Hop Limit.
Outgoing packets will still be sent using a Hop Limit of 255 to guarantee
d272 1
a272 1
a TTL/Hop Limit of 256 minus this value, ensuring they have not passed
@


1.30
log
@Add GTSM support (RFC 6720).

This also finishes the missing bits from our RFC 7552 implementation
because GTSM is mandatory for LDPv6.

To avoid any kind of interoperability problems, I included a few
knobs to enable/disable GTSM on a per-address-family and per-neighbor
basis. Cisco's LDPv6 implementation, for instance, doesn't support GTSM.

"reads good" claudio@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.29 2016/05/23 21:05:07 jmc Exp $
d22 1
a22 1
.Dd $Mdocdate: May 23 2016 $
d263 1
a263 1
The default value is 180; valid range is 3\-65535.
@


1.29
log
@various tweaks;
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.28 2016/05/23 19:14:03 renato Exp $
d148 22
d264 11
@


1.28
log
@Update copyright information.
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.27 2016/05/23 18:58:48 renato Exp $
d119 1
a119 1
Specify the prefered address-family for TCP transport connections.
a267 1
.Pp
a272 1
.Pp
a277 1
.Pp
d290 1
a313 1
.Pp
a317 1
.Pp
a319 1
.Pp
d332 1
@


1.27
log
@Add support for IPv6 (RFC 7552).

This includes:
* Full compliance to RFC 7552;
* Support for MD5 on LDPov6 sessions;
* Support for pseudowires over IPv6 LSPs (we're probably the world's
  first implementation doing this);
* Support for the IPv6 explicit-null label;
* Knob to specify the prefered address-family for TCP transport
  connections;
* Knob to use cisco non-compliant format to send and interpret the
  Dual-Stack capability TLV.
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.26 2016/05/23 18:49:22 renato Exp $
d3 1
@


1.26
log
@Start sentences on new lines in ldpd.conf(5).
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.25 2016/05/23 17:43:42 renato Exp $
d34 1
a34 1
config file is divided into six main sections.
d42 2
d83 2
a84 1
All interface related settings can be configured globally and per interface.
d89 1
a89 1
.Ic explicit-null
d94 2
a95 2
advertise explicit-null labels in place of implicit-null labels for directly
connected prefixes.
a109 4
.It Ic keepalive Ar seconds
Set the keepalive timeout in seconds.
The default value is 180; valid range is 1\-65535.
.Pp
d115 37
d164 2
a165 1
If not specified, the router-id will be used.
d171 5
a175 1
interface em0 {
d196 8
a203 1
targeted-neighbor A.B.C.D {
d229 1
d316 2
a317 2
.It Ic neighbor Ar address
Specify the endpoint of the pseudowire on the remote PE router.
d319 4
@


1.25
log
@Fix mess caused by my commit script.

I screwed up everything... trying to fix now.
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d21 1
a21 1
.Dd $Mdocdate$
d199 2
a200 1
solution. Currently only the VPLS solution is supported.
d220 4
a223 3
Set the bridge interface the VPLS is associated with. This parameter
is optional and is only used to remove MAC addresses received from MAC
address withdrawal messages. Only one bridge interface can be set.
d226 4
a229 4
Configure a non pseudowire interface pertaining to the VPLS. This
parameter is optional and is only used to send MAC address withdrawal
messages when the specified interface is shutdown. Multiple interfaces
can be configured.
d232 3
a234 2
Set the MTU advertised in the pseudowires. Local and remote MTUs must
match for a pseudowire to be set up. The default value is 1500.
d239 3
a241 2
Specify the type of the configured pseudowires. The type must be the
same at both endpoints. The default is
d247 2
a248 2
otherwise they are inherited. A pseudowire interface is specified by
its name.
d263 2
a264 1
preferred. The default is
d268 2
a269 2
Specify the endpoint of the pseudowire on the remote PE router. A targeted
neighbor will automatically be created for this address.
d272 3
a274 2
Set the PW ID used to identify the pseudowire. The PW ID must be the
same at both endpoints. Valid range is 1\-4294967295.
d280 2
a281 1
preferred. The default is
@


1.24
log
@Make neighbor parameters per lsr-id not per transport-address.

With the advent of IPv6 support, a single neighbor can have two different
transport-addresses: one for ipv4 and one for ipv6. In order to define
neighbor-specific parameters in an indistinguishable way, define them
by lsr-id. This way we can switch between LDPov4 and LDPov6 and keep
the same configuration.
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.23 2016/05/23 15:53:40 renato Exp $
d21 1
a21 1
.Dd $Mdocdate: May 23 2016 $
d70 1
a70 1
.Ic cost ) .
d75 3
a77 3
hi="2"
interface em0 {
	cost $hi
@


1.23
log
@Validate received hello holdtime and keepalive time.

Refuse a keepalive time of zero because it's invalid. For the hello
holdtime, zero is valid and means infinite.

Additionally, refuse values smaller than three for both the keepalive
timer and the hello holdtime. The keepalive/hello interval is calculated
as one third of their holdtime, which means that if the holdtime is one
or two, the calculated interval would be zero using integer arithmetic.

If anyone wants to use such a small holdtime, he or she should use
BFD instead.
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.22 2016/05/23 15:43:11 renato Exp $
d180 1
@


1.22
log
@Add knob to configure the transport address.

This will be especially important when we add support for IPv6, because
we'll not be able to use the router-id as the transport-address in
this case.
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.21 2016/05/23 15:41:04 renato Exp $
d146 1
a146 1
The default value is 15.
d190 1
a190 1
The default value is 180; valid range is 1\-65535.
@


1.21
log
@Allow setting the session holdtime per neighbor.
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.20 2016/05/23 15:36:53 renato Exp $
d113 1
d125 4
@


1.20
log
@Sort configuration options in ldpd.conf(5).
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.19 2016/05/23 15:32:48 renato Exp $
d182 4
@


1.19
log
@Add support for including additional configuration files.

Pulled from ospfd. Original author: dlg@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.18 2015/07/21 04:52:29 renato Exp $
d21 1
a21 1
.Dd $Mdocdate: July 21 2015 $
d86 11
a106 3
.It Ic router-id Ar address
Set the router ID; in combination with labelspace it forms the LSR-ID.
.Pp
d111 3
a206 11
.It Xo
.Ic type
.Pq Ic ethernet Ns | Ns Ic ethernet-tagged
.Xc
Specify the type of the configured pseudowires. The type must be the
same at both endpoints. The default is
.Ic ethernet .
.Pp
.It Ic mtu Ar number
Set the MTU advertised in the pseudowires. Local and remote MTUs must
match for a pseudowire to be set up. The default value is 1500.
d218 11
d244 7
a263 7
preferred. The default is
.Ic yes .
.It Xo
.Ic control-word
.Pq Ic yes Ns | Ns Ic no
.Xc
Specify whether the use of the control word is preferred or not
@


1.18
log
@VPLS signaling support.

This patch introduces full support for pseudowire signaling in ldpd(8),
including Control Word and Status TLV negotiation.

As of now it's not possible to configure a VPWS, but the signaling is
the same. In the future, when VPWS support is available in the kernel,
ldpd(8) can be extended to support VPWS with only a few modifications.

Limitations:
* No support for FEC 129, only FEC 128 (more widely deployed);
* No support for group withdraws (not widely deployed);
* No support for MAC withdraws (not widely deployed).

Related RFCs:
* RFC 3916: Requirements for Pseudo-Wire Emulation Edge-to-Edge (PWE3)
* RFC 3985: Pseudo Wire Emulation Edge-to-Edge (PWE3) Architecture
* RFC 4385: Pseudowire Emulation Edge-to-Edge (PWE3) Control Word for
  Use over an MPLS PSN
* RFC 4446: IANA Allocations for Pseudowire Edge to Edge Emulation (PWE3)
* RFC 4447: Pseudowire Setup and Maintenance Using the Label Distribution
  Protocol (LDP)
* RFC 4448: Encapsulation Methods for Transport of Ethernet over MPLS
  Networks
* RFC 4905: Encapsulation Methods for Transport of Layer 2 Frames over
  MPLS Networks
* RFC 4906: Transport of Layer 2 Frames Over MPLS

ok claudio@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.17 2015/07/19 22:36:30 jmc Exp $
d21 1
a21 1
.Dd $Mdocdate: July 19 2015 $
d51 10
@


1.17
log
@new sentence, new line;
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.16 2015/07/19 21:01:56 renato Exp $
d34 1
a34 1
config file is divided into five main sections.
d48 2
d164 81
@


1.16
log
@Implement md5 authentication support.

ok claudio@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.15 2015/07/19 20:50:03 renato Exp $
d147 2
a148 2
section allows for the configuration of neighbor-specific parameters. Note,
however, that
d150 2
a151 2
uses the hello discovery mechanism to discover its neighbors. Without an
underlying adjacency these commands have no effect.
@


1.15
log
@Remove incomplete support for unnecessary modes of  operation.

LDP has several modes of operation, it was designed in that way so it
could run on legacy equipment like ATM/FR switches with very strict
memory limitations.

For modern hardware there's no point on using either the "Conservative
Label Retention" or "Downstream On Demand" modes of operation since they
save memory at cost of blackholing traffic when routing changes. Major
vendors implement only the "Liberal Label Retention" and "Downstream
Unsolicited" modes for non ATM/FR hardware. Let's do that too.

As for using either "Independent Control" or "Ordered Control", let's
stick with the first option mainly because it's easier to implement
and because it doesn't really matter which control mode is used. For
reference, Cisco implements only "Independent Control" and Juniper only
"Ordered Control". Both modes are interoperable.

The point of supporting only one combination of all modes of operation
is that it will allow for the writing of a simpler code without removing
useful functionality.

ok claudio@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.14 2013/06/04 06:41:35 jmc Exp $
d21 1
a21 1
.Dd $Mdocdate: June 4 2013 $
d34 1
a34 1
config file is divided into four main sections.
d46 2
d143 18
@


1.14
log
@tweak previous;
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.13 2013/06/04 02:25:28 claudio Exp $
a87 33
.Pp
.It Xo
.Ic distribution
.Pq Ic independent Ns | Ns Ic ordered
.Xc
Select the distribution mode.
.Ic independent
distributes labels at any time;
.Ic ordered
forces
.Xr ldpd 8
to wait a mapping from nexthop before distributing it to peers.
.Pp
.It Xo
.Ic retention
.Pq Ic liberal Ns | Ns Ic conservative
.Xc
Select the retention mode.
.Ic conservative
retains just the labels advertised from nexthop;
.Ic liberal
mode retains every label received, even those not advertised
from nexthops.
.Pp
.It Xo
.Ic advertisement
.Pq Ic unsolicited Ns | Ns Ic ondemand
.Xc
Select the advertisement mode.
.Ic unsolicited
advertises labels according to the distribution mode;
.Ic ondemand
advertises labels solely upon explicit request from peers.
@


1.13
log
@Implement support for adjacencies and targeted hellos
Refactor adjacencies out of the neighbor handling so that it is possible to
have more complex topologies with targeted sessions.
From Renato Westphal
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.12 2013/06/01 20:07:07 jmc Exp $
d21 1
a21 1
.Dd $Mdocdate: June 1 2013 $
d44 1
a44 1
.It Sy Targeted neighbors Configuration
a170 1
.Pp
@


1.12
log
@zap extra .Pp;
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.11 2013/06/01 19:28:55 claudio Exp $
d34 1
a34 1
config file is divided into three main sections.
d44 2
d121 11
d143 1
a143 1
.It Ic holdtime Ar seconds
d150 23
a172 1
.It Ic hello-interval Ar seconds
@


1.11
log
@The keepalive timeout should be configured on a global basis and not per
interface.
Remove the iface pointer from the 'nbr' structure because it's not
needed anymore.
Diff from Renato Westphal
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.10 2013/06/01 18:47:07 claudio Exp $
a136 1
.Pp
@


1.10
log
@Drop support for per-interface labelspaces.
Support for per-interface labelspaces is only necessary for legacy ATM/FR
interfaces running in cell-mode. We shouldn't worry about this.
For platform-wide label spaces the label space id is always 0.
Diff by Renato Westphal
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.9 2013/06/01 18:35:02 claudio Exp $
d84 1
a84 1
Set the keepalive interval in seconds.
@


1.9
log
@Drop support for passive interfaces.
Support for passive interfaces was inherited from ospfd but it doesn't
make any sense at all for ldpd.
Diff from Renato Westphal
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.8 2012/08/29 20:15:19 jmc Exp $
d21 1
a21 1
.Dd $Mdocdate: August 29 2012 $
a81 4
.Pp
.It Ic labelspace Ar number
Set the label space advertised by
.Xr ldpd 8 .
@


1.8
log
@rfc 5036 obsoletes rfc 3036; ok claudio
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.7 2012/04/24 14:56:09 jmc Exp $
d21 1
a21 1
.Dd $Mdocdate: April 24 2012 $
d65 2
a66 1
Global settings concerns the main behaviour of the daemon.
a86 12
.It Ic holdtime Ar seconds
Set the hello holdtime in seconds.
The maximum time
.Xr ldpd 8
will wait between two consecutive hello messages from a peer before it is
marked as being down.
The default value is 15.
.Pp
.It Ic hello-interval Ar seconds
Set the hello interval in seconds.
The default value is 5; valid range is 1\-65535.
.Pp
d134 11
a144 2
.It Ic passive
Prevent transmission and reception of LDP packets on this interface.
@


1.7
log
@take a stab at documenting when arguments need quoted, and valid macro
characters;

prompted by a diff from robert peichaer org

thanks gilles and henning for feedback
ok deraadt zinke
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.6 2011/04/30 07:52:33 sthen Exp $
d21 1
a21 1
.Dd $Mdocdate: April 30 2011 $
d30 1
a30 1
daemon implements the Label Distribution Protocol as described in RFC 3036.
@


1.6
log
@no need to escape |, pointed out by jmc@@
"it's worth killing, if just to stop it being copied all over the place"
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.5 2010/09/01 13:54:54 claudio Exp $
d21 1
a21 1
.Dd $Mdocdate: September 1 2010 $
d51 2
a52 2
Macro names must start with a letter, and may contain letters, digits,
and underscores.
@


1.5
log
@s/lfib/fib/ for more consitency with the other routing daemons.
This started manly because of ldpctl beeing inconsistent and me misstyping
lfib almost every time.
OK michele@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.4 2010/01/02 21:29:56 jmc Exp $
d21 1
a21 1
.Dd $Mdocdate: January 2 2010 $
d70 1
a70 1
.Pq Ic yes Ns \&| Ns Ic no
d104 1
a104 1
.Pq Ic independent Ns \&| Ns Ic ordered
d116 1
a116 1
.Pq Ic liberal Ns \&| Ns Ic conservative
d127 1
a127 1
.Pq Ic unsolicited Ns \&| Ns Ic ondemand
@


1.4
log
@sort SEE ALSO;
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.3 2010/01/02 19:44:53 schwarze Exp $
d69 1
a69 1
.Ic lfib-update
@


1.3
log
@The .Rs macro must be followed by .Re, and empty .Rs is useless anyway.
Markup syntax error found by mandoc(1), also required to fix the mandoc build.
ok jmc@@ sobrado@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.2 2009/06/02 16:17:14 michele Exp $
d21 1
a21 1
.Dd $Mdocdate: June 2 2009 $
a154 1
.Xr rc.conf.local 8 ,
d156 2
a157 1
.Xr ldpd 8
@


1.2
log
@Fix ldpd.conf man page.

Document the most important options currently present.

input jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: ldpd.conf.5,v 1.1 2009/06/01 20:59:45 michele Exp $
d21 1
a21 1
.Dd $Mdocdate: June 1 2009 $
a157 1
.Rs
@


1.1
log
@Welcome ldpd, the Label Distribution Protocol daemon.
Built using the imsg/three process framework, its main aim
is to redistribute MPLS labels between peers.

Right now it has some really basic functionalities,
the basic protocol works and peers are able to exchange
labels and insert them in the kernel.
It still does not react to changes of topology.

Not yet connected to the builds.

ok claudio@@ deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d21 1
a21 1
.Dd $Mdocdate: April 13 2009 $
d69 1
a69 1
.Ic fib-update
d74 1
a74 1
do not update the Forwarding Information Base, a.k.a. the kernel routing
d79 34
a112 41
.It Xo
.Op Ic no
.Ic redistribute
.Sm off
.Po Ic static Ns \&| Ns Ic connected Ns \&| Ns
.Ic default Pc
.Sm on
.Xc
.It Xo
.Op Ic no
.Ic redistribute Ar prefix
.Xc
.It Xo
.Op Ic no
.Ic redistribute rtlabel Ar label
.Xc
If set to
.Ic connected ,
routes to directly attached networks will be
announced over RIP.
If set to
.Ic static ,
static routes will be announced over RIP.
If set to
.Ic default ,
a default route pointing to this router will be announced over RIP.
It is possible to specify a network range with
.Ar prefix ;
networks need to be part of that range to be redistributed.
Additionally it is possible to redistribute based on route labels
using the
.Ic rtlabel
keyword.
By default no additional routes will be announced over RIP.
.Pp
.Ic redistribute
statements are evaluated in sequential order, from first to last.
The first matching rule decides if a route should be redistributed or not.
Matching rules starting with
.Ic no
will force the route to be not announced.
d115 2
a116 5
.Ic split-horizon
.Sm off
.Po Ic default Ns \&| Ns Ic poisoned Ns \&| Ns
.Ic none Pc
.Sm on
d118 6
a123 10
If set to
.Ic default ,
do not redistribute routes to the interface from which they were learned.
If set to
.Ic poisoned ,
redistribute routes to the interface from which they were learned, by
forcing the metric to infinity.
Both these behaviours can resolve routing loops when a router goes down.
The default is
.Ic none .
d126 2
a127 2
.Ic triggered-updates
.Pq Ic yes Ns \&| Ns Ic no
d129 5
a133 3
Immediately trigger responses when a route changes.
The default is
.Ic yes .
a144 50
.It Ic auth-key Ar key
Set the authentication key for
.Ic simple
authentication.
Up to 16 characters can be specified.
.It Ic auth-md Ar key-id key
Set the authentication
.Ar key-id
and
.Ar key
for
.Ic crypt
authentication.
The valid range for
.Ar key-id
is 0\-255.
Up to 16 characters can be specified for
.Ar key .
Multiple keys may be specified.
.It Ic auth-md-keyid Ar key-id
Configure the
.Ar key-id
to use for
.Ic crypt
authentication.
The valid range for
.Ar key-id
is 0\-255.
The default key-id is 1.
.It Xo
.Ic auth-type
.Po Ic none Ns \&| Ns
.Ic simple Ns \&| Ns Ic crypt Pc
.Xc
Set the authentication type.
The default is
.Ic none .
Simple authentication uses a plaintext password, up to 16 characters.
Crypt authentication uses an MD5 hash.
.It Ic cost Ar number
Cost of the network connected through this interface.
Values must be between 1 and 16, inclusive.
.It Ic demote Ar group
Increase the
.Xr carp 4
demotion counter by 1 on the given interface group, usually
.Ar carp ,
when the interface state is going down.
The demotion counter will be decreased when the interface
state is active again.
@

