head	1.21;
access;
symbols
	OPENBSD_6_1:1.19.0.4
	OPENBSD_6_1_BASE:1.19
	OPENBSD_6_0:1.17.0.2
	OPENBSD_6_0_BASE:1.17
	OPENBSD_5_9:1.16.0.2
	OPENBSD_5_9_BASE:1.16
	OPENBSD_5_8:1.15.0.4
	OPENBSD_5_8_BASE:1.15
	OPENBSD_5_7:1.13.0.2
	OPENBSD_5_7_BASE:1.13
	OPENBSD_5_6:1.13.0.4
	OPENBSD_5_6_BASE:1.13
	OPENBSD_5_5:1.11.0.4
	OPENBSD_5_5_BASE:1.11
	OPENBSD_5_4:1.9.0.2
	OPENBSD_5_4_BASE:1.9
	OPENBSD_5_3:1.8.0.2
	OPENBSD_5_3_BASE:1.8;
locks; strict;
comment	@.\" @;


1.21
date	2017.08.12.11.20.34;	author goda;	state Exp;
branches;
next	1.20;
commitid	ccl4VRXLf9CVdvt9;

1.20
date	2017.08.11.16.41.47;	author goda;	state Exp;
branches;
next	1.19;
commitid	lPXceYnVd6sYbkcz;

1.19
date	2017.02.22.10.16.14;	author patrick;	state Exp;
branches;
next	1.18;
commitid	ZHe1cyzDjdYZXjKf;

1.18
date	2016.09.07.07.21.02;	author yasuoka;	state Exp;
branches;
next	1.17;
commitid	k7o6MpkftVExsEiY;

1.17
date	2016.05.26.11.47.13;	author mikeb;	state Exp;
branches;
next	1.16;
commitid	MV6pDfFtukxFJwRI;

1.16
date	2015.09.21.10.40.16;	author sobrado;	state Exp;
branches;
next	1.15;
commitid	Vg9nNsRNUpAr0gZL;

1.15
date	2015.06.24.10.09.32;	author jmc;	state Exp;
branches;
next	1.14;
commitid	82AuYmoHxE3wffR0;

1.14
date	2015.06.24.04.34.31;	author yasuoka;	state Exp;
branches;
next	1.13;
commitid	I0ZbiHMkHynW07Hv;

1.13
date	2014.03.22.04.32.39;	author yasuoka;	state Exp;
branches;
next	1.12;

1.12
date	2014.03.22.04.23.17;	author yasuoka;	state Exp;
branches;
next	1.11;

1.11
date	2013.09.11.05.38.08;	author yasuoka;	state Exp;
branches;
next	1.10;

1.10
date	2013.08.12.14.28.30;	author yasuoka;	state Exp;
branches;
next	1.9;

1.9
date	2013.03.19.12.49.30;	author sthen;	state Exp;
branches;
next	1.8;

1.8
date	2013.02.08.12.15.33;	author yasuoka;	state Exp;
branches;
next	1.7;

1.7
date	2013.02.08.11.06.26;	author yasuoka;	state Exp;
branches;
next	1.6;

1.6
date	2013.01.29.15.42.20;	author yasuoka;	state Exp;
branches;
next	1.5;

1.5
date	2012.09.22.14.32.35;	author jmc;	state Exp;
branches;
next	1.4;

1.4
date	2012.09.19.19.29.21;	author yasuoka;	state Exp;
branches;
next	1.3;

1.3
date	2012.09.19.18.33.56;	author yasuoka;	state Exp;
branches;
next	1.2;

1.2
date	2012.09.18.13.23.39;	author yasuoka;	state Exp;
branches;
next	1.1;

1.1
date	2012.09.18.13.14.08;	author yasuoka;	state Exp;
branches;
next	;


desc
@@


1.21
log
@add a new option to set limits on max-sessions each IPCP.

It can set limits on different max-sessions if there're using several protocols
such as PPPoE and L2TP/IPsec.

ok yasuoka@@
@
text
@.\"	$OpenBSD: npppd.conf.5,v 1.20 2017/08/11 16:41:47 goda Exp $
.\"
.\" Copyright (c) 2012 YASUOKA Masahiko <yasuoka@@openbsd.org>
.\"
.\" Permission to use, copy, modify, and distribute this software for any
.\" purpose with or without fee is hereby granted, provided that the above
.\" copyright notice and this permission notice appear in all copies.
.\"
.\" THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
.\" WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
.\" MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
.\" ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
.\" WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN
.\" ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF
.\" OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
.\"
.Dd $Mdocdate: August 11 2017 $
.Dt NPPPD.CONF 5
.Os
.Sh NAME
.Nm npppd.conf
.Nd npppd configuration file
.Sh DESCRIPTION
.Nm
is the configuration file for the PPP daemon
.Xr npppd 8 .
.Sh SECTIONS
.Nm
is divided into six sections:
.Pp
.Bl -tag -width "AuthenticationXXX" -offset indent -compact
.It Sy Global
Global settings.
.It Sy Tunnel
Tunneling protocol and PPP settings.
.It Sy IPCP
Internet Protocol Configuration Protocol (IPCP) of PPP.
.It Sy Interface
Interface settings.
.It Sy Authentication
Authentication settings.
.It Sy Bind
Bind settings.
.El
.Sh GLOBAL
The global options are as follows:
.Bl -tag -width Ds
.It Ic set max-session Ar number
Specify the maximum number of sessions.
.Sq 0
means no limit.
The default value is 0.
.It Ic set user-max-session Ar number
Specify the maximum number of sessions for each user.
.Sq 0
means no limit.
The default value is 0.
.El
.Sh TUNNEL
The
.Ic tunnel
setting is described below:
.Pp
.Ic tunnel Ar name Ic protocol Ar protocol Op Ar option ...
.Pp
Specify the tunnel
.Ar protocol :
.Pp
.Bl -tag -width "pppoeXXX" -offset indent -compact
.It Ic l2tp
Layer Two Tunneling Protocol (RFC 2661)
.It Ic pppoe
PPP Over Ethernet (RFC 2516)
.It Ic pptp
Point-to-Point Tunneling Protocol (RFC 2637)
.El
.Pp
The supported options are as follows:
.Bl -tag -width Ds
.It Ic listen on Ar address Op Ic port Ar port
Specify the IP address that this tunnel listens on.
Both IPv4 and IPv6 addresses can be used for L2TP.
Only IPv4 address can be used for PPTP.
If the port is omitted, the default port numbers are used.
The default port numbers are 1723 for PPTP and 1701 for L2TP.
The default value is 0.0.0.0.
This option is for PPTP and L2TP only.
This option can be used multiple times.
.It Ic listen on interface Ar interface-name
Specify the interface name that this PPPoE tunnel listens on.
The interface must be an Ethernet interface.
This option is for PPPoE only.
.It Ic l2tp-hostname Ar string
Specify an L2TP hostname.
The default value is the value that is returned by
.Xr gethostname 3 .
This option is for L2TP only.
.It Ic l2tp-vendor-name Ar string
Specify an L2TP vendor name.
The default value is "" (an empty string).
This option is for L2TP only.
.It Ic l2tp-hello-interval Ar number
Specify the interval time between L2TP hello requests, in seconds.
The default value is 60.
This option is for L2TP only.
.It Ic l2tp-hello-timeout Ar number
Specify the maximum time that
.Xr npppd 8
waits for L2TP hello responses, in seconds.
The default value is 30.
This option is for L2TP only.
.It Ic l2tp-accept-dialin Ar yes | no
If
.Dq yes
is specified,
.Xr npppd 8
accepts Proxy-LCP and Proxy-Authentication AVPs from LAC
to do
.Dq compulsory tunneling mode .
The default is
.Dq no .
This option is for L2TP only.
.It Ic l2tp-lcp-renegotiation Ar yes | no
If
.Dq yes
is specified,
.Xr npppd 8
will basically use the LCP that is received by Proxied-LCP AVPs,
but if the LCP is not acceptable
.Xr npppd 8
will negotiate LCP again.
The default is
.Dq yes .
This option is for L2TP only.
.It Ic l2tp-force-lcp-renegotiation Ar yes | no
If
.Dq yes
is specified,
.Xr npppd 8
will not use the LCP that is received by Proxied-LCP AVPs,
it will negotiate LCP again.
The default is
.Dq no .
This option is for L2TP only.
.It Ic l2tp-data-use-seq Ar yes | no
Specify
.Dq yes
to use sequencing for L2TP Data communications.
The default is
.Dq yes .
This option is for L2TP only.
.It Ic l2tp-require-ipsec Ar yes | no
Specify
.Dq yes
to refuse L2TP connections without IPsec encapsulation.
The default is
.Dq no .
This option is for L2TP only.
.It Ic pptp-hostname Ar string
Specify a PPTP hostname.
The default value is "" (an empty string).
This option is for PPTP only.
.It Ic pptp-vendor-name Ar string
Specify a PPTP vendor name.
The default value is "" (an empty string).
This option is for PPTP only.
.It Ic pptp-echo-interval Ar number
Specify the interval time between PPTP echo requests, in seconds.
The default value is 60.
This option is for PPTP only.
.It Ic pptp-echo-timeout Ar number
Specify the maximum time that
.Xr npppd 8
waits for PPTP echo replies, in seconds.
The default value is 60.
This option is for PPTP only.
.It Ic pppoe-service-name Ar string
Specify a service name.
The default is "" (an empty string).
This option is for PPPoE only.
.It Ic pppoe-accept-any-service Ar yes | no
If
.Dq yes
is specified
.Xr npppd 8
accepts requests from clients that are accepting any service names.
The default value is
.Dq yes .
This option is for PPPoE only.
.It Ic pppoe-ac-name Ar string
Specify the access concentrator (AC) name.
The default value is created by the MAC address
of the listening interface.
This option is for PPPoE only.
.It Ic mru Ar number
Specify the Maximum Receive Unit (MRU).
This value is used for LCP negotiation to ask the peer not to send packets
greater than the MRU octets.
The peer may use the MRU to decide its MTU, but this depends on the
implementation.
The default values are 1360 for L2TP, 1400 for PPTP, and 1492 for PPPoE.
.It Ic lcp-keepalive Ar yes | no
Specify whether
.Xr npppd 8
uses LCP keepalive.
The default value is
.Dq no
for L2TP and
.Dq yes
for PPTP and PPPoE.
.It Ic lcp-keepalive-interval Ar number
Specify the interval time between LCP echo requests, in seconds.
The default value is 300.
.It Ic lcp-keepalive-retry-interval Ar number
Specify the interval time between retrying LCP echo requests
without receiving the echo reply from the peer.
The value must be specified in seconds.
The default value is 60.
.It Ic lcp-keepalive-max-retries Ar number
Specify the maximum number of LCP echo retries.
If the peer doesn't respond and the number of retries reaches this value,
.Xr npppd 8
treats the link as dead and closes it.
The default value is 3.
.It Ic lcp-timeout Ar number
Specify the timeout value for LCP retransmission in seconds.
The default value is 3.
.It Ic lcp-max-configure Ar number
Specify the maximum number of LCP configure request transmissions.
The default value is 10.
.It Ic lcp-max-terminate Ar number
Specify the maximum number of LCP terminate request transmissions.
The default value is 2.
.It Ic lcp-max-nak-loop Ar number
Specify the maximum number of LCP configure NAK loops.
The default value is 5.
.It Ic authentication-method Ar authentication-method ...
Specify an authentication method:
.Pp
.Bl -tag -width mschapv2 -compact
.It Ic pap
Password Authentication Protocol.
.It Ic chap
PPP Challenge Handshake Authentication Protocol (RFC 1994).
.It Ic mschapv2
Microsoft PPP CHAP Extensions, Version 2 (RFC 2749).
.El
.Pp
.Ic mschapv2
is used as the default for PPTP;
.Ic pap chap mschapv2
is used as the default for other protocols.
.It Ic ccp-timeout Ar number
Specify the timeout value for CCP retransmission, in seconds.
The default value is 3.
.It Ic ccp-max-configure Ar number
Specify the maximum number of CCP configure request transmissions.
The default value is 10.
.It Ic ccp-max-terminate Ar number
Specify the maximum number of CCP terminate request transmissions.
The default value is 2.
.It Ic ccp-max-nak-loop Ar number
Specify the maximum number of CCP configure NAK loops.
The default value is 5.
.It Ic ipcp-timeout Ar number
Specify the timeout value for IPCP retransmission, in seconds.
The default value is 3.
.It Ic ipcp-max-configure Ar number
Specify the maximum number of IPCP configure request transmissions.
The default value is 10.
.It Ic ipcp-max-terminate Ar number
Specify the maximum number of IPCP terminate request transmissions.
The default value is 2.
.It Ic ipcp-max-nak-loop Ar number
Specify the maximum number of IPCP configure NAK loops.
The default value is 5.
.It Ic mppe Ar yes | no | required
If
.Dq yes
is specified,
.Xr npppd 8
will negotiate to use Microsoft Point-to-Point Encryption (MPPE), and it
will continue the PPP even if the negotiation fails.
If
.Dq required
is specified,
.Xr npppd 8
will negotiate to use MPPE, and it will not continue the PPP if the
negotiation fails.
If
.Dq no
is specified,
.Xr npppd 8
will negotiate not to use MPPE and it will refuse to use MPPE.
The default value is
.Dq required
for PPTP and
.Dq yes
for L2TP and PPPoE.
.It Ic mppe-key-length Ar key-length ...
Specify key lengths for this configuration.
The following key lengths can be used:
.Pp
.Bl -tag -width "128XXX" -compact
.It Ic 128
128-bit encryption.
.It Ic 56
56-bit encryption.
.It Ic 40
40-bit encryption.
.El
.It Ic mppe-key-state Ar mode ...
Specify the key change modes that this configuration supports.
The following modes can be used:
.Pp
.Bl -tag -width "statelessXXX" -compact
.It Ic stateful
Stateful mode key changes.
.It Ic stateless
Stateless mode key changes.
.El
.It Ic idle-timeout Ar number
Specify the value for the idle timer, in seconds.
The link is disconnected if there are no data packets sent or received
for more than the amount of the
.Ar idle-timeout .
The default is 0, which disables the idle timer.
.It Ic tcp-mss-adjust Ar yes | no
If
.Dq yes
is specified,
.Xr npppd  8
adjusts TCP SYN packets so that the value of TCP maximum segment size (MSS)
is less than the value calculated from the link MTU.
The default value is
.Dq no .
.It Ic ingress-filter Ar yes | no
If
.Dq yes
is specified,
.Xr npppd 8
applies an ingress filter for incoming packets.
The ingress filter drops all packets whose source address does not match
the address assigned by
.Xr npppd 8
for the link.
The default value is
.Dq no .
.It Ic pipex Ar yes | no
Specify whether
.Xr npppd 8
uses
.Xr pipex 4 .
The default is
.Dq yes .
The
.Xr sysctl 8
variable
.Va net.pipex.enable
should also be enabled to use
.Xr pipex 4 .
.It Ic debug-dump-pktin Ar protocol ...
If this option is specified,
.Xr npppd 8
dumps received packets which match the specified protocol.
The following protocols can be specified:
.Pp
.Bl -tag -width "mppeXXX" -offset indent -compact
.It Ic ip
Internet Protocol (IP)
.It Ic lcp
Link Configuration Protocol (LCP)
.It Ic pap
Password Authentication Protocol (PAP)
.It Ic chap
Challenge Handshake Authentication Protocol (CHAP)
.\" .It Ic eap
.\" Extended Authentication Protocol (EAP)
.It Ic mppe
Microsoft Point-to-Point Encryption (MPPE)
.It Ic ccp
Compression Control Protocol (CCP)
.It Ic ipcp
IP Configuration Protocol (IPCP)
.El
.It Ic debug-dump-pktout Ar protocol ...
If this option is specified,
.Xr npppd 8
dumps sent packets which match the specified protocol.
See
.Ic debug-dump-pktin
section for
.Ar protocol .
.It Ic l2tp-ctrl-in-pktdump Ar yes | no
Specify whether
.Xr npppd 8
dumps received L2TP control packets for debugging.
The default is
.Dq no .
.It Ic l2tp-ctrl-out-pktdump Ar yes | no
Specify whether
.Xr npppd 8
dumps sent L2TP control packets for debugging.
The default is
.Dq no .
.It Ic l2tp-data-in-pktdump Ar yes | no
Specify whether
.Xr npppd 8
dumps received L2TP data packets for debugging.
The default is
.Dq no .
.It Ic l2tp-data-out-pktdump Ar yes | no
Specify whether
.Xr npppd 8
dumps sent L2TP data packets for debugging.
The default is
.Dq no .
.It Ic pptp-ctrl-in-pktdump Ar yes | no
Specify whether
.Xr npppd 8
dumps received PPTP control packets for debugging.
The default is
.Dq no .
.It Ic pptp-ctrl-out-pktdump Ar yes | no
Specify whether
.Xr npppd 8
dumps sent PPTP control packets for debugging.
The default is
.Dq no .
.It Ic pptp-data-in-pktdump Ar yes | no
Specify whether
.Xr npppd 8
dumps received PPTP data packets for debugging.
The default is
.Dq no .
.It Ic pptp-data-out-pktdump Ar yes | no
Specify whether
.Xr npppd 8
dumps sent PPTP data packets for debugging.
The default is
.Dq no .
.It Ic pppoe-desc-in-pktdump Ar yes | no
Specify whether
.Xr npppd 8
dumps received PPPoE discovery packets for debugging.
The default is
.Dq no .
.It Ic pppoe-desc-out-pktdump Ar yes | no
Specify whether
.Xr npppd 8
dumps sent PPPoE discovery packets for debugging.
The default is
.Dq no .
.It Ic pppoe-session-in-pktdump Ar yes | no
Specify whether
.Xr npppd 8
dumps received PPPoE session packets for debug.
The default is
.Dq no .
.It Ic pppoe-session-out-pktdump Ar yes | no
Specify whether
.Xr npppd 8
dumps sent PPPoE session packets for debug.
The default is
.Dq no .
.El
.Sh IPCP
The
.Ic ipcp
setting is described below:
.Pp
.Ic ipcp Ar name Op Ar option ...
.Pp
.Ar name
specifies the name of this
.Ic ipcp
setting.
The maximum number of
.Ic ipcp
settings is 8.
.Pp
The supported options are as follows:
.Bl -tag -width Ds
.It Ic pool-address Ar address-range | address-mask Op Ic for Ar dynamic | static
Specify the IP address space that is pooled for this IPCP setting.
The address space can be specified by
.Ar address-range
(e.g. 192.168.0.2-192.168.0.254)
or
.Ar address-mask
(e.g. 192.168.0.0/24) .
.Ar dynamic
means the address space is reserved for dynamic allocation;
.Ar static
means the address space is reserved for static allocation.
The default is
.Ar dynamic .
This option can be used multiple times.
.It Ic dns-servers Ar primary-server-address Op Ar secondary-server-address
Specify the DNS servers' IP addresses.
.It Ic nbns-servers Ar primary-server-address Op Ar secondary-server-address
Specify the NetBIOS name servers' IP addresses.
.It Ic allow-user-selected-address Ar yes | no
Specify whether
.Xr npppd 8
is allowed to assign an address selected by the user.
The default is
.Dq yes .
.It Ic max-session Ar number
Specify the maximum number of sessions for this
.Ic ipcp
setting.
.Sq 0
means no limit.
The default value is 0.
.El
.Sh INTERFACE
The
.Ic interface
setting is described below:
.Pp
.Ic interface Ar ifname Ic address Ar address Ic ipcp Ar ipcp
.Pp
Use
.Xr tun 4
or
.Xr pppx 4
and
specify its name to
.Ar ifname .
.Ar address
is the IP address of this interface, and it is used as the tunnel address
to the tunnel peer.
.Ic ipcp
specifies the
setting name that is used with this interface.
The maximum number of
.Ic interface
settings is 8.
.Sh AUTHENTICATION
The
.Ic authentication
setting is described below:
.Pp
.Ic authentication Ar name Ic type Ar type { Ar option ... Ic }
.Pp
Specify a
.Ar name
for this authentication setting.
For
.Ar type ,
one of the following can be specified:
.Pp
.Bl -tag -offset indent -compact -width "radiusXXX"
.It Ic local
Authenticates using local file.
.It Ic radius
Authenticates using remote RADIUS servers.
.El
.Pp
The supported options are as follows:
.Bl -tag -width Ds
.It Ic username-suffix Ar string
Specify the suffix of the username
so that
.Xr npppd 8
selects this authentication setting only for a user who has the username
that matches this suffix pattern.
.\" .It Ic eap-capable Ar yes | no
.\" Specify whether this authentcation server is able to use EAP.
.\" Default is `yes'.
.It Ic strip-nt-domain Ar yes | no
Specify whether
.Xr npppd 8
removes the NT domain prefix,
such as '\e\eNTDOMAIN\e',
from the username before contacting the authentication server.
The default is
.Dq yes .
.It Ic strip-atmark-realm Ar yes | no
Specify whether
.Xr npppd 8
removes the realm part that begins with an at sign ('@@')
from the username before contacting the authentication server.
The default is
.Dq no .
.It Ic users-file Ar string
Specify the path for
.Xr npppd-users 5
that describes users' account information.
The path must be under
.Pa /etc/npppd/
because
.Xr npppd 8
is restricted to accessing files only in certain directories.
.It Ic authentication-server Op Ar radius-config
This option describes the settings for a RADIUS authentication server.
.Bl -tag -width Ds
.It Ic address Ar address Oo Ic port Ar port Oc Op Ic secret Ar secret
Specify the IP
.Ar address
and
.Ar port
of the RADIUS server,
using shared
.Ar secret .
.Ar secret
must be less than 127 characters.
The default port is 1812 for
.Ic authentication-server ;
1813 for
.Ic accounting-server .
This option can be specified multiple times (maximum 16) in a
.Ar radius-config .
.It Ic timeout Ar number
Specify the maximum time for waiting for a response, in seconds.
The default is 9.
.It Ic max-tries Ar number
Specify the maximum number of retransmissions.
The default is 3.
.It Ic max-failovers Ar number
Specify the maximum number of failovers.
The default is 1.
.El
.It Ic accounting-server { Ar radius-config Ic }
This option describes the settings for a RADIUS accounting server.
See
.Ic authentication-server
section for details of
.Ar radius-config .
.It Ic user-max-session Ar number
Specify the maximum number of sessions for each user for this
.Ic authentication
setting.
.El
.Sh BIND
.Ic bind
describes a group of
.Ar tunnel ,
.Ar authentication ,
and
.Ar interface
settings so that they are used together.
.Pp
.Ic bind Ic tunnel from Ar tunnel Ic authenticated by Ar authentication
.Ic to Ar ifname
.Sh EXAMPLES
A very simple configuration example is below:
.Bd -literal -offset indent
tunnel L2TP protocol l2tp
tunnel PPTP protocol pptp
ipcp IPCP {
    pool-address 10.0.0.2-10.0.0.254
    dns-servers 8.8.8.8
}
interface pppx0 address 10.0.0.1 ipcp IPCP
authentication LOCAL type local {
    users-file "/etc/npppd/npppd-users"
}
bind tunnel from L2TP authenticated by LOCAL to pppx0
bind tunnel from PPTP authenticated by LOCAL to pppx0
.Ed
.Pp
Another simple configuration, but with two authentication realms:
.Bd -literal -offset indent
tunnel L2TP protocol l2tp {
    listen on 203.0.113.100
}
ipcp IPCP {
    pool-address 10.0.0.2-10.0.0.254
    dns-servers 8.8.8.8
}
interface tun0 address 10.0.0.1 ipcp IPCP
interface tun1 address 10.0.0.1 ipcp IPCP
authentication RADIUS type radius {
    username-suffix "@@example.com"
    authentication-server {
        address 192.168.0.1 secret "hogehoge"
    }
    accounting-server {
        address 192.168.0.1 secret "hogehoge"
    }
}
authentication LOCAL type local {
    username-suffix "@@local"
    users-file "/etc/npppd/npppd-users"
}
bind tunnel from L2TP authenticated by RADIUS to tun0
bind tunnel from L2TP authenticated by LOCAL to tun1
.Ed
.Sh SEE ALSO
.Xr pipex 4 ,
.Xr pppx 4 ,
.Xr tun 4 ,
.Xr npppctl 8 ,
.Xr npppd 8 ,
.Xr sysctl 8
.Sh BUGS
The current version of
.Xr npppd 8
does not support adding or removing tunnel settings or changing listener
settings (listen address, port and l2tp-ipsec-require).
@


1.20
log
@add a new option to set limits on user-max-sessions each AUTHENTICATION.

It can set limits on different user-max-sessions if there're using several
protocols such as PPPoE and L2TP/IPsec.

ok yasuoka@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: npppd.conf.5,v 1.19 2017/02/22 10:16:14 patrick Exp $
d17 1
a17 1
.Dd $Mdocdate: February 22 2017 $
d509 7
@


1.19
log
@The default for the strip-nt-domain attribute is "yes", so fix up
the manpage to not tell lies.

ok yasuoka@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: npppd.conf.5,v 1.18 2016/09/07 07:21:02 yasuoka Exp $
d17 1
a17 1
.Dd $Mdocdate: September 7 2016 $
d624 4
@


1.18
log
@Fix about the default value of pptp-hostname.  It's an empty string.

Reported by Joe Holden.
@
text
@d1 1
a1 1
.\"	$OpenBSD: npppd.conf.5,v 1.17 2016/05/26 11:47:13 mikeb Exp $
d17 1
a17 1
.Dd $Mdocdate: May 26 2016 $
d572 1
a572 1
.Dq no .
@


1.17
log
@Improve and clarify a few bits; with input from jmc@@, ok yasuoka, jmc
@
text
@d1 1
a1 1
.\"	$OpenBSD: npppd.conf.5,v 1.16 2015/09/21 10:40:16 sobrado Exp $
d17 1
a17 1
.Dd $Mdocdate: September 21 2015 $
d161 1
a161 2
The default value is the value that is returned by
.Xr gethostname 3 .
@


1.16
log
@typo in documentation.
@
text
@d1 1
a1 1
.\"	$OpenBSD: npppd.conf.5,v 1.15 2015/06/24 10:09:32 jmc Exp $
d17 1
a17 1
.Dd $Mdocdate: June 24 2015 $
d110 1
d118 2
a119 1
to do `compulsory tunneling mode'.
d324 5
a328 6
Specify the timeout value for the idle timer, in seconds.
The idle timer disconnects the link if the link is idle for the time
specified by this value.
The link is treated as idle if no data packets are sent or received.
0 means disable the idle timer.
The default value is 0.
d571 1
a571 1
from the username before requesting the authentication server.
d577 2
a578 2
removes the realm part that begins '@@' (atmark)
from the username before requesting the authentication server.
@


1.15
log
@tweak previous;
@
text
@d1 1
a1 1
.\"	$OpenBSD: npppd.conf.5,v 1.14 2015/06/24 04:34:31 yasuoka Exp $
d41 1
a41 1
Authenticaton settings.
@


1.14
log
@Mention that pipex should be also configured by sysctl.
@
text
@d1 1
a1 1
.\"	$OpenBSD: npppd.conf.5,v 1.13 2014/03/22 04:32:39 yasuoka Exp $
d17 1
a17 1
.Dd $Mdocdate: March 22 2014 $
d356 1
a356 1
Note that
d360 2
a361 2
also should be enabled to use
pipex 4 .
@


1.13
log
@Now tunnel can have multiple listen addresses.
@
text
@d1 1
a1 1
.\"	$OpenBSD: npppd.conf.5,v 1.12 2014/03/22 04:23:17 yasuoka Exp $
d356 6
d685 2
a686 1
.Xr npppd 8
@


1.12
log
@Fixed a bug in npppd_auth_get_user() which caused segmentation faults after
a user authentication is succeeded in case the authentication config option
has `username-suffix' and 'strip-atmark-realm' is yes. Delete
`username-prefix' from authentication setting.  This config option was
mis-leading and useless.
@
text
@d1 1
a1 1
.\"	$OpenBSD: npppd.conf.5,v 1.11 2013/09/11 05:38:08 yasuoka Exp $
d17 1
a17 1
.Dd $Mdocdate: September 11 2013 $
d88 1
@


1.11
log
@some npppd.conf(5) should be npppd(8).
@
text
@d1 1
a1 1
.\"	$OpenBSD: npppd.conf.5,v 1.10 2013/08/12 14:28:30 yasuoka Exp $
d17 1
a17 1
.Dd $Mdocdate: August 12 2013 $
a554 6
.It Ic username-prefix Ar string
Specify the prefix of the username
so that
.Xr npppd 8
selects this authentication setting only for a user who has the username
that matches this prefix pattern.
@


1.10
log
@Clarify what "mru" config option does.

input and ok giovanni jmc
@
text
@d1 1
a1 1
.\"	$OpenBSD: npppd.conf.5,v 1.9 2013/03/19 12:49:30 sthen Exp $
d17 1
a17 1
.Dd $Mdocdate: March 19 2013 $
d107 1
a107 1
.Nm
d171 1
a171 1
.Nm
@


1.9
log
@typo: icpp/ipcp; from Renaud Allard
@
text
@d1 1
a1 1
.\"	$OpenBSD: npppd.conf.5,v 1.8 2013/02/08 12:15:33 yasuoka Exp $
d17 1
a17 1
.Dd $Mdocdate: February 8 2013 $
d195 4
a198 1
This value is used for LCP negotiation with the tunnel peer.
@


1.8
log
@add mention about 'mppe' configuration option which is missing.

pointed out by csszep at gmail.com
@
text
@d1 1
a1 1
.\"	$OpenBSD: npppd.conf.5,v 1.7 2013/02/08 11:06:26 yasuoka Exp $
d459 1
a459 1
.Ic icpp
@


1.7
log
@Listening on IPv6 address is not supported for pptp tunnel.  Document
this to the man page and refuse it by the config parser.
@
text
@d1 1
a1 1
.\"	$OpenBSD: npppd.conf.5,v 1.6 2013/01/29 15:42:20 yasuoka Exp $
d17 1
a17 1
.Dd $Mdocdate: January 29 2013 $
d272 23
@


1.6
log
@Add pppx.4 and enable links to it.

ok dlg@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: npppd.conf.5,v 1.5 2012/09/22 14:32:35 jmc Exp $
d17 1
a17 1
.Dd $Mdocdate: September 22 2012 $
d82 2
a83 1
Both IPv4 and IPv6 addresses can be used.
@


1.5
log
@various fixes; ok yasuoka
@
text
@d1 1
a1 1
.\"	$OpenBSD: npppd.conf.5,v 1.4 2012/09/19 19:29:21 yasuoka Exp $
d17 1
a17 1
.Dd $Mdocdate: September 19 2012 $
d486 1
a486 2
.\".Xr pppx 4
pppx
d654 1
a654 1
.\".Xr pppx 4 ,
@


1.4
log
@tweak man pages.
- new sentence, new line
- on npppd.8 BUGS section, clarified that what is dropped is L2TP/IPsec
  packets
these must be included the previous commit.
@
text
@d1 1
a1 1
.\"	$OpenBSD: npppd.conf.5,v 1.3 2012/09/19 18:33:56 yasuoka Exp $
d25 1
a25 1
is the configuration file for the PPP daemon,
d29 15
a43 15
is devided six sections:
.Bl -tag -compact -width Authentications
.It Sy Globals
Global setting
.It Sy Tunnels
Tunnel setting describes the tunneling protocol and PPP settings.
.It Sy IPCPs
IPCP setting describes the Internet Protocol Configuration Protocol(IPCP)
of PPP.
.It Sy Interfaces
Inteface setting
.It Sy Authentications
Authenticaton setting
.It Sy Binds
Bind the setting
d46 1
a46 1
Global options are following:
d50 3
a52 2
`0' means no limit.
Default value is `0'.
d55 3
a57 2
`0' means no limit.
Default value is `0'.
d62 3
a64 4
setting are described below:
.Bd -literal
.Ic tunnel Ar name Ic protocol Ar protocol Ic { Ar options Ic }
.Ed
d66 2
a67 6
Specify
.Ar name
of this tunnel protocol setting.
For
.Ar protocol ,
specify one of the following that this tunnel setting accepts from:
d69 1
a69 1
.Bl -tag -offset indent -compact -width pppoe
d72 2
a75 2
.It Ic pppoe
PPP Over Ethernet (RFC 2516)
d78 1
a78 1
Supported options are following:
d81 6
a86 6
Specify IP address that this tunnel protocol listens on.
Both IPv4 and IPv6 address can be used.
If the port is ommited, the default port numbers are used.
The default port number is 1723 for PPTP and 1701 for L2TP.
Default value is `0.0.0.0'.
This option can be specified if the tunnel protocol is not PPPoE.
d89 2
a90 2
The interface must be ethernet interface.
This option can be specified if the tunnel protocol is PPPoE.
d92 4
a95 4
Specify a hostname that are used by L2TP.
Default value is the value that is returned by
.Xr gethostname 2 .
This option can be specified if the tunnel protocol is L2TP.
d97 3
a99 3
Specify a vendor name that are used by L2TP.
Default value is "" (empty string).
This option can be specified if the tunnel protocol is L2TP.
d101 3
a103 3
Specify the interval time between L2TP hello request in seconds.
The default value is `60'.
This option can be specified if the tunnel protocol is L2TP.
d105 1
a105 1
Specify the maximim time that
d107 2
a108 3
waits L2TP hello response in seconds.
The default value is `30'.
This option can be specified if the tunnel protocol is L2TP.
d110 3
a112 1
If `yes' is specified,
d115 4
a118 3
that is to do `compulsory tunneling mode'.
The default is `no'.
This option can be specified if the tunnel protocol is L2TP.
d120 3
a122 1
If `yes' is specified,
d125 1
a125 1
but when if the LCP is not acceptable
d128 3
a130 2
The default is `yes'.
This option can be specified if the tunnel protocol is L2TP.
d132 3
a134 1
If `yes' is specified,
d138 3
a140 2
The default is `no'.
This option can be specified if the tunnel protocol is L2TP.
d142 6
a147 3
Specify `yes' to use sequencling for L2TP Data comunication.
The default is `yes'.
This option can be specified if the tunnel protocol is L2TP.
d149 6
a154 3
Specify `yes' to refuse L2TP connections without IPsec encapsulation.
The default is `no'.
This option can be specified if the tunnel protocol is L2TP.
d156 4
a159 4
Specify a hostname that are used by PPTP.
Default value is the value that is returned by
.Xr gethostname 2 .
This option can be specified if the tunnel protocol is PPTP.
d161 3
a163 3
Specify a vendor name that are used by PPTP.
Default value is "" (empty string).
This option can be specified if the tunnel protocol is PPTP.
d165 3
a167 3
Specify the interval time between PPTP echo request in seconds.
The default value is `60'.
This option can be specified if the tunnel protocol is PPTP.
d169 1
a169 1
Specify the maximim time that
d171 3
a173 3
waits PPTP echo reply in seconds.
The default value is `60'.
This option can be specified if the tunnel protocol is PPTP.
d176 2
a177 2
The default is "" (empty string).
This option can be specified if the tunnel protocol is PPPoE.
d179 8
a186 5
If `yes' is specified
.Xr npppd 8
accepts request from the clients that are accepting any service names
Default value is `yes'.
This option can be specified if the tunnel protocol is PPPoE.
d188 2
a189 2
Specify the access concentrator(ac) name.
The default value is created by the MAC Address
d191 1
a191 1
This option can be specified if the tunnel protocol is PPPoE.
d193 1
a193 1
Specified the MRU(Maximum Receive Unit) value.
d195 1
a195 1
The default value is `1360' for L2TP, `1400' for pptp and '1492' for PPPoE.
d199 6
a204 2
uses LCP keep alive.
The default value `no' for L2TP, `yes' for PPTP and PPPoE.
d206 2
a207 2
Specify the interval time between LCP echo request in seconds.
The default value is `300'.
d209 1
a209 1
Specify the interval time between retrying LCP echo request
d212 1
a212 1
The default value is `60'.
d214 2
a215 2
Specify the maximum number of retrying LCP echo.
If the peer doesn't respond and the number of retry reaches this value,
d217 2
a218 2
treats the link is dead and it closes the link.
The default value is `3'.
d221 1
a221 1
Default value is `3'.
d223 2
a224 2
Specify the maximum number of LCP configure reqeuest transmission.
Default value is `10'.
d226 2
a227 2
Specify the maximum number of LCP terminate reqeuest transmission.
Default value is `2'.
d230 1
a230 1
Default value is `5'.
d232 1
a232 1
Specify authentication methods.
a233 1
Following authentication methods can be used:
d236 1
a236 1
Password Authentication Protocol
d238 1
a238 1
PPP Challenge Handshake Authentication Protocol (RFC 1994)
d240 1
a240 1
Microsoft PPP CHAP Extensions, Version 2 (RFC 2749)
d243 4
a246 2
`mschapv2' is used as the default for PPTP,
`pap chap mschapv2' will be used as the default for other protocols.
d248 2
a249 2
Specify the timeout value for CCP retransmission in seconds.
Default value is `3'.
d251 2
a252 2
Specify the maximum number of CCP configure reqeuest transmission.
Default value is `10'.
d254 2
a255 2
Specify the maximum number of CCP terminate reqeuest transmission.
Default value is `2'.
d258 1
a258 1
Default value is `5'.
d260 2
a261 2
Specify the timeout value for IPCP retransmission in seconds.
Default value is `3'.
d263 2
a264 2
Specify the maximum number of IPCP configure reqeuest transmission.
Default value is `10'.
d266 2
a267 2
Specify the maximum number of IPCP terminate reqeuest transmission.
Default value is `2'.
d270 1
a270 1
Default value is `5'.
d272 2
a273 1
Specify key lengths that this configuration use.
d275 1
a275 2
Following key lengths can be used:
.Bl -tag -width 128 -compact
d277 1
a277 1
128 bits encryption
d279 1
a279 1
56 bits encryption
d281 1
a281 1
40 bits encryption
d284 2
a285 1
Specify the key change modes that this configuration supports to.
d287 1
a287 2
Following modes can be used:
.Bl -tag -width stateless -compact
d289 1
a289 1
Stateful mode key changes
d291 1
a291 1
Stateless mode key changes
d294 2
a295 2
Specify the timeout value for the idle timer in seconds.
The idle timer disconnects the link if the link keeps idle for the time
d297 1
a297 1
The link is treated as `idle' if the no data packet are sent or received.
d299 1
a299 1
Default value is `0'.
d301 3
a303 1
If `yes' is specified,
d305 4
a308 3
adjusts TCP SYN packets so that the value of TCP MSS (maximum segment
size) option is less than the value calculated from the link MTU.
The default value is `no'.
d310 7
a316 5
If `yes' is specified,
.Xr npppd 8
applies ingress filter for incoming packets.
The ingress filter drops all packets that source address does not match to
the address  assigned by
d319 2
a320 1
Default value is `no'.
d326 2
a327 1
Default is `yes'.
d332 3
a334 2
Following protocols can be specified:
.Bl -tag -width mppe -compact
d355 1
a355 1
dumps sending packets which match the specified protocol.
d363 3
a365 2
dumps received L2TP control packets for debug.
Default is `no'.
d369 3
a371 2
dumps sending L2TP control packets for debug.
Default is `no'.
d375 3
a377 2
dumps received L2TP data packets for debug.
Default is `no'.
d381 3
a383 2
dumps sending L2TP data packets for debug.
Default is `no'.
d387 3
a389 2
dumps received PPTP control packets for debug.
Default is `no'.
d393 3
a395 2
dumps sending PPTP control packets for debug.
Default is `no'.
d399 3
a401 2
dumps received PPTP data packets for debug.
Default is `no'.
d405 3
a407 2
dumps sending PPTP data packets for debug.
Default is `no'.
d411 3
a413 2
dumps received PPPoE discovery packets for debug.
Default is `no'.
d417 3
a419 2
dumps sending PPPoE discovery packets for debug.
Default is `no'.
d424 2
a425 1
Default is `no'.
d429 3
a431 2
dumps sending PPPoE session packets for debug.
Default is `no'.
d436 3
a438 4
setting are described below:
.Bd -literal
.Ic ipcp Ar name { Ar option ... Ic }
.Ed
d440 2
a441 1
Specify name of this
d448 1
a448 1
Supported options are following:
d454 1
a454 1
(eg. 192.168.0.2-192.168.0.254)
d457 1
a457 2
(eg. 192.168.0.0/24) .
.Ic for
d459 1
a459 1
means the address space is reserved for dynamic allocation,
d462 1
a462 1
Default is
d464 5
a468 5
This option can be used in multiple times.
.It Ic dns-servers Ar primary-server-address Op secondary-server-address
Specify the DNS servers' IP address.
.It Ic nbns-servers Ar primary-server-address Op secondary-server-address
Specify the NetBIOS name servers' IP address.
d472 3
a474 2
is allowed to assign prior the address that is selected by the user.
Default is `yes'.
d480 1
a480 1
.Bd -literal
a481 1
.Ed
d486 2
a487 1
.Xr pppx 4
d492 1
a492 1
is the IP address of this interface, and it is noticed as the tunnel address
a493 1
Specify the
d495 2
a496 1
setting name that are used with this interface.
d503 2
a504 2
setting are described below:
.Bd -literal
a505 1
.Ed
d507 1
a507 1
Specify
d514 1
a514 1
.Bl -tag -offset indent -compact -width radius
d516 1
a516 1
authenticates by the local file.
d518 1
a518 1
authenticates by the remote RADIUS servers.
d521 1
a521 1
Supported options are following:
d541 5
a545 3
remove the NT domain prefix like '\\\\NTDOMAIN\\' from the username
before requesting the authentication server.
Default is `no'.
d549 1
a549 1
remove the realm part that begins '@@' (atmark)
d551 2
a552 1
Default is `no'.
d555 1
a555 1
.Xr npppd-users 7
d557 8
a564 7
The path must be under `/etc/npppd/', because
.Xr npppd 8
is restricted to access the files only in limited directories.
.It Ic authentication-server { Ar radius-config Ic }
This option describes the settings for RADIUS authentication server.
This option can be used in RADIUS type only.
.Bl -tag -width max-failovers -compact
d566 1
a566 1
Specify the IP address and port of RADIUS server to
d569 3
a571 3
.Ar port ,
and
the shared secret to
d574 3
a576 3
must be less than 127 chars.
Default port is 1812 for
.Ic authentication-server,
d578 2
a579 2
.Ic accouting-server .
This option can be specified multiple times (max 16 times) in a
d582 2
a583 2
Specify the maximum time for waiting the response in seconds.
Default is `9'.
d585 2
a586 2
Specify the maximum number of retransmission.
Default is `3'.
d589 1
a589 1
Default is `1'.
d592 1
a592 1
This option describes the settings for RADIUS accounting server.
d595 2
a596 3
section for
.Ar radius-config
This option can be used in RADIUS type only.
d600 4
a603 5
describes a set of the
.Ar tunnel
setting,
.Ar authentication
setting and
d605 2
a606 2
setting so that they are used together.
.Bd -literal
a608 1
.Ed
d610 1
a610 1
Very simple configuration example is below:
d626 1
a626 1
Simple configuration but has two authentication realms:
a653 2
.Xr npppctl 8 ,
.Xr npppd 8 ,
d655 1
d657 2
a658 1
.Xr pppx 4
d660 1
a660 1
Current version of
d662 2
a663 2
does not support adding or removing tunnel settings or changing its listener
settings(listen address, port and l2tp-ipsec-require).
@


1.3
log
@tweak man pages.
- add missing copyright
- delete comment lines from the template
- new sentence, new line
- on npppd.8 BUGS section, clarified that what is dropped is L2TP/IPsec
  packets
@
text
@d1 1
a1 1
.\"	$OpenBSD: npppd.conf.5,v 1.2 2012/09/18 13:23:39 yasuoka Exp $
d17 1
a17 1
.Dd $Mdocdate: September 18 2012 $
d50 2
a51 1
`0' means no limit.  Default value is `0'.
d54 2
a55 1
`0' means no limit.  Default value is `0'.
d85 2
a86 2
Both IPv4 and IPv6 address can be used.  If the port is ommited, the default
port numbers are used.
d164 2
a165 1
Specify a service name.  The default is "" (empty string).
d294 2
a295 1
for the link.  Default value is `no'.
d423 2
a424 1
means the address space is reserved for static allocation.  Default is
@


1.2
log
@fix mandoc -Tlint warnings.
@
text
@d1 1
a1 1
.\"	$OpenBSD: npppd.conf.5,v 1.1 2012/09/18 13:14:08 yasuoka Exp $
a16 1
.\"
a564 8
.\" The following requests should be uncommented and used where appropriate.
.\" .Sh RETURN VALUES
.\" For sections 2, 3, and 9 function return values only.
.\" .Sh ENVIRONMENT
.\" For sections 1, 6, 7 & 8 only.
.\" .Sh FILES
.\" .Sh EXIT STATUS
.\" For sections 1, 6, & 8 only.
a608 4
.\" .Sh DIAGNOSTICS
.\" For sections 1, 4, 6, 7, and 8 only.
.\" .Sh ERRORS
.\" For sections 2, 3, and 9 error and signal handling only.
a614 4
.\" .Sh STANDARDS
.\" .Sh HISTORY
.\" .Sh AUTHORS
.\" .Sh CAVEATS
@


1.1
log
@New configuration syntax for npppd(8).  `npppd.conf' will be based on
parse.y and `npppd-users' will be based on getcap(3).  Add man pages.

feedback from giovanni
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d18 1
a18 1
.Dd $Mdocdate$
a56 1
.Pp
d60 1
a60 1
.Bd
d71 1
a71 1
.Bl -offset indent -compact -tag -width pppoe -indent
a78 1
.El
d123 1
a123 1
but when if the LCP is not acceptable 
d215 1
a215 1
.Bl -tag -width mschapv2 -compact -indent
d254 1
a254 1
.Bl -tag -width 128 -compact -indent
d266 1
a266 1
.Bl -tag -width stateless -compact -indent
d304 1
a304 1
.Bl -tag -width mppe -compact -indent
d395 1
a395 1
.Bd
a433 1
.Pp
d437 1
a437 1
.Bd
d443 2
a444 2
or 
.Xr pppx 4 
a457 1
.Pp
d461 1
a461 1
.Bd
d472 1
a472 1
.Bl -offset indent -compact -tag -width radius -indent
d518 1
a518 1
.Bl -tag -width max-failovers -compact -indent
d524 1
a524 1
and 
a553 1
.Pp
d562 1
a562 1
.Bd
a574 1
.Pp
@

