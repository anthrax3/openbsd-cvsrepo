head	1.9;
access;
symbols
	OPENBSD_5_6:1.8.0.30
	OPENBSD_5_6_BASE:1.8
	OPENBSD_5_5:1.8.0.28
	OPENBSD_5_5_BASE:1.8
	OPENBSD_5_4:1.8.0.24
	OPENBSD_5_4_BASE:1.8
	OPENBSD_5_3:1.8.0.22
	OPENBSD_5_3_BASE:1.8
	OPENBSD_5_2:1.8.0.20
	OPENBSD_5_2_BASE:1.8
	OPENBSD_5_1_BASE:1.8
	OPENBSD_5_1:1.8.0.18
	OPENBSD_5_0:1.8.0.16
	OPENBSD_5_0_BASE:1.8
	OPENBSD_4_9:1.8.0.14
	OPENBSD_4_9_BASE:1.8
	OPENBSD_4_8:1.8.0.12
	OPENBSD_4_8_BASE:1.8
	OPENBSD_4_7:1.8.0.8
	OPENBSD_4_7_BASE:1.8
	OPENBSD_4_6:1.8.0.10
	OPENBSD_4_6_BASE:1.8
	OPENBSD_4_5:1.8.0.6
	OPENBSD_4_5_BASE:1.8
	OPENBSD_4_4:1.8.0.4
	OPENBSD_4_4_BASE:1.8
	BIND_9_4_2_P1:1.1.1.7
	OPENBSD_4_3:1.8.0.2
	OPENBSD_4_3_BASE:1.8
	BIND_9_4_2:1.1.1.7
	OPENBSD_4_2:1.7.0.4
	OPENBSD_4_2_BASE:1.7
	OPENBSD_4_1:1.7.0.2
	OPENBSD_4_1_BASE:1.7
	BIND_9_3_4:1.1.1.6
	BIND_9_3_3:1.1.1.5
	OPENBSD_4_0:1.5.0.2
	OPENBSD_4_0_BASE:1.5
	BIND_9_3_2:1.1.1.4
	OPENBSD_3_9:1.4.0.4
	OPENBSD_3_9_BASE:1.4
	OPENBSD_3_8:1.4.0.2
	OPENBSD_3_8_BASE:1.4
	BIND_9_3_1:1.1.1.3
	OPENBSD_3_7:1.3.0.2
	OPENBSD_3_7_BASE:1.3
	BIND_9_3_0:1.1.1.2
	OPENBSD_3_6:1.2.0.8
	OPENBSD_3_6_BASE:1.2
	OPENBSD_3_5:1.2.0.6
	OPENBSD_3_5_BASE:1.2
	OPENBSD_3_4:1.2.0.4
	OPENBSD_3_4_BASE:1.2
	OPENBSD_3_3:1.2.0.2
	OPENBSD_3_3_BASE:1.2
	BIND_9_2_2_RC1:1.1.1.1
	ISC:1.1.1;
locks; strict;
comment	@# @;


1.9
date	2014.09.15.19.36.43;	author brad;	state dead;
branches;
next	1.8;
commitid	wEC1EwtQBuinSTtV;

1.8
date	2007.12.09.13.39.42;	author jakob;	state Exp;
branches;
next	1.7;

1.7
date	2007.01.25.07.31.25;	author jakob;	state Exp;
branches;
next	1.6;

1.6
date	2007.01.10.19.07.58;	author jakob;	state Exp;
branches;
next	1.5;

1.5
date	2006.04.05.17.36.32;	author jakob;	state Exp;
branches;
next	1.4;

1.4
date	2005.03.22.16.52.37;	author jakob;	state Exp;
branches;
next	1.3;

1.3
date	2004.09.28.17.14.01;	author jakob;	state Exp;
branches;
next	1.2;

1.2
date	2003.03.05.09.18.31;	author jakob;	state Exp;
branches;
next	1.1;

1.1
date	2003.01.20.21.05.52;	author jakob;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2003.01.20.21.05.52;	author jakob;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2004.09.28.16.32.07;	author jakob;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	2005.03.22.16.35.44;	author jakob;	state Exp;
branches;
next	1.1.1.4;

1.1.1.4
date	2006.04.05.16.41.50;	author jakob;	state Exp;
branches;
next	1.1.1.5;

1.1.1.5
date	2007.01.10.18.17.53;	author jakob;	state Exp;
branches;
next	1.1.1.6;

1.1.1.6
date	2007.01.25.07.13.42;	author jakob;	state Exp;
branches;
next	1.1.1.7;

1.1.1.7
date	2007.12.09.12.32.07;	author jakob;	state Exp;
branches;
next	;


desc
@@


1.9
log
@Garbage collecting some further bits that are not necessary
within the BIND directory and for Makefile.in removing some
files that no longer exist for the distclean target.

ok sthen@@
@
text
@Frequently Asked Questions about BIND 9

Copyright © 2004-2007 Internet Systems Consortium, Inc. ("ISC")

Copyright © 2000-2003 Internet Software Consortium.

-----------------------------------------------------------------------

1. Compilation and Installation Questions

Q: I'm trying to compile BIND 9, and "make" is failing due to files not
   being found. Why?

A: Using a parallel or distributed "make" to build BIND 9 is not
   supported, and doesn't work. If you are using one of these, use normal
   make or gmake instead.

Q: Isn't "make install" supposed to generate a default named.conf?

A: Short Answer: No.

   Long Answer: There really isn't a default configuration which fits any
   site perfectly. There are lots of decisions that need to be made and
   there is no consensus on what the defaults should be. For example
   FreeBSD uses /etc/namedb as the location where the configuration files
   for named are stored. Others use /var/named.

   What addresses to listen on? For a laptop on the move a lot you may
   only want to listen on the loop back interfaces.

   Who do you offer recursive service to? Is there are firewall to
   consider? If so is it stateless or stateful. Are you directly on the
   Internet? Are you on a private network? Are you on a NAT'd network? The
   answers to all these questions change how you configure even a caching
   name server.

2. Configuration and Setup Questions

Q: Why does named log the warning message "no TTL specified - using SOA
   MINTTL instead"?

A: Your zone file is illegal according to RFC1035. It must either have a
   line like:

   $TTL 86400

   at the beginning, or the first record in it must have a TTL field, like
   the "84600" in this example:

   example.com. 86400 IN SOA ns hostmaster ( 1 3600 1800 1814400 3600 )

Q: Why do I get errors like "dns_zone_load: zone foo/IN: loading master
   file bar: ran out of space"?

A: This is often caused by TXT records with missing close quotes. Check
   that all TXT records containing quoted strings have both open and close
   quotes.

Q: How do I restrict people from looking up the server version?

A: Put a "version" option containing something other than the real version
   in the "options" section of named.conf. Note doing this will not
   prevent attacks and may impede people trying to diagnose problems with
   your server. Also it is possible to "fingerprint" nameservers to
   determine their version.

Q: How do I restrict only remote users from looking up the server version?

A: The following view statement will intercept lookups as the internal
   view that holds the version information will be matched last. The
   caveats of the previous answer still apply, of course.

   view "chaos" chaos {
           match-clients { <those to be refused>; };
           allow-query { none; };
           zone "." {
                   type hint;
                   file "/dev/null";  // or any empty file
           };
   };

Q: What do "no source of entropy found" or "could not open entropy source
   foo" mean?

A: The server requires a source of entropy to perform certain operations,
   mostly DNSSEC related. These messages indicate that you have no source
   of entropy. On systems with /dev/random or an equivalent, it is used by
   default. A source of entropy can also be defined using the
   random-device option in named.conf.

Q: I'm trying to use TSIG to authenticate dynamic updates or zone
   transfers. I'm sure I have the keys set up correctly, but the server is
   rejecting the TSIG. Why?

A: This may be a clock skew problem. Check that the the clocks on the
   client and server are properly synchronised (e.g., using ntp).

Q: I see a log message like the following. Why?

   couldn't open pid file '/var/run/named.pid': Permission denied

A: You are most likely running named as a non-root user, and that user
   does not have permission to write in /var/run. The common ways of
   fixing this are to create a /var/run/named directory owned by the named
   user and set pid-file to "/var/run/named/named.pid", or set pid-file to
   "named.pid", which will put the file in the directory specified by the
   directory option (which, in this case, must be writable by the named
   user).

Q: I can query the nameserver from the nameserver but not from other
   machines. Why?

A: This is usually the result of the firewall configuration stopping the
   queries and / or the replies.

Q: How can I make a server a slave for both an internal and an external
   view at the same time? When I tried, both views on the slave were
   transferred from the same view on the master.

A: You will need to give the master and slave multiple IP addresses and
   use those to make sure you reach the correct view on the other machine.

   Master: 10.0.1.1 (internal), 10.0.1.2 (external, IP alias)
       internal:
           match-clients { !10.0.1.2; !10.0.1.4; 10.0.1/24; };
                   notify-source 10.0.1.1;
                   transfer-source 10.0.1.1;
                   query-source address 10.0.1.1;
       external:
           match-clients { any; };
           recursion no;   // don't offer recursion to the world
           notify-source 10.0.1.2;
           transfer-source 10.0.1.2;
           query-source address 10.0.1.2;

   Slave: 10.0.1.3 (internal), 10.0.1.4 (external, IP alias)
       internal:
           match-clients { !10.0.1.2; !10.0.1.4; 10.0.1/24; };
           notify-source 10.0.1.3;
           transfer-source 10.0.1.3;
           query-source address 10.0.1.3;
      external:
           match-clients { any; };
           recursion no;   // don't offer recursion to the world
           notify-source 10.0.1.4;
           transfer-source 10.0.1.4;
           query-source address 10.0.1.4;

   You put the external address on the alias so that all the other dns
   clients on these boxes see the internal view by default.

A: BIND 9.3 and later: Use TSIG to select the appropriate view.

   Master 10.0.1.1:
           key "external" {
                   algorithm hmac-md5;
                   secret "xxxxxxxx";
           };
           view "internal" {
                   match-clients { !key external; 10.0.1/24; };
                   ...
           };
           view "external" {
                   match-clients { key external; any; };
                   server 10.0.1.2 { keys external; };
                   recursion no;
                   ...
           };

   Slave 10.0.1.2:
           key "external" {
                   algorithm hmac-md5;
                   secret "xxxxxxxx";
           };
           view "internal" {
                   match-clients { !key external; 10.0.1/24; };
                   ...
           };
           view "external" {
                   match-clients { key external; any; };
                   server 10.0.1.1 { keys external; };
                   recursion no;
                   ...
           };

Q: I get error messages like "multiple RRs of singleton type" and "CNAME
   and other data" when transferring a zone. What does this mean?

A: These indicate a malformed master zone. You can identify the exact
   records involved by transferring the zone using dig then running
   named-checkzone on it.

   dig axfr example.com @@master-server > tmp
   named-checkzone example.com tmp

   A CNAME record cannot exist with the same name as another record except
   for the DNSSEC records which prove its existence (NSEC).

   RFC 1034, Section 3.6.2: "If a CNAME RR is present at a node, no other
   data should be present; this ensures that the data for a canonical name
   and its aliases cannot be different. This rule also insures that a
   cached CNAME can be used without checking with an authoritative server
   for other RR types."

Q: I get error messages like "named.conf:99: unexpected end of input"
   where 99 is the last line of named.conf.

A: Some text editors (notepad and wordpad) fail to put a line title
   indication (e.g. CR/LF) on the last line of a text file. This can be
   fixed by "adding" a blank line to the end of the file. Named expects to
   see EOF immediately after EOL and treats text files where this is not
   met as truncated.

Q: How do I share a dynamic zone between multiple views?

A: You choose one view to be master and the second a slave and transfer
   the zone between views.

   Master 10.0.1.1:
           key "external" {
                   algorithm hmac-md5;
                   secret "xxxxxxxx";
           };

           key "mykey" {
                   algorithm hmac-md5;
                   secret "yyyyyyyy";
           };

           view "internal" {
                   match-clients { !key external; 10.0.1/24; };
                   server 10.0.1.1 {
                           /* Deliver notify messages to external view. */
                           keys { external; };
                   };
                   zone "example.com" {
                           type master;
                           file "internal/example.db";
                           allow-update { key mykey; };
                           notify-also { 10.0.1.1; };
                   };
           };

           view "external" {
                   match-clients { key external; any; };
                   zone "example.com" {
                           type slave;
                           file "external/example.db";
                           masters { 10.0.1.1; };
                           transfer-source { 10.0.1.1; };
                           // allow-update-forwarding { any; };
                           // allow-notify { ... };
                   };
           };

Q: I get a error message like "zone wireless.ietf56.ietf.org/IN: loading
   master file primaries/wireless.ietf56.ietf.org: no owner".

A: This error is produced when a line in the master file contains leading
   white space (tab/space) but the is no current record owner name to
   inherit the name from. Usually this is the result of putting white
   space before a comment, forgetting the "@@" for the SOA record, or
   indenting the master file.

Q: Why are my logs in GMT (UTC).

A: You are running chrooted (-t) and have not supplied local timezone
   information in the chroot area.

   FreeBSD: /etc/localtime
   Solaris: /etc/TIMEZONE and /usr/share/lib/zoneinfo
   OSF: /etc/zoneinfo/localtime

   See also tzset(3) and zic(8).

Q: I get "rndc: connect failed: connection refused" when I try to run
   rndc.

A: This is usually a configuration error.

   First ensure that named is running and no errors are being reported at
   startup (/var/log/messages or equivalent). Running "named -g <usual
   arguments>" from a title can help at this point.

   Secondly ensure that named is configured to use rndc either by
   "rndc-confgen -a", rndc-confgen or manually. The Administrators
   Reference manual has details on how to do this.

   Old versions of rndc-confgen used localhost rather than 127.0.0.1 in /
   etc/rndc.conf for the default server. Update /etc/rndc.conf if
   necessary so that the default server listed in /etc/rndc.conf matches
   the addresses used in named.conf. "localhost" has two address
   (127.0.0.1 and ::1).

   If you use "rndc-confgen -a" and named is running with -t or -u ensure
   that /etc/rndc.conf has the correct ownership and that a copy is in the
   chroot area. You can do this by re-running "rndc-confgen -a" with
   appropriate -t and -u arguments.

Q: I get "transfer of 'example.net/IN' from 192.168.4.12#53: failed while
   receiving responses: permission denied" error messages.

A: These indicate a filesystem permission error preventing named creating
   / renaming the temporary file. These will usually also have other
   associated error messages like

   "dumping master file: sl/tmp-XXXX5il3sQ: open: permission denied"

   Named needs write permission on the directory containing the file.
   Named writes the new cache file to a temporary file then renames it to
   the name specified in named.conf to ensure that the contents are always
   complete. This is to prevent named loading a partial zone in the event
   of power failure or similar interrupting the write of the master file.

   Note file names are relative to the directory specified in options and
   any chroot directory ([<chroot dir>/][<options dir>]).

   If named is invoked as "named -t /chroot/DNS" with the following
   named.conf then "/chroot/DNS/var/named/sl" needs to be writable by the
   user named is running as.

   options {
           directory "/var/named";
   };

   zone "example.net" {
           type slave;
           file "sl/example.net";
           masters { 192.168.4.12; };
   };

Q: I want to forward all DNS queries from my caching nameserver to another
   server. But there are some domains which have to be served locally, via
   rbldnsd.

   How do I achieve this ?

A: options {
           forward only;
           forwarders { <ip.of.primary.nameserver>; };
   };

   zone "sbl-xbl.spamhaus.org" {
           type forward; forward only;
           forwarders { <ip.of.rbldns.server> port 530; };
   };

   zone "list.dsbl.org" {
           type forward; forward only;
           forwarders { <ip.of.rbldns.server> port 530; };
   };


Q: Can you help me understand how BIND 9 uses memory to store DNS zones?

   Some times it seems to take several times the amount of memory it needs
   to store the zone.

A: When reloading a zone named my have multiple copies of the zone in
   memory at one time. The zone it is serving and the one it is loading.
   If reloads are ultra fast it can have more still.

   e.g. Ones that are transferring out, the one that it is serving and the
   one that is loading.

   BIND 8 destroyed the zone before loading and also killed off outgoing
   transfers of the zone.

   The new strategy allows slaves to get copies of the new zone regardless
   of how often the master is loaded compared to the transfer time. The
   slave might skip some intermediate versions but the transfers will
   complete and it will keep reasonably in sync with the master.

   The new strategy also allows the master to recover from syntax and
   other errors in the master file as it still has an in-core copy of the
   old contents.

3. General Questions

Q: I keep getting log messages like the following. Why?

   Dec 4 23:47:59 client 10.0.0.1#1355: updating zone 'example.com/IN':
   update failed: 'RRset exists (value dependent)' prerequisite not
   satisfied (NXRRSET)

A: DNS updates allow the update request to test to see if certain
   conditions are met prior to proceeding with the update. The message
   above is saying that conditions were not met and the update is not
   proceeding. See doc/rfc/rfc2136.txt for more details on prerequisites.

Q: I keep getting log messages like the following. Why?

   Jun 21 12:00:00.000 client 10.0.0.1#1234: update denied

A: Someone is trying to update your DNS data using the RFC2136 Dynamic
   Update protocol. Windows 2000 machines have a habit of sending dynamic
   update requests to DNS servers without being specifically configured to
   do so. If the update requests are coming from a Windows 2000 machine,
   see http://support.microsoft.com/support/kb/articles/q246/8/04.asp for
   information about how to turn them off.

Q: When I do a "dig . ns", many of the A records for the root servers are
   missing. Why?

A: This is normal and harmless. It is a somewhat confusing side effect of
   the way BIND 9 does RFC2181 trust ranking and of the efforts BIND 9
   makes to avoid promoting glue into answers.

   When BIND 9 first starts up and primes its cache, it receives the root
   server addresses as additional data in an authoritative response from a
   root server, and these records are eligible for inclusion as additional
   data in responses. Subsequently it receives a subset of the root server
   addresses as additional data in a non-authoritative (referral) response
   from a root server. This causes the addresses to now be considered
   non-authoritative (glue) data, which is not eligible for inclusion in
   responses.

   The server does have a complete set of root server addresses cached at
   all times, it just may not include all of them as additional data,
   depending on whether they were last received as answers or as glue. You
   can always look up the addresses with explicit queries like "dig
   a.root-servers.net A".

Q: Why don't my zones reload when I do an "rndc reload" or SIGHUP?

A: A zone can be updated either by editing zone files and reloading the
   server or by dynamic update, but not both. If you have enabled dynamic
   update for a zone using the "allow-update" option, you are not supposed
   to edit the zone file by hand, and the server will not attempt to
   reload it.

Q: Why is named listening on UDP port other than 53?

A: Named uses a system selected port to make queries of other nameservers.
   This behaviour can be overridden by using query-source to lock down the
   port and/or address. See also notify-source and transfer-source.

Q: I get warning messages like "zone example.com/IN: refresh: failure
   trying master 1.2.3.4#53: timed out".

A: Check that you can make UDP queries from the slave to the master

   dig +norec example.com soa @@1.2.3.4

   You could be generating queries faster than the slave can cope with.
   Lower the serial query rate.

   serial-query-rate 5; // default 20

Q: I don't get RRSIG's returned when I use "dig +dnssec".

A: You need to ensure DNSSEC is enabled (dnssec-enable yes;).

Q: Can a NS record refer to a CNAME.

A: No. The rules for glue (copies of the *address* records in the parent
   zones) and additional section processing do not allow it to work.

   You would have to add both the CNAME and address records (A/AAAA) as
   glue to the parent zone and have CNAMEs be followed when doing
   additional section processing to make it work. No nameserver
   implementation supports either of these requirements.

Q: What does "RFC 1918 response from Internet for 0.0.0.10.IN-ADDR.ARPA"
   mean?

A: If the IN-ADDR.ARPA name covered refers to a internal address space you
   are using then you have failed to follow RFC 1918 usage rules and are
   leaking queries to the Internet. You should establish your own zones
   for these addresses to prevent you querying the Internet's name servers
   for these addresses. Please see http://as112.net/ for details of the
   problems you are causing and the counter measures that have had to be
   deployed.

   If you are not using these private addresses then a client has queried
   for them. You can just ignore the messages, get the offending client to
   stop sending you these messages as they are most probably leaking them
   or setup your own zones empty zones to serve answers to these queries.

   zone "10.IN-ADDR.ARPA" {
           type master;
           file "empty";
   };

   zone "16.172.IN-ADDR.ARPA" {
           type master;
           file "empty";
   };

   ...

   zone "31.172.IN-ADDR.ARPA" {
           type master;
           file "empty";
   };

   zone "168.192.IN-ADDR.ARPA" {
           type master;
           file "empty";
   };

   empty:
   @@ 10800 IN SOA <name-of-server>. <contact-email>. (
                  1 3600 1200 604800 10800 )
   @@ 10800 IN NS <name-of-server>.

   Note

   Future versions of named are likely to do this automatically.

Q: Will named be affected by the 2007 changes to daylight savings rules in
   the US.

A: No, so long as the machines internal clock (as reported by "date -u")
   remains at UTC. The only visible change if you fail to upgrade your OS,
   if you are in a affected area, will be that log messages will be a hour
   out during the period where the old rules do not match the new rules.

   For most OS's this change just means that you need to update the
   conversion rules from UTC to local time. Normally this involves
   updating a file in /etc (which sets the default timezone for the
   machine) and possibly a directory which has all the conversion rules
   for the world (e.g. /usr/share/zoneinfo). When updating the OS do not
   forget to update any chroot areas as well. See your OS's documentation
   for more details.

   The local timezone conversion rules can also be done on a individual
   basis by setting the TZ environment variable appropriately. See your
   OS's documentation for more details.

Q: Is there a bugzilla (or other tool) database that mere mortals can have
   (read-only) access to for bind?

A: No. The BIND 9 bug database is kept closed for a number of reasons.
   These include, but are not limited to, that the database contains
   proprietory information from people reporting bugs. The database has in
   the past and may in future contain unfixed bugs which are capable of
   bringing down most of the Internet's DNS infrastructure.

   The release pages for each version contain up to date lists of bugs
   that have been fixed post release. That is as close as we can get to
   providing a bug database.

4. Operating-System Specific Questions

4.1. HPUX

Q: I get the following error trying to configure BIND:

   checking if unistd.h or sys/types.h defines fd_set... no
   configure: error: need either working unistd.h or sys/select.h

A: You have attempted to configure BIND with the bundled C compiler. This
   compiler does not meet the minimum compiler requirements to for
   building BIND. You need to install a ANSI C compiler and / or teach
   configure how to find the ANSI C compiler. The later can be done by
   adjusting the PATH environment variable and / or specifying the
   compiler via CC.

   ./configure CC=<compiler> ...

4.2. Linux

Q: Why do I get the following errors:

   general: errno2result.c:109: unexpected error:
   general: unable to convert errno to isc_result: 14: Bad address
   client: UDP client handler shutting down due to fatal receive error: unexpected error

A: This is the result of a Linux kernel bug.

   See: http://marc.theaimsgroup.com/?l=linux-netdev&m=113081708031466&w=2

Q: Why do I see 5 (or more) copies of named on Linux?

A: Linux threads each show up as a process under ps. The approximate
   number of threads running is n+4, where n is the number of CPUs. Note
   that the amount of memory used is not cumulative; if each process is
   using 10M of memory, only a total of 10M is used.

   Newer versions of Linux's ps command hide the individual threads and
   require -L to display them.

Q: Why does BIND 9 log "permission denied" errors accessing its
   configuration files or zones on my Linux system even though it is
   running as root?

A: On Linux, BIND 9 drops most of its root privileges on startup. This
   including the privilege to open files owned by other users. Therefore,
   if the server is running as root, the configuration files and zone
   files should also be owned by root.

Q: I get the error message "named: capset failed: Operation not permitted"
   when starting named.

A: The capability module, part of "Linux Security Modules/LSM", has not
   been loaded into the kernel. See insmod(8).

Q: I'm running BIND on Red Hat Enterprise Linux or Fedora Core -

   Why can't named update slave zone database files?

   Why can't named create DDNS journal files or update the master zones
   from journals?

   Why can't named create custom log files?

A: Red Hat Security Enhanced Linux (SELinux) policy security protections :

   Red Hat have adopted the National Security Agency's SELinux security
   policy ( see http://www.nsa.gov/selinux ) and recommendations for BIND
   security , which are more secure than running named in a chroot and
   make use of the bind-chroot environment unnecessary .

   By default, named is not allowed by the SELinux policy to write, create
   or delete any files EXCEPT in these directories:

   $ROOTDIR/var/named/slaves
   $ROOTDIR/var/named/data
   $ROOTDIR/var/tmp


   where $ROOTDIR may be set in /etc/sysconfig/named if bind-chroot is
   installed.

   The SELinux policy particularly does NOT allow named to modify the
   $ROOTDIR/var/named directory, the default location for master zone
   database files.

   SELinux policy overrules file access permissions - so even if all the
   files under /var/named have ownership named:named and mode rw-rw-r--,
   named will still not be able to write or create files except in the
   directories above, with SELinux in Enforcing mode.

   So, to allow named to update slave or DDNS zone files, it is best to
   locate them in $ROOTDIR/var/named/slaves, with named.conf zone
   statements such as:

   zone "slave.zone." IN {
           type slave;
           file "slaves/slave.zone.db";
           ...
   };
   zone "ddns.zone." IN  {
           type master;
           allow-updates {...};
           file "slaves/ddns.zone.db";
   };


   To allow named to create its cache dump and statistics files, for
   example, you could use named.conf options statements such as:

   options {
           ...
           dump-file "/var/named/data/cache_dump.db";
           statistics-file "/var/named/data/named_stats.txt";
           ...
   };


   You can also tell SELinux to allow named to update any zone database
   files, by setting the SELinux tunable boolean parameter
   'named_write_master_zones=1', using the system-config-securitylevel
   GUI, using the 'setsebool' command, or in /etc/selinux/targeted/
   booleans.

   You can disable SELinux protection for named entirely by setting the
   'named_disable_trans=1' SELinux tunable boolean parameter.

   The SELinux named policy defines these SELinux contexts for named:

   named_zone_t : for zone database files       - $ROOTDIR/var/named/*
   named_conf_t : for named configuration files - $ROOTDIR/etc/{named,rndc}.*
   named_cache_t: for files modifiable by named - $ROOTDIR/var/{tmp,named/{slaves,data}}


   If you want to retain use of the SELinux policy for named, and put
   named files in different locations, you can do so by changing the
   context of the custom file locations .

   To create a custom configuration file location, e.g. '/root/
   named.conf', to use with the 'named -c' option, do:

   # chcon system_u:object_r:named_conf_t /root/named.conf


   To create a custom modifiable named data location, e.g. '/var/log/
   named' for a log file, do:

   # chcon system_u:object_r:named_cache_t /var/log/named


   To create a custom zone file location, e.g. /root/zones/, do:

   # chcon system_u:object_r:named_zone_t /root/zones/{.,*}


   See these man-pages for more information : selinux(8), named_selinux
   (8), chcon(1), setsebool(8)

4.3. Windows

Q: Zone transfers from my BIND 9 master to my Windows 2000 slave fail.
   Why?

A: This may be caused by a bug in the Windows 2000 DNS server where DNS
   messages larger than 16K are not handled properly. This can be worked
   around by setting the option "transfer-format one-answer;". Also check
   whether your zone contains domain names with embedded spaces or other
   special characters, like "John\032Doe\213s\032Computer", since such
   names have been known to cause Windows 2000 slaves to incorrectly
   reject the zone.

Q: I get "Error 1067" when starting named under Windows.

A: This is the service manager saying that named exited. You need to
   examine the Application log in the EventViewer to find out why.

   Common causes are that you failed to create "named.conf" (usually "C:\
   windows\dns\etc\named.conf") or failed to specify the directory in
   named.conf.

   options {
           Directory "C:\windows\dns\etc";
   };

4.4. FreeBSD

Q: I have FreeBSD 4.x and "rndc-confgen -a" just sits there.

A: /dev/random is not configured. Use rndcontrol(8) to tell the kernel to
   use certain interrupts as a source of random events. You can make this
   permanent by setting rand_irqs in /etc/rc.conf.

   /etc/rc.conf
   rand_irqs="3 14 15"

   See also http://people.freebsd.org/~dougb/randomness.html

4.5. Solaris

Q: How do I integrate BIND 9 and Solaris SMF

A: Sun has a blog entry describing how to do this.

   http://blogs.sun.com/roller/page/anay/Weblog?catname=%2FSolaris

4.6. Apple Mac OS X

Q: How do I run BIND 9 on Apple Mac OS X?

A: If you run Tiger(Mac OS 10.4) or later then this is all you need to do:

   % sudo rndc-confgen  > /etc/rndc.conf

   Copy the key statement from /etc/rndc.conf into /etc/rndc.key, e.g.:

   key "rndc-key" {
           algorithm hmac-md5;
           secret "uvceheVuqf17ZwIcTydddw==";
   };

   Then start the relevant service:

   % sudo service org.isc.named start

   This is persistent upon a reboot, so you will have to do it only once.

A: Alternatively you can just generate /etc/rndc.key by running:

   % sudo rndc-confgen -a

   Then start the relevant service:

   % sudo service org.isc.named start

   Named will look for /etc/rndc.key when it starts if it doesn't have a
   controls section or the existing controls are missing keys sub-clauses.
   This is persistent upon a reboot, so you will have to do it only once.

@


1.8
log
@resolve conflicts
@
text
@@


1.7
log
@resolve conflicts with 9.3.4; SECURITY UPDATE
@
text
@d7 1
a7 1
-------------------------------------------------------------------------------
d9 1
a9 1
Q: Why doesn't -u work on Linux 2.2.x when I build with --enable-threads?
d11 2
a12 6
A: Linux threads do not fully implement the Posix threads (pthreads) standard. In
   particular, setuid() operates only on the current thread, not the full process.
   Because of this limitation, BIND 9 cannot use setuid() on Linux as it can on
   all other supported platforms. setuid() cannot be called before creating
   threads, since the server does not start listening on reserved ports until
   after threads have started.
d14 3
a16 4
   In the 2.2.18 or 2.3.99-pre3 and newer kernels, the ability to preserve
   capabilities across a setuid() call is present. This allows BIND 9 to call
   setuid() early, while retaining the ability to bind reserved ports. This is a
   Linux-specific hack.
d18 1
a18 2
   On a 2.2 kernel, BIND 9 does drop many root privileges, so it should be less of
   a security risk than a root process that has not dropped privileges.
d20 1
a20 1
   If Linux threads ever work correctly, this restriction will go away.
d22 5
a26 2
   Configuring BIND9 with the --disable-threads option (the default) causes a
   non-threaded version to be built, which will allow -u to be used.
d28 2
a29 1
Q: Why do I get the following errors:
d31 5
a35 3
   general: errno2result.c:109: unexpected error:
   general: unable to convert errno to isc_result: 14: Bad address
   client: UDP client handler shutting down due to fatal receive error: unexpected error
d37 1
a37 3
A: This is the result of a Linux kernel bug.

   See: http://marc.theaimsgroup.com/?l=linux-netdev&m=113081708031466&w=2
d39 2
a40 2
Q: Why does named log the warning message "no TTL specified - using SOA MINTTL
   instead"?
d42 2
a43 2
A: Your zone file is illegal according to RFC1035. It must either have a line
   like:
d47 2
a48 2
   at the beginning, or the first record in it must have a TTL field, like the
   "84600" in this example:
d52 2
a53 1
Q: Why do I see 5 (or more) copies of named on Linux?
d55 3
a57 29
A: Linux threads each show up as a process under ps. The approximate number of
   threads running is n+4, where n is the number of CPUs. Note that the amount of
   memory used is not cumulative; if each process is using 10M of memory, only a
   total of 10M is used.

   Newer versions of Linux's ps command hide the individual threads and require -L
   to display them.

Q: Why does BIND 9 log "permission denied" errors accessing its configuration
   files or zones on my Linux system even though it is running as root?

A: On Linux, BIND 9 drops most of its root privileges on startup. This including
   the privilege to open files owned by other users. Therefore, if the server is
   running as root, the configuration files and zone files should also be owned by
   root.

Q: Why do I get errors like "dns_zone_load: zone foo/IN: loading master file bar:
   ran out of space"?

A: This is often caused by TXT records with missing close quotes. Check that all
   TXT records containing quoted strings have both open and close quotes.

Q: How do I produce a usable core file from a multithreaded named on Linux?

A: If the Linux kernel is 2.4.7 or newer, multithreaded core dumps are usable
   (that is, the correct thread is dumped). Otherwise, if using a 2.2 kernel,
   apply the kernel patch found in contrib/linux/coredump-patch and rebuild the
   kernel. This patch will cause multithreaded programs to dump the correct
   thread.
d61 5
a65 4
A: Put a "version" option containing something other than the real version in the
   "options" section of named.conf. Note doing this will not prevent attacks and
   may impede people trying to diagnose problems with your server. Also it is
   possible to "fingerprint" nameservers to determine their version.
d69 3
a71 3
A: The following view statement will intercept lookups as the internal view that
   holds the version information will be matched last. The caveats of the previous
   answer still apply, of course.
d82 2
a83 7
Q: What do "no source of entropy found" or "could not open entropy source foo"
   mean?

A: The server requires a source of entropy to perform certain operations, mostly
   DNSSEC related. These messages indicate that you have no source of entropy. On
   systems with /dev/random or an equivalent, it is used by default. A source of
   entropy can also be defined using the random-device option in named.conf.
d85 9
a93 39
Q: I installed BIND 9 and restarted named, but it's still BIND 8. Why?

A: BIND 9 is installed under /usr/local by default. BIND 8 is often installed
   under /usr. Check that the correct named is running.

Q: I'm trying to use TSIG to authenticate dynamic updates or zone transfers. I'm
   sure I have the keys set up correctly, but the server is rejecting the TSIG.
   Why?

A: This may be a clock skew problem. Check that the the clocks on the client and
   server are properly synchronised (e.g., using ntp).

Q: I'm trying to compile BIND 9, and "make" is failing due to files not being
   found. Why?

A: Using a parallel or distributed "make" to build BIND 9 is not supported, and
   doesn't work. If you are using one of these, use normal make or gmake instead.

Q: I have a BIND 9 master and a BIND 8.2.3 slave, and the master is logging error
   messages like "notify to 10.0.0.1#53 failed: unexpected end of input". What's
   wrong?

A: This error message is caused by a known bug in BIND 8.2.3 and is fixed in BIND
   8.2.4. It can be safely ignored - the notify has been acted on by the slave
   despite the error message.

Q: I keep getting log messages like the following. Why?

   Dec 4 23:47:59 client 10.0.0.1#1355: updating zone 'example.com/IN': update
   failed: 'RRset exists (value dependent)' prerequisite not satisfied (NXRRSET)

A: DNS updates allow the update request to test to see if certain conditions are
   met prior to proceeding with the update. The message above is saying that
   conditions were not met and the update is not proceeding. See doc/rfc/
   rfc2136.txt for more details on prerequisites.

Q: I keep getting log messages like the following. Why?

   Jun 21 12:00:00.000 client 10.0.0.1#1234: update denied
d95 2
a96 6
A: Someone is trying to update your DNS data using the RFC2136 Dynamic Update
   protocol. Windows 2000 machines have a habit of sending dynamic update requests
   to DNS servers without being specifically configured to do so. If the update
   requests are coming from a Windows 2000 machine, see http://
   support.microsoft.com/support/kb/articles/q246/8/04.asp for information about
   how to turn them off.
d102 17
a118 6
A: You are most likely running named as a non-root user, and that user does not
   have permission to write in /var/run. The common ways of fixing this are to
   create a /var/run/named directory owned by the named user and set pid-file to "
   /var/run/named/named.pid", or set pid-file to "named.pid", which will put the
   file in the directory specified by the directory option (which, in this case,
   must be writable by the named user).
d120 2
a121 48
Q: When I do a "dig . ns", many of the A records for the root servers are missing.
   Why?

A: This is normal and harmless. It is a somewhat confusing side effect of the way
   BIND 9 does RFC2181 trust ranking and of the efforts BIND 9 makes to avoid
   promoting glue into answers.

   When BIND 9 first starts up and primes its cache, it receives the root server
   addresses as additional data in an authoritative response from a root server,
   and these records are eligible for inclusion as additional data in responses.
   Subsequently it receives a subset of the root server addresses as additional
   data in a non-authoritative (referral) response from a root server. This causes
   the addresses to now be considered non-authoritative (glue) data, which is not
   eligible for inclusion in responses.

   The server does have a complete set of root server addresses cached at all
   times, it just may not include all of them as additional data, depending on
   whether they were last received as answers or as glue. You can always look up
   the addresses with explicit queries like "dig a.root-servers.net A".

Q: Zone transfers from my BIND 9 master to my Windows 2000 slave fail. Why?

A: This may be caused by a bug in the Windows 2000 DNS server where DNS messages
   larger than 16K are not handled properly. This can be worked around by setting
   the option "transfer-format one-answer;". Also check whether your zone contains
   domain names with embedded spaces or other special characters, like "John\
   032Doe\213s\032Computer", since such names have been known to cause Windows
   2000 slaves to incorrectly reject the zone.

Q: Why don't my zones reload when I do an "rndc reload" or SIGHUP?

A: A zone can be updated either by editing zone files and reloading the server or
   by dynamic update, but not both. If you have enabled dynamic update for a zone
   using the "allow-update" option, you are not supposed to edit the zone file by
   hand, and the server will not attempt to reload it.

Q: I can query the nameserver from the nameserver but not from other machines.
   Why?

A: This is usually the result of the firewall configuration stopping the queries
   and / or the replies.

Q: How can I make a server a slave for both an internal and an external view at
   the same time? When I tried, both views on the slave were transferred from the
   same view on the master.

A: You will need to give the master and slave multiple IP addresses and use those
   to make sure you reach the correct view on the other machine.
d149 2
a150 2
   You put the external address on the alias so that all the other dns clients on
   these boxes see the internal view by default.
d186 2
a187 1
Q: I have FreeBSD 4.x and "rndc-confgen -a" just sits there.
d189 3
a191 20
A: /dev/random is not configured. Use rndcontrol(8) to tell the kernel to use
   certain interrupts as a source of random events. You can make this permanent by
   setting rand_irqs in /etc/rc.conf.

   /etc/rc.conf
   rand_irqs="3 14 15"

   See also http://people.freebsd.org/~dougb/randomness.html

Q: Why is named listening on UDP port other than 53?

A: Named uses a system selected port to make queries of other nameservers. This
   behaviour can be overridden by using query-source to lock down the port and/or
   address. See also notify-source and transfer-source.

Q: I get error messages like "multiple RRs of singleton type" and "CNAME and other
   data" when transferring a zone. What does this mean?

A: These indicate a malformed master zone. You can identify the exact records
   involved by transferring the zone using dig then running named-checkzone on it.
d196 2
a197 25
   A CNAME record cannot exist with the same name as another record except for the
   DNSSEC records which prove its existance (NSEC).

   RFC 1034, Section 3.6.2: "If a CNAME RR is present at a node, no other data
   should be present; this ensures that the data for a canonical name and its
   aliases cannot be different. This rule also insures that a cached CNAME can be
   used without checking with an authoritative server for other RR types."

Q: I get error messages like "named.conf:99: unexpected end of input" where 99 is
   the last line of named.conf.

A: Some text editors (notepad and wordpad) fail to put a line title indication
   (e.g. CR/LF) on the last line of a text file. This can be fixed by "adding" a
   blank line to the end of the file. Named expects to see EOF immediately after
   EOL and treats text files where this is not met as truncated.

Q: I get warning messages like "zone example.com/IN: refresh: failure trying
   master 1.2.3.4#53: timed out".

A: Check that you can make UDP queries from the slave to the master

   dig +norec example.com soa @@1.2.3.4

   You could be generating queries faster than the slave can cope with. Lower the
   serial query rate.
d199 14
a212 1
   serial-query-rate 5; // default 20
d216 2
a217 2
A: You choose one view to be master and the second a slave and transfer the zone
   between views.
d231 1
a231 1
                   match-clients { !external; 10.0.1/24; };
d245 1
a245 1
                   match-clients { external; any; };
d256 2
a257 2
Q: I get a error message like "zone wireless.ietf56.ietf.org/IN: loading master
   file primaries/wireless.ietf56.ietf.org: no owner".
d259 5
a263 4
A: This error is produced when a line in the master file contains leading white
   space (tab/space) but the is no current record owner name to inherit the name
   from. Usually this is the result of putting white space before a comment.
   Forgeting the "@@" for the SOA record or indenting the master file.
d267 2
a268 2
A: You are running chrooted (-t) and have not supplied local timzone information
   in the chroot area.
d276 2
a277 7
Q: I get the error message "named: capset failed: Operation not permitted" when
   starting named.

A: The capability module, part of "Linux Security Modules/LSM", has not been
   loaded into the kernel. See insmod(8).

Q: I get "rndc: connect failed: connection refused" when I try to run rndc.
d281 18
a298 33
   First ensure that named is running and no errors are being reported at startup
   (/var/log/messages or equivalent). Running "named -g <usual arguments>" from a
   title can help at this point.

   Secondly ensure that named is configured to use rndc either by "rndc-confgen
   -a", rndc-confgen or manually. The Administrators Reference manual has details
   on how to do this.

   Old versions of rndc-confgen used localhost rather than 127.0.0.1 in /etc/
   rndc.conf for the default server. Update /etc/rndc.conf if necessary so that
   the default server listed in /etc/rndc.conf matches the addresses used in
   named.conf. "localhost" has two address (127.0.0.1 and ::1).

   If you use "rndc-confgen -a" and named is running with -t or -u ensure that /
   etc/rndc.conf has the correct ownership and that a copy is in the chroot area.
   You can do this by re-running "rndc-confgen -a" with appropriate -t and -u
   arguments.

Q: I don't get RRSIG's returned when I use "dig +dnssec".

A: You need to ensure DNSSEC is enabled (dnssec-enable yes;).

Q: I get "Error 1067" when starting named under Windows.

A: This is the service manager saying that named exited. You need to examine the
   Application log in the EventViewer to find out why.

   Common causes are that you failed to create "named.conf" (usually "C:\windows\
   dns\etc\named.conf") or failed to specify the directory in named.conf.

   options {
           Directory "C:\windows\dns\etc";
   };
d303 3
a305 3
A: These indicate a filesystem permission error preventing named creating /
   renaming the temporary file. These will usually also have other associated
   error messages like
d309 12
a320 12
   Named needs write permission on the directory containing the file. Named writes
   the new cache file to a temporary file then renames it to the name specified in
   named.conf to ensure that the contents are always complete. This is to prevent
   named loading a partial zone in the event of power failure or similar
   interrupting the write of the master file.

   Note file names are relative to the directory specified in options and any
   chroot directory ([<chroot dir>/][<options dir>]).

   If named is invoked as "named -t /chroot/DNS" with the following named.conf
   then "/chroot/DNS/var/named/sl" needs to be writable by the user named is
   running as.
d332 21
a352 1
Q: How do I intergrate BIND 9 and Solaris SMF
d354 97
a450 1
A: Sun has a blog entry describing how to do this.
d452 1
a452 1
   http://blogs.sun.com/roller/page/anay/Weblog?catname=%2FSolaris
d456 10
a465 2
A: No. The rules for glue (copies of the *address* records in the parent zones)
   and additional section processing do not allow it to work.
d467 12
a478 18
   You would have to add both the CNAME and address records (A/AAAA) as glue to
   the parent zone and have CNAMEs be followed when doing additional section
   processing to make it work. No namesever implementation supports either of
   these requirements.

Q: What does "RFC 1918 response from Internet for 0.0.0.10.IN-ADDR.ARPA" mean?

A: If the IN-ADDR.ARPA name covered refers to a internal address space you are
   using then you have failed to follow RFC 1918 usage rules and are leaking
   queries to the Internet. You should establish your own zones for these
   addresses to prevent you quering the Internet's name servers for these
   addresses. Please see http://as112.net/ for details of the problems you are
   causing and the counter measures that have had to be deployed.

   If you are not using these private addresses then a client has queried for
   them. You can just ignore the messages, get the offending client to stop
   sending you these messages as they are most probably leaking them or setup your
   own zones empty zones to serve answers to these queries.
d511 88
d603 2
a604 2
   Why can't named create DDNS journal files or update the master zones from
   journals?
d610 4
a613 4
   Red Hat have adopted the National Security Agency's SELinux security policy (
   see http://www.nsa.gov/selinux ) and recommendations for BIND security , which
   are more secure than running named in a chroot and make use of the bind-chroot
   environment unecessary .
d615 2
a616 2
   By default, named is not allowed by the SELinux policy to write, create or
   delete any files EXCEPT in these directories:
d623 2
a624 1
   where $ROOTDIR may be set in /etc/sysconfig/named if bind-chroot is installed.
d626 12
a637 10
   The SELinux policy particularly does NOT allow named to modify the $ROOTDIR/var
   /named directory, the default location for master zone database files.

   SELinux policy overrules file access permissions - so even if all the files
   under /var/named have ownership named:named and mode rw-rw-r--, named will
   still not be able to write or create files except in the directories above,
   with SELinux in Enforcing mode.

   So, to allow named to update slave or DDNS zone files, it is best to locate
   them in $ROOTDIR/var/named/slaves, with named.conf zone statements such as:
d651 2
a652 2
   To allow named to create its cache dump and statistics files, for example, you
   could use named.conf options statements such as:
d662 5
a666 4
   You can also tell SELinux to allow named to update any zone database files, by
   setting the SELinux tunable boolean parameter 'named_write_master_zones=1',
   using the system-config-securitylevel GUI, using the 'setsebool' command, or in
   /etc/selinux/targeted/booleans.
d678 3
a680 3
   If you want to retain use of the SELinux policy for named, and put named files
   in different locations, you can do so by changing the context of the custom
   file locations .
d682 2
a683 2
   To create a custom configuration file location, eg. '/root/named.conf', to use
   with the 'named -c' option, do:
d688 2
a689 2
   To create a custom modifiable named data location, eg. '/var/log/named' for a
   log file, do:
d694 1
a694 1
   To create a custom zone file location, eg. /root/zones/, do:
d699 2
a700 2
   See these man-pages for more information : selinux(8), named_selinux(8), chcon
   (1), setsebool(8)
d702 1
a702 2
Q: I want to forward all DNS queries from my caching nameserver to another server.
   But there are some domains which have to be served locally, via rbldnsd.
d704 19
a722 1
   How do I achieve this ?
d724 2
a725 3
A: options {
           forward only;
           forwarders { <ip.of.primary.nameserver>; };
d728 34
a761 3
   zone "sbl-xbl.spamhaus.org" {
           type forward; forward only;
           forwarders { <ip.of.rbldns.server> port 530; };
d764 7
a770 4
   zone "list.dsbl.org" {
           type forward; forward only;
           forwarders { <ip.of.rbldns.server> port 530; };
   };
d772 1
d774 1
a774 1
Q: Will named be affected by the 2007 changes to daylight savings rules in the US.
d776 1
a776 11
A: No, so long as the machines internal clock (as reported by "date -u") remains
   at UTC. The only visible change if you fail to upgrade your OS, if you are in a
   affected area, will be that log messages will be a hour out during the period
   where the old rules do not match the new rules.

   For most OS's this change just means that you need to update the conversion
   rules from UTC to local time. Normally this involves updating a file in /etc
   (which sets the default timezone for the machine) and possibly a directory
   which has all the conversion rules for the world (e.g. /usr/share/zoneinfo).
   When updating the OS do not forget to update any chroot areas as well. See your
   OS's documetation for more details.
d778 3
a780 3
   The local timezone conversion rules can also be done on a individual basis by
   setting the TZ envirionment variable appropriately. See your OS's documentation
   for more details.
@


1.6
log
@resolve conflicts and regen configure script
@
text
@d3 4
d636 39
@


1.5
log
@resolve conflicts
@
text
@d7 6
a12 6
A: Linux threads do not fully implement the Posix threads (pthreads) standard.
   In particular, setuid() operates only on the current thread, not the full
   process. Because of this limitation, BIND 9 cannot use setuid() on Linux as
   it can on all other supported platforms. setuid() cannot be called before
   creating threads, since the server does not start listening on reserved
   ports until after threads have started.
d16 2
a17 2
   setuid() early, while retaining the ability to bind reserved ports. This is
   a Linux-specific hack.
d19 2
a20 2
   On a 2.2 kernel, BIND 9 does drop many root privileges, so it should be less
   of a security risk than a root process that has not dropped privileges.
d27 10
d53 6
a58 3
   threads running is n+4, where n is the number of CPUs. Note that the amount
   of memory used is not cumulative; if each process is using 10M of memory,
   only a total of 10M is used.
d63 4
a66 4
A: On Linux, BIND 9 drops most of its root privileges on startup. This
   including the privilege to open files owned by other users. Therefore, if
   the server is running as root, the configuration files and zone files should
   also be owned by root.
d68 2
a69 2
Q: Why do I get errors like "dns_zone_load: zone foo/IN: loading master file
   bar: ran out of space"?
d71 2
a72 2
A: This is often caused by TXT records with missing close quotes. Check that
   all TXT records containing quoted strings have both open and close quotes.
d84 4
a87 4
A: Put a "version" option containing something other than the real version in
   the "options" section of named.conf. Note doing this will not prevent
   attacks and may impede people trying to diagnose problems with your server.
   Also it is possible to "fingerprint" nameservers to determine their version.
d91 3
a93 3
A: The following view statement will intercept lookups as the internal view
   that holds the version information will be matched last. The caveats of the
   previous answer still apply, of course.
d107 4
a110 5
A: The server requires a source of entropy to perform certain operations,
   mostly DNSSEC related. These messages indicate that you have no source of
   entropy. On systems with /dev/random or an equivalent, it is used by
   default. A source of entropy can also be defined using the random-device
   option in named.conf.
d117 3
a119 3
Q: I'm trying to use TSIG to authenticate dynamic updates or zone transfers.
   I'm sure I have the keys set up correctly, but the server is rejecting the
   TSIG. Why?
d121 2
a122 2
A: This may be a clock skew problem. Check that the the clocks on the client
   and server are properly synchronised (e.g., using ntp).
d128 1
a128 2
   doesn't work. If you are using one of these, use normal make or gmake
   instead.
d130 7
a136 7
Q: I have a BIND 9 master and a BIND 8.2.3 slave, and the master is logging
   error messages like "notify to 10.0.0.1#53 failed: unexpected end of input".
   What's wrong?

A: This error message is caused by a known bug in BIND 8.2.3 and is fixed in
   BIND 8.2.4. It can be safely ignored - the notify has been acted on by the
   slave despite the error message.
d141 1
a141 2
   failed: 'RRset exists (value dependent)' prerequisite not satisfied
   (NXRRSET)
d143 3
a145 3
A: DNS updates allow the update request to test to see if certain conditions
   are met prior to proceeding with the update. The message above is saying
   that conditions were not met and the update is not proceeding. See doc/rfc/
d153 5
a157 5
   protocol. Windows 2000 machines have a habit of sending dynamic update
   requests to DNS servers without being specifically configured to do so. If
   the update requests are coming from a Windows 2000 machine, see http://
   support.microsoft.com/support/kb/articles/q246/8/04.asp for information
   about how to turn them off.
d165 19
a183 19
   create a /var/run/named directory owned by the named user and set pid-file
   to "/var/run/named/named.pid", or set pid-file to "named.pid", which will
   put the file in the directory specified by the directory option (which, in
   this case, must be writable by the named user).

Q: When I do a "dig . ns", many of the A records for the root servers are
   missing. Why?

A: This is normal and harmless. It is a somewhat confusing side effect of the
   way BIND 9 does RFC2181 trust ranking and of the efforts BIND 9 makes to
   avoid promoting glue into answers.

   When BIND 9 first starts up and primes its cache, it receives the root
   server addresses as additional data in an authoritative response from a root
   server, and these records are eligible for inclusion as additional data in
   responses. Subsequently it receives a subset of the root server addresses as
   additional data in a non-authoritative (referral) response from a root
   server. This causes the addresses to now be considered non-authoritative
   (glue) data, which is not eligible for inclusion in responses.
d187 2
a188 2
   whether they were last received as answers or as glue. You can always look
   up the addresses with explicit queries like "dig a.root-servers.net A".
d192 6
a197 6
A: This may be caused by a bug in the Windows 2000 DNS server where DNS
   messages larger than 16K are not handled properly. This can be worked around
   by setting the option "transfer-format one-answer;". Also check whether your
   zone contains domain names with embedded spaces or other special characters,
   like "John\032Doe\213s\032Computer", since such names have been known to
   cause Windows 2000 slaves to incorrectly reject the zone.
d201 4
a204 4
A: A zone can be updated either by editing zone files and reloading the server
   or by dynamic update, but not both. If you have enabled dynamic update for a
   zone using the "allow-update" option, you are not supposed to edit the zone
   file by hand, and the server will not attempt to reload it.
d209 2
a210 2
A: This is usually the result of the firewall configuration stopping the
   queries and / or the replies.
d213 2
a214 2
   the same time? When I tried, both views on the slave were transferred from
   the same view on the master.
d216 2
a217 2
A: You will need to give the master and slave multiple IP addresses and use
   those to make sure you reach the correct view on the other machine.
d245 2
a246 2
   You put the external address on the alias so that all the other dns clients
   on these boxes see the internal view by default.
d261 1
a261 1
                   server 10.0.0.2 { keys external; };
d277 1
a277 1
                   server 10.0.0.1 { keys external; };
d285 2
a286 2
   certain interrupts as a source of random events. You can make this permanent
   by setting rand_irqs in /etc/rc.conf.
d296 2
a297 2
   behaviour can be overridden by using query-source to lock down the port and/
   or address. See also notify-source and transfer-source.
d299 2
a300 2
Q: I get error messages like "multiple RRs of singleton type" and "CNAME and
   other data" when transferring a zone. What does this mean?
d303 1
a303 2
   involved by transferring the zone using dig then running named-checkzone on
   it.
d308 2
a309 2
   A CNAME record cannot exist with the same name as another record except for
   the DNSSEC records which prove its existance (NSEC).
d313 2
a314 2
   aliases cannot be different. This rule also insures that a cached CNAME can
   be used without checking with an authoritative server for other RR types."
d316 2
a317 2
Q: I get error messages like "named.conf:99: unexpected end of input" where 99
   is the last line of named.conf.
d320 3
a322 3
   (e.g. CR/LF) on the last line of a text file. This can be fixed by "adding"
   a blank line to the end of the file. Named expects to see EOF immediately
   after EOL and treats text files where this is not met as truncated.
d331 2
a332 2
   You could be generating queries faster than the slave can cope with. Lower
   the serial query rate.
d338 2
a339 2
A: You choose one view to be master and the second a slave and transfer the
   zone between views.
d382 3
a384 3
   space (tab/space) but the is no current record owner name to inherit the
   name from. Usually this is the result of putting white space before a
   comment. Forgeting the "@@" for the SOA record or indenting the master file.
d388 2
a389 2
A: You are running chrooted (-t) and have not supplied local timzone
   information in the chroot area.
d407 3
a409 3
   First ensure that named is running and no errors are being reported at
   startup (/var/log/messages or equivalent). Running "named -g <usual
   arguments>" from a title can help at this point.
d412 2
a413 2
   -a", rndc-confgen or manually. The Administrators Reference manual has
   details on how to do this.
d420 4
a423 4
   If you use "rndc-confgen -a" and named is running with -t or -u ensure that
   /etc/rndc.conf has the correct ownership and that a copy is in the chroot
   area. You can do this by re-running "rndc-confgen -a" with appropriate -t
   and -u arguments.
d431 2
a432 2
A: This is the service manager saying that named exited. You need to examine
   the Application log in the EventViewer to find out why.
d434 2
a435 3
   Common causes are that you failed to create "named.conf" (usually "C:\
   windows\dns\etc\named.conf") or failed to specify the directory in
   named.conf.
d450 5
a454 5
   Named needs write permission on the directory containing the file. Named
   writes the new cache file to a temporary file then renames it to the name
   specified in named.conf to ensure that the contents are always complete.
   This is to prevent named loading a partial zone in the event of power
   failure or similar interrupting the write of the master file.
d500 2
a501 2
   sending you these messages as they are most probably leaking them or setup
   your own zones empty zones to serve answers to these queries.
d533 99
@


1.4
log
@resolve conflicts
@
text
@a0 3



d3 1
d8 15
a22 15
In particular, setuid() operates only on the current thread, not the full
process.  Because of this limitation, BIND 9 cannot use setuid() on Linux as it
can on all other supported platforms.  setuid() cannot be called before
creating threads, since the server does not start listening on reserved ports
until after threads have started.

  In the 2.2.18 or 2.3.99-pre3 and newer kernels, the ability to preserve
capabilities across a setuid() call is present.  This allows BIND 9 to call
setuid() early, while retaining the ability to bind reserved ports.  This is
a Linux-specific hack.

  On a 2.2 kernel, BIND 9 does drop many root privileges, so it should be less
of a security risk than a root process that has not dropped privileges.

  If Linux threads ever work correctly, this restriction will go away.
d24 2
a25 2
  Configuring BIND9 with the --disable-threads option (the default) causes a
non-threaded version to be built, which will allow -u to be used.
d27 2
d30 2
a31 5
Q: Why does named log the warning message "no TTL specified - using SOA
MINTTL instead"?

A: Your zone file is illegal according to RFC1035.  It must either
have a line like
d35 2
a36 2
at the beginning, or the first record in it must have a TTL field,
like the "84600" in this example:
d42 12
a53 15
A: Linux threads each show up as a process under ps.  The approximate
number of threads running is n+4, where n is the number of CPUs.  Note that
the amount of memory used is not cumulative; if each process is using 10M of
memory, only a total of 10M is used.


Q: Why does BIND 9 log "permission denied" errors accessing its
configuration files or zones on my Linux system even though it is running
as root?

A: On Linux, BIND 9 drops most of its root privileges on startup.
This including the privilege to open files owned by other users.
Therefore, if the server is running as root, the configuration files
and zone files should also be owned by root.

d56 1
a56 4
bar: ran out of space"

A: This is often caused by TXT records with missing close quotes.  Check that
all TXT records containing quoted strings have both open and close quotes.
d58 2
d63 5
a67 6
A: If the Linux kernel is 2.4.7 or newer, multithreaded core dumps
are usable (that is, the correct thread is dumped).  Otherwise, if using
a 2.2 kernel, apply the kernel patch found in contrib/linux/coredump-patch
and rebuild the kernel.  This patch will cause multithreaded programs to dump
the correct thread.

d71 19
a89 23
A: Put a "version" option containing something other than the real
version in the "options" section of named.conf.  Note doing this will
not prevent attacks and may impede people trying to diagnose problems
with your server.  Also it is possible to "fingerprint" nameservers to
determine their version.


Q: How do I restrict only remote users from looking up the server
version?

A: The following view statement will intercept lookups as the internal
view that holds the version information will be matched last.  The
caveats of the previous answer still apply, of course.

  view "chaos" chaos {
	  match-clients { <those to be refused>; };
	  allow-query { none; };
	  zone "." {
		  type hint;
		  file "/dev/null";  // or any empty file
	  };
  };

d92 1
a92 1
mean?
d95 6
a100 4
mostly DNSSEC related.  These messages indicate that you have no source
of entropy.  On systems with /dev/random or an equivalent, it is used by
default.  A source of entropy can also be defined using the random-device
option in named.conf.
d102 2
d105 3
a107 1
Q: I installed BIND 9 and restarted named, but it's still BIND 8.  Why?
d109 2
a110 2
A: BIND 9 is installed under /usr/local by default.  BIND 8 is often
installed under /usr.  Check that the correct named is running.
d112 2
d115 3
a117 3
Q: I'm trying to use TSIG to authenticate dynamic updates or zone
transfers.  I'm sure I have the keys set up correctly, but the server
is rejecting the TSIG.  Why?
d119 3
a121 2
A: This may be a clock skew problem.  Check that the the clocks on
the client and server are properly synchronized (e.g., using ntp).
d123 3
d127 1
a127 2
Q: I'm trying to compile BIND 9, and "make" is failing due to files not
being found.  Why?
d129 3
a131 3
A: Using a parallel or distributed "make" to build BIND 9 is not
supported, and doesn't work.  If you are using one of these, use
normal make or gmake instead.
d133 4
d138 1
a138 3
Q: I have a BIND 9 master and a BIND 8.2.3 slave, and the master is
logging error messages like "notify to 10.0.0.1#53 failed: unexpected
end of input".  What's wrong?
d140 1
a140 3
A: This error message is caused by a known bug in BIND 8.2.3 and is fixed
in BIND 8.2.4.  It can be safely ignored - the notify has been acted on by
the slave despite the error message.
d142 6
d149 1
a149 1
Q: I keep getting log messages like the following.  Why?
d151 1
a151 3
   Dec  4 23:47:59 client 10.0.0.1#1355: updating zone 'example.com/IN':
   update failed: 'RRset exists (value dependent)' prerequisite not
   satisfied (NXRRSET)
d153 35
a187 4
A: DNS updates allow the update request to test to see if certain
conditions are met prior to proceeding with the update.  The message
above is saying that conditions were not met and the update is not
proceeding.  See doc/rfc/rfc2136.txt for more details on prerequisites.
d189 1
d191 86
a276 1
Q: I keep getting log messages like the following.  Why?
d278 6
a283 1
   Jun 21 12:00:00.000 client 10.0.0.1#1234: update denied
d285 29
a313 6
A: Someone is trying to update your DNS data using the RFC2136 Dynamic
Update protocol.  Windows 2000 machines have a habit of sending dynamic
update requests to DNS servers without being specifically configured to
do so.  If the update requests are coming from a Windows 2000 machine,
see <http://support.microsoft.com/support/kb/articles/q246/8/04.asp>
for information about how to turn them off.
d315 2
d318 1
a318 1
Q: I see a log message like the following.  Why?
d320 4
a323 1
   couldn't open pid file '/var/run/named.pid': Permission denied
d325 1
a325 42
A: You are most likely running named as a non-root user, and that user
does not have permission to write in /var/run.  The common ways of
fixing this are to create a /var/run/named directory owned by the named
user and set pid-file to "/var/run/named/named.pid", or set
pid-file to "named.pid", which will put the file in the directory
specified by the directory option (which, in this case, must be writable
by the named user).


Q: When I do a "dig . ns", many of the A records for the root
servers are missing.  Why?

A: This is normal and harmless.  It is a somewhat confusing side effect
of the way BIND 9 does RFC2181 trust ranking and of the efforts BIND 9
makes to avoid promoting glue into answers.

When BIND 9 first starts up and primes its cache, it receives the root
server addresses as additional data in an authoritative response from
a root server, and these records are eligible for inclusion as
additional data in responses.  Subsequently it receives a subset of
the root server addresses as additional data in a non-authoritative
(referral) response from a root server.  This causes the addresses to
now be considered non-authoritative (glue) data, which is not eligible
for inclusion in responses.

The server does have a complete set of root server addresses cached
at all times, it just may not include all of them as additional data,
depending on whether they were last received as answers or as glue.
You can always look up the addresses with explicit queries like
"dig a.root-servers.net A".


Q: Zone transfers from my BIND 9 master to my Windows 2000 slave
fail.  Why?

A: This may be caused by a bug in the Windows 2000 DNS server where
DNS messages larger than 16K are not handled properly.  This can be
worked around by setting the option "transfer-format one-answer;".
Also check whether your zone contains domain names with embedded
spaces or other special characters, like "John\032Doe\213s\032Computer",
since such names have been known to cause Windows 2000 slaves to
incorrectly reject the zone.
d327 1
d329 2
a330 1
Q: Why don't my zones reload when I do an "rndc reload" or SIGHUP?
d332 36
a367 94
A: A zone can be updated either by editing zone files and reloading
the server or by dynamic update, but not both.  If you have enabled
dynamic update for a zone using the "allow-update" option, you are not
supposed to edit the zone file by hand, and the server will not
attempt to reload it.


Q: I can query the nameserver from the nameserver but not from other
machines.  Why?

A: This is usually the result of the firewall configuration stopping
the queries and / or the replies.


Q: How can I make a server a slave for both an internal and
an external view at the same time?  When I tried, both views
on the slave were transferred from the same view on the master.

A: You will need to give the master and slave multiple IP addresses and
use those to make sure you reach the correct view on the other machine.

	e.g.
	Master: 10.0.1.1 (internal), 10.0.1.2 (external, IP alias)
	    internal:
		match-clients { !10.0.1.2; !10.0.1.4; 10.0.1/24; };
		notify-source 10.0.1.1;
		transfer-source 10.0.1.1;
		query-source address 10.0.1.1;
	    external:
		match-clients { any; };
		recursion no;	// don't offer recursion to the world
		notify-source 10.0.1.2;
		transfer-source 10.0.1.2;
		query-source address 10.0.1.2;

	Slave: 10.0.1.3 (internal), 10.0.1.4 (external, IP alias)
	    internal:
		match-clients { !10.0.1.2; !10.0.1.4; 10.0.1/24; };
		notify-source 10.0.1.3;
		transfer-source 10.0.1.3;
		query-source address 10.0.1.3;
	    external:
		match-clients { any; };
		recursion no;	// don't offer recursion to the world
		notify-source 10.0.1.4;
		transfer-source 10.0.1.4;
		query-source address 10.0.1.4;

	You put the external address on the alias so that all the other
	dns clients on these boxes see the internal view by default.

A: (BIND 9.3 and later) Use TSIG to select the appropriate view.

	Master 10.0.1.1:
	key "external" {
		algorithm hmac-md5;
		secret "xxxxxxxx";
	};
	view "internal" {
		match-clients { !key external; 10.0.1/24; };
		...
	};
	view "external" {
		match-clients { key external; any; };
		server 10.0.0.2 { keys external; };
		recursion no;
		...
	};

	Slave 10.0.1.2:
	key "external" {
		 algorithm hmac-md5;
		 secret "xxxxxxxx";
	};
	view "internal" {
		match-clients { !key external; 10.0.1/24; };
	};
	view "external" {
		match-clients { key external; any; };
		server 10.0.0.1 { keys external; };
		recursion no;
		...
	};


Q: I have Freebsd 4.x and "rndc-confgen -a" just sits there.

A: /dev/random is not configured.  Use rndcontrol(8) to tell the kernel
to use certain interrupts as a source of random events.  You can make this
permanent by setting rand_irqs in /etc/rc.conf.

e.g.
	/etc/rc.conf
	rand_irqs="3 14 15"
d369 2
a370 1
See also http://people.freebsd.org/~dougb/randomness.html
d372 4
d377 1
a377 1
Q: Why is named listening on UDP port other than 53?
d379 2
a380 3
A: Named uses a system selected port to make queries of other nameservers.
This behaviour can be overridden by using query-source to lock down the
port and/or address.  See also notify-source and transfer-source.
d382 3
d386 1
a386 2
Q: I get error messages like "multiple RRs of singleton type" and
"CNAME and other data" when transferring a zone.  What does this mean?
d388 2
a389 3
A: These indicate a malformed master zone.  You can identify the
exact records involved by transferring the zone using dig then
running named-checkzone on it.
d391 2
a392 3
	e.g.
		dig axfr example.com @@master-server > tmp
		named-checkzone example.com tmp
d394 1
d396 1
a396 2
Q: I get error messages like "named.conf:99: unexpected end of input" where
99 is the last line of named.conf.
d398 17
a414 4
A: Some text editors (notepad and wordpad) fail to put a line termination
indication (e.g. CR/LF) on the last line of a text file.  This can be fixed
by "adding" a blank line to the end of the file.  Named expects to see EOF
immediately after EOL and treats text files where this is not met as truncated.
d416 1
d418 1
a418 2
Q: I get warning messages like "zone example.com/IN: refresh: failure trying master
1.2.3.4#53: timed out".
d420 1
a420 1
A: Check that you can make UDP queries from the slave to the master
d422 2
a423 1
	dig +norec example.com soa @@1.2.3.4
d425 3
a427 2
A: You could be generating queries faster than the slave can cope with.  Lower
the serial query rate.
d429 3
a431 1
	serial-query-rate 5; // default 20
d433 2
a434 1
Q: How do I share a dynamic zone between multiple views?
d436 3
a438 2
A: You choose one view to be master and the second a slave and transfer
the zone between views.
d440 1
a440 36
	Master 10.0.1.1:
	key "external" {
		algorithm hmac-md5;
		secret "xxxxxxxx";
	};

	key "mykey" {
		algorithm hmac-md5;
		secret "yyyyyyyy";
	};

	view "internal" {
		match-clients { !external; 10.0.1/24; };
		server 10.0.1.1 {
			/* Deliver notify messages to external view. */
			keys { external; };
		};
		zone "example.com" {
			type master;
			file "internal/example.db";
			allow-update { key mykey; };
			notify-also { 10.0.1.1; };
		};
	};

	view "external" {
		match-clients { external; any; };
		zone "example.com" {
			type slave;
			file "external/example.db";
			masters { 10.0.1.1; };
			transfer-source { 10.0.1.1; };
			// allow-update-forwarding { any; };
			// allow-notify { ... };
		};
	};
d442 5
a446 2
Q: I get a error message like "zone wireless.ietf56.ietf.org/IN: loading master
file primaries/wireless.ietf56.ietf.org: no owner".
d448 2
a449 5
A: This error is produced when a line in the master file contains leading
white space (tab/space) but the is no current record owner name to inherit
the name from.  Usually this is the result of putting white space before
a comment.  Forgeting the "@@" for the SOA record or indenting the master
file.
d451 3
d455 3
a457 1
Q: Why are my logs in GMT (UTC).
d459 5
a463 2
A: You are running chrooted (-t) and have not supplied local timzone
information in the chroot area.
d465 1
a465 3
	FreeBSD: /etc/localtime
	Solaris: /etc/TIMEZONE and /usr/share/lib/zoneinfo
	OSF: /etc/zoneinfo/localtime
d467 1
a467 1
	See also tzset(3) and zic(8).
d469 1
d471 1
a471 2
Q: I get the error message "named: capset failed: Operation not permitted"
when starting named.
d473 2
a474 1
A: The capset module has not been loaded into the kernel.  See insmod(8).
d476 4
d481 1
a481 2
Q: I get "rndc: connect failed: connection refused" when I try to run
   rndc.
d483 6
a488 1
A: This is usually a configuration error.
d490 4
a493 19
   First ensure that named is running and no errors are being
   reported at startup (/var/log/messages or equivalent).  Running
   "named -g <usual arguements>" from a terminal can help at this
   point.

   Secondly ensure that named is configured to use rndc either by
   "rndc-confgen -a", rndc-confgen or manually.  The Administators
   Reference manual has details on how to do this.

   Old versions of rndc-confgen used localhost rather than 127.0.0.1
   in /etc/rndc.conf for the default server.  Update /etc/rndc.conf
   if necessary so that the default server listed in /etc/rndc.conf
   matches the addresses used in named.conf.  "localhost" has two
   address (127.0.0.1 and ::1).

   If you use "rndc-confgen -a" and named is running with -t or -u
   ensure that /etc/rndc.conf has the correct ownership and that
   a copy is in the chroot area.  You can do this by re-running
   "rndc-confgen -a" with appropriate -t and -u arguements.
d495 4
d500 4
a503 1
Q: I don't get RRSIG's returned when I use "dig +dnssec".
d505 1
a505 1
A: You need to ensure DNSSEC is enabled (dnssec-enable yes;).
d507 4
d512 4
a515 1
Q: I get "Error 1067" when starting named under Windows.
d517 4
a520 2
A: This is the service manager saying that named exited.   You need to
   examine the Application log in the EventViewer to find out why.
d522 1
a522 7
   Common causes are that you failed to create "named.conf" (usually 
   "C:\windows\dns\etc\named.conf") or failed to specify the directory
   in named.conf.

        options {
                Directory "C:\windows\dns\etc";
        };
d524 1
@


1.3
log
@resolve conflicts
@
text
@d455 16
@


1.2
log
@update to BIND 9.2.2-release. ok millert@@
@
text
@d269 1
d271 30
a300 10
Q: When I try to use rndc, I get the error message "network
unreachable" or "connection refused", even though I know named is
running.

A: You probably have "default-server localhost" in /etc/rndc.conf,
your /etc/hosts or DNS maps "localhost" to both the IPv4 loopback
address 127.0.0.1 and the IPv6 loopback address ::1, and you do not
have IPv6 fully operational.  Change the "default-server localhost" to
"default-server 127.0.0.1" to make sure rdnc does not try to contact
the name server using IPv6.
d303 1
a303 1
Q: I have Freebsd 4.4 and "rndc-confgen -a" just sits there.
d313 2
d320 1
a320 1
port and/or address.
d356 99
@


1.1
log
@Initial revision
@
text
@d234 1
a234 1
on the slave were transfered from the same view on the master.
d285 1
a285 1
to use certian interupts as a source of random events.  You can make this
d301 1
a301 1
"CNAME and other data" when transfering a zone.  What does this mean?
d304 1
a304 1
exact records involved by transfering the zone using dig then
@


1.1.1.1
log
@ISC BIND version 9.2.2rc1
@
text
@@


1.1.1.2
log
@ISC BIND version 9.3.0. ok deraadt@@
@
text
@d234 1
a234 1
on the slave were transferred from the same view on the master.
a268 1
A: (BIND 9.3 and later) Use TSIG to select the appropriate view.
d270 10
a279 30
	Master 10.0.1.1:
	key "external" {
		algorithm hmac-md5;
		secret "xxxxxxxx";
	};
	view "internal" {
		match-clients { !key external; 10.0.1/24; };
		...
	};
	view "external" {
		match-clients { key external; any; };
		server 10.0.0.2 { keys external; };
		recursion no;
		...
	};

	Slave 10.0.1.2:
	key "external" {
		 algorithm hmac-md5;
		 secret "xxxxxxxx";
	};
	view "internal" {
		match-clients { !key external; 10.0.1/24; };
	};
	view "external" {
		match-clients { key external; any; };
		server 10.0.0.1 { keys external; };
		recursion no;
		...
	};
d282 1
a282 1
Q: I have Freebsd 4.x and "rndc-confgen -a" just sits there.
d285 1
a285 1
to use certain interrupts as a source of random events.  You can make this
a291 2
See also http://people.freebsd.org/~dougb/randomness.html

d297 1
a297 1
port and/or address.  See also notify-source and transfer-source.
d301 1
a301 1
"CNAME and other data" when transferring a zone.  What does this mean?
d304 1
a304 1
exact records involved by transferring the zone using dig then
a332 99
Q: How do I share a dynamic zone between multiple views?

A: You choose one view to be master and the second a slave and transfer
the zone between views.

	Master 10.0.1.1:
	key "external" {
		algorithm hmac-md5;
		secret "xxxxxxxx";
	};

	key "mykey" {
		algorithm hmac-md5;
		secret "yyyyyyyy";
	};

	view "internal" {
		match-clients { !external; 10.0.1/24; };
		server 10.0.1.1 {
			/* Deliver notify messages to external view. */
			keys { external; };
		};
		zone "example.com" {
			type master;
			file "internal/example.db";
			allow-update { key mykey; };
			notify-also { 10.0.1.1; };
		};
	};

	view "external" {
		match-clients { external; any; };
		zone "example.com" {
			type slave;
			file "external/example.db";
			masters { 10.0.1.1; };
			transfer-source { 10.0.1.1; };
			// allow-update-forwarding { any; };
			// allow-notify { ... };
		};
	};

Q: I get a error message like "zone wireless.ietf56.ietf.org/IN: loading master
file primaries/wireless.ietf56.ietf.org: no owner".

A: This error is produced when a line in the master file contains leading
white space (tab/space) but the is no current record owner name to inherit
the name from.  Usually this is the result of putting white space before
a comment.  Forgeting the "@@" for the SOA record or indenting the master
file.


Q: Why are my logs in GMT (UTC).

A: You are running chrooted (-t) and have not supplied local timzone
information in the chroot area.

	FreeBSD: /etc/localtime
	Solaris: /etc/TIMEZONE and /usr/share/lib/zoneinfo
	OSF: /etc/zoneinfo/localtime

	See also tzset(3) and zic(8).


Q: I get the error message "named: capset failed: Operation not permitted"
when starting named.

A: The capset module has not been loaded into the kernel.  See insmod(8).


Q: I get "rndc: connect failed: connection refused" when I try to run
   rndc.

A: This is usually a configuration error.

   First ensure that named is running and no errors are being
   reported at startup (/var/log/messages or equivalent).  Running
   "named -g <usual arguements>" from a terminal can help at this
   point.

   Secondly ensure that named is configured to use rndc either by
   "rndc-confgen -a", rndc-confgen or manually.  The Administators
   Reference manual has details on how to do this.

   Old versions of rndc-confgen used localhost rather than 127.0.0.1
   in /etc/rndc.conf for the default server.  Update /etc/rndc.conf
   if necessary so that the default server listed in /etc/rndc.conf
   matches the addresses used in named.conf.  "localhost" has two
   address (127.0.0.1 and ::1).

   If you use "rndc-confgen -a" and named is running with -t or -u
   ensure that /etc/rndc.conf has the correct ownership and that
   a copy is in the chroot area.  You can do this by re-running
   "rndc-confgen -a" with appropriate -t and -u arguements.


Q: I don't get RRSIG's returned when I use "dig +dnssec".

A: You need to ensure DNSSEC is enabled (dnssec-enable yes;).
@


1.1.1.3
log
@ISC BIND release 9.3.1. ok deraadt@@
@
text
@a454 16


Q: I get "Error 1067" when starting named under Windows.

A: This is the service manager saying that named exited.   You need to
   examine the Application log in the EventViewer to find out why.

   Common causes are that you failed to create "named.conf" (usually 
   "C:\windows\dns\etc\named.conf") or failed to specify the directory
   in named.conf.

        options {
                Directory "C:\windows\dns\etc";
        };


@


1.1.1.4
log
@ISC BIND release 9.3.2
@
text
@d1 3
a5 1
-------------------------------------------------------------------------------
d10 15
a24 15
   In particular, setuid() operates only on the current thread, not the full
   process. Because of this limitation, BIND 9 cannot use setuid() on Linux as
   it can on all other supported platforms. setuid() cannot be called before
   creating threads, since the server does not start listening on reserved
   ports until after threads have started.

   In the 2.2.18 or 2.3.99-pre3 and newer kernels, the ability to preserve
   capabilities across a setuid() call is present. This allows BIND 9 to call
   setuid() early, while retaining the ability to bind reserved ports. This is
   a Linux-specific hack.

   On a 2.2 kernel, BIND 9 does drop many root privileges, so it should be less
   of a security risk than a root process that has not dropped privileges.

   If Linux threads ever work correctly, this restriction will go away.
d26 2
a27 2
   Configuring BIND9 with the --disable-threads option (the default) causes a
   non-threaded version to be built, which will allow -u to be used.
a28 2
Q: Why does named log the warning message "no TTL specified - using SOA MINTTL
   instead"?
d30 5
a34 2
A: Your zone file is illegal according to RFC1035. It must either have a line
   like:
d38 2
a39 2
   at the beginning, or the first record in it must have a TTL field, like the
   "84600" in this example:
d45 15
a59 12
A: Linux threads each show up as a process under ps. The approximate number of
   threads running is n+4, where n is the number of CPUs. Note that the amount
   of memory used is not cumulative; if each process is using 10M of memory,
   only a total of 10M is used.

Q: Why does BIND 9 log "permission denied" errors accessing its configuration
   files or zones on my Linux system even though it is running as root?

A: On Linux, BIND 9 drops most of its root privileges on startup. This
   including the privilege to open files owned by other users. Therefore, if
   the server is running as root, the configuration files and zone files should
   also be owned by root.
d62 4
a65 1
   bar: ran out of space"?
a66 2
A: This is often caused by TXT records with missing close quotes. Check that
   all TXT records containing quoted strings have both open and close quotes.
d70 6
a75 5
A: If the Linux kernel is 2.4.7 or newer, multithreaded core dumps are usable
   (that is, the correct thread is dumped). Otherwise, if using a 2.2 kernel,
   apply the kernel patch found in contrib/linux/coredump-patch and rebuild the
   kernel. This patch will cause multithreaded programs to dump the correct
   thread.
d79 23
a101 19
A: Put a "version" option containing something other than the real version in
   the "options" section of named.conf. Note doing this will not prevent
   attacks and may impede people trying to diagnose problems with your server.
   Also it is possible to "fingerprint" nameservers to determine their version.

Q: How do I restrict only remote users from looking up the server version?

A: The following view statement will intercept lookups as the internal view
   that holds the version information will be matched last. The caveats of the
   previous answer still apply, of course.

   view "chaos" chaos {
           match-clients { <those to be refused>; };
           allow-query { none; };
           zone "." {
                   type hint;
                   file "/dev/null";  // or any empty file
           };
   };
d104 1
a104 1
   mean?
d107 4
a110 4
   mostly DNSSEC related. These messages indicate that you have no source of
   entropy. On systems with /dev/random or an equivalent, it is used by
   default. A source of entropy can also be defined using the random-device
   option in named.conf.
a111 1
Q: I installed BIND 9 and restarted named, but it's still BIND 8. Why?
d113 1
a113 2
A: BIND 9 is installed under /usr/local by default. BIND 8 is often installed
   under /usr. Check that the correct named is running.
d115 2
a116 3
Q: I'm trying to use TSIG to authenticate dynamic updates or zone transfers.
   I'm sure I have the keys set up correctly, but the server is rejecting the
   TSIG. Why?
a117 2
A: This may be a clock skew problem. Check that the the clocks on the client
   and server are properly synchronised (e.g., using ntp).
d119 3
a121 2
Q: I'm trying to compile BIND 9, and "make" is failing due to files not being
   found. Why?
d123 2
a124 3
A: Using a parallel or distributed "make" to build BIND 9 is not supported, and
   doesn't work. If you are using one of these, use normal make or gmake
   instead.
a125 3
Q: I have a BIND 9 master and a BIND 8.2.3 slave, and the master is logging
   error messages like "notify to 10.0.0.1#53 failed: unexpected end of input".
   What's wrong?
d127 2
a128 3
A: This error message is caused by a known bug in BIND 8.2.3 and is fixed in
   BIND 8.2.4. It can be safely ignored - the notify has been acted on by the
   slave despite the error message.
d130 3
a132 1
Q: I keep getting log messages like the following. Why?
a133 3
   Dec 4 23:47:59 client 10.0.0.1#1355: updating zone 'example.com/IN': update
   failed: 'RRset exists (value dependent)' prerequisite not satisfied
   (NXRRSET)
d135 3
a137 4
A: DNS updates allow the update request to test to see if certain conditions
   are met prior to proceeding with the update. The message above is saying
   that conditions were not met and the update is not proceeding. See doc/rfc/
   rfc2136.txt for more details on prerequisites.
d139 3
a141 1
Q: I keep getting log messages like the following. Why?
a142 1
   Jun 21 12:00:00.000 client 10.0.0.1#1234: update denied
d144 1
a144 6
A: Someone is trying to update your DNS data using the RFC2136 Dynamic Update
   protocol. Windows 2000 machines have a habit of sending dynamic update
   requests to DNS servers without being specifically configured to do so. If
   the update requests are coming from a Windows 2000 machine, see http://
   support.microsoft.com/support/kb/articles/q246/8/04.asp for information
   about how to turn them off.
d146 3
a148 1
Q: I see a log message like the following. Why?
d150 4
a153 1
   couldn't open pid file '/var/run/named.pid': Permission denied
a154 35
A: You are most likely running named as a non-root user, and that user does not
   have permission to write in /var/run. The common ways of fixing this are to
   create a /var/run/named directory owned by the named user and set pid-file
   to "/var/run/named/named.pid", or set pid-file to "named.pid", which will
   put the file in the directory specified by the directory option (which, in
   this case, must be writable by the named user).

Q: When I do a "dig . ns", many of the A records for the root servers are
   missing. Why?

A: This is normal and harmless. It is a somewhat confusing side effect of the
   way BIND 9 does RFC2181 trust ranking and of the efforts BIND 9 makes to
   avoid promoting glue into answers.

   When BIND 9 first starts up and primes its cache, it receives the root
   server addresses as additional data in an authoritative response from a root
   server, and these records are eligible for inclusion as additional data in
   responses. Subsequently it receives a subset of the root server addresses as
   additional data in a non-authoritative (referral) response from a root
   server. This causes the addresses to now be considered non-authoritative
   (glue) data, which is not eligible for inclusion in responses.

   The server does have a complete set of root server addresses cached at all
   times, it just may not include all of them as additional data, depending on
   whether they were last received as answers or as glue. You can always look
   up the addresses with explicit queries like "dig a.root-servers.net A".

Q: Zone transfers from my BIND 9 master to my Windows 2000 slave fail. Why?

A: This may be caused by a bug in the Windows 2000 DNS server where DNS
   messages larger than 16K are not handled properly. This can be worked around
   by setting the option "transfer-format one-answer;". Also check whether your
   zone contains domain names with embedded spaces or other special characters,
   like "John\032Doe\213s\032Computer", since such names have been known to
   cause Windows 2000 slaves to incorrectly reject the zone.
d156 1
a156 1
Q: Why don't my zones reload when I do an "rndc reload" or SIGHUP?
d158 1
a158 86
A: A zone can be updated either by editing zone files and reloading the server
   or by dynamic update, but not both. If you have enabled dynamic update for a
   zone using the "allow-update" option, you are not supposed to edit the zone
   file by hand, and the server will not attempt to reload it.

Q: I can query the nameserver from the nameserver but not from other machines.
   Why?

A: This is usually the result of the firewall configuration stopping the
   queries and / or the replies.

Q: How can I make a server a slave for both an internal and an external view at
   the same time? When I tried, both views on the slave were transferred from
   the same view on the master.

A: You will need to give the master and slave multiple IP addresses and use
   those to make sure you reach the correct view on the other machine.

   Master: 10.0.1.1 (internal), 10.0.1.2 (external, IP alias)
       internal:
           match-clients { !10.0.1.2; !10.0.1.4; 10.0.1/24; };
                   notify-source 10.0.1.1;
                   transfer-source 10.0.1.1;
                   query-source address 10.0.1.1;
       external:
           match-clients { any; };
           recursion no;   // don't offer recursion to the world
           notify-source 10.0.1.2;
           transfer-source 10.0.1.2;
           query-source address 10.0.1.2;

   Slave: 10.0.1.3 (internal), 10.0.1.4 (external, IP alias)
       internal:
           match-clients { !10.0.1.2; !10.0.1.4; 10.0.1/24; };
           notify-source 10.0.1.3;
           transfer-source 10.0.1.3;
           query-source address 10.0.1.3;
      external:
           match-clients { any; };
           recursion no;   // don't offer recursion to the world
           notify-source 10.0.1.4;
           transfer-source 10.0.1.4;
           query-source address 10.0.1.4;

   You put the external address on the alias so that all the other dns clients
   on these boxes see the internal view by default.

A: BIND 9.3 and later: Use TSIG to select the appropriate view.

   Master 10.0.1.1:
           key "external" {
                   algorithm hmac-md5;
                   secret "xxxxxxxx";
           };
           view "internal" {
                   match-clients { !key external; 10.0.1/24; };
                   ...
           };
           view "external" {
                   match-clients { key external; any; };
                   server 10.0.0.2 { keys external; };
                   recursion no;
                   ...
           };

   Slave 10.0.1.2:
           key "external" {
                   algorithm hmac-md5;
                   secret "xxxxxxxx";
           };
           view "internal" {
                   match-clients { !key external; 10.0.1/24; };
                   ...
           };
           view "external" {
                   match-clients { key external; any; };
                   server 10.0.0.1 { keys external; };
                   recursion no;
                   ...
           };

Q: I have FreeBSD 4.x and "rndc-confgen -a" just sits there.

A: /dev/random is not configured. Use rndcontrol(8) to tell the kernel to use
   certain interrupts as a source of random events. You can make this permanent
   by setting rand_irqs in /etc/rc.conf.
d160 6
a165 2
   /etc/rc.conf
   rand_irqs="3 14 15"
a166 1
   See also http://people.freebsd.org/~dougb/randomness.html
d168 1
a168 1
Q: Why is named listening on UDP port other than 53?
d170 1
a170 29
A: Named uses a system selected port to make queries of other nameservers. This
   behaviour can be overridden by using query-source to lock down the port and/
   or address. See also notify-source and transfer-source.

Q: I get error messages like "multiple RRs of singleton type" and "CNAME and
   other data" when transferring a zone. What does this mean?

A: These indicate a malformed master zone. You can identify the exact records
   involved by transferring the zone using dig then running named-checkzone on
   it.

   dig axfr example.com @@master-server > tmp
   named-checkzone example.com tmp

   A CNAME record cannot exist with the same name as another record except for
   the DNSSEC records which prove its existance (NSEC).

   RFC 1034, Section 3.6.2: "If a CNAME RR is present at a node, no other data
   should be present; this ensures that the data for a canonical name and its
   aliases cannot be different. This rule also insures that a cached CNAME can
   be used without checking with an authoritative server for other RR types."

Q: I get error messages like "named.conf:99: unexpected end of input" where 99
   is the last line of named.conf.

A: Some text editors (notepad and wordpad) fail to put a line title indication
   (e.g. CR/LF) on the last line of a text file. This can be fixed by "adding"
   a blank line to the end of the file. Named expects to see EOF immediately
   after EOL and treats text files where this is not met as truncated.
d172 42
a213 2
Q: I get warning messages like "zone example.com/IN: refresh: failure trying
   master 1.2.3.4#53: timed out".
a214 1
A: Check that you can make UDP queries from the slave to the master
d216 1
a216 1
   dig +norec example.com soa @@1.2.3.4
d218 94
a311 2
   You could be generating queries faster than the slave can cope with. Lower
   the serial query rate.
d313 1
a313 1
   serial-query-rate 5; // default 20
a314 1
Q: How do I share a dynamic zone between multiple views?
d316 1
a316 2
A: You choose one view to be master and the second a slave and transfer the
   zone between views.
d318 3
a320 36
   Master 10.0.1.1:
           key "external" {
                   algorithm hmac-md5;
                   secret "xxxxxxxx";
           };

           key "mykey" {
                   algorithm hmac-md5;
                   secret "yyyyyyyy";
           };

           view "internal" {
                   match-clients { !external; 10.0.1/24; };
                   server 10.0.1.1 {
                           /* Deliver notify messages to external view. */
                           keys { external; };
                   };
                   zone "example.com" {
                           type master;
                           file "internal/example.db";
                           allow-update { key mykey; };
                           notify-also { 10.0.1.1; };
                   };
           };

           view "external" {
                   match-clients { external; any; };
                   zone "example.com" {
                           type slave;
                           file "external/example.db";
                           masters { 10.0.1.1; };
                           transfer-source { 10.0.1.1; };
                           // allow-update-forwarding { any; };
                           // allow-notify { ... };
                   };
           };
a321 2
Q: I get a error message like "zone wireless.ietf56.ietf.org/IN: loading master
   file primaries/wireless.ietf56.ietf.org: no owner".
d323 2
a324 4
A: This error is produced when a line in the master file contains leading white
   space (tab/space) but the is no current record owner name to inherit the
   name from. Usually this is the result of putting white space before a
   comment. Forgeting the "@@" for the SOA record or indenting the master file.
d326 3
a328 1
Q: Why are my logs in GMT (UTC).
d330 3
a332 2
A: You are running chrooted (-t) and have not supplied local timzone
   information in the chroot area.
a333 3
   FreeBSD: /etc/localtime
   Solaris: /etc/TIMEZONE and /usr/share/lib/zoneinfo
   OSF: /etc/zoneinfo/localtime
d335 2
a336 1
   See also tzset(3) and zic(8).
d338 4
a341 2
Q: I get the error message "named: capset failed: Operation not permitted" when
   starting named.
a342 2
A: The capability module, part of "Linux Security Modules/LSM", has not been
   loaded into the kernel. See insmod(8).
d344 2
a345 1
Q: I get "rndc: connect failed: connection refused" when I try to run rndc.
d347 1
a347 1
A: This is usually a configuration error.
d349 1
a349 17
   First ensure that named is running and no errors are being reported at
   startup (/var/log/messages or equivalent). Running "named -g <usual
   arguments>" from a title can help at this point.

   Secondly ensure that named is configured to use rndc either by "rndc-confgen
   -a", rndc-confgen or manually. The Administrators Reference manual has
   details on how to do this.

   Old versions of rndc-confgen used localhost rather than 127.0.0.1 in /etc/
   rndc.conf for the default server. Update /etc/rndc.conf if necessary so that
   the default server listed in /etc/rndc.conf matches the addresses used in
   named.conf. "localhost" has two address (127.0.0.1 and ::1).

   If you use "rndc-confgen -a" and named is running with -t or -u ensure that
   /etc/rndc.conf has the correct ownership and that a copy is in the chroot
   area. You can do this by re-running "rndc-confgen -a" with appropriate -t
   and -u arguments.
d351 2
a352 1
Q: I don't get RRSIG's returned when I use "dig +dnssec".
d354 1
a354 1
A: You need to ensure DNSSEC is enabled (dnssec-enable yes;).
d356 1
a356 1
Q: I get "Error 1067" when starting named under Windows.
d358 2
a359 2
A: This is the service manager saying that named exited. You need to examine
   the Application log in the EventViewer to find out why.
d361 36
a396 3
   Common causes are that you failed to create "named.conf" (usually "C:\
   windows\dns\etc\named.conf") or failed to specify the directory in
   named.conf.
d398 2
a399 3
   options {
           Directory "C:\windows\dns\etc";
   };
d401 5
a405 2
Q: I get "transfer of 'example.net/IN' from 192.168.4.12#53: failed while
   receiving responses: permission denied" error messages.
a406 3
A: These indicate a filesystem permission error preventing named creating /
   renaming the temporary file. These will usually also have other associated
   error messages like
d408 1
a408 1
   "dumping master file: sl/tmp-XXXX5il3sQ: open: permission denied"
d410 2
a411 5
   Named needs write permission on the directory containing the file. Named
   writes the new cache file to a temporary file then renames it to the name
   specified in named.conf to ensure that the contents are always complete.
   This is to prevent named loading a partial zone in the event of power
   failure or similar interrupting the write of the master file.
d413 3
a415 2
   Note file names are relative to the directory specified in options and any
   chroot directory ([<chroot dir>/][<options dir>]).
d417 1
a417 3
   If named is invoked as "named -t /chroot/DNS" with the following named.conf
   then "/chroot/DNS/var/named/sl" needs to be writable by the user named is
   running as.
a418 3
   options {
           directory "/var/named";
   };
d420 2
a421 5
   zone "example.net" {
           type slave;
           file "sl/example.net";
           masters { 192.168.4.12; };
   };
d423 1
a423 1
Q: How do I intergrate BIND 9 and Solaris SMF
a424 1
A: Sun has a blog entry describing how to do this.
d426 2
a427 1
   http://blogs.sun.com/roller/page/anay/Weblog?catname=%2FSolaris
d429 1
a429 1
Q: Can a NS record refer to a CNAME.
d431 19
a449 2
A: No. The rules for glue (copies of the *address* records in the parent zones)
   and additional section processing do not allow it to work.
a450 4
   You would have to add both the CNAME and address records (A/AAAA) as glue to
   the parent zone and have CNAMEs be followed when doing additional section
   processing to make it work. No namesever implementation supports either of
   these requirements.
d452 1
a452 1
Q: What does "RFC 1918 response from Internet for 0.0.0.10.IN-ADDR.ARPA" mean?
d454 1
a454 6
A: If the IN-ADDR.ARPA name covered refers to a internal address space you are
   using then you have failed to follow RFC 1918 usage rules and are leaking
   queries to the Internet. You should establish your own zones for these
   addresses to prevent you quering the Internet's name servers for these
   addresses. Please see http://as112.net/ for details of the problems you are
   causing and the counter measures that have had to be deployed.
a455 4
   If you are not using these private addresses then a client has queried for
   them. You can just ignore the messages, get the offending client to stop
   sending you these messages as they are most probably leaking them or setup
   your own zones empty zones to serve answers to these queries.
d457 1
a457 21
   zone "10.IN-ADDR.ARPA" {
           type master;
           file "empty";
   };

   zone "16.172.IN-ADDR.ARPA" {
           type master;
           file "empty";
   };

   ...

   zone "31.172.IN-ADDR.ARPA" {
           type master;
           file "empty";
   };

   zone "168.192.IN-ADDR.ARPA" {
           type master;
           file "empty";
   };
d459 2
a460 4
   empty:
   @@ 10800 IN SOA <name-of-server>. <contact-email>. (
                  1 3600 1200 604800 10800 )
   @@ 10800 IN NS <name-of-server>.
d462 7
a468 1
   Note
a469 1
   Future versions of named are likely to do this automatically.
@


1.1.1.5
log
@ISC BIND release 9.3.3
@
text
@d7 6
a12 6
A: Linux threads do not fully implement the Posix threads (pthreads) standard. In
   particular, setuid() operates only on the current thread, not the full process.
   Because of this limitation, BIND 9 cannot use setuid() on Linux as it can on
   all other supported platforms. setuid() cannot be called before creating
   threads, since the server does not start listening on reserved ports until
   after threads have started.
d16 2
a17 2
   setuid() early, while retaining the ability to bind reserved ports. This is a
   Linux-specific hack.
d19 2
a20 2
   On a 2.2 kernel, BIND 9 does drop many root privileges, so it should be less of
   a security risk than a root process that has not dropped privileges.
a26 10
Q: Why do I get the following errors:

   general: errno2result.c:109: unexpected error:
   general: unable to convert errno to isc_result: 14: Bad address
   client: UDP client handler shutting down due to fatal receive error: unexpected error

A: This is the result of a Linux kernel bug.

   See: http://marc.theaimsgroup.com/?l=linux-netdev&m=113081708031466&w=2

d43 3
a45 6
   threads running is n+4, where n is the number of CPUs. Note that the amount of
   memory used is not cumulative; if each process is using 10M of memory, only a
   total of 10M is used.

   Newer versions of Linux's ps command hide the individual threads and require -L
   to display them.
d50 4
a53 4
A: On Linux, BIND 9 drops most of its root privileges on startup. This including
   the privilege to open files owned by other users. Therefore, if the server is
   running as root, the configuration files and zone files should also be owned by
   root.
d55 2
a56 2
Q: Why do I get errors like "dns_zone_load: zone foo/IN: loading master file bar:
   ran out of space"?
d58 2
a59 2
A: This is often caused by TXT records with missing close quotes. Check that all
   TXT records containing quoted strings have both open and close quotes.
d71 4
a74 4
A: Put a "version" option containing something other than the real version in the
   "options" section of named.conf. Note doing this will not prevent attacks and
   may impede people trying to diagnose problems with your server. Also it is
   possible to "fingerprint" nameservers to determine their version.
d78 3
a80 3
A: The following view statement will intercept lookups as the internal view that
   holds the version information will be matched last. The caveats of the previous
   answer still apply, of course.
d94 5
a98 4
A: The server requires a source of entropy to perform certain operations, mostly
   DNSSEC related. These messages indicate that you have no source of entropy. On
   systems with /dev/random or an equivalent, it is used by default. A source of
   entropy can also be defined using the random-device option in named.conf.
d105 3
a107 3
Q: I'm trying to use TSIG to authenticate dynamic updates or zone transfers. I'm
   sure I have the keys set up correctly, but the server is rejecting the TSIG.
   Why?
d109 2
a110 2
A: This may be a clock skew problem. Check that the the clocks on the client and
   server are properly synchronised (e.g., using ntp).
d116 2
a117 1
   doesn't work. If you are using one of these, use normal make or gmake instead.
d119 7
a125 7
Q: I have a BIND 9 master and a BIND 8.2.3 slave, and the master is logging error
   messages like "notify to 10.0.0.1#53 failed: unexpected end of input". What's
   wrong?

A: This error message is caused by a known bug in BIND 8.2.3 and is fixed in BIND
   8.2.4. It can be safely ignored - the notify has been acted on by the slave
   despite the error message.
d130 2
a131 1
   failed: 'RRset exists (value dependent)' prerequisite not satisfied (NXRRSET)
d133 3
a135 3
A: DNS updates allow the update request to test to see if certain conditions are
   met prior to proceeding with the update. The message above is saying that
   conditions were not met and the update is not proceeding. See doc/rfc/
d143 5
a147 5
   protocol. Windows 2000 machines have a habit of sending dynamic update requests
   to DNS servers without being specifically configured to do so. If the update
   requests are coming from a Windows 2000 machine, see http://
   support.microsoft.com/support/kb/articles/q246/8/04.asp for information about
   how to turn them off.
d155 19
a173 19
   create a /var/run/named directory owned by the named user and set pid-file to "
   /var/run/named/named.pid", or set pid-file to "named.pid", which will put the
   file in the directory specified by the directory option (which, in this case,
   must be writable by the named user).

Q: When I do a "dig . ns", many of the A records for the root servers are missing.
   Why?

A: This is normal and harmless. It is a somewhat confusing side effect of the way
   BIND 9 does RFC2181 trust ranking and of the efforts BIND 9 makes to avoid
   promoting glue into answers.

   When BIND 9 first starts up and primes its cache, it receives the root server
   addresses as additional data in an authoritative response from a root server,
   and these records are eligible for inclusion as additional data in responses.
   Subsequently it receives a subset of the root server addresses as additional
   data in a non-authoritative (referral) response from a root server. This causes
   the addresses to now be considered non-authoritative (glue) data, which is not
   eligible for inclusion in responses.
d177 2
a178 2
   whether they were last received as answers or as glue. You can always look up
   the addresses with explicit queries like "dig a.root-servers.net A".
d182 6
a187 6
A: This may be caused by a bug in the Windows 2000 DNS server where DNS messages
   larger than 16K are not handled properly. This can be worked around by setting
   the option "transfer-format one-answer;". Also check whether your zone contains
   domain names with embedded spaces or other special characters, like "John\
   032Doe\213s\032Computer", since such names have been known to cause Windows
   2000 slaves to incorrectly reject the zone.
d191 4
a194 4
A: A zone can be updated either by editing zone files and reloading the server or
   by dynamic update, but not both. If you have enabled dynamic update for a zone
   using the "allow-update" option, you are not supposed to edit the zone file by
   hand, and the server will not attempt to reload it.
d199 2
a200 2
A: This is usually the result of the firewall configuration stopping the queries
   and / or the replies.
d203 2
a204 2
   the same time? When I tried, both views on the slave were transferred from the
   same view on the master.
d206 2
a207 2
A: You will need to give the master and slave multiple IP addresses and use those
   to make sure you reach the correct view on the other machine.
d235 2
a236 2
   You put the external address on the alias so that all the other dns clients on
   these boxes see the internal view by default.
d251 1
a251 1
                   server 10.0.1.2 { keys external; };
d267 1
a267 1
                   server 10.0.1.1 { keys external; };
d275 2
a276 2
   certain interrupts as a source of random events. You can make this permanent by
   setting rand_irqs in /etc/rc.conf.
d286 2
a287 2
   behaviour can be overridden by using query-source to lock down the port and/or
   address. See also notify-source and transfer-source.
d289 2
a290 2
Q: I get error messages like "multiple RRs of singleton type" and "CNAME and other
   data" when transferring a zone. What does this mean?
d293 2
a294 1
   involved by transferring the zone using dig then running named-checkzone on it.
d299 2
a300 2
   A CNAME record cannot exist with the same name as another record except for the
   DNSSEC records which prove its existance (NSEC).
d304 2
a305 2
   aliases cannot be different. This rule also insures that a cached CNAME can be
   used without checking with an authoritative server for other RR types."
d307 2
a308 2
Q: I get error messages like "named.conf:99: unexpected end of input" where 99 is
   the last line of named.conf.
d311 3
a313 3
   (e.g. CR/LF) on the last line of a text file. This can be fixed by "adding" a
   blank line to the end of the file. Named expects to see EOF immediately after
   EOL and treats text files where this is not met as truncated.
d322 2
a323 2
   You could be generating queries faster than the slave can cope with. Lower the
   serial query rate.
d329 2
a330 2
A: You choose one view to be master and the second a slave and transfer the zone
   between views.
d373 3
a375 3
   space (tab/space) but the is no current record owner name to inherit the name
   from. Usually this is the result of putting white space before a comment.
   Forgeting the "@@" for the SOA record or indenting the master file.
d379 2
a380 2
A: You are running chrooted (-t) and have not supplied local timzone information
   in the chroot area.
d398 3
a400 3
   First ensure that named is running and no errors are being reported at startup
   (/var/log/messages or equivalent). Running "named -g <usual arguments>" from a
   title can help at this point.
d403 2
a404 2
   -a", rndc-confgen or manually. The Administrators Reference manual has details
   on how to do this.
d411 4
a414 4
   If you use "rndc-confgen -a" and named is running with -t or -u ensure that /
   etc/rndc.conf has the correct ownership and that a copy is in the chroot area.
   You can do this by re-running "rndc-confgen -a" with appropriate -t and -u
   arguments.
d422 2
a423 2
A: This is the service manager saying that named exited. You need to examine the
   Application log in the EventViewer to find out why.
d425 3
a427 2
   Common causes are that you failed to create "named.conf" (usually "C:\windows\
   dns\etc\named.conf") or failed to specify the directory in named.conf.
d442 5
a446 5
   Named needs write permission on the directory containing the file. Named writes
   the new cache file to a temporary file then renames it to the name specified in
   named.conf to ensure that the contents are always complete. This is to prevent
   named loading a partial zone in the event of power failure or similar
   interrupting the write of the master file.
d492 2
a493 2
   sending you these messages as they are most probably leaking them or setup your
   own zones empty zones to serve answers to these queries.
a524 99

Q: I'm running BIND on Red Hat Enterprise Linux or Fedora Core -

   Why can't named update slave zone database files?

   Why can't named create DDNS journal files or update the master zones from
   journals?

   Why can't named create custom log files?

A: Red Hat Security Enhanced Linux (SELinux) policy security protections :

   Red Hat have adopted the National Security Agency's SELinux security policy (
   see http://www.nsa.gov/selinux ) and recommendations for BIND security , which
   are more secure than running named in a chroot and make use of the bind-chroot
   environment unecessary .

   By default, named is not allowed by the SELinux policy to write, create or
   delete any files EXCEPT in these directories:

   $ROOTDIR/var/named/slaves
   $ROOTDIR/var/named/data
   $ROOTDIR/var/tmp


   where $ROOTDIR may be set in /etc/sysconfig/named if bind-chroot is installed.

   The SELinux policy particularly does NOT allow named to modify the $ROOTDIR/var
   /named directory, the default location for master zone database files.

   SELinux policy overrules file access permissions - so even if all the files
   under /var/named have ownership named:named and mode rw-rw-r--, named will
   still not be able to write or create files except in the directories above,
   with SELinux in Enforcing mode.

   So, to allow named to update slave or DDNS zone files, it is best to locate
   them in $ROOTDIR/var/named/slaves, with named.conf zone statements such as:

   zone "slave.zone." IN {
           type slave;
           file "slaves/slave.zone.db";
           ...
   };
   zone "ddns.zone." IN  {
           type master;
           allow-updates {...};
           file "slaves/ddns.zone.db";
   };


   To allow named to create its cache dump and statistics files, for example, you
   could use named.conf options statements such as:

   options {
           ...
           dump-file "/var/named/data/cache_dump.db";
           statistics-file "/var/named/data/named_stats.txt";
           ...
   };


   You can also tell SELinux to allow named to update any zone database files, by
   setting the SELinux tunable boolean parameter 'named_write_master_zones=1',
   using the system-config-securitylevel GUI, using the 'setsebool' command, or in
   /etc/selinux/targeted/booleans.

   You can disable SELinux protection for named entirely by setting the
   'named_disable_trans=1' SELinux tunable boolean parameter.

   The SELinux named policy defines these SELinux contexts for named:

   named_zone_t : for zone database files       - $ROOTDIR/var/named/*
   named_conf_t : for named configuration files - $ROOTDIR/etc/{named,rndc}.*
   named_cache_t: for files modifiable by named - $ROOTDIR/var/{tmp,named/{slaves,data}}


   If you want to retain use of the SELinux policy for named, and put named files
   in different locations, you can do so by changing the context of the custom
   file locations .

   To create a custom configuration file location, eg. '/root/named.conf', to use
   with the 'named -c' option, do:

   # chcon system_u:object_r:named_conf_t /root/named.conf


   To create a custom modifiable named data location, eg. '/var/log/named' for a
   log file, do:

   # chcon system_u:object_r:named_cache_t /var/log/named


   To create a custom zone file location, eg. /root/zones/, do:

   # chcon system_u:object_r:named_zone_t /root/zones/{.,*}


   See these man-pages for more information : selinux(8), named_selinux(8), chcon
   (1), setsebool(8)
@


1.1.1.6
log
@ISC BIND release 9.3.4
@
text
@a2 4
Copyright © 2004-2007 Internet Systems Consortium, Inc. ("ISC")

Copyright © 2000-2003 Internet Software Consortium.

a631 39

Q: I want to forward all DNS queries from my caching nameserver to another server.
   But there are some domains which have to be served locally, via rbldnsd.

   How do I achieve this ?

A: options {
           forward only;
           forwarders { <ip.of.primary.nameserver>; };
   };

   zone "sbl-xbl.spamhaus.org" {
           type forward; forward only;
           forwarders { <ip.of.rbldns.server> port 530; };
   };

   zone "list.dsbl.org" {
           type forward; forward only;
           forwarders { <ip.of.rbldns.server> port 530; };
   };


Q: Will named be affected by the 2007 changes to daylight savings rules in the US.

A: No, so long as the machines internal clock (as reported by "date -u") remains
   at UTC. The only visible change if you fail to upgrade your OS, if you are in a
   affected area, will be that log messages will be a hour out during the period
   where the old rules do not match the new rules.

   For most OS's this change just means that you need to update the conversion
   rules from UTC to local time. Normally this involves updating a file in /etc
   (which sets the default timezone for the machine) and possibly a directory
   which has all the conversion rules for the world (e.g. /usr/share/zoneinfo).
   When updating the OS do not forget to update any chroot areas as well. See your
   OS's documetation for more details.

   The local timezone conversion rules can also be done on a individual basis by
   setting the TZ envirionment variable appropriately. See your OS's documentation
   for more details.
@


1.1.1.7
log
@ISC BIND release 9.4.2
@
text
@d7 1
a7 1
-----------------------------------------------------------------------
d9 1
a9 1
1. Compilation and Installation Questions
d11 6
a16 2
Q: I'm trying to compile BIND 9, and "make" is failing due to files not
   being found. Why?
d18 4
a21 3
A: Using a parallel or distributed "make" to build BIND 9 is not
   supported, and doesn't work. If you are using one of these, use normal
   make or gmake instead.
d23 2
a24 1
Q: Isn't "make install" supposed to generate a default named.conf?
d26 1
a26 1
A: Short Answer: No.
d28 2
a29 5
   Long Answer: There really isn't a default configuration which fits any
   site perfectly. There are lots of decisions that need to be made and
   there is no consensus on what the defaults should be. For example
   FreeBSD uses /etc/namedb as the location where the configuration files
   for named are stored. Others use /var/named.
d31 1
a31 2
   What addresses to listen on? For a laptop on the move a lot you may
   only want to listen on the loop back interfaces.
d33 3
a35 5
   Who do you offer recursive service to? Is there are firewall to
   consider? If so is it stateless or stateful. Are you directly on the
   Internet? Are you on a private network? Are you on a NAT'd network? The
   answers to all these questions change how you configure even a caching
   name server.
d37 3
a39 1
2. Configuration and Setup Questions
d41 2
a42 2
Q: Why does named log the warning message "no TTL specified - using SOA
   MINTTL instead"?
d44 2
a45 2
A: Your zone file is illegal according to RFC1035. It must either have a
   line like:
d49 2
a50 2
   at the beginning, or the first record in it must have a TTL field, like
   the "84600" in this example:
d54 1
a54 2
Q: Why do I get errors like "dns_zone_load: zone foo/IN: loading master
   file bar: ran out of space"?
d56 29
a84 3
A: This is often caused by TXT records with missing close quotes. Check
   that all TXT records containing quoted strings have both open and close
   quotes.
d88 4
a91 5
A: Put a "version" option containing something other than the real version
   in the "options" section of named.conf. Note doing this will not
   prevent attacks and may impede people trying to diagnose problems with
   your server. Also it is possible to "fingerprint" nameservers to
   determine their version.
d95 3
a97 3
A: The following view statement will intercept lookups as the internal
   view that holds the version information will be matched last. The
   caveats of the previous answer still apply, of course.
d108 7
a114 2
Q: What do "no source of entropy found" or "could not open entropy source
   foo" mean?
d116 39
a154 9
A: The server requires a source of entropy to perform certain operations,
   mostly DNSSEC related. These messages indicate that you have no source
   of entropy. On systems with /dev/random or an equivalent, it is used by
   default. A source of entropy can also be defined using the
   random-device option in named.conf.

Q: I'm trying to use TSIG to authenticate dynamic updates or zone
   transfers. I'm sure I have the keys set up correctly, but the server is
   rejecting the TSIG. Why?
d156 6
a161 2
A: This may be a clock skew problem. Check that the the clocks on the
   client and server are properly synchronised (e.g., using ntp).
d167 6
a172 17
A: You are most likely running named as a non-root user, and that user
   does not have permission to write in /var/run. The common ways of
   fixing this are to create a /var/run/named directory owned by the named
   user and set pid-file to "/var/run/named/named.pid", or set pid-file to
   "named.pid", which will put the file in the directory specified by the
   directory option (which, in this case, must be writable by the named
   user).

Q: I can query the nameserver from the nameserver but not from other
   machines. Why?

A: This is usually the result of the firewall configuration stopping the
   queries and / or the replies.

Q: How can I make a server a slave for both an internal and an external
   view at the same time? When I tried, both views on the slave were
   transferred from the same view on the master.
d174 48
a221 2
A: You will need to give the master and slave multiple IP addresses and
   use those to make sure you reach the correct view on the other machine.
d249 2
a250 2
   You put the external address on the alias so that all the other dns
   clients on these boxes see the internal view by default.
d286 1
a286 2
Q: I get error messages like "multiple RRs of singleton type" and "CNAME
   and other data" when transferring a zone. What does this mean?
d288 20
a307 3
A: These indicate a malformed master zone. You can identify the exact
   records involved by transferring the zone using dig then running
   named-checkzone on it.
d312 25
a336 2
   A CNAME record cannot exist with the same name as another record except
   for the DNSSEC records which prove its existence (NSEC).
d338 1
a338 14
   RFC 1034, Section 3.6.2: "If a CNAME RR is present at a node, no other
   data should be present; this ensures that the data for a canonical name
   and its aliases cannot be different. This rule also insures that a
   cached CNAME can be used without checking with an authoritative server
   for other RR types."

Q: I get error messages like "named.conf:99: unexpected end of input"
   where 99 is the last line of named.conf.

A: Some text editors (notepad and wordpad) fail to put a line title
   indication (e.g. CR/LF) on the last line of a text file. This can be
   fixed by "adding" a blank line to the end of the file. Named expects to
   see EOF immediately after EOL and treats text files where this is not
   met as truncated.
d342 2
a343 2
A: You choose one view to be master and the second a slave and transfer
   the zone between views.
d357 1
a357 1
                   match-clients { !key external; 10.0.1/24; };
d371 1
a371 1
                   match-clients { key external; any; };
d382 2
a383 2
Q: I get a error message like "zone wireless.ietf56.ietf.org/IN: loading
   master file primaries/wireless.ietf56.ietf.org: no owner".
d385 4
a388 5
A: This error is produced when a line in the master file contains leading
   white space (tab/space) but the is no current record owner name to
   inherit the name from. Usually this is the result of putting white
   space before a comment, forgetting the "@@" for the SOA record, or
   indenting the master file.
d392 2
a393 2
A: You are running chrooted (-t) and have not supplied local timezone
   information in the chroot area.
d401 7
a407 2
Q: I get "rndc: connect failed: connection refused" when I try to run
   rndc.
d411 33
a443 18
   First ensure that named is running and no errors are being reported at
   startup (/var/log/messages or equivalent). Running "named -g <usual
   arguments>" from a title can help at this point.

   Secondly ensure that named is configured to use rndc either by
   "rndc-confgen -a", rndc-confgen or manually. The Administrators
   Reference manual has details on how to do this.

   Old versions of rndc-confgen used localhost rather than 127.0.0.1 in /
   etc/rndc.conf for the default server. Update /etc/rndc.conf if
   necessary so that the default server listed in /etc/rndc.conf matches
   the addresses used in named.conf. "localhost" has two address
   (127.0.0.1 and ::1).

   If you use "rndc-confgen -a" and named is running with -t or -u ensure
   that /etc/rndc.conf has the correct ownership and that a copy is in the
   chroot area. You can do this by re-running "rndc-confgen -a" with
   appropriate -t and -u arguments.
d448 3
a450 3
A: These indicate a filesystem permission error preventing named creating
   / renaming the temporary file. These will usually also have other
   associated error messages like
d454 12
a465 12
   Named needs write permission on the directory containing the file.
   Named writes the new cache file to a temporary file then renames it to
   the name specified in named.conf to ensure that the contents are always
   complete. This is to prevent named loading a partial zone in the event
   of power failure or similar interrupting the write of the master file.

   Note file names are relative to the directory specified in options and
   any chroot directory ([<chroot dir>/][<options dir>]).

   If named is invoked as "named -t /chroot/DNS" with the following
   named.conf then "/chroot/DNS/var/named/sl" needs to be writable by the
   user named is running as.
d477 1
a477 3
Q: I want to forward all DNS queries from my caching nameserver to another
   server. But there are some domains which have to be served locally, via
   rbldnsd.
d479 1
a479 16
   How do I achieve this ?

A: options {
           forward only;
           forwarders { <ip.of.primary.nameserver>; };
   };

   zone "sbl-xbl.spamhaus.org" {
           type forward; forward only;
           forwarders { <ip.of.rbldns.server> port 530; };
   };

   zone "list.dsbl.org" {
           type forward; forward only;
           forwarders { <ip.of.rbldns.server> port 530; };
   };
d481 1
a481 100

Q: Can you help me understand how BIND 9 uses memory to store DNS zones?

   Some times it seems to take several times the amount of memory it needs
   to store the zone.

A: When reloading a zone named my have multiple copies of the zone in
   memory at one time. The zone it is serving and the one it is loading.
   If reloads are ultra fast it can have more still.

   e.g. Ones that are transferring out, the one that it is serving and the
   one that is loading.

   BIND 8 destroyed the zone before loading and also killed off outgoing
   transfers of the zone.

   The new strategy allows slaves to get copies of the new zone regardless
   of how often the master is loaded compared to the transfer time. The
   slave might skip some intermediate versions but the transfers will
   complete and it will keep reasonably in sync with the master.

   The new strategy also allows the master to recover from syntax and
   other errors in the master file as it still has an in-core copy of the
   old contents.

3. General Questions

Q: I keep getting log messages like the following. Why?

   Dec 4 23:47:59 client 10.0.0.1#1355: updating zone 'example.com/IN':
   update failed: 'RRset exists (value dependent)' prerequisite not
   satisfied (NXRRSET)

A: DNS updates allow the update request to test to see if certain
   conditions are met prior to proceeding with the update. The message
   above is saying that conditions were not met and the update is not
   proceeding. See doc/rfc/rfc2136.txt for more details on prerequisites.

Q: I keep getting log messages like the following. Why?

   Jun 21 12:00:00.000 client 10.0.0.1#1234: update denied

A: Someone is trying to update your DNS data using the RFC2136 Dynamic
   Update protocol. Windows 2000 machines have a habit of sending dynamic
   update requests to DNS servers without being specifically configured to
   do so. If the update requests are coming from a Windows 2000 machine,
   see http://support.microsoft.com/support/kb/articles/q246/8/04.asp for
   information about how to turn them off.

Q: When I do a "dig . ns", many of the A records for the root servers are
   missing. Why?

A: This is normal and harmless. It is a somewhat confusing side effect of
   the way BIND 9 does RFC2181 trust ranking and of the efforts BIND 9
   makes to avoid promoting glue into answers.

   When BIND 9 first starts up and primes its cache, it receives the root
   server addresses as additional data in an authoritative response from a
   root server, and these records are eligible for inclusion as additional
   data in responses. Subsequently it receives a subset of the root server
   addresses as additional data in a non-authoritative (referral) response
   from a root server. This causes the addresses to now be considered
   non-authoritative (glue) data, which is not eligible for inclusion in
   responses.

   The server does have a complete set of root server addresses cached at
   all times, it just may not include all of them as additional data,
   depending on whether they were last received as answers or as glue. You
   can always look up the addresses with explicit queries like "dig
   a.root-servers.net A".

Q: Why don't my zones reload when I do an "rndc reload" or SIGHUP?

A: A zone can be updated either by editing zone files and reloading the
   server or by dynamic update, but not both. If you have enabled dynamic
   update for a zone using the "allow-update" option, you are not supposed
   to edit the zone file by hand, and the server will not attempt to
   reload it.

Q: Why is named listening on UDP port other than 53?

A: Named uses a system selected port to make queries of other nameservers.
   This behaviour can be overridden by using query-source to lock down the
   port and/or address. See also notify-source and transfer-source.

Q: I get warning messages like "zone example.com/IN: refresh: failure
   trying master 1.2.3.4#53: timed out".

A: Check that you can make UDP queries from the slave to the master

   dig +norec example.com soa @@1.2.3.4

   You could be generating queries faster than the slave can cope with.
   Lower the serial query rate.

   serial-query-rate 5; // default 20

Q: I don't get RRSIG's returned when I use "dig +dnssec".

A: You need to ensure DNSSEC is enabled (dnssec-enable yes;).
d485 2
a486 10
A: No. The rules for glue (copies of the *address* records in the parent
   zones) and additional section processing do not allow it to work.

   You would have to add both the CNAME and address records (A/AAAA) as
   glue to the parent zone and have CNAMEs be followed when doing
   additional section processing to make it work. No nameserver
   implementation supports either of these requirements.

Q: What does "RFC 1918 response from Internet for 0.0.0.10.IN-ADDR.ARPA"
   mean?
d488 18
a505 12
A: If the IN-ADDR.ARPA name covered refers to a internal address space you
   are using then you have failed to follow RFC 1918 usage rules and are
   leaking queries to the Internet. You should establish your own zones
   for these addresses to prevent you querying the Internet's name servers
   for these addresses. Please see http://as112.net/ for details of the
   problems you are causing and the counter measures that have had to be
   deployed.

   If you are not using these private addresses then a client has queried
   for them. You can just ignore the messages, get the offending client to
   stop sending you these messages as they are most probably leaking them
   or setup your own zones empty zones to serve answers to these queries.
a537 88
Q: Will named be affected by the 2007 changes to daylight savings rules in
   the US.

A: No, so long as the machines internal clock (as reported by "date -u")
   remains at UTC. The only visible change if you fail to upgrade your OS,
   if you are in a affected area, will be that log messages will be a hour
   out during the period where the old rules do not match the new rules.

   For most OS's this change just means that you need to update the
   conversion rules from UTC to local time. Normally this involves
   updating a file in /etc (which sets the default timezone for the
   machine) and possibly a directory which has all the conversion rules
   for the world (e.g. /usr/share/zoneinfo). When updating the OS do not
   forget to update any chroot areas as well. See your OS's documentation
   for more details.

   The local timezone conversion rules can also be done on a individual
   basis by setting the TZ environment variable appropriately. See your
   OS's documentation for more details.

Q: Is there a bugzilla (or other tool) database that mere mortals can have
   (read-only) access to for bind?

A: No. The BIND 9 bug database is kept closed for a number of reasons.
   These include, but are not limited to, that the database contains
   proprietory information from people reporting bugs. The database has in
   the past and may in future contain unfixed bugs which are capable of
   bringing down most of the Internet's DNS infrastructure.

   The release pages for each version contain up to date lists of bugs
   that have been fixed post release. That is as close as we can get to
   providing a bug database.

4. Operating-System Specific Questions

4.1. HPUX

Q: I get the following error trying to configure BIND:

   checking if unistd.h or sys/types.h defines fd_set... no
   configure: error: need either working unistd.h or sys/select.h

A: You have attempted to configure BIND with the bundled C compiler. This
   compiler does not meet the minimum compiler requirements to for
   building BIND. You need to install a ANSI C compiler and / or teach
   configure how to find the ANSI C compiler. The later can be done by
   adjusting the PATH environment variable and / or specifying the
   compiler via CC.

   ./configure CC=<compiler> ...

4.2. Linux

Q: Why do I get the following errors:

   general: errno2result.c:109: unexpected error:
   general: unable to convert errno to isc_result: 14: Bad address
   client: UDP client handler shutting down due to fatal receive error: unexpected error

A: This is the result of a Linux kernel bug.

   See: http://marc.theaimsgroup.com/?l=linux-netdev&m=113081708031466&w=2

Q: Why do I see 5 (or more) copies of named on Linux?

A: Linux threads each show up as a process under ps. The approximate
   number of threads running is n+4, where n is the number of CPUs. Note
   that the amount of memory used is not cumulative; if each process is
   using 10M of memory, only a total of 10M is used.

   Newer versions of Linux's ps command hide the individual threads and
   require -L to display them.

Q: Why does BIND 9 log "permission denied" errors accessing its
   configuration files or zones on my Linux system even though it is
   running as root?

A: On Linux, BIND 9 drops most of its root privileges on startup. This
   including the privilege to open files owned by other users. Therefore,
   if the server is running as root, the configuration files and zone
   files should also be owned by root.

Q: I get the error message "named: capset failed: Operation not permitted"
   when starting named.

A: The capability module, part of "Linux Security Modules/LSM", has not
   been loaded into the kernel. See insmod(8).

d542 2
a543 2
   Why can't named create DDNS journal files or update the master zones
   from journals?
d549 4
a552 4
   Red Hat have adopted the National Security Agency's SELinux security
   policy ( see http://www.nsa.gov/selinux ) and recommendations for BIND
   security , which are more secure than running named in a chroot and
   make use of the bind-chroot environment unnecessary .
d554 2
a555 2
   By default, named is not allowed by the SELinux policy to write, create
   or delete any files EXCEPT in these directories:
d562 1
a562 2
   where $ROOTDIR may be set in /etc/sysconfig/named if bind-chroot is
   installed.
d564 10
a573 12
   The SELinux policy particularly does NOT allow named to modify the
   $ROOTDIR/var/named directory, the default location for master zone
   database files.

   SELinux policy overrules file access permissions - so even if all the
   files under /var/named have ownership named:named and mode rw-rw-r--,
   named will still not be able to write or create files except in the
   directories above, with SELinux in Enforcing mode.

   So, to allow named to update slave or DDNS zone files, it is best to
   locate them in $ROOTDIR/var/named/slaves, with named.conf zone
   statements such as:
d587 2
a588 2
   To allow named to create its cache dump and statistics files, for
   example, you could use named.conf options statements such as:
d598 4
a601 5
   You can also tell SELinux to allow named to update any zone database
   files, by setting the SELinux tunable boolean parameter
   'named_write_master_zones=1', using the system-config-securitylevel
   GUI, using the 'setsebool' command, or in /etc/selinux/targeted/
   booleans.
d613 3
a615 3
   If you want to retain use of the SELinux policy for named, and put
   named files in different locations, you can do so by changing the
   context of the custom file locations .
d617 2
a618 2
   To create a custom configuration file location, e.g. '/root/
   named.conf', to use with the 'named -c' option, do:
d623 2
a624 2
   To create a custom modifiable named data location, e.g. '/var/log/
   named' for a log file, do:
d629 1
a629 1
   To create a custom zone file location, e.g. /root/zones/, do:
d634 2
a635 2
   See these man-pages for more information : selinux(8), named_selinux
   (8), chcon(1), setsebool(8)
d637 2
a638 1
4.3. Windows
d640 1
a640 2
Q: Zone transfers from my BIND 9 master to my Windows 2000 slave fail.
   Why?
d642 4
a645 7
A: This may be caused by a bug in the Windows 2000 DNS server where DNS
   messages larger than 16K are not handled properly. This can be worked
   around by setting the option "transfer-format one-answer;". Also check
   whether your zone contains domain names with embedded spaces or other
   special characters, like "John\032Doe\213s\032Computer", since such
   names have been known to cause Windows 2000 slaves to incorrectly
   reject the zone.
d647 3
a649 11
Q: I get "Error 1067" when starting named under Windows.

A: This is the service manager saying that named exited. You need to
   examine the Application log in the EventViewer to find out why.

   Common causes are that you failed to create "named.conf" (usually "C:\
   windows\dns\etc\named.conf") or failed to specify the directory in
   named.conf.

   options {
           Directory "C:\windows\dns\etc";
d652 3
a654 34
4.4. FreeBSD

Q: I have FreeBSD 4.x and "rndc-confgen -a" just sits there.

A: /dev/random is not configured. Use rndcontrol(8) to tell the kernel to
   use certain interrupts as a source of random events. You can make this
   permanent by setting rand_irqs in /etc/rc.conf.

   /etc/rc.conf
   rand_irqs="3 14 15"

   See also http://people.freebsd.org/~dougb/randomness.html

4.5. Solaris

Q: How do I integrate BIND 9 and Solaris SMF

A: Sun has a blog entry describing how to do this.

   http://blogs.sun.com/roller/page/anay/Weblog?catname=%2FSolaris

4.6. Apple Mac OS X

Q: How do I run BIND 9 on Apple Mac OS X?

A: If you run Tiger(Mac OS 10.4) or later then this is all you need to do:

   % sudo rndc-confgen  > /etc/rndc.conf

   Copy the key statement from /etc/rndc.conf into /etc/rndc.key, e.g.:

   key "rndc-key" {
           algorithm hmac-md5;
           secret "uvceheVuqf17ZwIcTydddw==";
a656 1
   Then start the relevant service:
d658 1
a658 1
   % sudo service org.isc.named start
d660 11
a670 1
   This is persistent upon a reboot, so you will have to do it only once.
d672 3
a674 11
A: Alternatively you can just generate /etc/rndc.key by running:

   % sudo rndc-confgen -a

   Then start the relevant service:

   % sudo service org.isc.named start

   Named will look for /etc/rndc.key when it starts if it doesn't have a
   controls section or the existing controls are missing keys sub-clauses.
   This is persistent upon a reboot, so you will have to do it only once.
@


