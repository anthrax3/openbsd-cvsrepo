head	1.1;
branch	1.1.1;
access;
symbols
	OPENBSD_6_1:1.1.1.4.0.40
	OPENBSD_6_1_BASE:1.1.1.4
	OPENBSD_6_0:1.1.1.4.0.36
	OPENBSD_6_0_BASE:1.1.1.4
	OPENBSD_5_9:1.1.1.4.0.32
	OPENBSD_5_9_BASE:1.1.1.4
	OPENBSD_5_8:1.1.1.4.0.34
	OPENBSD_5_8_BASE:1.1.1.4
	OPENBSD_5_7:1.1.1.4.0.26
	OPENBSD_5_7_BASE:1.1.1.4
	OPENBSD_5_6:1.1.1.4.0.30
	OPENBSD_5_6_BASE:1.1.1.4
	OPENBSD_5_5:1.1.1.4.0.28
	OPENBSD_5_5_BASE:1.1.1.4
	OPENBSD_5_4:1.1.1.4.0.24
	OPENBSD_5_4_BASE:1.1.1.4
	OPENBSD_5_3:1.1.1.4.0.22
	OPENBSD_5_3_BASE:1.1.1.4
	OPENBSD_5_2:1.1.1.4.0.20
	OPENBSD_5_2_BASE:1.1.1.4
	OPENBSD_5_1_BASE:1.1.1.4
	OPENBSD_5_1:1.1.1.4.0.18
	OPENBSD_5_0:1.1.1.4.0.16
	OPENBSD_5_0_BASE:1.1.1.4
	OPENBSD_4_9:1.1.1.4.0.14
	OPENBSD_4_9_BASE:1.1.1.4
	OPENBSD_4_8:1.1.1.4.0.12
	OPENBSD_4_8_BASE:1.1.1.4
	OPENBSD_4_7:1.1.1.4.0.8
	OPENBSD_4_7_BASE:1.1.1.4
	OPENBSD_4_6:1.1.1.4.0.10
	OPENBSD_4_6_BASE:1.1.1.4
	OPENBSD_4_5:1.1.1.4.0.6
	OPENBSD_4_5_BASE:1.1.1.4
	OPENBSD_4_4:1.1.1.4.0.4
	OPENBSD_4_4_BASE:1.1.1.4
	BIND_9_4_2_P1:1.1.1.4
	OPENBSD_4_3:1.1.1.4.0.2
	OPENBSD_4_3_BASE:1.1.1.4
	BIND_9_4_2:1.1.1.4
	OPENBSD_4_2:1.1.1.3.0.6
	OPENBSD_4_2_BASE:1.1.1.3
	OPENBSD_4_1:1.1.1.3.0.4
	OPENBSD_4_1_BASE:1.1.1.3
	BIND_9_3_4:1.1.1.3
	BIND_9_3_3:1.1.1.3
	OPENBSD_4_0:1.1.1.3.0.2
	OPENBSD_4_0_BASE:1.1.1.3
	BIND_9_3_2:1.1.1.3
	OPENBSD_3_9:1.1.1.2.0.6
	OPENBSD_3_9_BASE:1.1.1.2
	OPENBSD_3_8:1.1.1.2.0.4
	OPENBSD_3_8_BASE:1.1.1.2
	BIND_9_3_1:1.1.1.2
	OPENBSD_3_7:1.1.1.2.0.2
	OPENBSD_3_7_BASE:1.1.1.2
	BIND_9_3_0:1.1.1.2
	OPENBSD_3_6:1.1.1.1.0.8
	OPENBSD_3_6_BASE:1.1.1.1
	OPENBSD_3_5:1.1.1.1.0.6
	OPENBSD_3_5_BASE:1.1.1.1
	OPENBSD_3_4:1.1.1.1.0.4
	OPENBSD_3_4_BASE:1.1.1.1
	OPENBSD_3_3:1.1.1.1.0.2
	OPENBSD_3_3_BASE:1.1.1.1
	BIND_9_2_2_RC1:1.1.1.1
	ISC:1.1.1;
locks; strict;
comment	@# @;


1.1
date	2003.01.20.21.07.52;	author jakob;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2003.01.20.21.07.52;	author jakob;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2004.09.28.16.36.09;	author jakob;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	2006.04.05.16.44.35;	author jakob;	state Exp;
branches;
next	1.1.1.4;

1.1.1.4
date	2007.12.09.12.33.56;	author jakob;	state Exp;
branches;
next	;


desc
@@


1.1
log
@Initial revision
@
text
@<!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook V4.1//EN">
<!--
 - Copyright (C) 2001  Internet Software Consortium.
 -
 - Permission to use, copy, modify, and distribute this software for any
 - purpose with or without fee is hereby granted, provided that the above
 - copyright notice and this permission notice appear in all copies.
 -
 - THE SOFTWARE IS PROVIDED "AS IS" AND INTERNET SOFTWARE CONSORTIUM
 - DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL
 - IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL
 - INTERNET SOFTWARE CONSORTIUM BE LIABLE FOR ANY SPECIAL, DIRECT,
 - INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING
 - FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT,
 - NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION
 - WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
-->

<!-- $ISC: lwres_packet.docbook,v 1.6 2001/06/18 22:56:30 gson Exp $ -->

<refentry>

<refentryinfo>
<date>Jun 30, 2000</date>
</refentryinfo>

<refmeta>
<refentrytitle>lwres_packet</refentrytitle>
<manvolnum>3</manvolnum>
<refmiscinfo>BIND9</refmiscinfo>
</refmeta>

<refnamediv>
<refname>lwres_lwpacket_renderheader</refname>
<refname>lwres_lwpacket_parseheader</refname>
<refpurpose>lightweight resolver packet handling functions</refpurpose>
</refnamediv>
<refsynopsisdiv>
<funcsynopsis>
<funcsynopsisinfo>#include &lt;lwres/lwpacket.h&gt;</funcsynopsisinfo>
<funcprototype>
<funcdef>
lwres_result_t
<function>lwres_lwpacket_renderheader</function></funcdef>
<paramdef>lwres_buffer_t *b</paramdef>
<paramdef>lwres_lwpacket_t *pkt</paramdef>
</funcprototype>
<funcprototype>
<funcdef>
lwres_result_t
<function>lwres_lwpacket_parseheader</function></funcdef>
<paramdef>lwres_buffer_t *b</paramdef>
<paramdef>lwres_lwpacket_t *pkt</paramdef>
</funcprototype>
</funcsynopsis>
</refsynopsisdiv>
<refsect1>
<title>DESCRIPTION</title>
<para>
These functions rely on a
<type>struct lwres_lwpacket</type>
which is defined in
<filename>lwres/lwpacket.h</filename>.

<programlisting>
typedef struct lwres_lwpacket lwres_lwpacket_t;

struct lwres_lwpacket {
        lwres_uint32_t          length;
        lwres_uint16_t          version;
        lwres_uint16_t          pktflags;
        lwres_uint32_t          serial;
        lwres_uint32_t          opcode;
        lwres_uint32_t          result;
        lwres_uint32_t          recvlength;
        lwres_uint16_t          authtype;
        lwres_uint16_t          authlength;
};
</programlisting>
</para>

<para>
The elements of this structure are:
<variablelist>
<varlistentry><term><constant>length</constant></term>
<listitem>
<para>
the overall packet length, including the entire packet header.
This field is filled in by the lwres_gabn_*() and lwres_gnba_*()
calls.
</para></listitem></varlistentry>
<varlistentry><term><constant>version</constant></term>
<listitem>
<para>
the header format. There is currently only one format,
<type>LWRES_LWPACKETVERSION_0</type>.

This field is filled in by the lwres_gabn_*() and lwres_gnba_*()
calls.
</para></listitem></varlistentry>
<varlistentry><term><constant>pktflags</constant></term>
<listitem>
<para>
library-defined flags for this packet: for instance whether the packet
is a request or a reply. Flag values can be set, but not defined by
the caller.
This field is filled in by the application wit the exception of the
LWRES_LWPACKETFLAG_RESPONSE bit, which is set by the library in the
lwres_gabn_*() and lwres_gnba_*() calls.
</para></listitem></varlistentry>
<varlistentry><term><constant>serial</constant></term>
<listitem>
<para>
is set by the requestor and is returned in all replies. If two or more
packets from the same source have the same serial number and are from
the same source, they are assumed to be duplicates and the latter ones
may be dropped.
This field must be set by the application.
</para></listitem></varlistentry>
<varlistentry><term><constant>opcode</constant></term>
<listitem>
<para>
indicates the operation.
Opcodes between 0x00000000 and 0x03ffffff are
reserved for use by the lightweight resolver library. Opcodes between
0x04000000 and 0xffffffff are application defined.
This field is filled in by the lwres_gabn_*() and lwres_gnba_*()
calls.
</para></listitem></varlistentry>
<varlistentry><term><constant>result</constant></term>
<listitem>
<para>
is only valid for replies.
Results between 0x04000000 and 0xffffffff are application defined.
Results between 0x00000000 and 0x03ffffff are reserved for library use.
This field is filled in by the lwres_gabn_*() and lwres_gnba_*()
calls.
</para></listitem></varlistentry>
<varlistentry><term><constant>recvlength</constant></term>
<listitem>
<para>
is the maximum buffer size that the receiver can handle on requests
and the size of the buffer needed to satisfy a request when the buffer
is too large for replies.
This field is supplied by the application.
</para></listitem></varlistentry>
<varlistentry><term><constant>authtype</constant></term>
<listitem>
<para>
defines the packet level authentication that is used.
Authorisation types between 0x1000 and 0xffff are application defined
and types between 0x0000 and 0x0fff are reserved for library use.
Currently these are not used and must be zero.
</para></listitem></varlistentry>
<varlistentry><term><constant>authlen</constant></term>
<listitem>
<para>
gives the length of the authentication data.
Since packet authentication is currently not used, this must be zero.
</para></listitem></varlistentry>
</variablelist>
</para>
<para>
The following opcodes are currently defined:
<variablelist>
<varlistentry><term><constant>NOOP</constant></term>
<listitem>
<para>
Success is always returned and the packet contents are echoed.
The lwres_noop_*() functions should be used for this type.
</para></listitem></varlistentry>
<varlistentry><term><constant>GETADDRSBYNAME</constant></term>
<listitem>
<para>
returns all known addresses for a given name.
The lwres_gabn_*() functions should be used for this type.
</para></listitem></varlistentry>
<varlistentry><term><constant>GETNAMEBYADDR</constant></term>
<listitem>
<para>
return the hostname for the given address.
The lwres_gnba_*() functions should be used for this type.
</para></listitem></varlistentry>
</variablelist>
</para>

<para>
<function>lwres_lwpacket_renderheader()</function> transfers the
contents of lightweight resolver packet structure
<type>lwres_lwpacket_t</type> <parameter>*pkt</parameter> in network
byte order to the lightweight resolver buffer,
<parameter>*b</parameter>.
</para>

<para>
<function>lwres_lwpacket_parseheader()</function> performs the
converse operation.  It transfers data in network byte order from
buffer <parameter>*b</parameter> to resolver packet
<parameter>*pkt</parameter>.  The contents of the buffer
<parameter>b</parameter> should correspond to a
<type>lwres_lwpacket_t</type>.
</para>

</refsect1>

<refsect1>
<title>RETURN VALUES</title>
<para> Successful calls to
<function>lwres_lwpacket_renderheader()</function> and
<function>lwres_lwpacket_parseheader()</function> return
<errorcode>LWRES_R_SUCCESS</errorcode>.  If there is insufficient
space to copy data between the buffer <parameter>*b</parameter> and
lightweight resolver packet <parameter>*pkt</parameter> both functions
return <errorcode>LWRES_R_UNEXPECTEDEND</errorcode>.
</para>

</refsect1>
</refentry>
@


1.1.1.1
log
@ISC BIND version 9.2.2rc1
@
text
@@


1.1.1.2
log
@ISC BIND version 9.3.0. ok deraadt@@
@
text
@a2 1
 - Copyright (C) 2004  Internet Systems Consortium, Inc. ("ISC")
d9 8
a16 7
 - THE SOFTWARE IS PROVIDED "AS IS" AND ISC DISCLAIMS ALL WARRANTIES WITH
 - REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
 - AND FITNESS.  IN NO EVENT SHALL ISC BE LIABLE FOR ANY SPECIAL, DIRECT,
 - INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
 - LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE
 - OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
 - PERFORMANCE OF THIS SOFTWARE.
d19 1
a19 1
<!-- $ISC: lwres_packet.docbook,v 1.6.206.1 2004/03/06 08:15:42 marka Exp $ -->
@


1.1.1.3
log
@ISC BIND release 9.3.2
@
text
@d1 1
a1 3
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.0//EN"
               "http://www.oasis-open.org/docbook/xml/4.0/docbookx.dtd"
	       [<!ENTITY mdash "&#8212;">]>
d3 2
a4 2
 - Copyright (C) 2004, 2005  Internet Systems Consortium, Inc. ("ISC")
 - Copyright (C) 2000, 2001  Internet Software Consortium.
d19 1
a19 1
<!-- $ISC: lwres_packet.docbook,v 1.6.206.3 2005/05/12 21:36:16 sra Exp $ -->
a31 13

  <docinfo>
    <copyright>
      <year>2004</year>
      <year>2005</year>
      <holder>Internet Systems Consortium, Inc. ("ISC")</holder>
    </copyright>
    <copyright>
      <year>2000</year>
      <year>2001</year>
      <holder>Internet Software Consortium.</holder>
    </copyright>
  </docinfo>
@


1.1.1.4
log
@ISC BIND release 9.4.2
@
text
@d1 2
a2 2
<!DOCTYPE book PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN"
               "http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd"
d5 1
a5 1
 - Copyright (C) 2004, 2005, 2007  Internet Systems Consortium, Inc. ("ISC")
d8 1
a8 1
 - Permission to use, copy, modify, and/or distribute this software for any
d21 2
a22 1
<!-- $ISC: lwres_packet.docbook,v 1.7.18.6 2007/08/28 07:20:06 tbox Exp $ -->
d25 9
a33 9
  <refentryinfo>
    <date>Jun 30, 2000</date>
  </refentryinfo>

  <refmeta>
    <refentrytitle>lwres_packet</refentrytitle>
    <manvolnum>3</manvolnum>
    <refmiscinfo>BIND9</refmiscinfo>
  </refmeta>
a38 1
      <year>2007</year>
d48 7
a54 7
  <refnamediv>
    <refname>lwres_lwpacket_renderheader</refname>
    <refname>lwres_lwpacket_parseheader</refname>
    <refpurpose>lightweight resolver packet handling functions</refpurpose>
  </refnamediv>
  <refsynopsisdiv>
    <funcsynopsis>
d57 1
a57 1
        <funcdef>
d60 3
a62 3
        <paramdef>lwres_buffer_t *<parameter>b</parameter></paramdef>
        <paramdef>lwres_lwpacket_t *<parameter>pkt</parameter></paramdef>
        </funcprototype>
d64 1
a64 1
        <funcdef>
d67 3
a69 3
        <paramdef>lwres_buffer_t *<parameter>b</parameter></paramdef>
        <paramdef>lwres_lwpacket_t *<parameter>pkt</parameter></paramdef>
      </funcprototype>
d71 8
a78 9
  </refsynopsisdiv>
  <refsect1>
    <title>DESCRIPTION</title>
    <para>
      These functions rely on a
      <type>struct lwres_lwpacket</type>
      which is defined in
      <filename>lwres/lwpacket.h</filename>.
    </para>
d80 1
a80 1
    <para><programlisting>
d82 1
a82 3
      </programlisting>
    </para>
    <para><programlisting>
d95 1
a95 1
    </para>
d97 137
a233 192
    <para>
      The elements of this structure are:
      <variablelist>
        <varlistentry>
          <term><constant>length</constant></term>
          <listitem>
            <para>
              the overall packet length, including the entire packet header.
              This field is filled in by the lwres_gabn_*() and lwres_gnba_*()
              calls.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term><constant>version</constant></term>
          <listitem>
            <para>
              the header format. There is currently only one format,
              <type>LWRES_LWPACKETVERSION_0</type>.

              This field is filled in by the lwres_gabn_*() and lwres_gnba_*()
              calls.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term><constant>pktflags</constant></term>
          <listitem>
            <para>
              library-defined flags for this packet: for instance whether the
              packet
              is a request or a reply. Flag values can be set, but not defined
              by
              the caller.
              This field is filled in by the application wit the exception of
              the
              LWRES_LWPACKETFLAG_RESPONSE bit, which is set by the library in
              the
              lwres_gabn_*() and lwres_gnba_*() calls.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term><constant>serial</constant></term>
          <listitem>
            <para>
              is set by the requestor and is returned in all replies. If two
              or more
              packets from the same source have the same serial number and are
              from
              the same source, they are assumed to be duplicates and the
              latter ones
              may be dropped.
              This field must be set by the application.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term><constant>opcode</constant></term>
          <listitem>
            <para>
              indicates the operation.
              Opcodes between 0x00000000 and 0x03ffffff are
              reserved for use by the lightweight resolver library. Opcodes
              between
              0x04000000 and 0xffffffff are application defined.
              This field is filled in by the lwres_gabn_*() and lwres_gnba_*()
              calls.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term><constant>result</constant></term>
          <listitem>
            <para>
              is only valid for replies.
              Results between 0x04000000 and 0xffffffff are application
              defined.
              Results between 0x00000000 and 0x03ffffff are reserved for
              library use.
              This field is filled in by the lwres_gabn_*() and lwres_gnba_*()
              calls.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term><constant>recvlength</constant></term>
          <listitem>
            <para>
              is the maximum buffer size that the receiver can handle on
              requests
              and the size of the buffer needed to satisfy a request when the
              buffer
              is too large for replies.
              This field is supplied by the application.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term><constant>authtype</constant></term>
          <listitem>
            <para>
              defines the packet level authentication that is used.
              Authorisation types between 0x1000 and 0xffff are application
              defined
              and types between 0x0000 and 0x0fff are reserved for library
              use.
              Currently these are not used and must be zero.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term><constant>authlen</constant></term>
          <listitem>
            <para>
              gives the length of the authentication data.
              Since packet authentication is currently not used, this must be
              zero.
            </para>
          </listitem>
        </varlistentry>
      </variablelist>
    </para>
    <para>
      The following opcodes are currently defined:
      <variablelist>
        <varlistentry>
          <term><constant>NOOP</constant></term>
          <listitem>
            <para>
              Success is always returned and the packet contents are echoed.
              The lwres_noop_*() functions should be used for this type.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term><constant>GETADDRSBYNAME</constant></term>
          <listitem>
            <para>
              returns all known addresses for a given name.
              The lwres_gabn_*() functions should be used for this type.
            </para>
          </listitem>
        </varlistentry>
        <varlistentry>
          <term><constant>GETNAMEBYADDR</constant></term>
          <listitem>
            <para>
              return the hostname for the given address.
              The lwres_gnba_*() functions should be used for this type.
            </para>
          </listitem>
        </varlistentry>
      </variablelist>
    </para>

    <para><function>lwres_lwpacket_renderheader()</function>
      transfers the contents of lightweight resolver packet structure
      <type>lwres_lwpacket_t</type> <parameter>*pkt</parameter> in
      network byte order to the lightweight resolver buffer,
      <parameter>*b</parameter>.
    </para>

    <para><function>lwres_lwpacket_parseheader()</function>
      performs the converse operation.  It transfers data in network
      byte order from buffer <parameter>*b</parameter> to resolver
      packet <parameter>*pkt</parameter>.  The contents of the buffer
      <parameter>b</parameter> should correspond to a
      <type>lwres_lwpacket_t</type>.
    </para>

  </refsect1>

  <refsect1>
    <title>RETURN VALUES</title>
    <para>
      Successful calls to
      <function>lwres_lwpacket_renderheader()</function> and
      <function>lwres_lwpacket_parseheader()</function> return
      <errorcode>LWRES_R_SUCCESS</errorcode>.  If there is insufficient
      space to copy data between the buffer <parameter>*b</parameter> and
      lightweight resolver packet <parameter>*pkt</parameter> both
      functions
      return <errorcode>LWRES_R_UNEXPECTEDEND</errorcode>.
    </para>

  </refsect1>
</refentry><!--
 - Local variables:
 - mode: sgml
 - End:
-->
@


