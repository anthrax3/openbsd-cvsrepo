head	1.4;
access;
symbols
	OPENBSD_6_1:1.4.0.40
	OPENBSD_6_1_BASE:1.4
	OPENBSD_6_0:1.4.0.36
	OPENBSD_6_0_BASE:1.4
	OPENBSD_5_9:1.4.0.32
	OPENBSD_5_9_BASE:1.4
	OPENBSD_5_8:1.4.0.34
	OPENBSD_5_8_BASE:1.4
	OPENBSD_5_7:1.4.0.26
	OPENBSD_5_7_BASE:1.4
	OPENBSD_5_6:1.4.0.30
	OPENBSD_5_6_BASE:1.4
	OPENBSD_5_5:1.4.0.28
	OPENBSD_5_5_BASE:1.4
	OPENBSD_5_4:1.4.0.24
	OPENBSD_5_4_BASE:1.4
	OPENBSD_5_3:1.4.0.22
	OPENBSD_5_3_BASE:1.4
	OPENBSD_5_2:1.4.0.20
	OPENBSD_5_2_BASE:1.4
	OPENBSD_5_1_BASE:1.4
	OPENBSD_5_1:1.4.0.18
	OPENBSD_5_0:1.4.0.16
	OPENBSD_5_0_BASE:1.4
	OPENBSD_4_9:1.4.0.14
	OPENBSD_4_9_BASE:1.4
	OPENBSD_4_8:1.4.0.12
	OPENBSD_4_8_BASE:1.4
	OPENBSD_4_7:1.4.0.8
	OPENBSD_4_7_BASE:1.4
	OPENBSD_4_6:1.4.0.10
	OPENBSD_4_6_BASE:1.4
	OPENBSD_4_5:1.4.0.6
	OPENBSD_4_5_BASE:1.4
	OPENBSD_4_4:1.4.0.4
	OPENBSD_4_4_BASE:1.4
	BIND_9_4_2_P1:1.1.1.3
	OPENBSD_4_3:1.4.0.2
	OPENBSD_4_3_BASE:1.4
	BIND_9_4_2:1.1.1.3
	OPENBSD_4_2:1.3.0.12
	OPENBSD_4_2_BASE:1.3
	OPENBSD_4_1:1.3.0.10
	OPENBSD_4_1_BASE:1.3
	BIND_9_3_4:1.1.1.2
	BIND_9_3_3:1.1.1.2
	OPENBSD_4_0:1.3.0.8
	OPENBSD_4_0_BASE:1.3
	BIND_9_3_2:1.1.1.2
	OPENBSD_3_9:1.3.0.6
	OPENBSD_3_9_BASE:1.3
	OPENBSD_3_8:1.3.0.4
	OPENBSD_3_8_BASE:1.3
	BIND_9_3_1:1.1.1.2
	OPENBSD_3_7:1.3.0.2
	OPENBSD_3_7_BASE:1.3
	BIND_9_3_0:1.1.1.2
	OPENBSD_3_6:1.2.0.4
	OPENBSD_3_6_BASE:1.2
	OPENBSD_3_5:1.2.0.2
	OPENBSD_3_5_BASE:1.2
	OPENBSD_3_4:1.1.1.1.0.4
	OPENBSD_3_4_BASE:1.1.1.1
	OPENBSD_3_3:1.1.1.1.0.2
	OPENBSD_3_3_BASE:1.1.1.1
	BIND_9_2_2_RC1:1.1.1.1
	ISC:1.1.1;
locks; strict;
comment	@ * @;


1.4
date	2007.12.09.13.39.43;	author jakob;	state Exp;
branches;
next	1.3;

1.3
date	2004.09.28.17.14.06;	author jakob;	state Exp;
branches;
next	1.2;

1.2
date	2003.11.18.14.14.06;	author jakob;	state Exp;
branches;
next	1.1;

1.1
date	2003.01.20.21.07.08;	author jakob;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	2003.01.20.21.07.08;	author jakob;	state Exp;
branches;
next	1.1.1.2;

1.1.1.2
date	2004.09.28.16.34.59;	author jakob;	state Exp;
branches;
next	1.1.1.3;

1.1.1.3
date	2007.12.09.12.34.41;	author jakob;	state Exp;
branches;
next	;


desc
@@


1.4
log
@resolve conflicts
@
text
@/*
 * Copyright (C) 2004, 2005  Internet Systems Consortium, Inc. ("ISC")
 * Copyright (C) 1998-2003  Internet Software Consortium.
 *
 * Permission to use, copy, modify, and distribute this software for any
 * purpose with or without fee is hereby granted, provided that the above
 * copyright notice and this permission notice appear in all copies.
 *
 * THE SOFTWARE IS PROVIDED "AS IS" AND ISC DISCLAIMS ALL WARRANTIES WITH
 * REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
 * AND FITNESS.  IN NO EVENT SHALL ISC BE LIABLE FOR ANY SPECIAL, DIRECT,
 * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
 * LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE
 * OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
 * PERFORMANCE OF THIS SOFTWARE.
 */

/* $ISC: result.c,v 1.115.10.7 2005/06/17 02:04:31 marka Exp $ */

/*! \file */

#include <config.h>

#include <isc/once.h>
#include <isc/util.h>

#include <dns/result.h>
#include <dns/lib.h>

static const char *text[DNS_R_NRESULTS] = {
	"label too long",		       /*%< 0 DNS_R_LABELTOOLONG */
	"bad escape",			       /*%< 1 DNS_R_BADESCAPE */
	/*!
	 * Note that DNS_R_BADBITSTRING and DNS_R_BITSTRINGTOOLONG are
	 * deprecated.
	 */
	"bad bitstring",		       /*%< 2 DNS_R_BADBITSTRING */
	"bitstring too long",		       /*%< 3 DNS_R_BITSTRINGTOOLONG */
	"empty label",			       /*%< 4 DNS_R_EMPTYLABEL */

	"bad dotted quad",		       /*%< 5 DNS_R_BADDOTTEDQUAD */
	"invalid NS owner name (wildcard)",    /*%< 6 DNS_R_INVALIDNS */
	"unknown class/type",		       /*%< 7 DNS_R_UNKNOWN */
	"bad label type",		       /*%< 8 DNS_R_BADLABELTYPE */
	"bad compression pointer",	       /*%< 9 DNS_R_BADPOINTER */

	"too many hops",		       /*%< 10 DNS_R_TOOMANYHOPS */
	"disallowed (by application policy)",  /*%< 11 DNS_R_DISALLOWED */
	"extra input text",		       /*%< 12 DNS_R_EXTRATOKEN */
	"extra input data",		       /*%< 13 DNS_R_EXTRADATA */
	"text too long",		       /*%< 14 DNS_R_TEXTTOOLONG */

	"not at top of zone",		       /*%< 15 DNS_R_NOTZONETOP */
	"syntax error",			       /*%< 16 DNS_R_SYNTAX */
	"bad checksum",			       /*%< 17 DNS_R_BADCKSUM */
	"bad IPv6 address",		       /*%< 18 DNS_R_BADAAAA */
	"no owner",			       /*%< 19 DNS_R_NOOWNER */

	"no ttl",			       /*%< 20 DNS_R_NOTTL */
	"bad class",			       /*%< 21 DNS_R_BADCLASS */
	"name too long",		       /*%< 22 DNS_R_NAMETOOLONG */
	"partial match",		       /*%< 23 DNS_R_PARTIALMATCH */
	"new origin",			       /*%< 24 DNS_R_NEWORIGIN */

	"unchanged",			       /*%< 25 DNS_R_UNCHANGED */
	"bad ttl",			       /*%< 26 DNS_R_BADTTL */
	"more data needed/to be rendered",     /*%< 27 DNS_R_NOREDATA */
	"continue",			       /*%< 28 DNS_R_CONTINUE */
	"delegation",			       /*%< 29 DNS_R_DELEGATION */

	"glue",				       /*%< 30 DNS_R_GLUE */
	"dname",			       /*%< 31 DNS_R_DNAME */
	"cname",			       /*%< 32 DNS_R_CNAME */
	"bad database",			       /*%< 33 DNS_R_BADDB */
	"zonecut",			       /*%< 34 DNS_R_ZONECUT */

	"bad zone",			       /*%< 35 DNS_R_BADZONE */
	"more data",			       /*%< 36 DNS_R_MOREDATA */
	"up to date",			       /*%< 37 DNS_R_UPTODATE */
	"tsig verify failure",		       /*%< 38 DNS_R_TSIGVERIFYFAILURE */
	"tsig indicates error",		       /*%< 39 DNS_R_TSIGERRORSET */

	"RRSIG failed to verify",	       /*%< 40 DNS_R_SIGINVALID */
	"RRSIG has expired",		       /*%< 41 DNS_R_SIGEXPIRED */
	"RRSIG validity period has not begun", /*%< 42 DNS_R_SIGFUTURE */
	"key is unauthorized to sign data",    /*%< 43 DNS_R_KEYUNAUTHORIZED */
	"invalid time",			       /*%< 44 DNS_R_INVALIDTIME */

	"expected a TSIG or SIG(0)",	       /*%< 45 DNS_R_EXPECTEDTSIG */
	"did not expect a TSIG or SIG(0)",     /*%< 46 DNS_R_UNEXPECTEDTSIG */
	"TKEY is unacceptable",		       /*%< 47 DNS_R_INVALIDTKEY */
	"hint",				       /*%< 48 DNS_R_HINT */
	"drop",				       /*%< 49 DNS_R_DROP */

	"zone not loaded",		       /*%< 50 DNS_R_NOTLOADED */
	"ncache nxdomain",		       /*%< 51 DNS_R_NCACHENXDOMAIN */
	"ncache nxrrset",		       /*%< 52 DNS_R_NCACHENXRRSET */
	"wait",				       /*%< 53 DNS_R_WAIT */
	"not verified yet",		       /*%< 54 DNS_R_NOTVERIFIEDYET */

	"no identity",			       /*%< 55 DNS_R_NOIDENTITY */
	"no journal",			       /*%< 56 DNS_R_NOJOURNAL */
	"alias",			       /*%< 57 DNS_R_ALIAS */
	"use TCP",			       /*%< 58 DNS_R_USETCP */
	"no valid RRSIG",		       /*%< 59 DNS_R_NOVALIDSIG */

	"no valid NSEC",		       /*%< 60 DNS_R_NOVALIDNSEC */
	"not insecure",			       /*%< 61 DNS_R_NOTINSECURE */
	"unknown service",		       /*%< 62 DNS_R_UNKNOWNSERVICE */
	"recoverable error occurred",	       /*%< 63 DNS_R_RECOVERABLE */
	"unknown opt attribute record",	       /*%< 64 DNS_R_UNKNOWNOPT */

	"unexpected message id",	       /*%< 65 DNS_R_UNEXPECTEDID */
	"seen include file",		       /*%< 66 DNS_R_SEENINCLUDE */
	"not exact",		       	       /*%< 67 DNS_R_NOTEXACT */
	"address blackholed",	       	       /*%< 68 DNS_R_BLACKHOLED */
	"bad algorithm",		       /*%< 69 DNS_R_BADALG */

	"invalid use of a meta type",	       /*%< 70 DNS_R_METATYPE */
	"CNAME and other data",		       /*%< 71 DNS_R_CNAMEANDOTHER */
	"multiple RRs of singleton type",      /*%< 72 DNS_R_SINGLETON */
	"hint nxrrset",			       /*%< 73 DNS_R_HINTNXRRSET */
	"no master file configured",	       /*%< 74 DNS_R_NOMASTERFILE */

	"unknown protocol",		       /*%< 75 DNS_R_UNKNOWNPROTO */
	"clocks are unsynchronized",	       /*%< 76 DNS_R_CLOCKSKEW */
	"IXFR failed",			       /*%< 77 DNS_R_BADIXFR */
	"not authoritative",		       /*%< 78 DNS_R_NOTAUTHORITATIVE */
	"no valid KEY",		       	       /*%< 79 DNS_R_NOVALIDKEY */

	"obsolete",			       /*%< 80 DNS_R_OBSOLETE */
	"already frozen",		       /*%< 81 DNS_R_FROZEN */
	"unknown flag",			       /*%< 82 DNS_R_UNKNOWNFLAG */
	"expected a response",		       /*%< 83 DNS_R_EXPECTEDRESPONSE */
	"no valid DS",			       /*%< 84 DNS_R_NOVALIDDS */

	"NS is an address",		       /*%< 85 DNS_R_NSISADDRESS */
	"received FORMERR",		       /*%< 86 DNS_R_REMOTEFORMERR */
	"truncated TCP response",	       /*%< 87 DNS_R_TRUNCATEDTCP */
	"lame server detected",		       /*%< 88 DNS_R_LAME */
	"unexpected RCODE",		       /*%< 89 DNS_R_UNEXPECTEDRCODE */

	"unexpected OPCODE",		       /*%< 90 DNS_R_UNEXPECTEDOPCODE */
	"chase DS servers",		       /*%< 91 DNS_R_CHASEDSSERVERS */
	"empty name",			       /*%< 92 DNS_R_EMPTYNAME */
	"empty wild",			       /*%< 93 DNS_R_EMPTYWILD */
	"bad bitmap",			       /*%< 94 DNS_R_BADBITMAP */

	"from wildcard",		       /*%< 95 DNS_R_FROMWILDCARD */
	"bad owner name (check-names)",	       /*%< 96 DNS_R_BADOWNERNAME */
	"bad name (check-names)",	       /*%< 97 DNS_R_BADNAME */
	"dynamic zone",			       /*%< 98 DNS_R_DYNAMIC */
	"unknown command",		       /*%< 99 DNS_R_UNKNOWNCOMMAND */

	"must-be-secure",		       /*%< 100 DNS_R_MUSTBESECURE */
	"covering NSEC record returned",       /*%< 101 DNS_R_COVERINGNSEC */
	"MX is an address",		       /*%< 102 DNS_R_MXISADDRESS */
	"duplicate query"		       /*%< 103 DNS_R_DUPLICATE */
};

static const char *rcode_text[DNS_R_NRCODERESULTS] = {
	"NOERROR",				/*%< 0 DNS_R_NOEROR */
	"FORMERR",				/*%< 1 DNS_R_FORMERR */
	"SERVFAIL",				/*%< 2 DNS_R_SERVFAIL */
	"NXDOMAIN",				/*%< 3 DNS_R_NXDOMAIN */
	"NOTIMP",				/*%< 4 DNS_R_NOTIMP */

	"REFUSED",				/*%< 5 DNS_R_REFUSED */
	"YXDOMAIN",				/*%< 6 DNS_R_YXDOMAIN */
	"YXRRSET",				/*%< 7 DNS_R_YXRRSET */
	"NXRRSET",				/*%< 8 DNS_R_NXRRSET */
	"NOTAUTH",				/*%< 9 DNS_R_NOTAUTH */

	"NOTZONE",				/*%< 10 DNS_R_NOTZONE */
	"<rcode 11>",				/*%< 11 has no macro */
	"<rcode 12>",				/*%< 12 has no macro */
	"<rcode 13>",				/*%< 13 has no macro */
	"<rcode 14>",				/*%< 14 has no macro */

	"<rcode 15>",				/*%< 15 has no macro */
	"BADVERS",				/*%< 16 DNS_R_BADVERS */
};

#define DNS_RESULT_RESULTSET			2
#define DNS_RESULT_RCODERESULTSET		3

static isc_once_t		once = ISC_ONCE_INIT;

static void
initialize_action(void) {
	isc_result_t result;

	result = isc_result_register(ISC_RESULTCLASS_DNS, DNS_R_NRESULTS,
				     text, dns_msgcat, DNS_RESULT_RESULTSET);
	if (result == ISC_R_SUCCESS)
		result = isc_result_register(ISC_RESULTCLASS_DNSRCODE,
					     DNS_R_NRCODERESULTS,
					     rcode_text, dns_msgcat,
					     DNS_RESULT_RCODERESULTSET);
	if (result != ISC_R_SUCCESS)
		UNEXPECTED_ERROR(__FILE__, __LINE__,
				 "isc_result_register() failed: %u", result);
}

static void
initialize(void) {
	dns_lib_initmsgcat();
	RUNTIME_CHECK(isc_once_do(&once, initialize_action) == ISC_R_SUCCESS);
}

const char *
dns_result_totext(isc_result_t result) {
	initialize();

	return (isc_result_totext(result));
}

void
dns_result_register(void) {
	initialize();
}

dns_rcode_t
dns_result_torcode(isc_result_t result) {
	dns_rcode_t rcode = dns_rcode_servfail;

	if (DNS_RESULT_ISRCODE(result)) {
		/*
		 * Rcodes can't be bigger than 12 bits, which is why we
		 * AND with 0xFFF instead of 0xFFFF.
		 */
		return ((dns_rcode_t)((result) & 0xFFF));
	}
	/*
	 * Try to supply an appropriate rcode.
	 */
	switch (result) {
	case ISC_R_SUCCESS:
		rcode = dns_rcode_noerror;
		break;
	case ISC_R_BADBASE64:
	case ISC_R_NOSPACE:
	case ISC_R_RANGE:
	case ISC_R_UNEXPECTEDEND:
	case DNS_R_BADAAAA:
	/* case DNS_R_BADBITSTRING: deprecated */
	case DNS_R_BADCKSUM:
	case DNS_R_BADCLASS:
	case DNS_R_BADLABELTYPE:
	case DNS_R_BADPOINTER:
	case DNS_R_BADTTL:
	case DNS_R_BADZONE:
	/* case DNS_R_BITSTRINGTOOLONG: deprecated */
	case DNS_R_EXTRADATA:
	case DNS_R_LABELTOOLONG:
	case DNS_R_NOREDATA:
	case DNS_R_SYNTAX:
	case DNS_R_TEXTTOOLONG:
	case DNS_R_TOOMANYHOPS:
	case DNS_R_TSIGERRORSET:
	case DNS_R_UNKNOWN:
		rcode = dns_rcode_formerr;
		break;
	case DNS_R_DISALLOWED:
		rcode = dns_rcode_refused;
		break;
	case DNS_R_TSIGVERIFYFAILURE:
	case DNS_R_CLOCKSKEW:
		rcode = dns_rcode_notauth;
		break;
	default:
		rcode = dns_rcode_servfail;
	}

	return (rcode);
}
@


1.3
log
@resolve conflicts
@
text
@d2 1
a2 1
 * Copyright (C) 2004  Internet Systems Consortium, Inc. ("ISC")
d18 3
a20 1
/* $ISC: result.c,v 1.90.2.9.2.13 2004/05/14 05:06:39 marka Exp $ */
d31 3
a33 3
	"label too long",		       /*  0 DNS_R_LABELTOOLONG	     */
	"bad escape",			       /*  1 DNS_R_BADESCAPE	     */
	/*
d37 122
a158 120
	"bad bitstring",		       /*  2 DNS_R_BADBITSTRING	     */
	"bitstring too long",		       /*  3 DNS_R_BITSTRINGTOOLONG  */
	"empty label",			       /*  4 DNS_R_EMPTYLABEL	     */

	"bad dotted quad",		       /*  5 DNS_R_BADDOTTEDQUAD     */
	"invalid NS owner name (wildcard)",    /*  6 DNS_R_INVALIDNS	     */
	"unknown class/type",		       /*  7 DNS_R_UNKNOWN	     */
	"bad label type",		       /*  8 DNS_R_BADLABELTYPE	     */
	"bad compression pointer",	       /*  9 DNS_R_BADPOINTER	     */

	"too many hops",		       /* 10 DNS_R_TOOMANYHOPS	     */
	"disallowed (by application policy)",  /* 11 DNS_R_DISALLOWED	     */
	"extra input text",		       /* 12 DNS_R_EXTRATOKEN	     */
	"extra input data",		       /* 13 DNS_R_EXTRADATA	     */
	"text too long",		       /* 14 DNS_R_TEXTTOOLONG	     */

	"not at top of zone",		       /* 15 DNS_R_NOTZONETOP	     */
	"syntax error",			       /* 16 DNS_R_SYNTAX	     */
	"bad checksum",			       /* 17 DNS_R_BADCKSUM	     */
	"bad IPv6 address",		       /* 18 DNS_R_BADAAAA	     */
	"no owner",			       /* 19 DNS_R_NOOWNER	     */

	"no ttl",			       /* 20 DNS_R_NOTTL	     */
	"bad class",			       /* 21 DNS_R_BADCLASS	     */
	"name too long",		       /* 22 DNS_R_NAMETOOLONG	     */
	"partial match",		       /* 23 DNS_R_PARTIALMATCH	     */
	"new origin",			       /* 24 DNS_R_NEWORIGIN	     */

	"unchanged",			       /* 25 DNS_R_UNCHANGED	     */
	"bad ttl",			       /* 26 DNS_R_BADTTL	     */
	"more data needed/to be rendered",     /* 27 DNS_R_NOREDATA	     */
	"continue",			       /* 28 DNS_R_CONTINUE	     */
	"delegation",			       /* 29 DNS_R_DELEGATION	     */

	"glue",				       /* 30 DNS_R_GLUE		     */
	"dname",			       /* 31 DNS_R_DNAME	     */
	"cname",			       /* 32 DNS_R_CNAME	     */
	"bad database",			       /* 33 DNS_R_BADDB	     */
	"zonecut",			       /* 34 DNS_R_ZONECUT	     */

	"bad zone",			       /* 35 DNS_R_BADZONE	     */
	"more data",			       /* 36 DNS_R_MOREDATA	     */
	"up to date",			       /* 37 DNS_R_UPTODATE	     */
	"tsig verify failure",		       /* 38 DNS_R_TSIGVERIFYFAILURE */
	"tsig indicates error",		       /* 39 DNS_R_TSIGERRORSET	     */

	"RRSIG failed to verify",	       /* 40 DNS_R_SIGINVALID	     */
	"RRSIG has expired",		       /* 41 DNS_R_SIGEXPIRED	     */
	"RRSIG validity period has not begun", /* 42 DNS_R_SIGFUTURE	     */
	"key is unauthorized to sign data",    /* 43 DNS_R_KEYUNAUTHORIZED   */
	"invalid time",			       /* 44 DNS_R_INVALIDTIME	     */

	"expected a TSIG or SIG(0)",	       /* 45 DNS_R_EXPECTEDTSIG	     */
	"did not expect a TSIG or SIG(0)",     /* 46 DNS_R_UNEXPECTEDTSIG    */
	"TKEY is unacceptable",		       /* 47 DNS_R_INVALIDTKEY	     */
	"hint",				       /* 48 DNS_R_HINT		     */
	"drop",				       /* 49 DNS_R_DROP		     */

	"zone not loaded",		       /* 50 DNS_R_NOTLOADED	     */
	"ncache nxdomain",		       /* 51 DNS_R_NCACHENXDOMAIN    */
	"ncache nxrrset",		       /* 52 DNS_R_NCACHENXRRSET     */
	"wait",				       /* 53 DNS_R_WAIT		     */
	"not verified yet",		       /* 54 DNS_R_NOTVERIFIEDYET    */

	"no identity",			       /* 55 DNS_R_NOIDENTITY	     */
	"no journal",			       /* 56 DNS_R_NOJOURNAL	     */
	"alias",			       /* 57 DNS_R_ALIAS	     */
	"use TCP",			       /* 58 DNS_R_USETCP	     */
	"no valid RRSIG",		       /* 59 DNS_R_NOVALIDSIG	     */

	"no valid NSEC",		       /* 60 DNS_R_NOVALIDNSEC	     */
	"not insecure",			       /* 61 DNS_R_NOTINSECURE	     */
	"unknown service",		       /* 62 DNS_R_UNKNOWNSERVICE    */
	"recoverable error occurred",	       /* 63 DNS_R_RECOVERABLE       */
	"unknown opt attribute record",	       /* 64 DNS_R_UNKNOWNOPT	     */

	"unexpected message id",	       /* 65 DNS_R_UNEXPECTEDID      */
	"seen include file",		       /* 66 DNS_R_SEENINCLUDE       */
	"not exact",		       	       /* 67 DNS_R_NOTEXACT	     */
	"address blackholed",	       	       /* 68 DNS_R_BLACKHOLED	     */
	"bad algorithm",		       /* 69 DNS_R_BADALG	     */

	"invalid use of a meta type",	       /* 70 DNS_R_METATYPE	     */
	"CNAME and other data",		       /* 71 DNS_R_CNAMEANDOTHER     */
	"multiple RRs of singleton type",      /* 72 DNS_R_SINGLETON	     */
	"hint nxrrset",			       /* 73 DNS_R_HINTNXRRSET	     */
	"no master file configured",	       /* 74 DNS_R_NOMASTERFILE	     */

	"unknown protocol",		       /* 75 DNS_R_UNKNOWNPROTO	     */
	"clocks are unsynchronized",	       /* 76 DNS_R_CLOCKSKEW	     */
	"IXFR failed",			       /* 77 DNS_R_BADIXFR	     */
	"not authoritative",		       /* 78 DNS_R_NOTAUTHORITATIVE  */
	"no valid KEY",		       	       /* 79 DNS_R_NOVALIDKEY	     */

	"obsolete",			       /* 80 DNS_R_OBSOLETE	     */
	"already frozen",		       /* 81 DNS_R_FROZEN	     */
	"unknown flag",			       /* 82 DNS_R_UNKNOWNFLAG	     */
	"expected a response",		       /* 83 DNS_R_EXPECTEDRESPONSE  */
	"no valid DS",			       /* 84 DNS_R_NOVALIDDS	     */

	"NS is an address",		       /* 85 DNS_R_NSISADDRESS	     */
	"received FORMERR",		       /* 86 DNS_R_REMOTEFORMERR     */
	"truncated TCP response",	       /* 87 DNS_R_TRUNCATEDTCP	     */
	"lame server detected",		       /* 88 DNS_R_LAME		     */
	"unexpected RCODE",		       /* 89 DNS_R_UNEXPECTEDRCODE   */

	"unexpected OPCODE",		       /* 90 DNS_R_UNEXPECTEDOPCODE  */
	"chase DS servers",		       /* 91 DNS_R_CHASEDSSERVERS    */
	"empty name",			       /* 92 DNS_R_EMPTYNAME	     */
	"empty wild",			       /* 93 DNS_R_EMPTYWILD	     */
	"bad bitmap",			       /* 94 DNS_R_BADBITMAP	     */

	"from wildcard",		       /* 95 DNS_R_FROMWILDCARD	     */
	"bad owner name (check-names)",	       /* 96 DNS_R_BADOWNERNAME	     */
	"bad name (check-names)",	       /* 97 DNS_R_BADNAME	     */
	"dynamic zone",			       /* 98 DNS_R_DYNAMIC	     */
	"unknown command",		       /* 99 DNS_R_UNKNOWNCOMMAND    */

	"must-be-secure",		       /* 100 DNS_R_MUSTBESECURE     */
	"covering NSEC record returned"	       /* 101 DNS_R_COVERINGNSEC     */
d162 17
a178 17
	"NOERROR",				/*  0 DNS_R_NOEROR	     */
	"FORMERR",				/*  1 DNS_R_FORMERR	     */
	"SERVFAIL",				/*  2 DNS_R_SERVFAIL	     */
	"NXDOMAIN",				/*  3 DNS_R_NXDOMAIN	     */
	"NOTIMP",				/*  4 DNS_R_NOTIMP	     */

	"REFUSED",				/*  5 DNS_R_REFUSED	     */
	"YXDOMAIN",				/*  6 DNS_R_YXDOMAIN	     */
	"YXRRSET",				/*  7 DNS_R_YXRRSET	     */
	"NXRRSET",				/*  8 DNS_R_NXRRSET	     */
	"NOTAUTH",				/*  9 DNS_R_NOTAUTH	     */

	"NOTZONE",				/* 10 DNS_R_NOTZONE 	     */
	"<rcode 11>",				/* 11 has no macro	     */
	"<rcode 12>",				/* 12 has no macro	     */
	"<rcode 13>",				/* 13 has no macro	     */
	"<rcode 14>",				/* 14 has no macro	     */
d180 2
a181 2
	"<rcode 15>",				/* 15 has no macro	     */
	"BADVERS",				/* 16 DNS_R_BADVERS	     */
@


1.2
log
@update to BIND v9.2.3. ok todd@@
@
text
@d2 1
d9 7
a15 8
 * THE SOFTWARE IS PROVIDED "AS IS" AND INTERNET SOFTWARE CONSORTIUM
 * DISCLAIMS ALL WARRANTIES WITH REGARD TO THIS SOFTWARE INCLUDING ALL
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL
 * INTERNET SOFTWARE CONSORTIUM BE LIABLE FOR ANY SPECIAL, DIRECT,
 * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING
 * FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT,
 * NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION
 * WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
d18 1
a18 1
/* $ISC: result.c,v 1.90.2.9 2003/07/22 04:03:44 marka Exp $ */
d31 4
d81 3
a83 3
	"SIG failed to verify",		       /* 40 DNS_R_SIGINVALID	     */
	"SIG has expired",		       /* 41 DNS_R_SIGEXPIRED	     */
	"SIG validity period has not begun",   /* 42 DNS_R_SIGFUTURE	     */
d103 1
a103 1
	"no valid SIG",			       /* 59 DNS_R_NOVALIDSIG	     */
d105 1
a105 1
	"no valid NXT",			       /* 60 DNS_R_NOVALIDNXT	     */
d126 2
a127 2
	"<unused 78>",			       /* 78 unused		     */
	"no valid KEY",			       /* 79 DNS_R_NOVALIDKEY	     */
d133 19
a151 1
	"<unused 84>",
d153 2
a154 11
	"<unused 85>",
	"<unused 86>",
	"<unused 87>",
	"<unused 88>",
	"<unused 89>",

	"<unused 90>",
	"<unused 91>",
	"empty name",				/* 92 DNS_R_EMPTYNAME	     */
	"empty wild",				/* 93 DNS_R_EMPTYWILD	     */
	"bad bitmap"				/* 94 DNS_R_BADBITMAP	     */
d242 1
a242 1
	case DNS_R_BADBITSTRING:
d249 1
a249 1
	case DNS_R_BITSTRINGTOOLONG:
@


1.1
log
@Initial revision
@
text
@d2 1
a2 1
 * Copyright (C) 1998-2002  Internet Software Consortium.
d18 1
a18 1
/* $ISC: result.c,v 1.90.2.5 2002/03/26 00:55:00 marka Exp $ */
d128 14
a141 1
	"expected a response"		       /* 83 DNS_R_EXPECTEDRESPONSE  */
@


1.1.1.1
log
@ISC BIND version 9.2.2rc1
@
text
@@


1.1.1.2
log
@ISC BIND version 9.3.0. ok deraadt@@
@
text
@d2 1
a2 2
 * Copyright (C) 2004  Internet Systems Consortium, Inc. ("ISC")
 * Copyright (C) 1998-2003  Internet Software Consortium.
d8 8
a15 7
 * THE SOFTWARE IS PROVIDED "AS IS" AND ISC DISCLAIMS ALL WARRANTIES WITH
 * REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
 * AND FITNESS.  IN NO EVENT SHALL ISC BE LIABLE FOR ANY SPECIAL, DIRECT,
 * INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
 * LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE
 * OR OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
 * PERFORMANCE OF THIS SOFTWARE.
d18 1
a18 1
/* $ISC: result.c,v 1.90.2.9.2.13 2004/05/14 05:06:39 marka Exp $ */
a30 4
	/*
	 * Note that DNS_R_BADBITSTRING and DNS_R_BITSTRINGTOOLONG are
	 * deprecated.
	 */
d77 3
a79 3
	"RRSIG failed to verify",	       /* 40 DNS_R_SIGINVALID	     */
	"RRSIG has expired",		       /* 41 DNS_R_SIGEXPIRED	     */
	"RRSIG validity period has not begun", /* 42 DNS_R_SIGFUTURE	     */
d99 1
a99 1
	"no valid RRSIG",		       /* 59 DNS_R_NOVALIDSIG	     */
d101 1
a101 1
	"no valid NSEC",		       /* 60 DNS_R_NOVALIDNSEC	     */
d122 2
a123 2
	"not authoritative",		       /* 78 DNS_R_NOTAUTHORITATIVE  */
	"no valid KEY",		       	       /* 79 DNS_R_NOVALIDKEY	     */
d128 1
a128 23
	"expected a response",		       /* 83 DNS_R_EXPECTEDRESPONSE  */
	"no valid DS",			       /* 84 DNS_R_NOVALIDDS	     */

	"NS is an address",		       /* 85 DNS_R_NSISADDRESS	     */
	"received FORMERR",		       /* 86 DNS_R_REMOTEFORMERR     */
	"truncated TCP response",	       /* 87 DNS_R_TRUNCATEDTCP	     */
	"lame server detected",		       /* 88 DNS_R_LAME		     */
	"unexpected RCODE",		       /* 89 DNS_R_UNEXPECTEDRCODE   */

	"unexpected OPCODE",		       /* 90 DNS_R_UNEXPECTEDOPCODE  */
	"chase DS servers",		       /* 91 DNS_R_CHASEDSSERVERS    */
	"empty name",			       /* 92 DNS_R_EMPTYNAME	     */
	"empty wild",			       /* 93 DNS_R_EMPTYWILD	     */
	"bad bitmap",			       /* 94 DNS_R_BADBITMAP	     */

	"from wildcard",		       /* 95 DNS_R_FROMWILDCARD	     */
	"bad owner name (check-names)",	       /* 96 DNS_R_BADOWNERNAME	     */
	"bad name (check-names)",	       /* 97 DNS_R_BADNAME	     */
	"dynamic zone",			       /* 98 DNS_R_DYNAMIC	     */
	"unknown command",		       /* 99 DNS_R_UNKNOWNCOMMAND    */

	"must-be-secure",		       /* 100 DNS_R_MUSTBESECURE     */
	"covering NSEC record returned"	       /* 101 DNS_R_COVERINGNSEC     */
d216 1
a216 1
	/* case DNS_R_BADBITSTRING: deprecated */
d223 1
a223 1
	/* case DNS_R_BITSTRINGTOOLONG: deprecated */
@


1.1.1.3
log
@ISC BIND release 9.4.2
@
text
@d2 1
a2 1
 * Copyright (C) 2004, 2005  Internet Systems Consortium, Inc. ("ISC")
d18 1
a18 3
/* $ISC: result.c,v 1.115.10.7 2005/06/17 02:04:31 marka Exp $ */

/*! \file */
d29 3
a31 3
	"label too long",		       /*%< 0 DNS_R_LABELTOOLONG */
	"bad escape",			       /*%< 1 DNS_R_BADESCAPE */
	/*!
d35 120
a154 122
	"bad bitstring",		       /*%< 2 DNS_R_BADBITSTRING */
	"bitstring too long",		       /*%< 3 DNS_R_BITSTRINGTOOLONG */
	"empty label",			       /*%< 4 DNS_R_EMPTYLABEL */

	"bad dotted quad",		       /*%< 5 DNS_R_BADDOTTEDQUAD */
	"invalid NS owner name (wildcard)",    /*%< 6 DNS_R_INVALIDNS */
	"unknown class/type",		       /*%< 7 DNS_R_UNKNOWN */
	"bad label type",		       /*%< 8 DNS_R_BADLABELTYPE */
	"bad compression pointer",	       /*%< 9 DNS_R_BADPOINTER */

	"too many hops",		       /*%< 10 DNS_R_TOOMANYHOPS */
	"disallowed (by application policy)",  /*%< 11 DNS_R_DISALLOWED */
	"extra input text",		       /*%< 12 DNS_R_EXTRATOKEN */
	"extra input data",		       /*%< 13 DNS_R_EXTRADATA */
	"text too long",		       /*%< 14 DNS_R_TEXTTOOLONG */

	"not at top of zone",		       /*%< 15 DNS_R_NOTZONETOP */
	"syntax error",			       /*%< 16 DNS_R_SYNTAX */
	"bad checksum",			       /*%< 17 DNS_R_BADCKSUM */
	"bad IPv6 address",		       /*%< 18 DNS_R_BADAAAA */
	"no owner",			       /*%< 19 DNS_R_NOOWNER */

	"no ttl",			       /*%< 20 DNS_R_NOTTL */
	"bad class",			       /*%< 21 DNS_R_BADCLASS */
	"name too long",		       /*%< 22 DNS_R_NAMETOOLONG */
	"partial match",		       /*%< 23 DNS_R_PARTIALMATCH */
	"new origin",			       /*%< 24 DNS_R_NEWORIGIN */

	"unchanged",			       /*%< 25 DNS_R_UNCHANGED */
	"bad ttl",			       /*%< 26 DNS_R_BADTTL */
	"more data needed/to be rendered",     /*%< 27 DNS_R_NOREDATA */
	"continue",			       /*%< 28 DNS_R_CONTINUE */
	"delegation",			       /*%< 29 DNS_R_DELEGATION */

	"glue",				       /*%< 30 DNS_R_GLUE */
	"dname",			       /*%< 31 DNS_R_DNAME */
	"cname",			       /*%< 32 DNS_R_CNAME */
	"bad database",			       /*%< 33 DNS_R_BADDB */
	"zonecut",			       /*%< 34 DNS_R_ZONECUT */

	"bad zone",			       /*%< 35 DNS_R_BADZONE */
	"more data",			       /*%< 36 DNS_R_MOREDATA */
	"up to date",			       /*%< 37 DNS_R_UPTODATE */
	"tsig verify failure",		       /*%< 38 DNS_R_TSIGVERIFYFAILURE */
	"tsig indicates error",		       /*%< 39 DNS_R_TSIGERRORSET */

	"RRSIG failed to verify",	       /*%< 40 DNS_R_SIGINVALID */
	"RRSIG has expired",		       /*%< 41 DNS_R_SIGEXPIRED */
	"RRSIG validity period has not begun", /*%< 42 DNS_R_SIGFUTURE */
	"key is unauthorized to sign data",    /*%< 43 DNS_R_KEYUNAUTHORIZED */
	"invalid time",			       /*%< 44 DNS_R_INVALIDTIME */

	"expected a TSIG or SIG(0)",	       /*%< 45 DNS_R_EXPECTEDTSIG */
	"did not expect a TSIG or SIG(0)",     /*%< 46 DNS_R_UNEXPECTEDTSIG */
	"TKEY is unacceptable",		       /*%< 47 DNS_R_INVALIDTKEY */
	"hint",				       /*%< 48 DNS_R_HINT */
	"drop",				       /*%< 49 DNS_R_DROP */

	"zone not loaded",		       /*%< 50 DNS_R_NOTLOADED */
	"ncache nxdomain",		       /*%< 51 DNS_R_NCACHENXDOMAIN */
	"ncache nxrrset",		       /*%< 52 DNS_R_NCACHENXRRSET */
	"wait",				       /*%< 53 DNS_R_WAIT */
	"not verified yet",		       /*%< 54 DNS_R_NOTVERIFIEDYET */

	"no identity",			       /*%< 55 DNS_R_NOIDENTITY */
	"no journal",			       /*%< 56 DNS_R_NOJOURNAL */
	"alias",			       /*%< 57 DNS_R_ALIAS */
	"use TCP",			       /*%< 58 DNS_R_USETCP */
	"no valid RRSIG",		       /*%< 59 DNS_R_NOVALIDSIG */

	"no valid NSEC",		       /*%< 60 DNS_R_NOVALIDNSEC */
	"not insecure",			       /*%< 61 DNS_R_NOTINSECURE */
	"unknown service",		       /*%< 62 DNS_R_UNKNOWNSERVICE */
	"recoverable error occurred",	       /*%< 63 DNS_R_RECOVERABLE */
	"unknown opt attribute record",	       /*%< 64 DNS_R_UNKNOWNOPT */

	"unexpected message id",	       /*%< 65 DNS_R_UNEXPECTEDID */
	"seen include file",		       /*%< 66 DNS_R_SEENINCLUDE */
	"not exact",		       	       /*%< 67 DNS_R_NOTEXACT */
	"address blackholed",	       	       /*%< 68 DNS_R_BLACKHOLED */
	"bad algorithm",		       /*%< 69 DNS_R_BADALG */

	"invalid use of a meta type",	       /*%< 70 DNS_R_METATYPE */
	"CNAME and other data",		       /*%< 71 DNS_R_CNAMEANDOTHER */
	"multiple RRs of singleton type",      /*%< 72 DNS_R_SINGLETON */
	"hint nxrrset",			       /*%< 73 DNS_R_HINTNXRRSET */
	"no master file configured",	       /*%< 74 DNS_R_NOMASTERFILE */

	"unknown protocol",		       /*%< 75 DNS_R_UNKNOWNPROTO */
	"clocks are unsynchronized",	       /*%< 76 DNS_R_CLOCKSKEW */
	"IXFR failed",			       /*%< 77 DNS_R_BADIXFR */
	"not authoritative",		       /*%< 78 DNS_R_NOTAUTHORITATIVE */
	"no valid KEY",		       	       /*%< 79 DNS_R_NOVALIDKEY */

	"obsolete",			       /*%< 80 DNS_R_OBSOLETE */
	"already frozen",		       /*%< 81 DNS_R_FROZEN */
	"unknown flag",			       /*%< 82 DNS_R_UNKNOWNFLAG */
	"expected a response",		       /*%< 83 DNS_R_EXPECTEDRESPONSE */
	"no valid DS",			       /*%< 84 DNS_R_NOVALIDDS */

	"NS is an address",		       /*%< 85 DNS_R_NSISADDRESS */
	"received FORMERR",		       /*%< 86 DNS_R_REMOTEFORMERR */
	"truncated TCP response",	       /*%< 87 DNS_R_TRUNCATEDTCP */
	"lame server detected",		       /*%< 88 DNS_R_LAME */
	"unexpected RCODE",		       /*%< 89 DNS_R_UNEXPECTEDRCODE */

	"unexpected OPCODE",		       /*%< 90 DNS_R_UNEXPECTEDOPCODE */
	"chase DS servers",		       /*%< 91 DNS_R_CHASEDSSERVERS */
	"empty name",			       /*%< 92 DNS_R_EMPTYNAME */
	"empty wild",			       /*%< 93 DNS_R_EMPTYWILD */
	"bad bitmap",			       /*%< 94 DNS_R_BADBITMAP */

	"from wildcard",		       /*%< 95 DNS_R_FROMWILDCARD */
	"bad owner name (check-names)",	       /*%< 96 DNS_R_BADOWNERNAME */
	"bad name (check-names)",	       /*%< 97 DNS_R_BADNAME */
	"dynamic zone",			       /*%< 98 DNS_R_DYNAMIC */
	"unknown command",		       /*%< 99 DNS_R_UNKNOWNCOMMAND */

	"must-be-secure",		       /*%< 100 DNS_R_MUSTBESECURE */
	"covering NSEC record returned",       /*%< 101 DNS_R_COVERINGNSEC */
	"MX is an address",		       /*%< 102 DNS_R_MXISADDRESS */
	"duplicate query"		       /*%< 103 DNS_R_DUPLICATE */
d158 17
a174 17
	"NOERROR",				/*%< 0 DNS_R_NOEROR */
	"FORMERR",				/*%< 1 DNS_R_FORMERR */
	"SERVFAIL",				/*%< 2 DNS_R_SERVFAIL */
	"NXDOMAIN",				/*%< 3 DNS_R_NXDOMAIN */
	"NOTIMP",				/*%< 4 DNS_R_NOTIMP */

	"REFUSED",				/*%< 5 DNS_R_REFUSED */
	"YXDOMAIN",				/*%< 6 DNS_R_YXDOMAIN */
	"YXRRSET",				/*%< 7 DNS_R_YXRRSET */
	"NXRRSET",				/*%< 8 DNS_R_NXRRSET */
	"NOTAUTH",				/*%< 9 DNS_R_NOTAUTH */

	"NOTZONE",				/*%< 10 DNS_R_NOTZONE */
	"<rcode 11>",				/*%< 11 has no macro */
	"<rcode 12>",				/*%< 12 has no macro */
	"<rcode 13>",				/*%< 13 has no macro */
	"<rcode 14>",				/*%< 14 has no macro */
d176 2
a177 2
	"<rcode 15>",				/*%< 15 has no macro */
	"BADVERS",				/*%< 16 DNS_R_BADVERS */
@


