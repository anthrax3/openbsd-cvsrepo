head	1.19;
access;
symbols
	OPENBSD_3_5:1.16.0.4
	OPENBSD_3_5_BASE:1.16
	OPENBSD_3_4:1.16.0.2
	OPENBSD_3_4_BASE:1.16
	OPENBSD_3_3:1.15.0.2
	OPENBSD_3_3_BASE:1.15
	OPENBSD_3_2:1.10.0.6
	OPENBSD_3_2_BASE:1.10
	OPENBSD_3_1:1.10.0.4
	OPENBSD_3_1_BASE:1.10
	OPENBSD_3_0:1.10.0.2
	OPENBSD_3_0_BASE:1.10
	OPENBSD_2_9_BASE:1.7
	OPENBSD_2_9:1.7.0.6
	OPENBSD_2_8:1.7.0.4
	OPENBSD_2_8_BASE:1.7
	OPENBSD_2_7:1.7.0.2
	OPENBSD_2_7_BASE:1.7
	OPENBSD_2_6:1.6.0.2
	OPENBSD_2_6_BASE:1.6
	OPENBSD_2_5:1.3.0.2
	OPENBSD_2_5_BASE:1.3
	OPENBSD_2_4:1.2.0.2
	OPENBSD_2_4_BASE:1.2;
locks; strict;
comment	@.\" @;


1.19
date	2004.04.28.06.57.41;	author henning;	state dead;
branches;
next	1.18;

1.18
date	2004.04.03.10.26.15;	author jmc;	state Exp;
branches;
next	1.17;

1.17
date	2004.04.03.10.15.37;	author jmc;	state Exp;
branches;
next	1.16;

1.16
date	2003.06.25.09.27.57;	author jmc;	state Exp;
branches;
next	1.15;

1.15
date	2003.03.18.23.52.23;	author avsm;	state Exp;
branches;
next	1.14;

1.14
date	2003.03.18.23.43.27;	author avsm;	state Exp;
branches;
next	1.13;

1.13
date	2003.03.15.21.01.50;	author jmc;	state Exp;
branches;
next	1.12;

1.12
date	2003.02.01.16.29.52;	author jmc;	state Exp;
branches;
next	1.11;

1.11
date	2003.01.17.19.25.01;	author deraadt;	state Exp;
branches;
next	1.10;

1.10
date	2001.10.01.20.13.18;	author jakob;	state Exp;
branches;
next	1.9;

1.9
date	2001.06.24.22.11.48;	author niklas;	state Exp;
branches;
next	1.8;

1.8
date	2001.06.24.06.05.11;	author beck;	state Exp;
branches;
next	1.7;

1.7
date	99.11.15.03.41.40;	author aaron;	state Exp;
branches;
next	1.6;

1.6
date	99.09.23.04.12.10;	author alex;	state Exp;
branches;
next	1.5;

1.5
date	99.05.12.13.26.52;	author aaron;	state Exp;
branches;
next	1.4;

1.4
date	99.04.21.21.27.48;	author aaron;	state Exp;
branches;
next	1.3;

1.3
date	98.11.24.03.06.38;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	98.08.18.03.53.07;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	98.08.18.03.43.34;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.19
log
@It is a big pleasure for me to remove this highe pile of gunk from the tree.
dhclient, dhcrelay and dhcpd have been factored out and cleaned up big time,
dhcpd and dhcrelay chroot itself, drop privileges and lock their bpf
descriptors after applyiing read/write filters now, and this pile of ISC code
with it's lovely char ServerName; /* Name of Server */ constructs is
obsolete.
theo ok, I owe you some beers for this pleasure
@
text
@.\"	$OpenBSD: dhcpd.8,v 1.18 2004/04/03 10:26:15 jmc Exp $
.\"
.\" Copyright (c) 1995, 1996 The Internet Software Consortium.
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\"
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of The Internet Software Consortium nor the names
.\"    of its contributors may be used to endorse or promote products derived
.\"    from this software without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE INTERNET SOFTWARE CONSORTIUM AND
.\" CONTRIBUTORS ``AS IS'' AND ANY EXPRESS OR IMPLIED WARRANTIES,
.\" INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF
.\" MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
.\" DISCLAIMED.  IN NO EVENT SHALL THE INTERNET SOFTWARE CONSORTIUM OR
.\" CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
.\" SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
.\" LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF
.\" USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
.\" ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,
.\" OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT
.\" OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\" This software has been written for the Internet Software Consortium
.\" by Ted Lemon <mellon@@fugue.com> in cooperation with Vixie
.\" Enterprises.  To learn more about the Internet Software Consortium,
.\" see ``http://www.isc.org/''.  To learn more about Vixie
.\" Enterprises, see ``http://www.vix.com''.
.\"
.Dd January 1, 1995
.Dt DHCPD 8
.Os
.Sh NAME
.Nm dhcpd
.Nd Dynamic Host Configuration Protocol Server
.Sh SYNOPSIS
.Nm dhcpd
.Op Fl p Ar port
.Op Fl f
.Op Fl d
.Op Fl q
.Op Fl cf Ar config-file
.Op Fl lf Ar lease-file
.Bk -words
.Op Ar if0 Op Ar ... ifN
.Ek
.Sh DESCRIPTION
The Internet Software Consortium DHCP Server,
.Nm dhcpd ,
implements the Dynamic Host Configuration Protocol (DHCP) and the
Internet Bootstrap Protocol (BOOTP).
DHCP allows hosts on a TCP/IP network to request and be assigned IP addresses,
and also to discover information about the network to which they are attached.
BOOTP provides similar functionality, with certain restrictions.
.Sh OPERATION
The DHCP protocol allows a host which is unknown to the network
administrator to be automatically assigned a new IP address out of a
pool of IP addresses for its network.
In order for this to work, the network administrator allocates address pools
in each subnet and enters them into the
.Xr dhcpd.conf 5
file.
.Pp
On startup,
.Nm
reads the
.Pa dhcpd.conf
file and stores a list of available addresses on each subnet in memory.
When a client requests an address using the DHCP protocol,
.Nm
allocates an address for it.
Each client is assigned a lease, which expires after an amount of time
chosen by the administrator (by default, one day).
Before leases expire, the clients to which leases are assigned are expected
to renew them in order to continue to use the addresses.
Once a lease has expired, the client to which that lease was assigned is no
longer permitted to use the leased IP address.
.Pp
In order to keep track of leases across system reboots and server restarts,
.Nm
keeps a list of leases it has assigned in the
.Xr dhcpd.leases 5
file.
Before
.Nm
grants a lease to a host, it records the lease in this file and makes sure
that the contents of the file are flushed to disk.
This ensures that even in the event of a system crash,
.Nm
will not forget about a lease that it has assigned.
On startup, after reading the
.Pa dhcpd.conf
file,
.Nm
reads the
.Pa dhcpd.leases
file to refresh its memory about what leases have been assigned.
.Pp
New leases are appended to the end of the
.Pa dhcpd.leases
file.
In order to prevent the file from becoming arbitrarily large,
from time to time
.Nm
creates a new
.Pa dhcpd.leases
file from its in-core lease database.
Once this file has been written to disk, the old file is renamed
.Pa dhcpd.leases~ ,
and the new file is renamed
.Pa dhcpd.leases .
If the system crashes in the middle of this process, whichever
.Pa dhcpd.leases
file remains will contain all the lease information, so there is no need for
a special crash recovery process.
.Pp
BOOTP support is also provided by this server.
Unlike DHCP, the BOOTP protocol does not provide a protocol for recovering
dynamically-assigned addresses once they are no longer needed.
It is still possible to dynamically assign addresses to BOOTP clients, but
some administrative process for reclaiming addresses is required.
By default, leases are granted to BOOTP clients in perpetuity, although
the network administrator may set an earlier cutoff date or a shorter
lease length for BOOTP leases if that makes sense.
.Pp
BOOTP clients may also be served in the old standard way, which is
simply to provide a declaration in the
.Pa dhcpd.conf
file for each BOOTP client, permanently assigning an address to each client.
.Pp
Whenever changes are made to the
.Pa dhcpd.conf
file,
.Nm
must be restarted.
To restart
.Nm dhcpd ,
send a SIGTERM (signal 15) to the process ID contained in
.Pa /var/run/dhcpd.pid ,
and then re-invoke
.Nm dhcpd .
Because the DHCP server database is not as lightweight as a BOOTP database,
.Nm
does not automatically restart itself when it sees a change to the
.Pa dhcpd.conf
file.
.Pp
DHCP traffic always bypasses IPsec.
Otherwise there could be situations when a server has an IPsec SA for the
client and sends replies over that,
which a newly booted client would not be able to grasp.
.Sh COMMAND LINE
The names of the network interfaces on which
.Nm
should listen for broadcasts may be specified on the command line.
This should be done on systems where
.Nm
is unable to identify non-broadcast interfaces,
but should not be required on other systems.
If no interface names are specified on the command line,
.Nm
will identify all network interfaces which are up, eliminating non-broadcast
interfaces if possible, and listen for DHCP broadcasts on each interface.
.Pp
If
.Nm
should listen on a port other than the standard (port 67), the
.Fl p
flag may used.
It should be followed by the UDP port number on which
.Nm
should listen.
This is mostly useful for debugging purposes.
If the
.Fl p
flag is specified, the server will transmit responses to clients at a
port number that is one greater than the one specified \- i.e., if you
specify
.Fl p
67, then the server will listen on port 67 and transmit to port 68.
Datagrams that must go through relay agents are sent to the port
number specified with the
.Fl p
flag.
If you wish to use alternate port numbers, you must configure
any relay agents you are using to use the same alternate port numbers.
.Pp
To run
.Nm
as a foreground process, rather than allowing it to run as a daemon in the
background, the
.Fl f
flag should be specified.
This is useful when running
.Nm
under a debugger, or when running it out of inittab on System V systems.
.Pp
To have
.Nm
log to
.Ar stderr ,
the
.Fl d
flag should be specified.
This can be useful for debugging, and also at sites where a complete log of
all dhcp activity must be kept, but
.Xr syslogd 8
is not reliable or otherwise cannot be used.
Normally,
.Nm
will log all output using the
.Xr syslog 3
function with the log facility set to LOG_DAEMON.
.Pp
.Nm
can be made to use an alternate configuration file with the
.Fl cf
flag, or an alternate lease file with the
.Fl lf
flag.
Because of the importance of using the same lease database at all times when
running
.Nm
in production, these options should be used
.Em only
for testing lease files or database files in a non-production environment.
.Pp
To avoid printing out the entire copyright message on start-up, the
.Fl q
flag should be specified.
.Sh CONFIGURATION
The syntax of the
.Xr dhcpd.conf 5
file is discussed separately.
This section should be used as an overview of the configuration process,
and the
.Xr dhcpd.conf 5
documentation should be consulted for detailed reference information.
.Bl -tag -width 3n
.It Subnets
.Nm
needs to know the subnet numbers and netmasks of all subnets for
which it will be providing service.
In addition, in order to dynamically allocate addresses, it must be assigned
one or more ranges of addresses on each subnet which it can in turn assign
to client hosts as they boot.
Thus, a very simple configuration providing DHCP support might look like this:
.Bd -literal -offset indent
subnet 239.252.197.0 netmask 255.255.255.0 {
  range 239.252.197.10 239.252.197.250;
}
.Ed
.Pp
Multiple address ranges may be specified like this:
.Bd -literal -offset indent
subnet 239.252.197.0 netmask 255.255.255.0 {
  range 239.252.197.10 239.252.197.107;
  range 239.252.197.113 239.252.197.250;
}
.Ed
.Pp
If a subnet will only be provided with BOOTP service and no dynamic
address assignment, the range clause can be left out entirely, but the
subnet statement must appear.
.It Lease Lengths
DHCP leases can be assigned almost any length from zero seconds to infinity.
What lease length makes sense for any given subnet, or for any given
installation, will vary depending on the kinds of hosts being served.
.Pp
For example, in an office environment where systems are added from
time to time and removed from time to time, but move relatively
infrequently, it might make sense to allow lease times of a month of more.
In a final test environment on a manufacturing floor, it may make more sense
to assign a maximum lease length of 30 minutes \- enough time to go through a
simple test procedure on a network appliance before packaging it up for
delivery.
.Pp
It is possible to specify two lease lengths: the default length that
will be assigned if a client doesn't ask for any particular lease
length, and a maximum lease length.
These are specified as clauses to the subnet command:
.Bd -literal -offset indent
subnet 239.252.197.0 netmask 255.255.255.0 {
  range 239.252.197.10 239.252.197.107;
  default-lease-time 600;
  max-lease-time 7200;
}
.Ed
.Pp
This particular subnet declaration specifies a default lease time of
600 seconds (ten minutes), and a maximum lease time of 7200 seconds
(two hours).
Other common values would be 86400 (one day), 604800 (one week)
and 2592000 (30 days).
.Pp
Each subnet need not have the same lease \- in the case of an office
environment and a manufacturing environment served by the same DHCP
server, it might make sense to have widely disparate values for
default and maximum lease times on each subnet.
.It BOOTP Support
Each BOOTP client must be explicitly declared in the
.Xr dhcpd.conf 5
file.
A very basic client declaration will specify the client network interface's
hardware address and the IP address to assign to that client.
If the client needs to be able to load a boot file from the server,
that file's name must be specified.
A simple BOOTP client declaration might look like this:
.Bd -literal -offset indent
host haagen {
  hardware ethernet 08:00:2b:4c:59:23;
  fixed-address 239.252.197.9;
  filename "/tftpboot/haagen.boot";
}
.Ed
.It Options
DHCP (and also BOOTP with Vendor Extensions) provides a mechanism
whereby the server can provide the client with information about how
to configure its network interface (e.g., subnet mask), and also how
the client can access various network services (e.g., DNS, IP routers,
and so on).
.Pp
These options can be specified on a per-subnet basis, and, for BOOTP
clients, also on a per-client basis.
In the event that a BOOTP client declaration specifies options that are
also specified in its subnet declaration, the options specified in the
client declaration take precedence.
A reasonably complete DHCP configuration might look something like this:
.Bd -literal -offset indent
subnet 239.252.197.0 netmask 255.255.255.0 {
  range 239.252.197.10 239.252.197.250;
  default-lease-time 600 max-lease-time 7200;
  option subnet-mask 255.255.255.0;
  option broadcast-address 239.252.197.255;
  option routers 239.252.197.1;
  option domain-name-servers 239.252.197.2, 239.252.197.3;
  option domain-name "isc.org";
}
.Ed
.Pp
A BOOTP host on that subnet that needs to be in a different domain and
use a different name server might be declared as follows:
.Bd -literal -offset indent
host haagen {
  hardware ethernet 08:00:2b:4c:59:23;
  fixed-address 239.252.197.9;
  filename "/tftpboot/haagen.boot";
  option domain-name-servers 192.5.5.1;
  option domain-name "vix.com";
}
.Ed
.El
.Pp
A more complete description of the
.Pa dhcpd.conf
file syntax is provided in
.Xr dhcpd.conf 5 .
.Sh FILES
.Bl -tag -width "/var/db/dhcpd.leases~  " -compact
.It /etc/dhcpd.conf
DHCPD configuration file.
.It /var/db/dhcpd.leases
Current DHCPD lease file.
.It /var/db/dhcpd.leases~
Backup DHCPD lease file.
.It /var/run/dhcpd.pid
DHCPD PID.
.El
.Sh SEE ALSO
.Xr dhcpd.conf 5 ,
.Xr dhcpd.leases 5 ,
.Xr dhclient 8 ,
.Xr dhcp 8 ,
.Xr dhcrelay 8 ,
.Xr pxeboot 8
.Sh AUTHORS
.Nm
was written by
.An Ted Lemon Aq mellon@@vix.com
under a contract with Vixie Labs.
Funding for this project was provided by the Internet Software Corporation.
Information about the Internet Software Consortium can be found at
.Pa http://www.isc.org/ .
.Sh BUGS
We realize that it would be nice if one could send a SIGHUP to the server
and have it reload the database.
This is not technically impossible, but it would require a great deal of work,
our resources are extremely limited, and they can be better spent elsewhere.
So please don't complain about this on the mailing list unless you're prepared
to fund a project to implement this feature, or prepared to do it yourself.
@


1.18
log
@remove a scad of .Pp's before displays, making postscript
output nicer;
@
text
@d1 1
a1 1
.\"	$OpenBSD: dhcpd.8,v 1.17 2004/04/03 10:15:37 jmc Exp $
@


1.17
log
@add pxeboot references to FILES and SEE ALSO;
ok deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: dhcpd.8,v 1.16 2003/06/25 09:27:57 jmc Exp $
a256 1
.Pp
a263 1
.Pp
a290 1
.Pp
a317 1
.Pp
a337 1
.Pp
a351 1
.Pp
@


1.16
log
@mdoc version of the dhcp pages;
from myself and pjanzen@@.

input and ok in dhclient-script.8 from krw@@
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d389 2
a390 1
.Xr dhcrelay 8
@


1.15
log
@missed a RUNDIR -> /var/run
@
text
@d1 1
a1 1
.\"	dhcpd.8
d38 27
a64 41
.TH dhcpd 8
.SH NAME
dhcpd - Dynamic Host Configuration Protocol Server
.SH SYNOPSIS
.B dhcpd
[
.B -p
.I port
]
[
.B -f
]
[
.B -d
]
[
.B -q
]
[
.B -cf
.I config-file
]
[
.B -lf
.I lease-file
]
[
.I if0
[
.I ...ifN
]
]
.SH DESCRIPTION
The Internet Software Consortium DHCP Server, dhcpd, implements the
Dynamic Host Configuration Protocol (DHCP) and the Internet Bootstrap
Protocol (BOOTP).  DHCP allows hosts on a TCP/IP network to request
and be assigned IP addresses, and also to discover information about
the network to which they are attached.  BOOTP provides similar
functionality, with certain restrictions.
.SH OPERATION
.PP
d67 65
a131 43
pool of IP addresses for its network.   In order for this to work, the
network administrator allocates address pools in each subnet and
enters them into the dhcpd.conf(5) file.
.PP
On startup, dhcpd reads the
.IR dhcpd.conf
file and stores a list of available addresses on each subnet in
memory.  When a client requests an address using the DHCP protocol,
dhcpd allocates an address for it.  Each client is assigned a lease,
which expires after an amount of time chosen by the administrator (by
default, one day).  Before leases expire, the clients to which leases
are assigned are expected to renew them in order to continue to use
the addresses.  Once a lease has expired, the client to which that
lease was assigned is no longer permitted to use the leased IP
address.
.PP
In order to keep track of leases across system reboots and server
restarts, dhcpd keeps a list of leases it has assigned in the
dhcpd.leases(5) file.   Before dhcpd grants a lease to a host, it
records the lease in this file and makes sure that the contents of the
file are flushed to disk.   This ensures that even in the event of a
system crash, dhcpd will not forget about a lease that it has
assigned.   On startup, after reading the dhcpd.conf file, dhcpd
reads the dhcpd.leases file to refresh its memory about what leases
have been assigned.
.PP
New leases are appended to the end of the dhcpd.leases
file.   In order to prevent the file from becoming arbitrarily large,
from time to time dhcpd creates a new dhcpd.leases file from its
in-core lease database.  Once this file has been written to disk, the
old file is renamed
.IR dhcpd.leases~ ,
and the new file is renamed dhcpd.leases.   If the system crashes in
the middle of this process, whichever dhcpd.leases file remains will
contain all the lease information, so there is no need for a special
crash recovery process.
.PP
BOOTP support is also provided by this server.  Unlike DHCP, the BOOTP
protocol does not provide a protocol for recovering
dynamically-assigned addresses once they are no longer needed.   It is
still possible to dynamically assign addresses to BOOTP clients, but
some administrative process for reclaiming addresses is required.   By
default, leases are granted to BOOTP clients in perpetuity, although
d134 49
a182 39
.PP
BOOTP clients may also be served in the old standard way, which is to
simply provide a declaration in the dhcpd.conf file for each
BOOTP client, permanently assigning an address to each client.
.PP
Whenever changes are made to the dhcpd.conf file, dhcpd must be
restarted.   To restart dhcpd, send a SIGTERM (signal 15) to the
process ID contained in
.IR /var/run/dhcpd.pid ,
and then re-invoke dhcpd.  Because the DHCP server database is not as
lightweight as a BOOTP database, dhcpd does not automatically restart
itself when it sees a change to the dhcpd.conf file.
.PP
Note: We get a lot of complaints about this.   We realize that it would
be nice if one could send a SIGHUP to the server and have it reload
the database.   This is not technically impossible, but it would
require a great deal of work, our resources are extremely limited, and
they can be better spent elsewhere.   So please don't complain about
this on the mailing list unless you're prepared to fund a project to
implement this feature, or prepared to do it yourself.
.PP
DHCP traffic always bypasses IPsec, otherwise there could be situations
when a server has an IPsec SA for the client, and sends replies over that,
which a potentially newly booted client cannot grasp.
.SH COMMAND LINE
.PP
The names of the network interfaces on which dhcpd should listen for
broadcasts may be specified on the command line.  This should be done
on systems where dhcpd is unable to identify non-broadcast interfaces,
but should not be required on other systems.  If no interface names
are specified on the command line dhcpd will identify all network
interfaces which are up, eliminating non-broadcast interfaces if
possible, and listen for DHCP broadcasts on each interface.
.PP
If dhcpd should listen on a port other than the standard (port 67),
the
.B -p
flag may used.  It should be followed by the udp port number on which
dhcpd should listen.  This is mostly useful for debugging purposes.
d184 1
a184 1
.B -p
d186 1
a186 1
port number that is one greater than the one specified - i.e., if you
d188 1
a188 1
.B -p
d192 3
a194 2
.B -p
flag - if you wish to use alternate port numbers, you must configure
d196 31
a226 17
.PP
To run dhcpd as a foreground process, rather than allowing it to run
as a daemon in the background, the
.B -f
flag should be specified.  This is useful when running dhcpd under a
debugger, or when running it out of inittab on System V systems.
.PP
To have dhcpd log to the standard error descriptor, specify the
.B -d
flag.  This can be useful for debugging, and also at sites where a
complete log of all dhcp activity must be kept but syslogd is not
reliable or otherwise cannot be used.   Normally, dhcpd will log all
output using the syslog(3) function with the log facility set to
LOG_DAEMON.
.PP
Dhcpd can be made to use an alternate configuration file with the
.B -cf
d228 36
a263 31
.B -lf
flag.   Because of the importance of using the same lease database at
all times when running dhcpd in production, these options should be
used \fBonly\fR for testing lease files or database files in a
non-production environment.
.PP
When starting dhcpd up from a system startup script (e.g., /etc/rc),
it may not be desirable to print out the entire copyright message on
startup.   To avoid printing this message, the
.B -q
flag may be specified.
.SH CONFIGURATION
The syntax of the dhcpd.conf(5) file is discussed separately.   This
section should be used as an overview of the configuration process,
and the dhcpd.conf(5) documentation should be consulted for detailed
reference information.
.PP
.SH Subnets
dhcpd needs to know the subnet numbers and netmasks of all subnets for
which it will be providing service.   In addition, in order to
dynamically allocate addresses, it must be assigned one or more ranges
of addresses on each subnet which it can in turn assign to client
hosts as they boot.   Thus, a very simple configuration providing DHCP
support might look like this:
.nf
.sp 1
	subnet 239.252.197.0 netmask 255.255.255.0 {
	  range 239.252.197.10 239.252.197.250;
        }
.fi
.PP
d265 8
a272 8
.nf
.sp 1
	subnet 239.252.197.0 netmask 255.255.255.0 {
	  range 239.252.197.10 239.252.197.107;
	  range 239.252.197.113 239.252.197.250;
	}
.fi
.PP
d276 5
a280 7
.PP
.SH Lease Lengths
DHCP leases can be assigned almost any length from zero seconds to
infinity.   What lease length makes sense for any given subnet, or for
any given installation, will vary depending on the kinds of hosts
being served.
.PP
d283 6
a288 6
infrequently, it might make sense to allow lease times of a month of
more.   In a final test environment on a manufacturing floor, it may
make more sense to assign a maximum lease length of 30 minutes -
enough time to go through a simple test procedure on a network
appliance before packaging it up for delivery.
.PP
d291 11
a301 11
length, and a maximum lease length.   These are specified as clauses
to the subnet command:
.nf
.sp 1
	subnet 239.252.197.0 netmask 255.255.255.0 {
	  range 239.252.197.10 239.252.197.107;
	  default-lease-time 600;
	  max-lease-time 7200;
	}
.fi
.PP
d304 5
a308 4
(two hours).   Other common values would be 86400 (one day), 604800
(one week) and 2592000 (30 days).
.PP
Each subnet need not have the same lease\(emin the case of an office
d312 18
a329 16
.SH BOOTP Support
Each BOOTP client must be explicitly declared in the dhcpd.conf
file.   A very basic client declaration will specify the client
network interface's hardware address and the IP address to assign to
that client.   If the client needs to be able to load a boot file from
the server, that file's name must be specified.   A simple bootp
client declaration might look like this:
.nf
.sp 1
	host haagen {
	  hardware ethernet 08:00:2b:4c:59:23;
	  fixed-address 239.252.197.9;
	  filename "/tftpboot/haagen.boot";
	}
.fi
.SH Options
d335 1
a335 1
.PP
d337 19
a355 19
clients, also on a per-client basis.   In the event that a BOOTP
client declaration specifies options that are also specified in its
subnet declaration, the options specified in the client declaration
take precedence.   An reasonably complete DHCP configuration might
look something like this:
.nf
.sp 1
	subnet 239.252.197.0 netmask 255.255.255.0 {
	  range 239.252.197.10 239.252.197.250;
	  default-lease-time 600 max-lease-time 7200;
	  option subnet-mask 255.255.255.0;
	  option broadcast-address 239.252.197.255;
	  option routers 239.252.197.1;
	  option domain-name-servers 239.252.197.2, 239.252.197.3;
	  option domain-name "isc.org";
	}
.fi
.PP
A bootp host on that subnet that needs to be in a different domain and
d357 39
a395 23
.nf
.sp 1
	host haagen {
	  hardware ethernet 08:00:2b:4c:59:23;
	  fixed-address 239.252.197.9;
	  filename "/tftpboot/haagen.boot";
	  option domain-name-servers 192.5.5.1;
	  option domain-name "vix.com";
	}
.fi
.PP
A more complete description of the dhcpd.conf file syntax is provided
in dhcpd.conf(5).
.SH FILES
.B /etc/dhcpd.conf, /var/db/dhcpd.leases, /var/run/dhcpd.pid,
.B /var/db/dhcpd.leases~.
.SH SEE ALSO
dhcpd.conf(5), dhcpd.leases(5), dhclient(8), dhcp(8), dhcrelay(8)
.SH AUTHOR
.B dhcpd(8)
was written by Ted Lemon <mellon@@vix.com>
under a contract with Vixie Labs.   Funding
for this project was provided by the Internet Software Corporation.
d397 8
a404 1
.B http://www.isc.org/.
@


1.14
log
@- expand DBDIR, ETCDIR, RUNDIR to the actual directories to make
  the man pages easier to read
- add dhcp(8) to SEE ALSO in dhcpd(8)
- rearrange SEE ALSO in section order as well as alphabetical in dhcpd(8)

ok millert@@, todd@@
@
text
@d134 1
a134 1
.IR RUNDIR/dhcpd.pid ,
@


1.13
log
@recoginzed -> recognized;
elimininating -> eliminating;

typos courtesy NetBSD (Igor Sobrado)
@
text
@d332 2
a333 2
.B ETCDIR/dhcpd.conf, DBDIR/dhcpd.leases, RUNDIR/dhcpd.pid,
.B DBDIR/dhcpd.leases~.
d335 1
a335 1
dhclient(8), dhcrelay(8), dhcpd.conf(5), dhcpd.leases(5)
@


1.12
log
@typos;
chat(8): removed reference to uucico(8)

ok deraadt@@
@
text
@d157 1
a157 1
interfaces which are up, elimininating non-broadcast interfaces if
@


1.11
log
@seperate[d][ly] -> separate[d][ly]; alan@@alanday.com
@
text
@d147 1
a147 1
DHCP traffic always bypass IPsec, otherwise there can come up situations
d263 1
a263 1
	|
@


1.10
log
@change broken url
@
text
@d207 1
a207 1
The syntax of the dhcpd.conf(5) file is discussed seperately.   This
@


1.9
log
@Old M of mine, uncovered by the recent dhcpd update:  Bypass IPsec in all
DHCP traffic.
@
text
@d36 1
a36 1
.\" see ``http://www.isc.org/isc''.  To learn more about Vixie
d342 1
a342 1
.B http://www.isc.org/isc.
@


1.8
log
@dhcp 2.0pl5 merge/cleanup/deadcode slashing. still needs more eyes on this
but appears to work better than what's been in-tree before for dealing with
stupid dhcp servers.
@
text
@d146 4
@


1.7
log
@Consistify DHCP man page titles somewhat; d@@, sebastion@@irelandmail.com
@
text
@d40 1
a40 1
dhcpd - Dynamic Host Configuration Protocol (DHCP)Server
a76 7
.SH SYSTEM REQUIREMENTS
There \fPmust\fR be a /etc/dhcpd.conf file.   There \fBmust\fR
be a /var/db/dhcpd.leases file.   This file can initially be created by
typing \fItouch /var/db/dhcpd.leases\fR.   You must have the Berkeley
Packet Filter (bpf) configured in your kernel.   You must have
at least one /dev/bpf* file for each broadcast network interface that
is attached to your system.
d119 2
a120 2
protocol does not provides a protocol for recovering
dynamically assigned addresses once they are no longer needed.   It is
d134 1
a134 1
.IR /var/run/dhcpd.pid ,
d153 1
a153 1
interfaces which are up, eliminating non-broadcast interfaces if
d161 12
d203 1
a203 1
The syntax of the dhcpd.conf(5) file is discussed separately.   This
d287 1
a287 1
DHCP (and also BOOTP with Vendor Extensions) provide a mechanism
d328 2
a329 2
.B /etc/dhcpd.conf, /var/db/dhcpd.leases, /var/run/dhcpd.pid,
.B /var/db/dhcpd.leases~.
d331 1
a331 1
dhclient(8), dhcrelay(8), dhcpd.conf(5), dhcpd.leases(5), bpf(4)
@


1.6
log
@Typo fixes.
@
text
@d40 1
a40 1
dhcpd - Dynamic Host Configuration Protocol Server
@


1.5
log
@grammar police: do not hyphenate compound words that act as adjectives if the
first word ends in -ly

i.e., fully-qualified, newly-created, globally-visible, etc. are wrong
@
text
@d160 1
a160 1
interfaces which are up, elimininating non-broadcast interfaces if
@


1.4
log
@seperate -> separate, people really need to learn how to spell this word
@
text
@d127 1
a127 1
dynamically-assigned addresses once they are no longer needed.   It is
@


1.3
log
@grammer
@
text
@d198 1
a198 1
The syntax of the dhcpd.conf(5) file is discussed seperately.   This
@


1.2
log
@openbsd
@
text
@d126 1
a126 1
protocol does not provide a protocol for recovering
@


1.1
log
@ISC dhcp, needs security audit for sure
@
text
@d81 1
a81 1
Packet Filter (bpf) configured in your NetBSD kernel.   You must have
@

