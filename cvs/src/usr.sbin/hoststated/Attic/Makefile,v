head	1.16;
access;
symbols
	OPENBSD_4_2:1.12.0.2
	OPENBSD_4_2_BASE:1.12
	OPENBSD_4_1:1.11.0.2
	OPENBSD_4_1_BASE:1.11;
locks; strict;
comment	@# @;


1.16
date	2007.12.07.17.27.07;	author deraadt;	state dead;
branches;
next	1.15;

1.15
date	2007.11.26.09.38.25;	author reyk;	state Exp;
branches;
next	1.14;

1.14
date	2007.09.25.08.24.26;	author pyr;	state Exp;
branches;
next	1.13;

1.13
date	2007.09.10.11.59.22;	author reyk;	state Exp;
branches;
next	1.12;

1.12
date	2007.05.29.17.12.04;	author reyk;	state Exp;
branches;
next	1.11;

1.11
date	2007.02.26.19.35.43;	author reyk;	state Exp;
branches;
next	1.10;

1.10
date	2007.02.25.18.15.37;	author deraadt;	state Exp;
branches;
next	1.9;

1.9
date	2007.02.23.00.28.06;	author deraadt;	state Exp;
branches;
next	1.8;

1.8
date	2007.02.22.03.32.39;	author reyk;	state Exp;
branches;
next	1.7;

1.7
date	2007.02.03.20.24.21;	author reyk;	state Exp;
branches;
next	1.6;

1.6
date	2007.01.30.15.11.51;	author reyk;	state Exp;
branches;
next	1.5;

1.5
date	2007.01.29.14.23.31;	author pyr;	state Exp;
branches;
next	1.4;

1.4
date	2007.01.09.02.32.58;	author reyk;	state Exp;
branches;
next	1.3;

1.3
date	2007.01.09.00.45.32;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	2007.01.08.13.37.26;	author reyk;	state Exp;
branches;
next	1.1;

1.1
date	2006.12.16.11.45.07;	author reyk;	state Exp;
branches;
next	;


desc
@@


1.16
log
@hoststated/hoststatectl get repository copied (and de-tagged) into
relayd/relayctl.  This is a more suitable place for a daemon that has
grown out of it's initial roots of "monitoring and redirecting services
at various layers", into one that is "a full featured proxy, which
happens to know what is up/down"
@
text
@#	$OpenBSD: Makefile,v 1.15 2007/11/26 09:38:25 reyk Exp $

PROG=		hoststated
SRCS=		parse.y log.c control.c buffer.c imsg.c ssl.c ssl_privsep.c \
		hoststated.c pfe.c pfe_filter.c hce.c relay.c relay_udp.c \
		carp.c check_icmp.c check_tcp.c check_script.c name2id.c
MAN=		hoststated.8 hoststated.conf.5

LDADD=		-levent -lssl -lcrypto
DPADD=		${LIBEVENT} ${LIBSSL} ${LIBCRYPTO}
CFLAGS+=	-Wall -I${.CURDIR}
CFLAGS+=	-Wstrict-prototypes -Wmissing-prototypes
CFLAGS+=	-Wmissing-declarations
CFLAGS+=	-Wshadow -Wpointer-arith -Wcast-qual
CFLAGS+=	-Wsign-compare -Wbounded
CLEANFILES+=	y.tab.h

.include <bsd.prog.mk>
@


1.15
log
@allow to add labels to protocol actions, they will be printed in http
error pages and can be used to refer to additional information.

ok pyr@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.14 2007/09/25 08:24:26 pyr Exp $
@


1.14
log
@Introduce two new functions to be able to load certificates while
already chrooted and with privileges dropped.
This is the very first step in being able to reload a
layer 7 configuration.

not ok reyk who's away but should be glad to see this in.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.13 2007/09/10 11:59:22 reyk Exp $
d6 1
a6 1
		carp.c check_icmp.c check_tcp.c check_script.c
@


1.13
log
@add support for relaying DNS traffic (with a little bit of packet
header randomization). this adds an infrastructure to support
UDP-based protocols.

ok gilles@@, tested by some
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.12 2007/05/29 17:12:04 reyk Exp $
d4 3
a6 3
SRCS=		parse.y log.c control.c buffer.c imsg.c hoststated.c \
		ssl.c pfe.c pfe_filter.c hce.c relay.c relay_udp.c carp.c \
		check_icmp.c check_tcp.c check_script.c
@


1.12
log
@add a new check method which allows to run external scripts/programs
for custom evaluations.

pyr agrees to put it in now but to do some improvements of the timeout
handling later.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.11 2007/02/26 19:35:43 reyk Exp $
d4 2
a5 2
SRCS=		parse.y log.c control.c buffer.c imsg.c hoststated.c	\
		ssl.c pfe.c pfe_filter.c hce.c relay.c carp.c 		\
@


1.11
log
@re-enable the -W flags except -Werror which behaves differently with
different gcc versions (it previously broke the tree on sparc with gcc
2.95 when compiling sys/hash.h).

-Werror removal suggested by deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.10 2007/02/25 18:15:37 deraadt Exp $
d5 2
a6 2
		ssl.c pfe.c pfe_filter.c hce.c				\
		check_icmp.c check_tcp.c relay.c carp.c
@


1.10
log
@delete -W flags that reyk uses to break the tree
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.9 2007/02/23 00:28:06 deraadt Exp $
d11 5
a15 5
CFLAGS+=	-Wall -Werror -I${.CURDIR}
#CFLAGS+=	-Wstrict-prototypes -Wmissing-prototypes
#CFLAGS+=	-Wmissing-declarations
#CFLAGS+=	-Wshadow -Wpointer-arith -Wcast-qual
#CFLAGS+=	-Wsign-compare -Wbounded
@


1.9
log
@knf
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.8 2007/02/22 03:32:39 reyk Exp $
d12 4
a15 4
CFLAGS+=	-Wstrict-prototypes -Wmissing-prototypes
CFLAGS+=	-Wmissing-declarations
CFLAGS+=	-Wshadow -Wpointer-arith -Wcast-qual
CFLAGS+=	-Wsign-compare -Wbounded
@


1.8
log
@Add layer 7 functionality to hoststated used for layer 7
loadbalancing, SSL acceleration, general-purpose TCP relaying, and
transparent proxying.

see hoststated.conf(5) and my upcoming article on undeadly.org for
details.

ok to commit deraadt@@ pyr@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 2007/02/03 20:24:21 reyk Exp $
d4 2
a5 2
SRCS=		parse.y log.c control.c buffer.c imsg.c hoststated.c 	\
		ssl.c pfe.c pfe_filter.c hce.c 				\
d10 1
a10 1
DPADD=		${LIBEVENT} ${LIBSSL} ${LIBCRYPTO} 
@


1.7
log
@merge tcp-based checks into one file, no functional changes

ok pyr@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.6 2007/01/30 15:11:51 reyk Exp $
d6 1
a6 1
		check_icmp.c check_tcp.c
@


1.6
log
@this diff changes "-lcrypto -lssl" to "-lssl -lcrypto" to let it
compile on vax. on some architectures the order of the libraries
matters for the linker.

ok pyr@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.5 2007/01/29 14:23:31 pyr Exp $
d6 1
a6 1
		check_icmp.c check_tcp.c check_http.c check_send_expect.c
@


1.5
log
@Add SSL support to hoststated.
with help and OK reyk@@
with help and advice by claudio@@ and Srebrenko Sehic
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.4 2007/01/09 02:32:58 reyk Exp $
d9 2
a10 2
LDADD=		-levent -lcrypto -lssl
DPADD=		${LIBEVENT} ${LIBCRYPTO} ${LIBSSL}
@


1.4
log
@unbreak
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.3 2007/01/09 00:45:32 deraadt Exp $
d5 1
a5 1
		pfe.c pfe_filter.c hce.c 				\
d9 2
a10 2
LDADD=		-levent
DPADD=		${LIBEVENT}
@


1.3
log
@adapt to rename
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.2 2007/01/08 13:37:26 reyk Exp $
d7 1
a7 1
MAN=		hostated.8 hostated.conf.5
@


1.2
log
@add a generic send/expect check using regular expression (see
regex(3)).  this allows to define additional checks for other TCP
protocols.

From Pierre-Yves Ritschard (pyr at spootnik dot org)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.1 2006/12/16 11:45:07 reyk Exp $
d3 2
a4 2
PROG=		hostated
SRCS=		parse.y log.c control.c buffer.c imsg.c hostated.c 	\
@


1.1
log
@Import hostated, the host status daemon.  This daemon will monitor
remote hosts and dynamically alter pf(4) tables and redirection rules
for active server load balancing.  The daemon has been written by
Pierre-Yves Ritschard (pyr at spootnik.org) and was formerly known as
"slbd".

The daemon is fully functional but it still needs some work and
cleanup so we don't link it to the build yet.  Some TODOs are a
partial rewrite of the check_* routines (use libevent whenever we
can), improvement of the manpages, and general knf and cleanup.

ok deraadt@@ claudio@@
@
text
@d1 1
a1 1
#	$OpenBSD$
d4 3
a6 2
SRCS=		parse.y log.c control.c buffer.c imsg.c hostated.c \
		pfe.c pfe_filter.c hce.c check_icmp.c check_tcp.c check_http.c
@

