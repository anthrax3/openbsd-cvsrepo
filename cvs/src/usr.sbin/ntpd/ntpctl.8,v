head	1.8;
access;
symbols
	OPENBSD_6_1:1.8.0.10
	OPENBSD_6_1_BASE:1.8
	OPENBSD_6_0:1.8.0.6
	OPENBSD_6_0_BASE:1.8
	OPENBSD_5_9:1.8.0.2
	OPENBSD_5_9_BASE:1.8
	OPENBSD_5_8:1.8.0.4
	OPENBSD_5_8_BASE:1.8
	OPENBSD_5_7:1.7.0.2
	OPENBSD_5_7_BASE:1.7
	OPENBSD_5_6:1.6.0.6
	OPENBSD_5_6_BASE:1.6
	OPENBSD_5_5:1.6.0.4
	OPENBSD_5_5_BASE:1.6;
locks; strict;
comment	@.\" @;


1.8
date	2015.03.11.19.38.48;	author jmc;	state Exp;
branches;
next	1.7;
commitid	idfRkC5LcPgxlodv;

1.7
date	2015.02.10.06.40.08;	author reyk;	state Exp;
branches;
next	1.6;
commitid	pXoTR74Ztt0R3SV0;

1.6
date	2014.01.22.02.55.15;	author benno;	state Exp;
branches;
next	1.5;

1.5
date	2014.01.10.22.54.12;	author deraadt;	state Exp;
branches;
next	1.4;

1.4
date	2013.10.16.21.23.59;	author jmc;	state Exp;
branches;
next	1.3;

1.3
date	2013.10.06.16.52.31;	author jmc;	state Exp;
branches;
next	1.2;

1.2
date	2013.10.04.20.30.38;	author schwarze;	state Exp;
branches;
next	1.1;

1.1
date	2013.10.04.14.28.16;	author phessler;	state Exp;
branches;
next	;


desc
@@


1.8
log
@-s is not optional, sadly;
while here i've reformatted the page to stop kidding that -s is 4 options;

original issue kind of spotted by adam thompson, though note i am not fixing the
issue he complained about (i'll address that mail in a minute);
@
text
@.\" $OpenBSD: ntpctl.8,v 1.7 2015/02/10 06:40:08 reyk Exp $
.\"
.\" Copyright (c) 2012 Mike Miller <mmiller@@mgm51.com>
.\"
.\" Permission to use, copy, modify, and distribute this software for any
.\" purpose with or without fee is hereby granted, provided that the above
.\" copyright notice and this permission notice appear in all copies.
.\"
.\" THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES
.\" WITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF
.\" MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR
.\" ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES
.\" WHATSOEVER RESULTING FROM LOSS OF MIND, USE, DATA OR PROFITS, WHETHER IN
.\" AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT
.\" OF OR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.
.\"
.Dd $Mdocdate: February 10 2015 $
.Dt NTPCTL 8
.Os
.Sh NAME
.Nm ntpctl
.Nd control the Network Time Protocol daemon
.Sh SYNOPSIS
.Nm ntpctl
.Fl s Cm all | peers | Sensors | status
.Sh DESCRIPTION
The
.Nm
program displays information about the running
.Xr ntpd 8
daemon.
.Pp
The options are as follows:
.Bl -tag -width "-s modifierX"
.It Fl s Cm all | peers | Sensors | status
Used to display information about the running daemon.
Keywords may be abbreviated.
.Pp
.Cm all
shows all data available.
.Pp
.Cm peers
shows the following information about each peer: weight, trustlevel,
stratum, number of seconds until the next poll, polling interval
in seconds, and offset, network delay and network jitter in milliseconds.
When the system clock is synced to a peer, an asterisk
is displayed to the left of the weight column for that peer.
.Pp
.Cm Sensors
shows the following information about each sensor: weight, sensor "good"
status, stratum, and offset and the configured correction in
milliseconds.
When the system clock is synced to a sensor, an asterisk
is displayed to the left of the weight column for that sensor.
.Pp
.Cm status
shows the status of peers and sensors, and whether the system clock is synced.
When the system clock is synced, the stratum is displayed.
When the system clock is not synced, the offset of the system clock,
as reported by the
.Xr adjtime 2
system call, is displayed.
When the median constraint is set, the offset to the local time is displayed.
.El
.Sh FILES
.Bl -tag -width "/var/run/ntpd.sockXXX" -compact
.It Pa /var/run/ntpd.sock
Socket file for communication with
.Xr ntpd 8 .
.El
.Sh SEE ALSO
.Xr adjtime 2 ,
.Xr ntpd.conf 5 ,
.Xr ntpd 8
.Sh HISTORY
The
.Nm
program first appeared in
.Ox 5.5 .
@


1.7
log
@Add support for "constraints": when configured, ntpd(8) will query the
time from HTTPS servers, by parsing the Date: header, and use the
median constraint time as a boundary to verify NTP responses.  This
adds some level of authentication and protection against MITM attacks
while preserving the accuracy of the NTP protocol; without relying on
authentication options for NTP that are basically unavailable at
present.  This is an initial implementation and the semantics will be
improved once it is in the tree.

Discussed with deraadt@@ and henning@@
OK henning@@
@
text
@d1 1
a1 1
.\" $OpenBSD: ntpctl.8,v 1.6 2014/01/22 02:55:15 benno Exp $
d17 1
a17 1
.Dd $Mdocdate: January 22 2014 $
d25 1
a25 1
.Op Fl s Cm all | peers | Sensors | status
d33 1
a33 1
The options (which may be abbreviated) are as follows:
d35 9
a43 4
.It Fl s Cm all
Show all data.
.It Fl s Cm peers
Show the following information about each peer: weight, trustlevel,
d48 3
a50 2
.It Fl s Cm Sensors
Show the following information about each sensor: weight, sensor "good"
d55 3
a57 2
.It Fl s Cm status
Show the status of peers and sensors, and whether the system clock is synced.
@


1.6
log
@allow -s<abrev> in addition to -s <word> in ntpctl commandline, like
all the other tools do. changes option 'sensors' to 'Sensors'.
ok henning@@, and grudgingly phessler@@
@
text
@d1 1
a1 1
.\" $OpenBSD: ntpctl.8,v 1.5 2014/01/10 22:54:12 deraadt Exp $
d17 1
a17 1
.Dd $Mdocdate: January 10 2014 $
d56 1
@


1.5
log
@improve ntpctl usage so that the manual page does not need to be read
every time
ok jmc
@
text
@d1 1
a1 1
.\" $OpenBSD: ntpctl.8,v 1.4 2013/10/16 21:23:59 jmc Exp $
d17 1
a17 1
.Dd $Mdocdate: October 16 2013 $
d25 1
a25 1
.Op Fl s Cm all | peers | sensors | status
d33 1
a33 1
The options are as follows:
d43 1
a43 1
.It Fl s Cm sensors
@


1.4
log
@tidy up the "modifier" list a little and sync usage();

NB: this utility has only one option, and it's not optional! i haven;t
marked -s as being mandatory, since hopefully someone will make
ntpctl run without arguments do something useful;
@
text
@d1 1
a1 1
.\" $OpenBSD: ntpctl.8,v 1.3 2013/10/06 16:52:31 jmc Exp $
d17 1
a17 1
.Dd $Mdocdate: October 6 2013 $
d25 1
a25 1
.Op Fl s Ar modifier
d35 1
a35 5
.It Fl s Ar modifier
Show the data specified by
.Ar modifier :
.Bl -tag -width "sensorsXXX"
.It Cm all
d37 1
a37 1
.It Cm peers
d43 1
a43 1
.It Cm sensors
d49 1
a49 1
.It Cm status
a55 1
.El
@


1.3
log
@tweak previous;
@
text
@d1 1
a1 1
.\" $OpenBSD: ntpctl.8,v 1.2 2013/10/04 20:30:38 schwarze Exp $
d17 1
a17 1
.Dd $Mdocdate: October 4 2013 $
d39 1
a39 1
.It Fl s Cm all
d41 1
a41 1
.It Fl s Cm peers
d47 1
a47 1
.It Fl s Cm sensors
d53 1
a53 1
.It Fl s Cm status
@


1.2
log
@Tweak previous:
* For time_t values, use the printf("%lld", (long long)t) idiom.
* Don't print "Invalid program name" in usage() when main() just runs ntpd.
* Make "Show/Shows" consistent in the manual, sort .Xr and correct .Ox.
OK phessler@@
@
text
@d1 1
a1 1
.\" $OpenBSD: ntpctl.8,v 1.1 2013/10/04 14:28:16 phessler Exp $
d22 1
a22 1
.Nd "control program for the Network Time Protocol daemon"
a24 1
.Bk -words
a25 1
.Ek
d38 3
a40 10
.Bl -tag -width XXXXXXXXXX -compact
.Pp
.It Fl s Cm status
Show the status of peers and sensors, and whether the system clock is
synced.  When the system clock is synced, the stratum is displayed.
When the system clock is not synced, the offset of the system clock,
as reported by the
.Xr adjtime 2
system call, is displayed.
.Pp
d44 2
a45 2
in seconds, and offset, network delay and network jitter in
milliseconds.  When the system clock is synced to a peer, an asterisk
a46 1
.Pp
d53 8
a60 3
.Pp
.It Fl s Cm all
Show all of the above.
d63 1
a63 1
.Bl -tag -width "/var/db/ntpd.driftXXX" -compact
@


1.1
log
@Add ntpctl(8), which allows us to query the locally running ntpd(8) process

diff from Mike Miller <mmiller mgm51 com> (many thanks!)

OK phessler@@, henning@@, todd@@
@
text
@d1 1
a1 1
.\" $OpenBSD: ntpctl.8 $
d17 1
a17 1
.Dd $Mdocdate:  $
d51 1
a51 1
Shows the following information about each peer: weight, trustlevel,
d58 1
a58 1
Shows the following information about each sensor: weight, sensor "good"
d65 1
a65 1
Shows all of the above.
d75 2
a76 2
.Xr ntpd 8 ,
.Xr ntpd.conf 5
d81 1
a81 1
.Ox 5.3 .
@

