head	1.22;
access;
symbols
	OPENBSD_5_5:1.21.0.54
	OPENBSD_5_5_BASE:1.21
	OPENBSD_5_4:1.21.0.50
	OPENBSD_5_4_BASE:1.21
	OPENBSD_5_3:1.21.0.48
	OPENBSD_5_3_BASE:1.21
	OPENBSD_5_2:1.21.0.46
	OPENBSD_5_2_BASE:1.21
	OPENBSD_5_1_BASE:1.21
	OPENBSD_5_1:1.21.0.44
	OPENBSD_5_0:1.21.0.42
	OPENBSD_5_0_BASE:1.21
	OPENBSD_4_9:1.21.0.40
	OPENBSD_4_9_BASE:1.21
	OPENBSD_4_8:1.21.0.38
	OPENBSD_4_8_BASE:1.21
	OPENBSD_4_7:1.21.0.34
	OPENBSD_4_7_BASE:1.21
	OPENBSD_4_6:1.21.0.36
	OPENBSD_4_6_BASE:1.21
	OPENBSD_4_5:1.21.0.32
	OPENBSD_4_5_BASE:1.21
	OPENBSD_4_4:1.21.0.30
	OPENBSD_4_4_BASE:1.21
	OPENBSD_4_3:1.21.0.28
	OPENBSD_4_3_BASE:1.21
	OPENBSD_4_2:1.21.0.26
	OPENBSD_4_2_BASE:1.21
	OPENBSD_4_1:1.21.0.24
	OPENBSD_4_1_BASE:1.21
	OPENBSD_4_0:1.21.0.22
	OPENBSD_4_0_BASE:1.21
	OPENBSD_3_9:1.21.0.20
	OPENBSD_3_9_BASE:1.21
	OPENBSD_3_8:1.21.0.18
	OPENBSD_3_8_BASE:1.21
	OPENBSD_3_7:1.21.0.16
	OPENBSD_3_7_BASE:1.21
	OPENBSD_3_6:1.21.0.14
	OPENBSD_3_6_BASE:1.21
	OPENBSD_3_5:1.21.0.12
	OPENBSD_3_5_BASE:1.21
	OPENBSD_3_4:1.21.0.10
	OPENBSD_3_4_BASE:1.21
	OPENBSD_3_3:1.21.0.8
	OPENBSD_3_3_BASE:1.21
	OPENBSD_3_2:1.21.0.6
	OPENBSD_3_2_BASE:1.21
	OPENBSD_3_1:1.21.0.4
	OPENBSD_3_1_BASE:1.21
	OPENBSD_3_0:1.21.0.2
	OPENBSD_3_0_BASE:1.21
	OPENBSD_2_9_BASE:1.20
	OPENBSD_2_9:1.20.0.2
	OPENBSD_2_8:1.19.0.2
	OPENBSD_2_8_BASE:1.19
	OPENBSD_2_7:1.14.0.2
	OPENBSD_2_7_BASE:1.14
	OPENBSD_2_6:1.12.0.2
	OPENBSD_2_6_BASE:1.12
	OPENBSD_2_5:1.5.0.2
	OPENBSD_2_5_BASE:1.5
	OPENBSD_2_4:1.1.0.2
	OPENBSD_2_4_BASE:1.1;
locks; strict;
comment	@# @;


1.22
date	2014.03.17.17.15.51;	author deraadt;	state dead;
branches;
next	1.21;

1.21
date	2001.06.07.09.32.54;	author brian;	state Exp;
branches;
next	1.20;

1.20
date	2000.11.22.02.13.08;	author brian;	state Exp;
branches;
next	1.19;

1.19
date	2000.08.17.14.14.55;	author brian;	state Exp;
branches;
next	1.18;

1.18
date	2000.08.15.10.26.32;	author brian;	state Exp;
branches;
next	1.17;

1.17
date	2000.08.09.19.31.25;	author brian;	state Exp;
branches;
next	1.16;

1.16
date	2000.06.23.09.47.04;	author brian;	state Exp;
branches;
next	1.15;

1.15
date	2000.06.13.09.57.50;	author brian;	state Exp;
branches;
next	1.14;

1.14
date	2000.03.19.10.33.32;	author brian;	state Exp;
branches;
next	1.13;

1.13
date	2000.01.07.03.26.52;	author brian;	state Exp;
branches;
next	1.12;

1.12
date	99.08.17.17.25.34;	author brian;	state Exp;
branches;
next	1.11;

1.11
date	99.08.05.10.32.13;	author brian;	state Exp;
branches;
next	1.10;

1.10
date	99.07.27.23.47.21;	author brian;	state Exp;
branches;
next	1.9;

1.9
date	99.07.15.02.10.31;	author brian;	state Exp;
branches;
next	1.8;

1.8
date	99.07.15.02.04.06;	author brian;	state Exp;
branches;
next	1.7;

1.7
date	99.05.08.11.06.32;	author brian;	state Exp;
branches;
next	1.6;

1.6
date	99.04.27.00.21.25;	author brian;	state Exp;
branches;
next	1.5;

1.5
date	99.03.16.11.54.05;	author brian;	state Exp;
branches;
next	1.4;

1.4
date	99.02.25.12.07.23;	author brian;	state Exp;
branches;
next	1.3;

1.3
date	99.02.16.00.18.01;	author brian;	state Exp;
branches;
next	1.2;

1.2
date	98.12.14.01.23.34;	author brian;	state Exp;
branches;
next	1.1;

1.1
date	98.08.31.00.22.14;	author brian;	state Exp;
branches;
next	;


desc
@@


1.22
log
@ppp(8) goes to the bit bucket in the sky
@
text
@Copyright (c) 2001 Brian Somers <brian@@Awfulhak.org>
              based on work by Eivind Eklund <perhaps@@yes.no>,
All rights reserved.

Redistribution and use in source and binary forms, with or without
modification, are permitted provided that the following conditions
are met:
1. Redistributions of source code must retain the above copyright
   notice, this list of conditions and the following disclaimer.
2. Redistributions in binary form must reproduce the above copyright
   notice, this list of conditions and the following disclaimer in the
   documentation and/or other materials provided with the distribution.

THIS SOFTWARE IS PROVIDED BY THE AUTHOR AND CONTRIBUTORS ``AS IS'' AND
ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHOR OR CONTRIBUTORS BE LIABLE
FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
SUCH DAMAGE.

$OpenBSD: README.changes,v 1.21 2001/06/07 09:32:54 brian Exp $

This file summarises changes made to ppp that effect
its configuration.

It does not describe new features, rather it attempts
to answer any `this used to work, why doesn't it now?'
questions.

o The `set debug' command was replaced with `set log'.
o The `set log LCP' command was split into LCP, IPCP and CCP logs.
o Syslogd is used for logging.  /etc/syslog.conf must be updated.
o LQR is disabled by default.
o Openmode is active by default.
o Users must be a member of group `network' for ppp access.  Furthermore,
  they must be `allow'ed to run ppp via the `allow' command in the
  configuration file.
  For a brief period, ppp could only be run as root.
o No diagnostic socket is created by default.  The `set server' command
  must be used.
o The diagnostic socket password must be specified *only* on the `set
  server' command line.
o When `set server' is used to re-select a diagnostic port, all existing
  diagnostic connections are dropped.
o pppd-deflate is now called deflate24.
o Filter IPs of 0.0.0.0 have a default width of 0, not 32.
o Errors in `add' and `delete' are logged as warnings rather than being
  written to the TCP/IP log.
o Any number of diagnostic prompts are allowed, and they are allowed in
  interactive mode.
o The default `device' is cuaa1, then cuaa0
o A password of "*" in ppp.secret causes a passwd database lookup in
  pap mode.
o The value of the CONNECT environment variable is logged in the
  utmp host field in -direct mode.
o Out-of-sequence FSM packets (IPCP/LCP/CCP) are dropped by default.
o Reconnect values are used after an LQR timeout.
o ^C works on the parent in -background mode.
o The dial/call/open command works asynchronously.  As a result, prompts
  do not lose control while dialing.
o The `display' command has been removed.  All information is available
  with the appropriate `show' command.
o Msext does not need to be enabled/disabled.  Setting the NBNS (set nbns)
  will auto enable it.  The DNS side may be enabled/disabled, and if
  enabled without a `set dns' (was `set ns') will use values from
  /etc/resolv.conf.
o Filters are now called `allow', `dial', `in' and `out'.  `set
  ifilter ...' becomes `set filter in ...' etc.
o Authname and Authkey may only be `set' in phase DEAD.
o Set encrypt is no longer necessary.  Ppp will respond to M$CHAP
  servers correctly if it's built with DES.
o Throughput statistics are enabled by default.
o `Set stopped' only has two parameters.  It's no longer possible to
  have an IPCP stopped timer.
o `Set timeout' only has one or two parameters.  Use `set lqrperiod' and
  `set {lcp,ccp,ipcp,chap,pap}retry' for the other timers.  These timeout
  values can be seen using the relevant show commands.
o `set loopback' is now `enable/disable loopback'.
o `show auto', `show loopback' and `show mtu' are all part of `show bundle'.
o `show mru' is part of `show lcp'
o `show msext' and `show vj' are part of `show ipcp'
o `show reconnect' and `show redial' are part of `show link'
o A signal 15 (TERM) will now shut down the link gracefully.
o A signal 2 (HUP) will drop all links immediately.
o Signal 30 (USR1) is now ignored.
o Add & delete commands are not necessary in ppp.linkup if they are
  `sticky routes' (ie, contain MYADDR or HISADDR).
o LINK and CARRIER logging are no longer available.
o Timer based DEBUG messages are now logged in the new TIMER log.
o Ppp can use tun devices > tun255.
o Protocol-compressed packets are accepted even if they were denied
  at LCP negotiation time.
o Passwords aren't logged when logging the ``set server'' line.
o Command line options only need enough characters to uniquely identify
  them.  -a == -auto, -dd == -ddial etc.  -interactive is also allowed.
o If you don't like seeing additional interface aliases when running in
  -auto -alias mode, add ``iface clear'' to your ppp.linkdown file -
  check the sample file.
o Ppp waits for 1 second before checking whether the device supports
  carrier.  This is controllable with ``set cd''.
o Random dial timeouts are now between 1 and 30 seconds inclusive rather
  than between 0 and 29.
o Ppp now accepts M$CHAP (as well as normal CHAP) by default.  If this
  is not required, you must ``deny chap05 chap80''.
o The ``set device'' command now expects each device to be specified as an
  argument rather than concatentating all arguments and splitting based
  on commas and spaces.
o The ``show modem'' command is deprecated and has been changed to
  ``show physical''.
o The words ``host'' and ``port'' are no longer accepted by the ``set filter''
  command.  Removing them should yield the same results as before.
o The ``set weight'' command has been deprecated.  The ``set bandwidth''
  command should now be used instead.
o The ``set autoload'' command syntax and implementation have changed as the
  old implementation was mis-designed and dysfunctional.
o Ppp now waits either the full ``set cd'' time or until carrier is detected
  before running the login script (whichever comes first).
o The -alias flag has been deprecated.  The -nat flag should be used instead.
o Unbalanced quotes in commands are now warned about and the entire command
  is ignored.
o It is now only necessary to escape the `-' character in chat scripts twice.
  See the example files for details.
o Environment variables and ~ are expanded on in commands
o ``nat pptp'' is no longer necessary as this is now done transparently
o The ``!'' at the start of chat scripts and authkey can be made literal
  (rather than meaning execute) by doubling it to ``!!''.
o MP autoload throughput measurements are now based on the maximum of input
  and output averages rather than on the total.
o When only one link is open in MP mode, MP link level compression is not
  open and the peer MRU >= the peer MRRU, ppp sends outbound traffic as
  PROTO_IP traffic rather than PROTO_MP.
o MSCHAPv2 is now accepted by default.  If you don't wish to negotiate
  this, you must explicitly deny it.
o MPPE is enabled and accepted by default (although deflate and predictor1
  are preferred.
@


1.21
log
@Depricate the -alias option (it's been -nat for a long time)
Handle carriage-return/line-feed stuff for ftp natting more generically
Fix an alignment bug when logging DNS traffic
Fix/add some copyrights
@
text
@d26 1
a26 1
$OpenBSD: README.changes,v 1.20 2000/11/22 02:13:08 brian Exp $
@


1.20
log
@Enable and accept MPPE by default (deflate & pred1 are preferred)
Accept MSCHAPv2 by default.
Hard sentence breaks
Describe tunneling more clearly
Some cosmetic netgraph fixes (Not used in OpenBSD)
@
text
@d1 26
a26 1
$OpenBSD: README.changes,v 1.19 2000/08/17 14:14:55 brian Exp $
@


1.19
log
@If we're in MP mode with a single open link, MP link level compression
isn't open and the links MRU >= our MRRU, send outbound traffic as
PROTO_IP rather than PROTO_MP.  This shaves some bytes off the front
of each packet 'till the second link is brought up.

Idea obtained from: Cisco
@
text
@d1 1
a1 1
$OpenBSD: README.changes,v 1.18 2000/08/15 10:26:32 brian Exp $
d112 4
@


1.18
log
@Maintain input and output throughput averages and choose the highest
of the two when calculating the MP throughput average for the ``set
autoload'' implementation.

This makes more sense as all links I know of are full-duplex.  This
also means that people may need to adjust their autoload settings
as 100% bandwidth is now the theoretical maximum rather than 200%
(but of course, halfing the current settings is probably not the
correct answer either!).

This involves a ppp version bump as we need to pass an extra
throughput array through the MP local domain socket.
@
text
@d1 1
a1 1
$OpenBSD: README.changes,v 1.17 2000/08/09 19:31:25 brian Exp $
d109 3
@


1.17
log
@Allow leading ``!'' characters in authkeys and chat scripts to
be doubled up to mean a single literaly ``!''.
@
text
@d1 1
a1 1
$OpenBSD: README.changes,v 1.16 2000/06/23 09:47:04 brian Exp $
d107 2
@


1.16
log
@Improved 227, 229 and EPRT support in the nat code; FreeBSD
Moved security checks into one place; FreeBSD
Remove ``nat pptp'' now that it's transparent
@
text
@d1 1
a1 1
$OpenBSD: README.changes,v 1.15 2000/06/13 09:57:50 brian Exp $
d105 2
@


1.15
log
@Add ``set ifqueue'' to adjust the number of packets ppp buffers.
Handle an ``open'' correctly from state DATALINK_READY.
Don't disable the autoload timer when bringing down the second last auto
link or bringing up the last auto link.
Allow ``set urgent none'' to disable IPTOS_LOWDELAY prioritisation.
Honour ``set speed sync'' for ``!program'' links and use a udp socketpair
between ppp and ``program''.
HUP ``program'' when a ``!program'' link comes down.
Don't complain about valid padded ppp frames, but complain and drop the
data if the length claims to be more than the payload.
Correct the umask when creating a new /etc/resolv.conf (when dns is enabled),
and don't segfault when trying to rewrite the previous (non-existent) contents.
Be more verbose about ``inappropriate peer'' messages in MP mode.
Allow ``nat target MYADDR'' (to redirect incoming connections to the gateway).
Pass everything through the NAT engine - let it decide if it wants it.
Fix the return code when failing to create a tcp link
@
text
@d1 1
a1 1
$OpenBSD$
d104 1
@


1.14
log
@Allow environment variables on command/config lines; markk@@knigma.org
Add the ``resolv'' command so that when ``enable dns''
is used, it's possible to restore the file.
@
text
@d1 2
@


1.13
log
@Upgrade from 2.23 -> 2.26
I'll follow up with a list of changes (too big for a commit message IMHO)
@
text
@d101 1
@


1.12
log
@Implement a minimum idle time value as an optional second argument
to ``set timeout''.
This is useful for situations where your minimum call charge is (say)
5 minutes (like mine is)
@
text
@d86 1
a86 1
o The ``show modem'' command is depricated and has been changed to
d90 1
a90 1
o The ``set weight'' command has been depricated.  The ``set bandwidth''
d94 7
@


1.11
log
@o Obsolete the undocumented ``set weight'' command.
o If we're using RADIUS and the RADIUS mtu is less than our
  peers mru/mrru, reduce our mtu to this value for NetBSD too.
o Make struct throughput's sample period dynamic and tweak the ppp
  version number to reflect the extra stuff being passed through
  the local domain socket as a result (MP mode).
o Measure the current throughput based on the number of samples actually
  taken rather than on the full sample period.
o Keep the throughput statisics persistent while being passed to
  another ppp invocation through the local domain socket.
o When showing throughput statistics after the timer has stopped, use
  the stopped time for overall calculations, not the current time.
  Also show the stopped time and how long the current throughput has
  been sampled for.
o Use time() consistently in throughput.c
o Tighten up the ``show bundle'' output.
o Introduce the ``set bandwidth'' command.
o Rewrite the ``set autoload'' command.  It now takes three arguments
  and works based on a rolling bundle throughput average compared against
  the theoretical bundle bandwidth over a given period (read: it's now
  functional).
@
text
@d53 3
a55 3
o `Set timeout' only has one parameter.  Use `set lqrperiod' and `set
  {lcp,ccp,ipcp,chap,pap}retry' for the other timers.  `show timeout'
  is also now available using the relevant show commands.
@


1.10
log
@o Overhaul filtering, adding facilities to jump over rules and to
  negate the sense of rules.
o Remove the redundant (and undocumented) ``host'' and ``port''
  words (README.changes updated).
o Don't permit (and ignore) garbage instead of the protocol.

Mostly submitted by:  Peter Jeremy <jeremyp@@gsmx07.alcatel.com.au>
@
text
@d90 4
@


1.9
log
@Back out the mis-commit of my development ISDN modifications.
@
text
@d88 2
@


1.8
log
@Don't declare `end' if we aren't compiling radius support.
@
text
@a87 2
o Ppp now waits the full ``set cd'' time before running the login script,
  and drops the connection at that point if CD is required and not present.
@


1.7
log
@o Redesign the layering mechanism and make the aliasing code part of
  the layering.

  We now ``stack'' layers as soon as we open the device (when we figure
  out what we're dealing with).  A static set of `dispatch' routines are
  also declared for dealing with incoming packets after they've been
  `pulled' up through the stacked layers.

  Physical devices are now assigned handlers based on the device type
  when they're opened.  For the moment there are three device types;
  ttys, execs and tcps.

o Increment version number to 2.2
o Make an entry in [uw]tmp for non-tty -direct invocations (after
  pap/chap authentication).
o Make throughput counters quad_t's
o Account for the absolute number of mbuf malloc()s and free()s in
  ``show mem''.
o ``show modem'' becomes ``show physical''.
@
text
@d88 2
@


1.6
log
@Change ``set device'' so that it parses its arguments as one
device per argument rather than the old way of concatenating
everything then splitting the result at commas and whitespace.

Old syntax of ``set device /dev/cuaa0, /dev/cuaa1''
may no longer contain the comma, but syntax such as
``set device "!ssh host ppp -direct label"'' is now
possible.
@
text
@d86 2
@


1.5
log
@Mention changes to the default authentication behaviour.
@
text
@d83 3
@


1.4
log
@When our dial timeout is ``random'', display its value
correctly by invoking the timer to get the value before
displaying the message.
Don't assume that a value of 0 is ``random'' in
``show datalink''.
Make the random value between 1 and DIAL_TIMEOUT rather
than between 0 and DIAL_TIMEOUT-1
@
text
@d81 2
@


1.3
log
@Wait by default for one second after the login script
is complete before checking carrier.  If it's there,
the device supports carrier.  If it's not it doesn't.

Add the ``set cd'' command for deciding how soon to check
for carrier, and for deciding if carrier is REQUIRED.

The default has changed:  Pre 2.0 versions of ppp waited
for 1 second.  Version 2 didn't wait, but this causes
problems with some (few?) modems that don't assert carrier
immediately on reporting CONNECT.  The one second delay
is back now and can be removed with ``set cd 0''.

Bump the ppp version number in case this needs to be changed
again....
@
text
@d79 2
@


1.2
log
@Mention the cosmetic necessity to ``iface clear'' in ppp.linkdown.
@
text
@d77 2
@


1.1
log
@Upgrade ppp to version 2.0

This adds a number of features including:
o Multilink
o Callback (including CBCP)
o DNS negotiation (client & server)
o Easy to configure masquerading/packet aliasing
o Any number of diagnostic socket connections (limits DOS attacks)
o Sticky routes (ppp updates the routing table when the IP number is changed)

See the file README.changes for things that effect current
configurations.
@
text
@d74 3
@

