head	1.57;
access;
symbols
	OPENBSD_6_2:1.57.0.6
	OPENBSD_6_2_BASE:1.57
	OPENBSD_6_1:1.57.0.4
	OPENBSD_6_1_BASE:1.57
	OPENBSD_6_0:1.52.0.4
	OPENBSD_6_0_BASE:1.52
	OPENBSD_5_9:1.51.0.2
	OPENBSD_5_9_BASE:1.51
	OPENBSD_5_8:1.50.0.4
	OPENBSD_5_8_BASE:1.50
	OPENBSD_5_7:1.49.0.2
	OPENBSD_5_7_BASE:1.49
	OPENBSD_5_6:1.48.0.8
	OPENBSD_5_6_BASE:1.48
	OPENBSD_5_5:1.48.0.6
	OPENBSD_5_5_BASE:1.48
	OPENBSD_5_4:1.48.0.2
	OPENBSD_5_4_BASE:1.48
	OPENBSD_5_3:1.47.0.4
	OPENBSD_5_3_BASE:1.47
	OPENBSD_5_2:1.47.0.2
	OPENBSD_5_2_BASE:1.47
	OPENBSD_5_1_BASE:1.45
	OPENBSD_5_1:1.45.0.2
	OPENBSD_5_0:1.40.0.2
	OPENBSD_5_0_BASE:1.40
	OPENBSD_4_9:1.35.0.4
	OPENBSD_4_9_BASE:1.35
	OPENBSD_4_8:1.35.0.2
	OPENBSD_4_8_BASE:1.35
	OPENBSD_4_7:1.33.0.2
	OPENBSD_4_7_BASE:1.33
	OPENBSD_4_6:1.29.0.4
	OPENBSD_4_6_BASE:1.29
	OPENBSD_4_5:1.28.0.4
	OPENBSD_4_5_BASE:1.28
	OPENBSD_4_4:1.28.0.2
	OPENBSD_4_4_BASE:1.28
	OPENBSD_4_3:1.25.0.2
	OPENBSD_4_3_BASE:1.25
	OPENBSD_4_2:1.24.0.2
	OPENBSD_4_2_BASE:1.24
	OPENBSD_4_1:1.21.0.4
	OPENBSD_4_1_BASE:1.21
	OPENBSD_4_0:1.21.0.2
	OPENBSD_4_0_BASE:1.21
	OPENBSD_3_9:1.20.0.2
	OPENBSD_3_9_BASE:1.20
	OPENBSD_3_8:1.17.0.4
	OPENBSD_3_8_BASE:1.17
	OPENBSD_3_7:1.17.0.2
	OPENBSD_3_7_BASE:1.17
	OPENBSD_3_6:1.8.0.2
	OPENBSD_3_6_BASE:1.8
	OPENBSD_3_5:1.7.0.2
	OPENBSD_3_5_BASE:1.7;
locks; strict;
comment	@.\" @;


1.57
date	2017.03.25.19.53.33;	author espie;	state Exp;
branches;
next	1.56;
commitid	lfyDuvCWHPEgUFSe;

1.56
date	2017.03.11.18.24.55;	author schwarze;	state Exp;
branches;
next	1.55;
commitid	5HNpPqUHe6rv1kaw;

1.55
date	2017.03.11.11.42.10;	author espie;	state Exp;
branches;
next	1.54;
commitid	pJVQfhlR0hZwj9Do;

1.54
date	2017.02.27.21.53.11;	author rpe;	state Exp;
branches;
next	1.53;
commitid	7XQfqtkSXX43wr6R;

1.53
date	2017.02.15.13.19.08;	author jmc;	state Exp;
branches;
next	1.52;
commitid	j8UnunCP9XczEY7i;

1.52
date	2016.06.14.17.09.25;	author espie;	state Exp;
branches;
next	1.51;
commitid	fzkAVJOxjDiRRtE9;

1.51
date	2015.10.07.17.52.38;	author jmc;	state Exp;
branches;
next	1.50;
commitid	wtnyUwU0yuhbcppY;

1.50
date	2015.04.08.17.25.58;	author millert;	state Exp;
branches;
next	1.49;
commitid	8DORJHPXFHGbuURw;

1.49
date	2014.09.08.01.27.55;	author schwarze;	state Exp;
branches;
next	1.48;
commitid	cPoapLAXYNe1fcgV;

1.48
date	2013.04.30.18.33.30;	author espie;	state Exp;
branches;
next	1.47;

1.47
date	2012.07.06.12.11.51;	author espie;	state Exp;
branches;
next	1.46;

1.46
date	2012.07.06.12.02.50;	author espie;	state Exp;
branches;
next	1.45;

1.45
date	2011.12.02.16.01.17;	author jmc;	state Exp;
branches;
next	1.44;

1.44
date	2011.12.02.12.00.32;	author espie;	state Exp;
branches;
next	1.43;

1.43
date	2011.11.25.09.30.08;	author espie;	state Exp;
branches;
next	1.42;

1.42
date	2011.08.23.10.32.27;	author espie;	state Exp;
branches;
next	1.41;

1.41
date	2011.08.17.10.48.27;	author espie;	state Exp;
branches;
next	1.40;

1.40
date	2011.07.18.19.19.08;	author espie;	state Exp;
branches;
next	1.39;

1.39
date	2011.07.12.10.51.28;	author espie;	state Exp;
branches;
next	1.38;

1.38
date	2011.07.12.10.34.09;	author espie;	state Exp;
branches;
next	1.37;

1.37
date	2011.03.19.09.39.39;	author jmc;	state Exp;
branches;
next	1.36;

1.36
date	2011.03.19.09.32.36;	author jmc;	state Exp;
branches;
next	1.35;

1.35
date	2010.06.05.07.11.43;	author espie;	state Exp;
branches;
next	1.34;

1.34
date	2010.05.10.09.12.18;	author espie;	state Exp;
branches;
next	1.33;

1.33
date	2010.02.28.15.35.41;	author jmc;	state Exp;
branches;
next	1.32;

1.32
date	2010.01.10.22.44.00;	author espie;	state Exp;
branches;
next	1.31;

1.31
date	2010.01.10.21.27.59;	author espie;	state Exp;
branches;
next	1.30;

1.30
date	2009.12.21.11.03.00;	author espie;	state Exp;
branches;
next	1.29;

1.29
date	2009.04.14.17.53.58;	author espie;	state Exp;
branches;
next	1.28;

1.28
date	2008.03.09.15.36.45;	author jmc;	state Exp;
branches;
next	1.27;

1.27
date	2008.03.08.11.48.01;	author espie;	state Exp;
branches;
next	1.26;

1.26
date	2008.03.08.11.41.42;	author espie;	state Exp;
branches;
next	1.25;

1.25
date	2007.10.31.14.45.06;	author jmc;	state Exp;
branches;
next	1.24;

1.24
date	2007.05.31.19.20.26;	author jmc;	state Exp;
branches;
next	1.23;

1.23
date	2007.05.31.11.05.41;	author espie;	state Exp;
branches;
next	1.22;

1.22
date	2007.04.15.10.17.29;	author espie;	state Exp;
branches;
next	1.21;

1.21
date	2006.08.01.10.23.38;	author bernd;	state Exp;
branches;
next	1.20;

1.20
date	2005.09.07.14.01.59;	author jmc;	state Exp;
branches;
next	1.19;

1.19
date	2005.09.07.09.24.19;	author jmc;	state Exp;
branches;
next	1.18;

1.18
date	2005.09.04.22.47.56;	author espie;	state Exp;
branches;
next	1.17;

1.17
date	2005.01.03.01.02.45;	author espie;	state Exp;
branches;
next	1.16;

1.16
date	2004.12.27.22.54.25;	author espie;	state Exp;
branches;
next	1.15;

1.15
date	2004.12.09.18.58.25;	author espie;	state Exp;
branches;
next	1.14;

1.14
date	2004.12.02.00.29.04;	author xsa;	state Exp;
branches;
next	1.13;

1.13
date	2004.11.15.13.20.40;	author jmc;	state Exp;
branches;
next	1.12;

1.12
date	2004.11.15.10.49.19;	author jmc;	state Exp;
branches;
next	1.11;

1.11
date	2004.11.14.11.58.43;	author espie;	state Exp;
branches;
next	1.10;

1.10
date	2004.10.11.13.10.25;	author espie;	state Exp;
branches;
next	1.9;

1.9
date	2004.10.11.10.07.37;	author espie;	state Exp;
branches;
next	1.8;

1.8
date	2004.08.06.16.45.51;	author millert;	state Exp;
branches;
next	1.7;

1.7
date	2004.02.25.21.56.12;	author espie;	state Exp;
branches;
next	1.6;

1.6
date	2004.01.27.15.34.31;	author espie;	state Exp;
branches;
next	1.5;

1.5
date	2004.01.27.14.50.52;	author espie;	state Exp;
branches;
next	1.4;

1.4
date	2004.01.27.13.09.16;	author espie;	state Exp;
branches;
next	1.3;

1.3
date	2003.11.14.23.03.55;	author espie;	state Exp;
branches;
next	1.2;

1.2
date	2003.10.26.10.33.24;	author espie;	state Exp;
branches;
next	1.1;

1.1
date	2003.10.19.18.38.06;	author espie;	state Exp;
branches;
next	;


desc
@@


1.57
log
@document tweaked checksum behavior, reorder environment, remove old cruft.
@
text
@.\"	$OpenBSD: pkg_delete.1,v 1.56 2017/03/11 18:24:55 schwarze Exp $
.\"
.\" Documentation and design originally from FreeBSD. All the code has
.\" been rewritten since. We keep the documentation's notice:
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\"
.\" Jordan K. Hubbard
.\"
.\"
.Dd $Mdocdate: March 11 2017 $
.Dt PKG_DELETE 1
.Os
.Sh NAME
.Nm pkg_delete
.Nd delete software package distributions
.Sh SYNOPSIS
.Nm pkg_delete
.Op Fl acIimnqsVvXx
.Op Fl B Ar pkg-destdir
.Op Fl D Ar name Ns Op = Ns Ar value
.Op Ar pkg-name ...
.Sh DESCRIPTION
The
.Nm
command is used to delete packages that have been previously installed
with the
.Xr pkg_add 1
command.
.Pp
Package names may be specified either as the package name itself, or as a
filename which consists of the package name plus the
.Dq .tgz
suffix, or as a full pathname like
.Pa /var/db/pkg/pkgname ,
so that shell wildcards can be used.
.Pp
Version numbers and flavors
.Po
see
.Xr packages-specs 7
.Pc
can be omitted, unless the resulting specification is ambiguous.
.Pp
Otherwise,
.Ar pkg-name
in
.Nm
may use the same convenient shortcuts as
.Xr pkg_add 1 :
.Sq Nm Ar autoconf Ns % Ns Ar 2.13
will delete
.Ar autoconf
from the
.Ar 2.13
branch.
.Pp
.Nm
will
.Xr syslog 3
deletions by default.
.Pp
.Nm
relies on the file system information being consistent.
In case of a system crash,
.Pa /var/db/pkg
may become corrupted.
Use
.Xr pkg_check 8
to repair things.
.Pp
.Nm
may ask questions in interactive mode, or error out otherwise.
Interactive mode is the default on a tty, see
options
.Fl I/i .
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl a
Delete unused dependencies (packages that are not needed by anything tagged
as installed manually).
Can be used without
.Ar pkgnames .
If used with
.Ar pkgnames ,
it will only delete non manual installs in the list.
.It Fl B Ar pkg-destdir
Set
.Ar pkg-destdir
as the prefix to prepend to any object deleted.
.It Fl c
Delete extra configuration file, mentioned as
.Dl @@extra file
in the packing-list.
.It Fl D Ar name Ns Op = Ns Ar value
Force removal of the package.
.Ar name
is a keyword that states what failsafe
should be waived.
Recognized keywords include:
.Pp
.Bl -tag -width "dependenciesXX" -compact
.It Ar baddepend
Force the deletion of packages even if they reference nonexistent dependencies.
.It Ar checksum
Verify checksums before deleting files.
.It Ar dependencies
Also delete the whole set of packages that depends upon the requested packages.
.It Ar nonroot
Uninstall even if not running as root.
.It Ar scripts
External scripts may fail.
.El
.It Fl I
Force non-interactive mode.
Default is to be interactive when run from a tty.
.It Fl i
Force interactive mode, even if not run from a tty.
.Nm
may ask questions to the user if faced with difficult decisions.
.It Fl m
Causes
.Nm
to always display the progress meter in cases it would not do so by default.
.It Fl n
Don't actually deinstall a package, just report the steps that
would be taken if it were.
.It Fl qq
Do not bother with checksums for configuration files.
.It Fl s
Don't actually deinstall packages, report the disk size changes
that would happen.
.It Fl V
Turn on statistics output.
For now, only displays the number of packages done/total number of packages.
Several
.Fl V
will turn on more statistics in the future.
.It Fl v
Turn on verbose output.
Several
.Fl v
turn on more verbose output.
By default,
.Nm
is almost completely silent, but it reacts to keyboard status requests
.Po
see
.Xr stty 1
.Pc .
.Fl v
turns on basic messages,
.Fl vv
adds relevant system operations,
.Fl vvv
shows most internal computations apart from individual file/directory
additions, and
.Fl vvvvv
shows everything.
.It Fl X
Delete everything, except the list of packages that follow.
.It Fl x
Disable progress meter.
.El
.Sh TECHNICAL DETAILS
.Nm
examines installed package records for the
.Ar pkgname
specified,  checks inter-dependencies between installed packages,
deletes the package contents in an order respecting dependencies
(e.g., packages with dependencies get removed first), and finally
removes the package records.
.Pp
If a package is required by other installed packages not mentioned in
the list of packages to remove,
.Nm
will list those dependent packages and refuse to delete the package.
.Sh ENVIRONMENT
.Bl -tag -width PKG_CHECKSUM
.It Ev PKG_CHECKSUM
If set, verify files checksums during deletion, exactly like
.Fl D Ns Ar checksum .
.It Ev PKG_DBDIR
Where to look for installed packages instead of
.Pa /var/db/pkg .
.It Ev PKG_DESTDIR
Value for
.Ar pkg-destdir ,
if no
.Fl B
option is specified.
.El
.Sh SEE ALSO
.Xr pkg_add 1 ,
.Xr pkg_create 1 ,
.Xr pkg_info 1 ,
.Xr packages-specs 7 ,
.Xr pkg_check 8
.Sh AUTHORS
.Bl -tag -width indent -compact
.It An Jordan Hubbard
initial design
.It An Marc Espie
complete rewrite
.El
@


1.56
log
@more consistency on .Fl ... Ns Ar lines, requested by jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.55 2017/03/11 11:42:10 espie Exp $
d113 2
d136 2
a137 6
.It Fl q
Delete package quickly, do not bother with checksums before removing normal
files.
For signed packages, do not bother verifying signatures either.
If used twice,
it will not bother with checksums for configuration files either.
d187 4
a190 1
.Bl -tag -width PKG_DESTDIR
@


1.55
log
@document recent changes.
acknowledge that installurl requires some internal treatment
explain how %c works now.
Document -Dsnap and -V
Remove the pesky spaces in -Dname, since no-one types the space ever
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.54 2017/02/27 21:53:11 rpe Exp $
d18 1
a18 1
.Dd $Mdocdate: February 27 2017 $
d28 1
a28 1
.Op Fl D Ns Ar name Ns Op = Ns Ar value
d86 1
a86 1
.Bl -tag -width BB-pkg-destdir
d103 1
a103 3
.It Xo
.Fl D Ns Ar name Ns Op = Ns Ar value
.Xc
@


1.54
log
@Remove support for pkg.conf in light of the consolidation towards
a single configuration file for the OpenBSD repository location.

The pkg_* tools now use installurl(5) to find the package repository.

NOTE:
/etc/installurl only contains a single URL pointing to a mirror.
Use the PKG_PATH environment variable to specify more than one
package repository.

prodded by and OK deraadt@@ aja@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.53 2017/02/15 13:19:08 jmc Exp $
d18 1
a18 1
.Dd $Mdocdate: February 15 2017 $
d26 1
a26 1
.Op Fl acIimnqsvXx
d28 1
a28 1
.Op Fl D Ar name Ns Op = Ns Ar value
d104 1
a104 2
.Fl D
.Ar name Ns Op = Ns Ar value
d145 6
@


1.53
log
@improve list item formatting;
from salvador sabaini
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.52 2016/06/14 17:09:25 espie Exp $
d18 1
a18 1
.Dd $Mdocdate: June 14 2016 $
d68 1
a68 5
deletions by default
.Po
but see
.Xr pkg.conf 5
.Pc .
a200 1
.Xr pkg.conf 5 ,
@


1.52
log
@refer to pkg_add(1) for pkg-name conventions
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.51 2015/10/07 17:52:38 jmc Exp $
d18 1
a18 1
.Dd $Mdocdate: October 7 2015 $
d116 2
a117 1
.Bl -tag -width "dependenciesXX"
d119 1
a119 1
force the deletion of packages even if they reference nonexistent dependencies.
d121 1
a121 1
also delete the whole set of packages that depends upon the requested packages.
d123 1
a123 1
uninstall even if not running as root.
d125 1
a125 1
external scripts may fail.
@


1.51
log
@"..." implies optional, so no need for []; from michael reed
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.50 2015/04/08 17:25:58 millert Exp $
d18 1
a18 1
.Dd $Mdocdate: April 8 2015 $
d51 13
@


1.50
log
@s/inexistent/nonexistent/
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.49 2014/09/08 01:27:55 schwarze Exp $
d18 1
a18 1
.Dd $Mdocdate: September 8 2014 $
d29 1
a29 1
.Ar pkg-name Op Ar ...
@


1.49
log
@obvious cases of missing .An;
found with the new mandoc(1) MANDOCERR_AN_MISSING warning;
no text changes
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.48 2013/04/30 18:33:30 espie Exp $
d18 1
a18 1
.Dd $Mdocdate: April 30 2013 $
d105 1
a105 1
force the deletion of packages even if they reference inexistent dependencies.
@


1.48
log
@point people at pkg_check
ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.47 2012/07/06 12:11:51 espie Exp $
d18 1
a18 1
.Dd $Mdocdate: July 6 2012 $
d196 1
a196 1
.It "Jordan Hubbard"
d198 1
a198 1
.It "Marc Espie"
@


1.47
log
@a bit of cleanup
- remove description of INSTALL/DEINSTALL scripts, they've been dead
for years.
- explain upfront about interactive mode.
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.46 2012/07/06 12:02:50 espie Exp $
d62 9
d192 2
a193 1
.Xr packages-specs 7
@


1.46
log
@have -i be automatically on for ttys.
use -i/-I to force interactive/non interactive mode
(-I for not running scripts has been dead for years)
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.45 2011/12/02 16:01:17 jmc Exp $
d18 1
a18 1
.Dd $Mdocdate: December 2 2011 $
d61 6
a165 22
.Pp
If a
.Cm deinstall
script exists for the package (deprecated,
.Cm @@unexec
is more versatile),
it is executed before any files are removed.
Such a script can be used to remove messy dynamic files created by the
package on installation or during usage.
The
.Nm deinstall
script is called as:
.Bd -filled -offset indent
.Cm deinstall
.Ar <pkg-name>
.Ar DEINSTALL
.Ed
.Pp
Passing the keyword
.Ar DEINSTALL
lets you potentially write only one program/script that handles all
aspects of installation and deletion.
d176 1
a176 6
option is specified;
value passed to any
.Cm DEINSTALL
or
.Cm REQUIRE
script invoked from the package.
@


1.45
log
@-X before -x;
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.44 2011/12/02 12:00:32 espie Exp $
d26 1
a26 1
.Op Fl acimnqsvXx
d98 3
d102 1
a102 1
Switch on interactive mode.
@


1.44
log
@-X exclude option: negates the packages we give (remove them instead of
adding them).
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.43 2011/11/25 09:30:08 espie Exp $
d18 1
a18 1
.Dd $Mdocdate: November 25 2011 $
d26 1
a26 1
.Op Fl acimnqsvxX
@


1.43
log
@describe fixed behavior a little better
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.42 2011/08/23 10:32:27 espie Exp $
d18 1
a18 1
.Dd $Mdocdate: August 23 2011 $
d26 1
a26 1
.Op Fl acimnqsvx
d139 2
@


1.42
log
@zap old INSTALL/DEINSTALL stuff, it's been deprecated for 3 years, and removed
from pkg_create for over a year.
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.41 2011/08/17 10:48:27 espie Exp $
d18 1
a18 1
.Dd $Mdocdate: August 17 2011 $
d68 3
@


1.41
log
@pkg_add and pkg_delete will now syslog activity by default.
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.40 2011/07/18 19:19:08 espie Exp $
d18 1
a18 1
.Dd $Mdocdate: July 18 2011 $
d26 1
a26 1
.Op Fl acIimnqsvx
a94 2
.It Fl I
If scripts exist for a given package, do not execute them.
@


1.40
log
@allow pkg_delete -a pkgname to do something useful:
- first delete the list of packages
- then if -a was specified, try deleting everything else (but only !manual)
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.39 2011/07/12 10:51:28 espie Exp $
d18 1
a18 1
.Dd $Mdocdate: July 12 2011 $
d51 9
@


1.39
log
@put back options -Dbaddepend -Ddependencies
uninstalled and verbosedeps are now always on.
ambiguous will die ?
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.38 2011/07/12 10:34:09 espie Exp $
d57 2
a58 3
Don't use any
.Ar pkg-name
with this option.
@


1.38
log
@document new -a
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.37 2011/03/19 09:39:39 jmc Exp $
d18 1
a18 1
.Dd $Mdocdate: March 19 2011 $
a77 2
.It Ar ambiguous
delete all packages matching ambiguous package specifications.
a85 4
.It Ar uninstalled
proceed even if some package names don't resolve to installed package names.
.It Ar verbosedeps
show detailed dependency information.
@


1.37
log
@fix some name[=value] horrors;
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.36 2011/03/19 09:32:36 jmc Exp $
d26 1
a26 1
.Op Fl cIimnqsvx
d54 6
@


1.36
log
@Xr pkg.conf.5; from Patrick Lamaiziere
ok espie
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.35 2010/06/05 07:11:43 espie Exp $
d18 1
a18 1
.Dd $Mdocdate: June 5 2010 $
d28 1
a28 4
.Oo Fl D Ar name
.Ns Oo Ns = Ns Ar value
.Oc
.Oc
@


1.35
log
@document front-end changes
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.34 2010/05/10 09:12:18 espie Exp $
d18 1
a18 1
.Dd $Mdocdate: May 10 2010 $
d192 1
@


1.34
log
@document that INSTALL/DEINSTALL scripts are dead.
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d18 1
a18 1
.Dd $Mdocdate$
d26 1
a26 1
.Op Fl cIinqsvx
d96 4
@


1.33
log
@progress-meter -> progress meter, which is at least consistent with our
other pages;
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.32 2010/01/10 22:44:00 espie Exp $
d18 1
a18 1
.Dd $Mdocdate: January 10 2010 $
d148 4
a151 1
script exists for the package, it is executed before any files are removed.
@


1.32
log
@fix some mdoc tidbits. Thanks to jmc@@ for advice.
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d18 1
a18 1
.Dd $Mdocdate$
d130 1
a130 1
Disable progress-meter.
@


1.31
log
@unify options a bit: use -Dname=value for defines uniformously (e.g., deprecate
-F keyword heavily).
@
text
@d65 4
a68 1
.It Fl D Ar name Ns = Ns Ar value
a72 3
The
.Op = Ns value
part is actually unnecessary in most cases.
@


1.30
log
@document recent changes, clean up old pkg_delete options
@
text
@d28 4
a31 1
.Op Fl F Ar keywords
d65 1
a65 1
.It Fl F Ar keywords
d67 2
a68 2
.Ar keywords
is a comma-separated list of keywords that state what failsafes
d70 4
a73 1
These include:
@


1.29
log
@initial implementation of package signatures, based on x509 certificates and
smime detached signatures.
@
text
@d26 1
a26 1
.Op Fl cIinqvx
d99 3
d107 16
@


1.28
log
@tweak previous;
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.27 2008/03/08 11:48:01 espie Exp $
d18 1
a18 1
.Dd $Mdocdate: March 8 2008 $
d96 1
@


1.27
log
@better -q: mention once, and it speeds up (assumes normal files haven't
changed), but still checks config files. Use twice, and wipe your config
out as well.
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d18 1
a18 1
.Dd $Mdocdate$
d96 2
a97 1
If used twice, it will not bother with checksums either for configuration files.
@


1.26
log
@tweak messages mentioning checksums so that they mention checksums, not
specifics like md5, since that's likely to change.
@
text
@d94 3
a96 1
Delete package quickly, do not bother with checksums before removing files.
@


1.25
log
@better .Nd; from Pierre Riteau
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.24 2007/05/31 19:20:26 jmc Exp $
d94 1
a94 1
Delete package quickly, do not bother checking MD5s before removing files.
@


1.24
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.23 2007/05/31 11:05:41 espie Exp $
d23 1
a23 1
.Nd a utility for deleting previously installed software package distributions
@


1.23
log
@kill REQ script directly. I'm pretty sure it doesn't quite work anyways.
Deprecate INSTALL and DEINSTALL, write out warnings in pkg_create.

Clean up some more old cruft
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.22 2007/04/15 10:17:29 espie Exp $
d18 1
a18 1
.Dd November 25, 1994
@


1.22
log
@update copyright years, standardize licence.
reword the introduction to the stuff originally from FreeBSD to clarify
slightly.
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.21 2006/08/01 10:23:38 bernd Exp $
a115 21
.Pp
If the package contains a
.Ar require
file (see
.Xr pkg_create 1 ) ,
then this is executed first as
.Bd -filled -offset indent
.Cm require
.Ar <pkg-name>
.Ar DEINSTALL
.Ed
.Pp
(where
.Ar pkgname
is the name of the package in question and
.Ar DEINSTALL
is a keyword denoting that this is a deinstallation)
to see whether or not deinstallation should continue.
A non-zero exit status means no, unless the
.Fl f
option is specified.
@


1.21
log
@If pkg_delete is trying to remove more than one package at the same time and
is finding some dependency problems, explain which package depend on what.
(with -v, -i or '-F verbosedeps')

idea & ok espie@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.20 2005/09/07 14:01:59 jmc Exp $
d3 2
a4 2
.\" FreeBSD install - a package for the installation and maintenance
.\" of non-core utilities.
a16 2
.\"
.\"     from FreeBSD: @@(#)pkg_delete.1
@


1.20
log
@use `pkg-name' rather than `pkgname' here, for consistency with other
pkg_* bits;

ok espie@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.19 2005/09/07 09:24:19 jmc Exp $
d83 2
@


1.19
log
@sort options and sync usage();
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.18 2005/09/04 22:47:56 espie Exp $
d31 1
a31 1
.Ar pkgname Op Ar ...
@


1.18
log
@* New -i interactive option, that can ask obnoxious questions.
* move the signature code to a packing-list method, prepend the pkgname.
* depend on distant listings, cache these systematically.
* cut the PKG_PATH at :/ systematically, much simpler than parsing URLs.
People should get used to trailing /s.
* let pkg_add -u actually run the update.
* check for signature in more places, for instance, let pkg_add installed_stuff
be a void operation.
* grab enough stuff during updates to check signatures, so that pkg_add -u
can report updates that are not needed right away, instead of waiting
for the more confusing `trying to update'
* beginning of @@module support.
* @@pkgpath support, including updates.
* systematically expand stems when applicable.
* use visitors systematically in pkg_info.
* pkg_info -S reports signature.
* remove hardcoding of categories in PackingList, so that future modules
will be able to expand them.
* add @@updateset and @@incompatibility keywords.
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.17 2005/01/03 01:02:45 espie Exp $
d28 1
a28 1
.Op Fl ciInqvx
d84 2
a89 2
.It Fl I
If scripts exist for a given package, do not execute them.
@


1.17
log
@rename -f -> -F
okay pvalchev@@, naddy@@, marco@@, deraadt@@

(keep -f around for the transition, will scrap it soon)
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.16 2004/12/27 22:54:25 espie Exp $
d28 1
a28 1
.Op Fl cInqvx
d84 4
@


1.16
log
@recover from a nasty problem, allow people to delete package even if
some dependency got badly adjusted.
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.15 2004/12/09 18:58:25 espie Exp $
d30 1
a30 1
.Op Fl f Ar keys
d64 1
a64 1
.It Fl f Ar keys
d66 1
a66 1
.Ar keys
@


1.15
log
@make -f scripts work again, and document it properly in both pkg_add and
pkg_delete since it now works for both.
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.14 2004/12/02 00:29:04 xsa Exp $
d73 2
@


1.14
log
@wipe old .Xr's; ok espie@@.
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.13 2004/11/15 13:20:40 jmc Exp $
d77 2
@


1.13
log
@tweaks;
ok espie@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.12 2004/11/15 10:49:19 jmc Exp $
a168 1
.Xr mkstemp 3 ,
@


1.12
log
@sort options;
ok espie@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.11 2004/11/14 11:58:43 espie Exp $
d28 1
a28 1
.Op Fl cDInqvx
d86 1
a86 1
Delete package quickly, do not bother checking md5s before removing files.
d169 2
a170 1
.Xr mkstemp 3
@


1.11
log
@turn on progress meter by default, use -x to disable it.
document the new stuff, partial reorder of options.
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.10 2004/10/11 13:10:25 espie Exp $
d60 4
a63 5
.It Fl I
If scripts exist for a given package, do not execute them.
.It Fl n
Don't actually deinstall a package, just report the steps that
would be taken if it were.
d70 1
a70 1
.Bl -tag -width keyword
d80 5
a84 4
.It Fl c
Delete extra configuration file, mentioned as
.Dl @@extra file
in the packing-list.
a147 1
.Pp
@


1.10
log
@common code for all script running.
Common option for not running scripts: -I for both pkg_add and pkg_delete.
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.9 2004/10/11 10:07:37 espie Exp $
d28 1
a28 1
.Op Fl cDInqv
a59 2
.It Fl v
Turn on verbose output.
d87 7
@


1.9
log
@kill old MTREE option that was never implemented in the new tools anyways.
kill -C and -P options which are definitely no longer used as well.
Reorder special files so that REQUIRE is at front (and it's executed first
anyways).
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.8 2004/08/06 16:45:51 millert Exp $
d28 1
a28 1
.Op Fl cDnqv
d62 2
a63 2
.It Fl D
If a deinstallation script exists for a given package, do not execute it.
@


1.8
log
@Use .Dl instead of a literal block when we only have a single line.  Has
the side effect of fixing some ugly indentation (or the lack thereof).
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.7 2004/02/25 21:56:12 espie Exp $
d165 1
a165 2
.Xr mkstemp 3 ,
.Xr mtree 8
@


1.7
log
@Add -B support to pkg_delete.
new method in Logger, annotate, so that the pkg_delete log script can
set
PKG_DESTDIR=  conditionally, and use ${PKG_DESTDIR} later on in filenames.
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.6 2004/01/27 15:34:31 espie Exp $
d85 1
a85 3
.Bd -literal
@@extra file
.Ed
@


1.6
log
@more forced keywords.
`looks sane' henning@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.5 2004/01/27 14:50:52 espie Exp $
d29 1
d55 5
a59 1
.Bl -tag -width keyword
d146 17
@


1.5
log
@first series of -forced switches, looks okay to henning@@.
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.4 2004/01/27 13:09:16 espie Exp $
d69 4
d74 3
a76 1
install even if not running as root.
@


1.4
log
@-f framework, manpage fixes.
comments and okay jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.3 2003/11/14 23:03:55 espie Exp $
d67 5
@


1.3
log
@synch doc with reality
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.2 2003/10/26 10:33:24 espie Exp $
d28 3
a30 2
.Op Fl cvDnfq
.Ar pkg-name Op Ar ...
d39 2
a40 1
Package names may be specified either as the package name itself, or as filenames which consist of the package name plus the
d42 10
a51 5
,
.Dq .tar.gz
, or the
.Dq .tar
suffix.
d54 1
a54 3
.Bl -tag -width Ds
.It Ar pkg-name Op Ar ...
The named packages are deinstalled.
d62 5
a66 3
.It Fl f
Force removal of the package, even if a dependency is recorded or the
deinstall or require script fails.
d78 6
a83 4
does pretty much what it says.
It examines installed package records in
.Pa /var/db/pkg/<pkg-name> ,
deletes the package contents, and finally removes the package records.
d85 2
a86 1
If a package is required by other installed packages,
d88 1
a88 4
will list those dependent packages and refuse to delete the package
(unless the
.Fl f
option is given).
d102 1
a102 1
.Ar pkg-name
d114 2
a115 4
It is this script's responsibility to clean up any additional messy details
around the package's installation, since all
.Nm
knows how to do is delete the files created in the original distribution.
@


1.2
log
@Partial synch with reality, ok sturm.
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.1 2003/10/19 18:38:06 espie Exp $
d28 1
a28 2
.Op Fl cvDdnfq
.Op Fl p Ar prefix
a124 13
All scripts are called with the environment variable
.Ev PKG_PREFIX
set to the installation prefix (see the
.Fl p
option above).
This allows a package author to write a script
that reliably performs some action on the directory where the package
is installed, even if the user might have changed it by specifying the
.Fl p
option when running
.Nm
or
.Cm pkg_add .
@


1.1
log
@Add manpages, with a few minor changes from old ones.
ok pval
@
text
@d1 1
a1 1
.\"	$OpenBSD: pkg_delete.1,v 1.17 2003/08/21 20:24:56 espie Exp $
a57 19
.It Fl p Ar prefix
Set
.Ar prefix
as the directory in which to delete files from any installed packages
which do not explicitly set theirs.
For most packages, the prefix will
be set automatically to the installed location by
.Xr pkg_add 1 .
.It Fl d
Remove empty directories created by file cleanup.
By default, only
files/directories explicitly listed in a package's contents (either as
normal files/directories or with the
.Cm @@dirrm
directive) will be removed at deinstallation time.
This option tells
.Nm
to also remove any directories that were emptied as a result of removing
the package.
@

