head	1.6;
access;
symbols
	OPENBSD_3_3:1.4.0.2
	OPENBSD_3_3_BASE:1.4
	OPENBSD_3_2:1.3.0.4
	OPENBSD_3_2_BASE:1.3
	OPENBSD_3_1:1.3.0.2
	OPENBSD_3_1_BASE:1.3
	OPENBSD_3_0:1.1.0.20
	OPENBSD_3_0_BASE:1.1
	OPENBSD_2_9_BASE:1.1
	OPENBSD_2_9:1.1.0.18
	OPENBSD_2_8:1.1.0.16
	OPENBSD_2_8_BASE:1.1
	OPENBSD_2_7:1.1.0.14
	OPENBSD_2_7_BASE:1.1
	OPENBSD_2_6:1.1.0.12
	OPENBSD_2_6_BASE:1.1
	OPENBSD_2_5:1.1.0.10
	OPENBSD_2_5_BASE:1.1
	OPENBSD_2_4:1.1.0.8
	OPENBSD_2_4_BASE:1.1
	OPENBSD_2_3:1.1.0.6
	OPENBSD_2_3_BASE:1.1
	OPENBSD_2_2:1.1.0.4
	OPENBSD_2_2_BASE:1.1
	OPENBSD_2_1:1.1.0.2
	OPENBSD_2_1_BASE:1.1;
locks; strict;
comment	@ * @;


1.6
date	2003.06.22.23.57.07;	author maja;	state dead;
branches;
next	1.5;

1.5
date	2003.05.05.08.37.05;	author avsm;	state Exp;
branches;
next	1.4;

1.4
date	2003.02.13.05.54.39;	author maja;	state Exp;
branches;
next	1.3;

1.3
date	2002.01.01.21.15.03;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	2001.11.19.09.03.07;	author deraadt;	state Exp;
branches;
next	1.1;

1.1
date	97.03.30.20.51.22;	author maja;	state Exp;
branches;
next	;


desc
@@


1.6
log
@Remove files without copyright. Add a yp v1 protocol specification and
generate files at compile time. -moj  ok @@deraadt
@
text
@/*
 * Please do not edit this file.
 * It was generated using rpcgen.
 */

#include <rpcsvc/yp.h>
#include "ypv1.h"
#ifndef lint
static const char rcsid[] = "$OpenBSD: ypserv_xdr_v1.c,v 1.5 2003/05/05 08:37:05 avsm Exp $";
#endif /* not lint */

bool_t
xdr_ypreqtype(xdrs, objp)
	XDR *xdrs;
	ypreqtype *objp;
{
	if (!xdr_enum(xdrs, (enum_t *)objp)) {
		return (FALSE);
	}
	return (TRUE);
}

bool_t
xdr_ypresptype(xdrs, objp)
	XDR *xdrs;
	ypresptype *objp;
{
	if (!xdr_enum(xdrs, (enum_t *)objp)) {
		return (FALSE);
	}
	return (TRUE);
}

bool_t
xdr_yprequest(xdrs, objp)
	XDR *xdrs;
	yprequest *objp;
{
	if (!xdr_ypreqtype(xdrs, &objp->yp_reqtype)) {
		return (FALSE);
	}
	switch (objp->yp_reqtype) {
	case YPREQ_KEY:
		if (!xdr_ypreq_key(xdrs, &objp->yp_reqbody.yp_req_keytype)) {
			return (FALSE);
		}
		break;
	case YPREQ_NOKEY:
		if (!xdr_ypreq_nokey(xdrs, &objp->yp_reqbody.yp_req_nokeytype)) {
			return (FALSE);
		}
		break;
	case YPREQ_MAP_PARMS:
		if (!xdr_ypmap_parms(xdrs, &objp->yp_reqbody.yp_req_map_parmstype)) {
			return (FALSE);
		}
		break;
	default:
		return (FALSE);
	}
	return (TRUE);
}

bool_t
xdr_ypresponse(xdrs, objp)
	XDR *xdrs;
	ypresponse *objp;
{
	if (!xdr_ypresptype(xdrs, &objp->yp_resptype)) {
		return (FALSE);
	}
	switch (objp->yp_resptype) {
	case YPRESP_VAL:
		if (!xdr_ypresp_val(xdrs, &objp->yp_respbody.yp_resp_valtype)) {
			return (FALSE);
		}
		break;
	case YPRESP_KEY_VAL:
		if (!xdr_ypresp_key_val(xdrs, &objp->yp_respbody.yp_resp_key_valtype)) {
			return (FALSE);
		}
		break;
	case YPRESP_MAP_PARMS:
		if (!xdr_ypmap_parms(xdrs, &objp->yp_respbody.yp_resp_map_parmstype)) {
			return (FALSE);
		}
		break;
	default:
		return (FALSE);
	}
	return (TRUE);
}
@


1.5
log
@-Wall cleanup: trim unused vars, better err() message in stdhosts,
and constify rcsid[]

deraadt@@ ok
@
text
@d9 1
a9 1
static const char rcsid[] = "$OpenBSD: ypserv_xdr_v1.c,v 1.4 2003/02/13 05:54:39 maja Exp $";
@


1.4
log
@This fixes the problem with ypxfr switching key and value on map transfer.

This will make librpcsvc follow the real protocol and not the incorrect
specification in yp.x.

The changes in yp.x is from FreeBSD. A make build is the simplest way
to get things working but the following five step is an alternative

   1) make depend && make && make install  in lib/librpcsvc
   2) make includes                        in lib/librpcsvc
   3) make depend && make && make install  in lib/libc
   4) make depend && make && make install  in usr.sbin/ypserv/ypserv
   5) make depend && make && make install  in usr.sbin/ypserv/ypxfr

-moj ok niklas@@ ho@@
@
text
@d9 1
a9 1
static char rcsid[] = "$OpenBSD: ypserv_xdr_v1.c,v 1.3 2002/01/01 21:15:03 deraadt Exp $";
a16 2
	int32_t *buf;

a27 2
	int32_t *buf;

a68 2
	int32_t *buf;

@


1.3
log
@bit more cleanup
@
text
@d6 1
a6 1
#include "yp.h"
d9 1
a9 1
static char rcsid[] = "$OpenBSD: ypserv_xdr_v1.c,v 1.2 2001/11/19 09:03:07 deraadt Exp $";
@


1.2
log
@use a private svc_run() function that checks for a signal handler flag;
now signal safe.  Also, massive KNF.
@
text
@d9 1
a9 1
static char rcsid[] = "$OpenBSD: ypserv_xdr_v1.c,v 1.1 1997/03/30 20:51:22 maja Exp $";
d17 1
a17 1
	register long *buf;
d30 1
a30 1
	register long *buf;
a43 1
		printf("error 1\n");
a48 1
			printf("error 2\n");
a53 1
			printf("error 3\n");
a58 1
			printf("error 4\n");
a62 1
		printf("error 5\n");
d73 1
a73 1
	register long *buf;
@


1.1
log
@Added support for YP V1. Partly from FreeBSD. -moj
@
text
@d9 1
a9 1
static char rcsid[] = "$OpenBSD$";
d17 1
d19 3
a21 5
	 register long *buf;

	 if (!xdr_enum(xdrs, (enum_t *)objp)) {
		 return (FALSE);
	 }
d30 1
d32 3
a34 5
	 register long *buf;

	 if (!xdr_enum(xdrs, (enum_t *)objp)) {
		 return (FALSE);
	 }
d68 1
a68 1
		return (FALSE);	 	
a77 1

a103 1

@

