head	1.14;
access;
symbols
	OPENBSD_6_1:1.12.0.8
	OPENBSD_6_1_BASE:1.12
	OPENBSD_6_0:1.12.0.4
	OPENBSD_6_0_BASE:1.12
	OPENBSD_5_9:1.12.0.2
	OPENBSD_5_9_BASE:1.12
	OPENBSD_5_8:1.11.0.50
	OPENBSD_5_8_BASE:1.11
	OPENBSD_5_7:1.11.0.42
	OPENBSD_5_7_BASE:1.11
	OPENBSD_5_6:1.11.0.46
	OPENBSD_5_6_BASE:1.11
	OPENBSD_5_5:1.11.0.44
	OPENBSD_5_5_BASE:1.11
	OPENBSD_5_4:1.11.0.40
	OPENBSD_5_4_BASE:1.11
	OPENBSD_5_3:1.11.0.38
	OPENBSD_5_3_BASE:1.11
	OPENBSD_5_2:1.11.0.36
	OPENBSD_5_2_BASE:1.11
	OPENBSD_5_1_BASE:1.11
	OPENBSD_5_1:1.11.0.34
	OPENBSD_5_0:1.11.0.32
	OPENBSD_5_0_BASE:1.11
	OPENBSD_4_9:1.11.0.30
	OPENBSD_4_9_BASE:1.11
	OPENBSD_4_8:1.11.0.28
	OPENBSD_4_8_BASE:1.11
	OPENBSD_4_7:1.11.0.24
	OPENBSD_4_7_BASE:1.11
	OPENBSD_4_6:1.11.0.26
	OPENBSD_4_6_BASE:1.11
	OPENBSD_4_5:1.11.0.22
	OPENBSD_4_5_BASE:1.11
	OPENBSD_4_4:1.11.0.20
	OPENBSD_4_4_BASE:1.11
	OPENBSD_4_3:1.11.0.18
	OPENBSD_4_3_BASE:1.11
	OPENBSD_4_2:1.11.0.16
	OPENBSD_4_2_BASE:1.11
	OPENBSD_4_1:1.11.0.14
	OPENBSD_4_1_BASE:1.11
	OPENBSD_4_0:1.11.0.12
	OPENBSD_4_0_BASE:1.11
	OPENBSD_3_9:1.11.0.10
	OPENBSD_3_9_BASE:1.11
	OPENBSD_3_8:1.11.0.8
	OPENBSD_3_8_BASE:1.11
	OPENBSD_3_7:1.11.0.6
	OPENBSD_3_7_BASE:1.11
	OPENBSD_3_6:1.11.0.4
	OPENBSD_3_6_BASE:1.11
	OPENBSD_3_5:1.11.0.2
	OPENBSD_3_5_BASE:1.11
	OPENBSD_3_4:1.10.0.2
	OPENBSD_3_4_BASE:1.10
	OPENBSD_3_3:1.9.0.2
	OPENBSD_3_3_BASE:1.9
	OPENBSD_3_2:1.8.0.4
	OPENBSD_3_2_BASE:1.8
	OPENBSD_3_1:1.8.0.2
	OPENBSD_3_1_BASE:1.8
	OPENBSD_3_0:1.5.0.18
	OPENBSD_3_0_BASE:1.5
	OPENBSD_2_9_BASE:1.5
	OPENBSD_2_9:1.5.0.16
	OPENBSD_2_8:1.5.0.14
	OPENBSD_2_8_BASE:1.5
	OPENBSD_2_7:1.5.0.12
	OPENBSD_2_7_BASE:1.5
	OPENBSD_2_6:1.5.0.10
	OPENBSD_2_6_BASE:1.5
	OPENBSD_2_5:1.5.0.8
	OPENBSD_2_5_BASE:1.5
	OPENBSD_2_4:1.5.0.6
	OPENBSD_2_4_BASE:1.5
	OPENBSD_2_3:1.5.0.4
	OPENBSD_2_3_BASE:1.5
	OPENBSD_2_2:1.5.0.2
	OPENBSD_2_2_BASE:1.5
	OPENBSD_2_1:1.4.0.2
	OPENBSD_2_1_BASE:1.4
	OPENBSD_2_0:1.3.0.2
	OPENBSD_2_0_BASE:1.3;
locks; strict;
comment	@# @;


1.14
date	2017.07.10.21.30.37;	author espie;	state Exp;
branches;
next	1.13;
commitid	XYfTVJ6bHQf1fCDD;

1.13
date	2017.06.16.10.25.54;	author espie;	state Exp;
branches;
next	1.12;
commitid	Yn1L9TuGVODhqMDI;

1.12
date	2015.10.26.10.12.46;	author deraadt;	state Exp;
branches;
next	1.11;
commitid	fit45WT7q8GoIZrc;

1.11
date	2004.01.20.21.06.02;	author matthieu;	state Exp;
branches;
next	1.10;

1.10
date	2003.06.22.23.57.07;	author maja;	state Exp;
branches;
next	1.9;

1.9
date	2003.02.13.05.54.39;	author maja;	state Exp;
branches;
next	1.8;

1.8
date	2002.01.01.21.10.59;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	2001.12.05.10.02.37;	author deraadt;	state Exp;
branches;
next	1.6;

1.6
date	2001.12.01.23.27.24;	author miod;	state Exp;
branches;
next	1.5;

1.5
date	97.08.09.23.10.11;	author maja;	state Exp;
branches;
next	1.4;

1.4
date	97.03.30.20.51.17;	author maja;	state Exp;
branches;
next	1.3;

1.3
date	96.05.30.09.53.23;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	96.01.20.00.40.15;	author chuck;	state Exp;
branches;
next	1.1;

1.1
date	95.11.01.16.56.30;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.14
log
@remove misc. depend and yacc nits that no longer matter.
okay millert@@
@
text
@#	$OpenBSD: Makefile,v 1.13 2017/06/16 10:25:54 espie Exp $

PROG=	ypserv
MAN=	ypserv.acl.5 securenet.5 ypserv.8

XSRCS=	ypv1.x
TSRCS=	${XSRCS:R:S/$/.c/g}
HDRS=	${XSRCS:R:S/$/.h/g}
SRCS+=	${TSRCS}

SRCS+=	ypserv.c ypserv_proc.c ypserv_db.c acl.c yplog.c ypdb.c

CLEANFILES+=	${TSRCS} ${HDRS}

LDADD+=	-lrpcsvc
DPADD+=	${LIBRPCSVC}
.PATH:	${.CURDIR}/../common
CFLAGS+=-DDAEMON -DOPTDB -I${.CURDIR}/../common -I.
#CFLAGS=-DDAEMON -I${.CURDIR}/../common  -DDEBUG -g

all:	ypserv
ypv1.c: ypv1.h

BUILDFIRST =	${HDRS}

ypv1.c: ypv1.x
	rpcgen -C -c ${.CURDIR}/ypv1.x -o ypv1.c

ypv1.h: ypv1.x
	rpcgen -C -h ${.CURDIR}/ypv1.x -o ypv1.h

.include <bsd.prog.mk>
@


1.13
log
@mark files as BUILDFIRST, or write explicit dependencies, so that most
programs will build even without a make depend first.
okay tb@@ millert@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.12 2015/10/26 10:12:46 deraadt Exp $
a21 1
beforedepend:	${HDRS}
@


1.12
log
@last consumer in base of pidfile()...
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.11 2004/01/20 21:06:02 matthieu Exp $
d25 1
@


1.11
log
@explicit .x.[ch] rules to avoid accidental bad matches in /usr/include.
ok millert@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.10 2003/06/22 23:57:07 maja Exp $
d15 2
a16 2
LDADD+=	-lutil -lrpcsvc
DPADD+=	${LIBUTIL} ${LIBRPCSVC}
@


1.10
log
@Remove files without copyright. Add a yp v1 protocol specification and
generate files at compile time. -moj  ok @@deraadt
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.9 2003/02/13 05:54:39 maja Exp $
a24 1
.include <bsd.prog.mk>
d26 2
a27 1
.SUFFIXES: .x .c .h
d29 2
a30 2
.x.c:
	rpcgen -C -c ${.IMPSRC} -o ${.TARGET}
d32 1
a32 2
.x.h:
	rpcgen -C -h ${.IMPSRC} -o ${.TARGET}
@


1.9
log
@This fixes the problem with ypxfr switching key and value on map transfer.

This will make librpcsvc follow the real protocol and not the incorrect
specification in yp.x.

The changes in yp.x is from FreeBSD. A make build is the simplest way
to get things working but the following five step is an alternative

   1) make depend && make && make install  in lib/librpcsvc
   2) make includes                        in lib/librpcsvc
   3) make depend && make && make install  in lib/libc
   4) make depend && make && make install  in usr.sbin/ypserv/ypserv
   5) make depend && make && make install  in usr.sbin/ypserv/ypxfr

-moj ok niklas@@ ho@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.8 2002/01/01 21:10:59 deraadt Exp $
a3 2
SRCS=	ypserv.c ypserv_proc.c ypserv_db.c acl.c yplog.c ypdb.c \
	ypserv_xdr_v1.c
d5 10
d18 1
a18 1
CFLAGS+=-DDAEMON -DOPTDB -I${.CURDIR}/../common
d21 4
d26 8
@


1.8
log
@go back to the swapped xdr_ypresp_key_val for now
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 2001/12/05 10:02:37 deraadt Exp $
d5 1
a5 1
	ypserv_xdr.c ypserv_xdr_v1.c
@


1.7
log
@this stuff is supplied by -lrpcsvc
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.6 2001/12/01 23:27:24 miod Exp $
d4 2
a5 1
SRCS=	ypserv.c ypserv_proc.c ypserv_db.c acl.c yplog.c ypdb.c ypserv_xdr_v1.c
@


1.6
log
@Use pidfile() instead of doing the equivalent thing by hand, and sometimes
forgetting to unlink the pid file at exit.
ok millert@@ deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.5 1997/08/09 23:10:11 maja Exp $
d4 1
a4 2
SRCS=	ypserv.c ypserv_proc.c ypserv_db.c acl.c yplog.c ypdb.c ypserv_xdr.c \
	ypserv_xdr_v1.c
d6 2
a7 2
LDADD+=	-lutil
DPADD+=	${LIBUTIL}
@


1.5
log
@Increased performance in ypserv by two different actions:

1) ypdb_open_db now check error condition when something goes wrong.
   Instead of always as before. by request of theo.

2) turned on -DOPTDB in Makefile. This will cause ypserv to keep databases
   opened. If not defined ypserv will open and close the map for every
   request. I think it was turned off before when yppush didn't work.

   If a map changes yppush will signal to ypserv that the map has changed
   and ypserv will reopen the map.

   ypserv will start closing maps when it run out of file descriptors. Then
   it will close the map least resent used.

-moj
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.4 1997/03/30 20:51:17 maja Exp $
d7 2
@


1.4
log
@Added support for YP V1. Partly from FreeBSD. -moj
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.3 1996/05/30 09:53:23 deraadt Exp $
d8 1
a8 1
CFLAGS+=-DDAEMON -I${.CURDIR}/../common 
@


1.3
log
@$OpenBSD$ tag and few spelling errors
@
text
@d1 1
a1 1
#	$OpenBSD$
d4 2
a5 1
SRCS=	ypserv.c ypserv_proc.c ypserv_db.c acl.c yplog.c ypdb.c ypserv_xdr.c
d8 1
a8 1
CFLAGS+=-DDAEMON -I${.CURDIR}/../common
@


1.2
log
@minor clean up
@
text
@d1 1
a1 2
#	from: @@(#)Makefile	5.8 (Berkeley) 7/28/90
#	$Id: Makefile,v 1.1 1995/11/01 16:56:30 deraadt Exp $
@


1.1
log
@+ full set of ypserv tools that compile
@
text
@d2 1
a2 1
#	$Id: Makefile,v 1.8 1995/10/24 21:35:29 moj Exp $
d9 1
@
