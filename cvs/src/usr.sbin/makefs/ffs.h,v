head	1.9;
access;
symbols
	OPENBSD_6_2_BASE:1.9
	OPENBSD_6_1:1.9.0.4
	OPENBSD_6_1_BASE:1.9;
locks; strict;
comment	@ * @;


1.9
date	2016.11.13.10.22.21;	author natano;	state Exp;
branches;
next	1.8;
commitid	OTTgByMsEs4uwRyO;

1.8
date	2016.11.11.09.54.07;	author natano;	state Exp;
branches;
next	1.7;
commitid	Z4QvXKrzswQtHtNF;

1.7
date	2016.11.10.08.26.38;	author natano;	state Exp;
branches;
next	1.6;
commitid	pR23SKoOr8iJVLcB;

1.6
date	2016.11.08.19.22.29;	author natano;	state Exp;
branches;
next	1.5;
commitid	vdZl9Veq16pymCmL;

1.5
date	2016.11.06.12.33.30;	author natano;	state Exp;
branches;
next	1.4;
commitid	sPCDsy9xorF1YWTA;

1.4
date	2016.10.22.16.51.52;	author natano;	state Exp;
branches;
next	1.3;
commitid	c3bc3iog8Vd2Umt6;

1.3
date	2016.10.18.17.23.21;	author natano;	state Exp;
branches;
next	1.2;
commitid	mFWxcHDQMKvsT7VE;

1.2
date	2016.10.16.20.26.56;	author natano;	state Exp;
branches;
next	1.1;
commitid	CmcYdpJMky9LxxDQ;

1.1
date	2016.10.16.17.08.53;	author natano;	state Exp;
branches;
next	;
commitid	O38itEriwOj0afR7;


desc
@@


1.9
log
@Pick up the FS image size, the sector size and the bsize and fsize
parameters from the disklabel.

discussed with deraadt
@
text
@/*	$OpenBSD: ffs.h,v 1.6 2016/11/08 19:22:29 natano Exp $	*/
/*	$NetBSD: ffs.h,v 1.2 2011/10/09 21:33:43 christos Exp $	*/

/*
 * Copyright (c) 2001-2003 Wasabi Systems, Inc.
 * All rights reserved.
 *
 * Written by Luke Mewburn for Wasabi Systems, Inc.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions
 * are met:
 * 1. Redistributions of source code must retain the above copyright
 *    notice, this list of conditions and the following disclaimer.
 * 2. Redistributions in binary form must reproduce the above copyright
 *    notice, this list of conditions and the following disclaimer in the
 *    documentation and/or other materials provided with the distribution.
 * 3. All advertising materials mentioning features or use of this software
 *    must display the following acknowledgement:
 *      This product includes software developed for the NetBSD Project by
 *      Wasabi Systems, Inc.
 * 4. The name of Wasabi Systems, Inc. may not be used to endorse
 *    or promote products derived from this software without specific prior
 *    written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY WASABI SYSTEMS, INC. ``AS IS'' AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED
 * TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
 * PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL WASABI SYSTEMS, INC
 * BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE)
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE
 * POSSIBILITY OF SUCH DAMAGE.
 */

#ifndef _FFS_H
#define _FFS_H

typedef struct {
	char	label[MAXVOLLEN];	/* volume name/label */
	int	bsize;		/* block size */
	int	fsize;		/* fragment size */
	int	density;	/* bytes per inode */
	int	minfree;	/* free space threshold */
	int	optimization;	/* optimization (space or time) */
	int	maxbpg;		/* maximum blocks per file in a cyl group */
	int	avgfilesize;	/* expected average file size */
	int	avgfpdir;	/* expected # of files per directory */
	int	version;	/* filesystem version (1 = FFS, 2 = UFS2) */
	int	maxbsize;	/* maximum extent size */
	int	maxblkspercg;	/* max # of blocks per cylinder group */

	struct disklabel *lp;	/* disk label */
	struct partition *pp;	/* matching FFS partition in disklabel */
} ffs_opt_t;

#endif /* _FFS_H */
@


1.8
log
@Clean up FFS option handling somewhat; no functional change.
@
text
@d1 1
a1 1
/*	$OpenBSD: ffs.h,v 1.7 2016/11/10 08:26:38 natano Exp $	*/
d57 1
@


1.7
log
@Remove the unused cpg field from ffs_opt_t.
@
text
@d1 1
a1 1
/*	$OpenBSD: ffs.h,v 1.6 2016/11/08 19:22:29 natano Exp $	*/
a48 1
	int	maxcontig;	/* max contiguous blocks to allocate */
@


1.6
log
@Add a disklabel option that creates a disklabel with the info provided
by disktab. This is one piece of the puzzle that will allow use to build
install media without vnd.

ok deraadt
@
text
@d1 1
a1 1
/*	$OpenBSD: ffs.h,v 1.4 2016/10/22 16:51:52 natano Exp $	*/
a45 1
	int	cpg;		/* cylinders per group */
@


1.5
log
@Remove unused fields from ffs_opt_t.
@
text
@d57 2
@


1.4
log
@Include our own <ufs/ufs/dinode.h>, <ufs/ufs/dir.h> and <ufs/ffs/fs.h>
header files instead of relying on copies of NetBSD's headers. This
required some changes in the .c files, due to renamed fields, functions
and preprocessor macros. Also pull in our own ffs_tables.c. As a bonus
this diff gets rid of layout compatibility issues in the superblock
(position of the fs_flags field).
@
text
@d1 1
a1 1
/*	$OpenBSD: ffs.h,v 1.3 2016/10/18 17:23:21 natano Exp $	*/
a46 1
	int	cpgflg;		/* cpg was specified by user */
a47 3
	int	ntracks;	/* number of tracks */
	int	nsectors;	/* number of sectors */
	int	rpm;		/* rpm */
a50 1
	int	rotdelay;	/* rotational delay between blocks */
a51 1
	int	nrpos;		/* # of distinguished rotational positions */
@


1.3
log
@Merge ufs/{ufs,ffs}/ into ffs/.
@
text
@d1 1
a1 1
/*	$OpenBSD: ffs.h,v 1.2 2016/10/16 20:26:56 natano Exp $	*/
a41 3
#include "ffs/dinode.h"
#include "ffs/fs.h"

a62 1
		/* XXX: support `old' file systems ? */
@


1.2
log
@Add OpenBSD RCS tags; reminded by tb
@
text
@d1 1
a1 1
/*	$OpenBSD$	*/
d42 2
a43 2
#include <ufs/ufs/dinode.h>
#include <ufs/ffs/fs.h>
@


1.1
log
@Import makefs - a tool to create filesystem images from a directory.

This is a rough port of the NetBSD tool with some features removed we
don't need. It compiles, but I don't promise anything more. Importing
now, so we can hack on it in tree.

The supported filesystem types are: cd9660, ffs and msdosfs.

ok deraadt
@
text
@d1 1
@

