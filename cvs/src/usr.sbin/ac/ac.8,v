head	1.22;
access;
symbols
	OPENBSD_6_2_BASE:1.22
	OPENBSD_6_1:1.22.0.28
	OPENBSD_6_1_BASE:1.22
	OPENBSD_6_0:1.22.0.24
	OPENBSD_6_0_BASE:1.22
	OPENBSD_5_9:1.22.0.20
	OPENBSD_5_9_BASE:1.22
	OPENBSD_5_8:1.22.0.22
	OPENBSD_5_8_BASE:1.22
	OPENBSD_5_7:1.22.0.14
	OPENBSD_5_7_BASE:1.22
	OPENBSD_5_6:1.22.0.18
	OPENBSD_5_6_BASE:1.22
	OPENBSD_5_5:1.22.0.16
	OPENBSD_5_5_BASE:1.22
	OPENBSD_5_4:1.22.0.12
	OPENBSD_5_4_BASE:1.22
	OPENBSD_5_3:1.22.0.10
	OPENBSD_5_3_BASE:1.22
	OPENBSD_5_2:1.22.0.8
	OPENBSD_5_2_BASE:1.22
	OPENBSD_5_1_BASE:1.22
	OPENBSD_5_1:1.22.0.6
	OPENBSD_5_0:1.22.0.4
	OPENBSD_5_0_BASE:1.22
	OPENBSD_4_9:1.22.0.2
	OPENBSD_4_9_BASE:1.22
	OPENBSD_4_8:1.21.0.2
	OPENBSD_4_8_BASE:1.21
	OPENBSD_4_7:1.20.0.2
	OPENBSD_4_7_BASE:1.20
	OPENBSD_4_6:1.20.0.4
	OPENBSD_4_6_BASE:1.20
	OPENBSD_4_5:1.19.0.6
	OPENBSD_4_5_BASE:1.19
	OPENBSD_4_4:1.19.0.4
	OPENBSD_4_4_BASE:1.19
	OPENBSD_4_3:1.19.0.2
	OPENBSD_4_3_BASE:1.19
	OPENBSD_4_2:1.18.0.2
	OPENBSD_4_2_BASE:1.18
	OPENBSD_4_1:1.17.0.2
	OPENBSD_4_1_BASE:1.17
	OPENBSD_4_0:1.14.0.4
	OPENBSD_4_0_BASE:1.14
	OPENBSD_3_9:1.14.0.2
	OPENBSD_3_9_BASE:1.14
	OPENBSD_3_8:1.11.0.12
	OPENBSD_3_8_BASE:1.11
	OPENBSD_3_7:1.11.0.10
	OPENBSD_3_7_BASE:1.11
	OPENBSD_3_6:1.11.0.8
	OPENBSD_3_6_BASE:1.11
	OPENBSD_3_5:1.11.0.6
	OPENBSD_3_5_BASE:1.11
	OPENBSD_3_4:1.11.0.4
	OPENBSD_3_4_BASE:1.11
	OPENBSD_3_3:1.11.0.2
	OPENBSD_3_3_BASE:1.11
	OPENBSD_3_2:1.10.0.4
	OPENBSD_3_2_BASE:1.10
	OPENBSD_3_1:1.10.0.2
	OPENBSD_3_1_BASE:1.10
	OPENBSD_3_0:1.8.0.4
	OPENBSD_3_0_BASE:1.8
	OPENBSD_2_9_BASE:1.8
	OPENBSD_2_9:1.8.0.2
	OPENBSD_2_8:1.7.0.4
	OPENBSD_2_8_BASE:1.7
	OPENBSD_2_7:1.7.0.2
	OPENBSD_2_7_BASE:1.7
	OPENBSD_2_6:1.6.0.2
	OPENBSD_2_6_BASE:1.6
	OPENBSD_2_5:1.3.0.2
	OPENBSD_2_5_BASE:1.3
	OPENBSD_2_4:1.2.0.10
	OPENBSD_2_4_BASE:1.2
	OPENBSD_2_3:1.2.0.8
	OPENBSD_2_3_BASE:1.2
	OPENBSD_2_2:1.2.0.6
	OPENBSD_2_2_BASE:1.2
	OPENBSD_2_1:1.2.0.4
	OPENBSD_2_1_BASE:1.2
	OPENBSD_2_0:1.2.0.2
	OPENBSD_2_0_BASE:1.2
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@.\" @;


1.22
date	2010.09.03.11.22.36;	author jmc;	state Exp;
branches;
next	1.21;

1.21
date	2010.07.04.10.17.25;	author millert;	state Exp;
branches;
next	1.20;

1.20
date	2009.04.26.13.10.20;	author tobias;	state Exp;
branches;
next	1.19;

1.19
date	2007.11.17.15.08.57;	author sobrado;	state Exp;
branches;
next	1.18;

1.18
date	2007.05.31.19.20.21;	author jmc;	state Exp;
branches;
next	1.17;

1.17
date	2007.02.03.18.48.55;	author jmc;	state Exp;
branches;
next	1.16;

1.16
date	2007.02.03.18.47.02;	author jmc;	state Exp;
branches;
next	1.15;

1.15
date	2007.02.02.14.53.37;	author ajacoutot;	state Exp;
branches;
next	1.14;

1.14
date	2005.11.17.14.42.06;	author jmc;	state Exp;
branches;
next	1.13;

1.13
date	2005.11.16.12.35.44;	author jmc;	state Exp;
branches;
next	1.12;

1.12
date	2005.11.12.16.21.18;	author jmc;	state Exp;
branches;
next	1.11;

1.11
date	2003.03.18.08.37.34;	author jmc;	state Exp;
branches;
next	1.10;

1.10
date	2002.03.13.22.31.41;	author marc;	state Exp;
branches;
next	1.9;

1.9
date	2002.02.13.08.33.47;	author mpech;	state Exp;
branches;
next	1.8;

1.8
date	2000.11.09.17.53.10;	author aaron;	state Exp;
branches;
next	1.7;

1.7
date	2000.03.19.17.56.58;	author aaron;	state Exp;
branches;
next	1.6;

1.6
date	99.09.23.04.12.10;	author alex;	state Exp;
branches;
next	1.5;

1.5
date	99.07.09.13.35.53;	author aaron;	state Exp;
branches;
next	1.4;

1.4
date	99.06.05.22.16.18;	author aaron;	state Exp;
branches;
next	1.3;

1.3
date	98.11.08.00.21.25;	author aaron;	state Exp;
branches;
next	1.2;

1.2
date	96.10.08.01.21.00;	author michaels;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.47.09;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.47.09;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.22
log
@add an EXIT STATUS section for /usr/sbin;
@
text
@.\"	$OpenBSD: ac.8,v 1.21 2010/07/04 10:17:25 millert Exp $
.\"
.\" Copyright (c) 1994 Simon J. Gerraty
.\" Copyright (c) 1994 Christopher G. Demetriou
.\" All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"      This product includes software developed by Christopher G. Demetriou.
.\" 3. The name of the author may not be used to endorse or promote products
.\"    derived from this software without specific prior written permission
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE AUTHOR ``AS IS'' AND ANY EXPRESS OR
.\" IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
.\" OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED.
.\" IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY DIRECT, INDIRECT,
.\" INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT
.\" NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
.\" DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
.\" THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
.\" (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF
.\" THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
.\"
.Dd $Mdocdate: July 4 2010 $
.Dt AC 8
.Os
.Sh NAME
.Nm ac
.Nd connect time accounting
.Sh SYNOPSIS
.Nm ac
.Op Fl dp
.Op Fl t Ar tty
.Op Fl w Ar wtmp
.Op Ar user ...
.Sh DESCRIPTION
If the file
.Pa /var/log/wtmp
exists, a record of individual login and logout
times are written to it by
.Xr login 1
and
.Xr init 8 ,
respectively.
.Nm
examines these records and writes the accumulated connect time
for all logins to the standard output.
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl d
Display the connect times in 24 hour chunks.
.It Fl p
Print individual users' totals.
.It Fl t Ar tty
Only do accounting logins on certain ttys.
The
.Ar tty
specification can start with
.Ql \&!
to indicate not this
.Ar tty
and end with
.Ql *
to indicate all similarly named ttys.
Multiple
.Fl t
flags may be specified.
.It Fl w Ar wtmp
Read connect time data from
.Ar wtmp
instead of the default file,
.Pa /var/log/wtmp .
.It Ar user ...
Display totals for the given individuals only.
.El
.Pp
If no arguments are given,
.Nm
displays the total connect time for all
accounts with login sessions recorded in
.Xr wtmp 5 .
.Pp
The default
.Pa wtmp
file will increase without bound unless it is truncated.
It is normally truncated by
.Xr newsyslog 8 ,
which renames and rotates the
.Pa wtmp
files every week.
In order for
.Nm
to run in sync with the rotation of
.Pa wtmp ,
.Xr newsyslog 8
is configured to run
just after
.Nm
completes.
.Pp
User accounting information can be mailed weekly
to the system administrator:
see
.Xr weekly 8
for more information.
No login or connect time accounting is performed if
.Pa /var/log/wtmp
does not exist.
.Sh FILES
.Bl -tag -width "/var/log/wtmp.[0-7]XX" -compact
.It Pa /var/log/wtmp
connect time accounting file
.It Pa /var/log/wtmp.[0-7]
rotated files
.El
.Sh EXIT STATUS
.Ex -std ac
.Sh EXAMPLES
Allow times recorded in
.Pa modems
to be charged out at a different rate than
.Pa other :
.Bd -literal -offset indent
$ ac -p -t "ttyd*" \*(Gt modems
$ ac -p -t "!ttyd*" \*(Gt other
.Ed
.Sh SEE ALSO
.Xr login 1 ,
.Xr wtmp 5 ,
.Xr cron 8 ,
.Xr init 8 ,
.Xr newsyslog 8 ,
.Xr sa 8
.Sh HISTORY
An
.Nm
command appeared in
.At v6 .
This version of
.Nm
was written for
.Nx 0.9a
from the specification provided by various systems' manual pages.
@


1.21
log
@Remove the non-standard, commented out, -c option.
OK tedu@@ jmc@@ deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: ac.8,v 1.20 2009/04/26 13:10:20 tobias Exp $
d32 1
a32 1
.Dd $Mdocdate: April 26 2009 $
a117 2
.Pp
.Ex -std ac
d125 2
@


1.20
log
@typos fixed

ok jmc
@
text
@d1 1
a1 1
.\"	$OpenBSD: ac.8,v 1.19 2007/11/17 15:08:57 sobrado Exp $
d32 1
a32 1
.Dd $Mdocdate: November 17 2007 $
a40 1
.\".Op Fl c Ar console
a60 8
.\" .It Fl c Ar console
.\" Use
.\" .Ar console
.\" as the name of the device that local X sessions (ut_host of ":0.0")
.\" originate from.  If any login has been recorded on
.\" .Ar console
.\" then these X sessions are ignored unless COMPAT_SUNOS was defined at
.\" compile time.
a152 20
.\" .Sh NOTES
.\" If COMPAT_SUNOS is defined
.\" .Nm ac
.\" ignores the fact that entries with ut_host of ":0.0" are not real
.\" login sessions.  Normally such entries are ignored except in the case
.\" of a user being logged in when the
.\" .Pa wtmp
.\" file was rotated, in which case a login with ut_host of ":0.0" may
.\" appear without any preceding console logins.
.\" If no one is logged in on the console, the user is deemed to have
.\" logged in on at the earliest time stamp found in
.\" .Pa wtmp .
.\" Use of
.\" .Pa console
.\" allows
.\" .Nm ac
.\" to identify and correctly process a logout for the user.  The default
.\" value for
.\" .Pa console
.\" is usually correct at compile time.
@


1.19
log
@the usage message should start with "usage:";
no need for "users", ellipsis allows various users to be specified;
synchronize synopsis and usage

ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: ac.8,v 1.18 2007/05/31 19:20:21 jmc Exp $
d32 1
a32 1
.Dd $Mdocdate: May 31 2007 $
d178 1
a178 1
.\" to identify and correcty process a logout for the user.  The default
@


1.18
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: ac.8,v 1.17 2007/02/03 18:48:55 jmc Exp $
d32 1
a32 1
.Dd $Mdocdate$
d44 1
a44 1
.Op Ar users ...
d91 1
a91 1
.It Ar users ...
@


1.17
log
@use .Ex;
@
text
@d1 1
a1 1
.\"	$OpenBSD: ac.8,v 1.16 2007/02/03 18:47:02 jmc Exp $
d32 1
a32 1
.Dd March 15, 1994
@


1.16
log
@point to weekly(8);
ok/help ajacoutot
@
text
@d1 1
a1 1
.\"	$OpenBSD: ac.8,v 1.15 2007/02/02 14:53:37 ajacoutot Exp $
d128 1
a128 3
The
.Nm
utility exits 0 on success or \*(Gt0 if a fatal error occurred.
@


1.15
log
@- cope with recent weekly and newsyslog.conf changes

some review by jason@@, ok mk@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: ac.8,v 1.14 2005/11/17 14:42:06 jmc Exp $
d119 5
@


1.14
log
@restructure the wtmp/newsyslog blurb slightly, to make this read better;
@
text
@d1 1
a1 1
.\"	$OpenBSD: ac.8,v 1.13 2005/11/16 12:35:44 jmc Exp $
d108 1
a108 1
files, keeping a week's worth of data on hand.
d114 1
a114 1
will have to be altered to run
a117 16
A suggested procedure is to
uncomment the
.Nm
entry provided in
.Xr weekly 8
and make the following amendment to
.Pa /etc/newsyslog :
.Bd -literal -offset 3n
/var/log/wtmp	644  7     *    $W6D4	ZB
.Ed
.Pp
This will provide weekly mail reports on user accounting information,
truncating the log file just after
.Xr weekly 8
is run from root's
.Xr crontab 5 .
@


1.13
log
@rework the section on syncing log rotation on /etc/weekly, which of
course don't necessarily run together;

pointed out by hugo villeneuve, and indeed the fix comes from him;

also move the examples into an EXAMPLES section, and make FILES a little
better too;
@
text
@d1 1
a1 1
.\"	$OpenBSD: ac.8,v 1.12 2005/11/12 16:21:18 jmc Exp $
d116 6
d123 2
a124 4
completes.
A suggested amendment to
.Pa /etc/newsyslog
is as follows:
d129 2
a130 1
This will truncate the log file just after
a133 6
For weekly mail reports on user accounting information,
uncomment the
.Nm
entry provided in
.Xr weekly 8
as well as making the change suggested above.
@


1.12
log
@clarify how wtmp is rotated, since it was rather misleading;
@
text
@d1 1
a1 1
.\"	$OpenBSD$
d99 1
a99 1
.Pa wtmp .
a105 2
run by
.Xr cron 8 ,
d108 28
a135 2
files, keeping a week's worth of data on
hand.
a139 11
For example,
.Bd -literal -offset
$ ac -p -t "ttyd*" > modems
$ ac -p -t "!ttyd*" > other
.Ed
.Pp
allows times recorded in
.Pa modems
to be charged out at a different rate than
.Pa other .
.Pp
d142 1
a142 1
utility exits 0 on success or >0 if a fatal error occurred.
d144 1
a144 1
.Bl -tag -width /var/log/wtmp.[0-7] -compact
d150 9
d161 1
a161 1
.Xr utmp 5 ,
@


1.11
log
@small typos;

ok miod@@
@
text
@d1 2
a31 2
.\"	$Id: ac.8,v 1.10 2002/03/13 22:31:41 marc Exp $
.\"
d104 3
a106 2
It is normally truncated by the daily scripts run
by
d108 1
a108 1
which rename and rotate the
d140 1
d142 1
@


1.10
log
@login(8) -> login(1)
@
text
@d30 1
a30 1
.\"	$Id: ac.8,v 1.9 2002/02/13 08:33:47 mpech Exp $
d159 1
a159 1
.\" appear without any preceeding console logins.
@


1.9
log
@When you give command examples and etc., in a manual page prefix them with:
$ command
or
# command

deraadt@@ ok
@
text
@d30 1
a30 1
.\"	$Id: ac.8,v 1.8 2000/11/09 17:53:10 aaron Exp $
d50 1
a50 1
.Xr login 8
@


1.8
log
@Change all option list specifications to ".Bl -tag -width Ds". Most man
pages just needed their -width parameter tweaked to "Ds", which provides
a nice width of 6 constant characters. For consistency more than anything.
@
text
@d30 1
a30 1
.\"	$Id: ac.8,v 1.7 2000/03/19 17:56:58 aaron Exp $
d117 2
a118 2
ac -p -t "ttyd*" > modems
ac -p -t "!ttyd*" > other
@


1.7
log
@Remove hard sentence breaks. Add $OpenBSD$ tags where appropriate. Some other
cleanup along the way.
@
text
@d30 1
a30 1
.\"	$Id: ac.8,v 1.6 1999/09/23 04:12:10 alex Exp $
d59 1
a59 1
.Bl -tag -width indentXXX
@


1.6
log
@Typo fixes.
@
text
@a0 1
.\"
d30 1
a30 1
.\"	$Id: ac.8,v 1.5 1999/07/09 13:35:53 aaron Exp $
d73 2
a74 1
Only do accounting logins on certain ttys.  The
d110 2
a111 1
hand.  No login or connect time accounting is performed if
@


1.5
log
@- remove all trailing whitespace
     * except when it is escaped with a `\' at the end of the line
- fix remaining .Nm usage as well
- this is from a patch I received from kwesterback@@home.com, who has been
  working on some scripts for fixing formatting errors in mdoc'd man pages

Ok, so there could be a cost/benefit debate with this commit, but since I have
the patch we might as well commit it...
@
text
@d31 1
a31 1
.\"	$Id: ac.8,v 1.4 1999/06/05 22:16:18 aaron Exp $
d143 1
a143 1
command appeard in
@


1.4
log
@remove trailing whitespace, some Nm cleanup
@
text
@d31 1
a31 1
.\"	$Id: ac.8,v 1.3 1998/11/08 00:21:25 aaron Exp $
d40 1
a40 1
.Nm
@


1.3
log
@usr.sbin/ man page repairs, a-i
@
text
@d31 1
a31 1
.\"	$Id: ac.8,v 1.2 1996/10/08 01:21:00 michaels Exp $
d40 1
a40 1
.Nm ac
d47 1
a47 1
If the file 
d55 1
a55 1
.Nm ac
d64 1
a64 1
.\" Use 
d76 3
a78 1
specification can start with '!' to indicate not this
d80 3
a82 1
and end with '*' to indicate all similarly named ttys.
d96 1
a96 1
.Nm ac
d126 1
a126 1
.Nm ac
d142 1
a142 1
.Nm ac
d146 1
a146 1
.Nm ac
d155 1
a155 1
.\" of a user being logged in when the 
d158 1
a158 1
.\" appear without any preceeding console logins.  
@


1.2
log
@Attempt at cleanup.
@
text
@d31 1
a31 1
.\"	$Id: ac.8,v 1.1.1.1 1995/10/18 08:47:09 deraadt Exp $
d55 1
a55 1
.Nm \&Ac
d123 1
a123 1
utility exits 0 on success, and >0 if a fatal error occurs.
d132 2
d135 1
a135 3
.Xr sa 8 ,
.Xr login 1 ,
.Xr utmp 5
@


1.1
log
@Initial revision
@
text
@d31 1
a31 1
.\"	$Id: ac.8,v 1.2 1995/09/27 19:17:27 jtc Exp $
d35 1
a35 1
.Os NetBSD 0.9a
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
