head	1.38;
access;
symbols
	OPENBSD_6_2:1.38.0.8
	OPENBSD_6_2_BASE:1.38
	OPENBSD_6_1:1.38.0.10
	OPENBSD_6_1_BASE:1.38
	OPENBSD_6_0:1.38.0.6
	OPENBSD_6_0_BASE:1.38
	OPENBSD_5_9:1.38.0.2
	OPENBSD_5_9_BASE:1.38
	OPENBSD_5_8:1.38.0.4
	OPENBSD_5_8_BASE:1.38
	OPENBSD_5_7:1.37.0.2
	OPENBSD_5_7_BASE:1.37
	OPENBSD_5_6:1.37.0.6
	OPENBSD_5_6_BASE:1.37
	OPENBSD_5_5:1.37.0.4
	OPENBSD_5_5_BASE:1.37
	OPENBSD_5_4:1.36.0.6
	OPENBSD_5_4_BASE:1.36
	OPENBSD_5_3:1.36.0.4
	OPENBSD_5_3_BASE:1.36
	OPENBSD_5_2:1.36.0.2
	OPENBSD_5_2_BASE:1.36
	OPENBSD_5_1_BASE:1.35
	OPENBSD_5_1:1.35.0.6
	OPENBSD_5_0:1.35.0.4
	OPENBSD_5_0_BASE:1.35
	OPENBSD_4_9:1.35.0.2
	OPENBSD_4_9_BASE:1.35
	OPENBSD_4_8:1.34.0.2
	OPENBSD_4_8_BASE:1.34
	OPENBSD_4_7:1.32.0.10
	OPENBSD_4_7_BASE:1.32
	OPENBSD_4_6:1.32.0.12
	OPENBSD_4_6_BASE:1.32
	OPENBSD_4_5:1.32.0.8
	OPENBSD_4_5_BASE:1.32
	OPENBSD_4_4:1.32.0.6
	OPENBSD_4_4_BASE:1.32
	OPENBSD_4_3:1.32.0.4
	OPENBSD_4_3_BASE:1.32
	OPENBSD_4_2:1.32.0.2
	OPENBSD_4_2_BASE:1.32
	OPENBSD_4_1:1.31.0.6
	OPENBSD_4_1_BASE:1.31
	OPENBSD_4_0:1.31.0.4
	OPENBSD_4_0_BASE:1.31
	OPENBSD_3_9:1.31.0.2
	OPENBSD_3_9_BASE:1.31
	OPENBSD_3_8:1.29.0.4
	OPENBSD_3_8_BASE:1.29
	OPENBSD_3_7:1.29.0.2
	OPENBSD_3_7_BASE:1.29
	OPENBSD_3_6:1.27.0.6
	OPENBSD_3_6_BASE:1.27
	OPENBSD_3_5:1.27.0.4
	OPENBSD_3_5_BASE:1.27
	OPENBSD_3_4:1.27.0.2
	OPENBSD_3_4_BASE:1.27
	OPENBSD_3_3:1.22.0.2
	OPENBSD_3_3_BASE:1.22
	OPENBSD_3_2:1.20.0.4
	OPENBSD_3_2_BASE:1.20
	OPENBSD_3_1:1.20.0.2
	OPENBSD_3_1_BASE:1.20
	OPENBSD_3_0:1.18.0.2
	OPENBSD_3_0_BASE:1.18
	OPENBSD_2_9_BASE:1.16
	OPENBSD_2_9:1.16.0.2
	OPENBSD_2_8:1.14.0.4
	OPENBSD_2_8_BASE:1.14
	OPENBSD_2_7:1.14.0.2
	OPENBSD_2_7_BASE:1.14
	OPENBSD_2_6:1.11.0.2
	OPENBSD_2_6_BASE:1.11
	OPENBSD_2_5:1.8.0.4
	OPENBSD_2_5_BASE:1.8
	OPENBSD_2_4:1.8.0.2
	OPENBSD_2_4_BASE:1.8
	OPENBSD_2_3:1.7.0.4
	OPENBSD_2_3_BASE:1.7
	OPENBSD_2_2:1.7.0.2
	OPENBSD_2_2_BASE:1.7
	OPENBSD_2_1:1.5.0.2
	OPENBSD_2_1_BASE:1.5
	OPENBSD_2_0:1.1.1.1.0.2
	OPENBSD_2_0_BASE:1.1.1.1
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@.\" @;


1.38
date	2015.03.13.19.58.41;	author jmc;	state Exp;
branches;
next	1.37;
commitid	OcwhWBKGs3Yn7EeA;

1.37
date	2014.01.10.20.20.34;	author jmc;	state Exp;
branches;
next	1.36;

1.36
date	2012.07.08.21.19.42;	author naddy;	state Exp;
branches;
next	1.35;

1.35
date	2010.09.03.11.22.36;	author jmc;	state Exp;
branches;
next	1.34;

1.34
date	2010.07.15.20.51.38;	author schwarze;	state Exp;
branches;
next	1.33;

1.33
date	2010.07.13.07.01.23;	author jmc;	state Exp;
branches;
next	1.32;

1.32
date	2007.05.31.19.20.26;	author jmc;	state Exp;
branches;
next	1.31;

1.31
date	2005.10.15.08.23.37;	author jmc;	state Exp;
branches;
next	1.30;

1.30
date	2005.10.15.08.20.40;	author jmc;	state Exp;
branches;
next	1.29;

1.29
date	2004.12.30.10.01.47;	author jmc;	state Exp;
branches;
next	1.28;

1.28
date	2004.12.13.15.50.02;	author jmc;	state Exp;
branches;
next	1.27;

1.27
date	2003.09.05.18.34.27;	author henning;	state Exp;
branches;
next	1.26;

1.26
date	2003.09.02.18.56.35;	author jmc;	state Exp;
branches;
next	1.25;

1.25
date	2003.06.12.12.59.51;	author jmc;	state Exp;
branches;
next	1.24;

1.24
date	2003.06.02.23.36.54;	author millert;	state Exp;
branches;
next	1.23;

1.23
date	2003.04.02.19.00.26;	author jmc;	state Exp;
branches;
next	1.22;

1.22
date	2003.02.07.07.45.13;	author jmc;	state Exp;
branches;
next	1.21;

1.21
date	2002.11.18.20.18.20;	author millert;	state Exp;
branches;
next	1.20;

1.20
date	2002.03.09.18.54.19;	author millert;	state Exp;
branches;
next	1.19;

1.19
date	2002.03.04.19.56.39;	author millert;	state Exp;
branches;
next	1.18;

1.18
date	2001.10.01.16.48.18;	author jakob;	state Exp;
branches;
next	1.17;

1.17
date	2001.08.10.02.33.46;	author millert;	state Exp;
branches;
next	1.16;

1.16
date	2001.04.18.14.39.24;	author aaron;	state Exp;
branches;
next	1.15;

1.15
date	2000.11.09.17.53.19;	author aaron;	state Exp;
branches;
next	1.14;

1.14
date	2000.03.19.17.57.09;	author aaron;	state Exp;
branches;
next	1.13;

1.13
date	2000.03.15.00.09.46;	author aaron;	state Exp;
branches;
next	1.12;

1.12
date	2000.01.14.06.10.38;	author deraadt;	state Exp;
branches;
next	1.11;

1.11
date	99.07.04.19.25.20;	author aaron;	state Exp;
branches;
next	1.10;

1.10
date	99.06.05.22.17.32;	author aaron;	state Exp;
branches;
next	1.9;

1.9
date	99.05.16.19.58.13;	author alex;	state Exp;
branches;
next	1.8;

1.8
date	98.08.20.20.11.39;	author marc;	state Exp;
branches;
next	1.7;

1.7
date	97.07.18.05.46.13;	author millert;	state Exp;
branches;
next	1.6;

1.6
date	97.07.12.23.05.35;	author millert;	state Exp;
branches;
next	1.5;

1.5
date	97.01.03.21.40.50;	author millert;	state Exp;
branches;
next	1.4;

1.4
date	96.12.20.18.13.42;	author millert;	state Exp;
branches;
next	1.3;

1.3
date	96.12.10.08.26.08;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	96.12.08.01.13.41;	author niklas;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.47.49;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.47.49;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.38
log
@remove the first comma from constructs like ", and," and ", or,": you can use
"and" and "or" to join sentence clauses, and you can use commas, but both hinders
reading;
@
text
@.\"	$OpenBSD: mtree.8,v 1.37 2014/01/10 20:20:34 jmc Exp $
.\"	$NetBSD: mtree.8,v 1.4 1995/03/07 21:26:25 cgd Exp $
.\"
.\" Copyright (c) 1989, 1990, 1993
.\"	The Regents of the University of California.  All rights reserved.
.\"
.\" Redistribution and use in source and binary forms, with or without
.\" modification, are permitted provided that the following conditions
.\" are met:
.\" 1. Redistributions of source code must retain the above copyright
.\"    notice, this list of conditions and the following disclaimer.
.\" 2. Redistributions in binary form must reproduce the above copyright
.\"    notice, this list of conditions and the following disclaimer in the
.\"    documentation and/or other materials provided with the distribution.
.\" 3. Neither the name of the University nor the names of its contributors
.\"    may be used to endorse or promote products derived from this software
.\"    without specific prior written permission.
.\"
.\" THIS SOFTWARE IS PROVIDED BY THE REGENTS AND CONTRIBUTORS ``AS IS'' AND
.\" ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
.\" IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
.\" ARE DISCLAIMED.  IN NO EVENT SHALL THE REGENTS OR CONTRIBUTORS BE LIABLE
.\" FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL
.\" DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS
.\" OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION)
.\" HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT
.\" LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY
.\" OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF
.\" SUCH DAMAGE.
.\"
.\"     @@(#)mtree.8	8.2 (Berkeley) 12/11/93
.\"
.Dd $Mdocdate: January 10 2014 $
.Dt MTREE 8
.Os
.Sh NAME
.Nm mtree
.Nd map a directory hierarchy
.Sh SYNOPSIS
.Nm mtree
.Bk -words
.Op Fl cdeilnqrtUux
.Op Fl f Ar spec
.Op Fl K Ar keywords
.Op Fl k Ar keywords
.Op Fl p Ar path
.Op Fl s Ar seed
.Ek
.Sh DESCRIPTION
The utility
.Nm mtree
compares the file hierarchy rooted in the current directory against a
specification read from the standard input.
Messages are written to the standard output for any files whose
characteristics do not match the specification, or which are
missing from either the file hierarchy or the specification.
For an explanation of the directory hierarchy,
see
.Xr hier 7 .
.Pp
The options are as follows:
.Bl -tag -width Ds
.It Fl c
Print a specification for the file hierarchy to the standard output.
.It Fl d
Ignore everything except directory type files.
.It Fl e
Don't complain about files that are in the file hierarchy, but not in the
specification.
.It Fl f Ar spec
Read the specification from file
.Ar spec ,
instead of from the standard input.
.It Fl i
Indents the output 4 spaces each time a directory level is descended when
creating a specification with the
.Fl c
option.
This does not affect either the /set statements or the comment before each
directory.
It does however affect the comment before the close of each directory.
.It Fl K Ar keywords
Add the specified (whitespace or comma separated) keywords to the current
set of keywords.
.It Fl k Ar keywords
Use the
.Dq type
keyword plus the specified (whitespace or comma separated)
keywords instead of the current set of keywords.
.It Fl l
Do
.Dq loose
permissions checks, in which more stringent permissions
will match less stringent ones.
For example, a file marked mode 0444 will pass a check for mode 0644.
.Dq Loose
checks apply only to read, write and execute permissions -- in
particular, if other bits like the sticky bit or suid/sgid bits are
set either in the specification or the file, exact checking will be
performed.
This flag may not be set at the same time as the
.Fl u
or
.Fl U
flags.
.It Fl n
Do not emit pathname comments when creating a specification.
Normally
a comment is emitted before each directory and before the close of that
directory when using the
.Fl c
option.
.It Fl p Ar path
Use the file hierarchy rooted in
.Ar path ,
instead of the current directory.
.It Fl q
Quiet mode.
Do not complain when a
.Dq missing
directory cannot be created because it already exists.
This occurs when the directory is a symbolic link.
.It Fl r
Remove any files in the file hierarchy that are not described in the
specification.
.It Fl s Ar seed
Display a single checksum to the standard error output that represents all
of the files for which the keyword
.Cm cksum
was specified.
The checksum is seeded with the specified value.
.It Fl t
If a file's timestamp is different from the specification,
.Dq touch
it to match the specification (and list as modified).
.It Fl U
Modify the owner, group, and permissions of existing files to match
the specification and create any missing directories.
User, group, and permissions must all be specified for missing directories
to be created.
Exit with a status of 0 on success, 1 if any error occurred;
a mismatch is not considered an error if it was corrected.
.It Fl u
Same as the
.Fl U
option except a status of 2 is returned if the file hierarchy
did not match the specification.
.It Fl x
Don't descend below mount points in the file hierarchy.
.El
.Pp
Specifications are mostly composed of
.Dq keywords
(i.e., strings that specify values relating to files).
No keywords have default values, and if a keyword has no value set, no
checks based on it are performed.
.Pp
Currently supported keywords are as follows:
.Bl -tag -width sha256digest
.It Cm cksum
The checksum of the file using the default algorithm specified by
the
.Xr cksum 1
utility.
.It Cm flags
The current file's flags (whitespace or comma separated) in symbolic form
as specified by
.Xr chflags 1 .
The string
.Dq none
may be used to indicate that no flags should be set on the file.
.It Cm gid
The file group as a numeric value.
.It Cm gname
The file group as a symbolic name.
.It Cm ignore
Ignore any file hierarchy below this file.
.It Cm link
The file the symbolic link is expected to reference.
.It Cm md5digest
The MD5 message digest of the file.
.It Cm mode
The current file's permissions as a numeric (octal) or symbolic
value.
.It Cm nlink
The number of hard links the file is expected to have.
.It Cm nochange
Do not change the attributes (owner, group, mode, etc) on a file or directory.
.It Cm optional
The file is optional; don't complain about the file if it's
not in the file hierarchy.
.It Cm rmd160digest
The RIPEMD-160 message digest of the file.
.It Cm sha1digest
The SHA-1 message digest of the file.
.It Cm sha256digest
The SHA-256 message digest of the file.
.It Cm size
The size, in bytes, of the file.
.It Cm time
The last modification time of the file.
.It Cm type
The type of the file; may be set to any one of the following:
.Pp
.Bl -tag -width Cm -compact
.It Cm block
block special device
.It Cm char
character special device
.It Cm dir
directory
.It Cm fifo
FIFO
.It Cm file
regular file
.It Cm link
symbolic link
.It Cm socket
socket
.El
.It Cm uid
The file owner as a numeric value.
.It Cm uname
The file owner as a symbolic name.
.El
.Pp
The default set of keywords are
.Cm gid ,
.Cm mode ,
.Cm nlink ,
.Cm size ,
.Cm link ,
.Cm time ,
and
.Cm uid .
.Pp
There are four types of lines in a specification.
.Pp
The first type of line sets a global value for a keyword, and consists of
the string
.Dq /set
followed by whitespace, followed by sets of keyword/value
pairs, separated by whitespace.
Keyword/value pairs consist of a keyword, followed by an equals sign
.Pq Sq = ,
followed by a value, without whitespace characters.
Once a keyword has been set, its value remains unchanged until either
reset or unset.
.Pp
The second type of line unsets keywords and consists of the string
.Dq /unset ,
followed by whitespace, followed by one or more keywords,
separated by whitespace.
.Pp
The third type of line is a file specification and consists of a file
name, followed by whitespace, followed by zero or more whitespace
separated keyword/value pairs.
The file name may be preceded by whitespace characters.
The file name may contain any of the standard file name matching
characters
.Po
.Dq \&[ ,
.Dq \&] ,
.Dq \&? ,
or
.Dq \&*
.Pc ,
in which case files in the hierarchy will be associated with the first
pattern that they match.
.Pp
Each of the keyword/value pairs consist of a keyword, followed by an
equals sign, followed by the keyword's value, without
whitespace characters.
These values override, without changing, the global value of the
corresponding keyword.
.Pp
All paths are relative.
Specifying a directory will cause subsequent files to be searched
for in that directory hierarchy.
Which brings us to the last type of line in a specification: a line
containing only the string
.Dq ..
causes the current directory
path to ascend one level.
.Pp
Empty lines and lines whose first non-whitespace character is a hash
mark
.Pq Sq #
are ignored.
.Sh FILES
.Bl -tag -width /etc/mtree -compact
.It Pa /etc/mtree
system specification directory
.El
.Sh EXIT STATUS
The
.Nm mtree
utility exits with a status of 0 on success, 1 if any error occurred,
and 2 if the file hierarchy did not match the specification.
A status of 2 is converted to a status of 0 if the
.Fl U
option is used.
.Sh EXAMPLES
To detect system binaries that have been
.Dq trojan horsed ,
it is recommended
that
.Nm mtree
.Fl cK
.Cm sha256digest
be run on the file systems, and a copy of the results stored on a different
machine or, at least, in encrypted form.
The output file itself should be digested using the
.Xr sha256 1
utility.
Then, periodically,
.Nm mtree
and
.Xr sha256 1
should be run against the on-line specifications.
While it is possible for the bad guys to change the on-line specifications
to conform to their modified binaries, it is believed to be
impractical for them to create a modified specification which has
the same SHA-256 digest as the original.
.Pp
The
.Fl d
and
.Fl u
options can be used in combination to create directory hierarchies
for distributions and other such things; the files in
.Pa /etc/mtree
were used to create almost all directories in a normal binary
distribution.
.Sh SEE ALSO
.Xr chgrp 1 ,
.Xr chmod 1 ,
.Xr cksum 1 ,
.Xr md5 1 ,
.Xr stat 2 ,
.Xr fts 3 ,
.Xr md5 3 ,
.Xr rmd160 3 ,
.Xr sha1 3 ,
.Xr sha2 3 ,
.Xr hier 7 ,
.Xr chown 8
.Sh HISTORY
The
.Nm mtree
utility appeared in
.Bx 4.3 Reno .
@


1.37
log
@do not list sha1 and sha256 in SEE ALSO, since md5 is already there, and
they're one and the same page now;
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.36 2012/07/08 21:19:42 naddy Exp $
d33 1
a33 1
.Dd $Mdocdate: July 8 2012 $
d312 1
a312 1
machine, or, at least, in encrypted form.
@


1.36
log
@Add support for the "sha256digest" keyword to create/compare
SHA-256 digests of files.  In the man page, also replace SHA-1
with SHA-256 in the examples section.

Man page formatting tweak and ok schwarze@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.35 2010/09/03 11:22:36 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: September 3 2010 $
a339 2
.Xr sha1 1 ,
.Xr sha256 1 ,
@


1.35
log
@add an EXIT STATUS section for /usr/sbin;
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.34 2010/07/15 20:51:38 schwarze Exp $
d33 1
a33 1
.Dd $Mdocdate: July 15 2010 $
d159 1
a159 1
.Bl -tag -width Cm
d196 2
d310 1
a310 1
.Cm sha1digest
d314 1
a314 1
.Xr sha1 1
d319 1
a319 1
.Xr sha1 1
d324 1
a324 1
the same SHA1 digest as the original.
d341 1
d347 1
@


1.34
log
@More delimiters that need quoting inside macros, hunted down by jmc@@,
who asked me to commit because he is just running out of the door.
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.33 2010/07/13 07:01:23 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: July 13 2010 $
d288 6
a293 1
.Pp
a300 5
.Sh FILES
.Bl -tag -width /etc/mtree -compact
.It Pa /etc/mtree
system specification directory
.El
@


1.33
log
@no more rmd160(1);
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.32 2007/05/31 19:20:26 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate: May 31 2007 $
d260 1
a260 1
.Dq [ ,
@


1.32
log
@convert to new .Dd format;
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.31 2005/10/15 08:23:37 jmc Exp $
d33 1
a33 1
.Dd $Mdocdate$
a337 1
.Xr rmd160 1 ,
@


1.31
log
@no need to escape a double dot sequence (..);
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.30 2005/10/15 08:20:40 jmc Exp $
d33 1
a33 1
.Dd December 11, 1993
@


1.30
log
@sync the keywords list back into (alphabetical) order;
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.29 2004/12/30 10:01:47 jmc Exp $
d280 1
a280 1
.Dq \&..
@


1.29
log
@-c is required when generating initial specification;
ok deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.28 2004/12/13 15:50:02 jmc Exp $
d178 2
a195 4
.It Cm uid
The file owner as a numeric value.
.It Cm uname
The file owner as a symbolic name.
a197 2
.It Cm link
The file the symbolic link is expected to reference.
d219 4
@


1.28
log
@more references to hier(7), from mickey;
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.27 2003/09/05 18:34:27 henning Exp $
d307 1
a307 1
.Fl K
@


1.27
log
@-t missing in synopsis
pr3444 jeffi@@rcn.com
ok jmc@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.26 2003/09/02 18:56:35 jmc Exp $
d57 3
d345 1
@


1.26
log
@escape punctuation; (and a nit in openssl.1)
ok deraadt@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.25 2003/06/12 12:59:51 jmc Exp $
d42 1
a42 1
.Op Fl cdeilnqrUux
@


1.25
log
@- section reorder
- macro fixes
- kill whitespace at EOL
- new sentence, new line
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.24 2003/06/02 23:36:54 millert Exp $
d259 1
a259 1
.Dq ? ,
@


1.24
log
@Remove the advertising clause in the UCB license which Berkeley
rescinded 22 July 1999.  Proofed by myself and Theo.
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.23 2003/04/02 19:00:26 jmc Exp $
d88 1
a88 1
Do 
d277 1
a277 1
.Dq Nm \&..
d293 5
a329 5
.Sh FILES
.Bl -tag -width /etc/mtree -compact
.It Pa /etc/mtree
system specification directory
.El
@


1.23
log
@fifo -> FIFO

ok millert@@
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.22 2003/02/07 07:45:13 jmc Exp $
d15 1
a15 5
.\" 3. All advertising materials mentioning features or use of this software
.\"    must display the following acknowledgement:
.\"	This product includes software developed by the University of
.\"	California, Berkeley and its contributors.
.\" 4. Neither the name of the University nor the names of its contributors
@


1.22
log
@typos;
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.21 2002/11/18 20:18:20 millert Exp $
d216 1
a216 1
fifo
@


1.21
log
@fix typos; Jon Bernard
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.20 2002/03/09 18:54:19 millert Exp $
d45 1
d52 1
d77 1
a77 1
create a specification with the
d122 1
a122 1
directory cannot be created because it is already exists.
d142 1
a142 1
Exit with a status of 0 on success, 1 if any error occurred,
d154 1
a154 1
.Dq keywords ,
@


1.20
log
@Rename the new 'preserve' flag to 'nochange' for consistency with FreeBSD.
The old 'preserve' name is still accepted but is not documented and will
be removed in the future.
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.19 2002/03/04 19:56:39 millert Exp $
d78 1
a78 1
This does not effect either the /set statements or the comment before each
d80 1
a80 1
It does however effect the comment before the close of each directory.
d120 1
a120 1
directory can not be created because it is already exists.
@


1.19
log
@Add a 'preserve' flag to tell mtree not to change the attributes of
a file/directory.  This is useful when you want to update children
of a directory but not the parent.
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.18 2001/10/01 16:48:18 jakob Exp $
d184 2
a188 2
.It Cm preserve
The file's attributes should be preserved; don't change owner, group, mode, etc.
@


1.18
log
@add -l flag - do loose permissions checks, in which more stringent permissions
will match less stringent ones. ok millert@@, deraadt@@.
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.17 2001/08/10 02:33:46 millert Exp $
d187 2
@


1.17
log
@Add file flag support to mtree from henning@@crackinghacking.de
with man page update and minor tweaks by me.
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.16 2001/04/18 14:39:24 aaron Exp $
d45 1
a45 1
.Op Fl cdeinqrUux
d89 16
@


1.16
log
@We're talking about SHA1 here, not MD5; d.doroshenko@@omnitel.net
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.15 2000/11/09 17:53:19 aaron Exp $
d148 7
a154 2
.It Cm ignore
Ignore any file hierarchy below this file.
d159 2
@


1.15
log
@Change all option list specifications to ".Bl -tag -width Ds". Most man
pages just needed their -width parameter tweaked to "Ds", which provides
a nice width of 6 constant characters. For consistency more than anything.
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.14 2000/03/19 17:57:09 aaron Exp $
d291 1
a291 1
the same MD5 digest as the original.
@


1.14
log
@Remove hard sentence breaks. Add $OpenBSD$ tags where appropriate. Some other
cleanup along the way.
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.13 2000/03/15 00:09:46 aaron Exp $
d61 1
a61 1
.Bl -tag -width flag
@


1.13
log
@Repair mdoc botch.
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.12 2000/01/14 06:10:38 deraadt Exp $
d90 2
a91 1
Do not emit pathname comments when creating a specification.  Normally
d98 1
a98 1
.Ar path  ,
d101 2
a102 1
Quiet mode.  Do not complain when a
d104 2
a105 2
directory can not be created because it is already exists.  This occurs
when the directory is a symbolic link.
@


1.12
log
@typo; rogoyski@@cs.utexas.edu
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.11 1999/07/04 19:25:20 aaron Exp $
d233 1
a233 1
.Dq ] ,
@


1.11
log
@more macro conversion
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.10 1999/06/05 22:17:32 aaron Exp $
a239 1
they match.
@


1.10
log
@remove trailing whitespace, some Nm cleanup
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.9 1999/05/16 19:58:13 alex Exp $
d178 1
a178 1
.sp
@


1.9
log
@Cleanup xrefs under SEE ALSO.  Specifically:

  - Sort xrefs by section, and then alphabetically.
  - Add missing commas between xref items.
  - Remove commas from the last xref entry.
  - Remove duplicate entries.
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.8 1998/08/20 20:11:39 marc Exp $
d69 3
a71 3
.It Fl f
Read the specification from
.Ar file  ,
d81 1
a81 1
.It Fl K
d84 4
a87 2
.It Fl k
Use the ``type'' keyword plus the specified (whitespace or comma separated)
d90 1
a90 1
Do not emit pathname comments when creating a specification.  Normally 
d92 1
a92 1
directory when using the 
d95 1
a95 1
.It Fl p
d101 1
a101 1
.Sq missing
d107 1
a107 1
.It Fl s
d115 2
a116 1
``touch'' it to match the specification (and list as modified).
d133 3
a135 2
Specifications are mostly composed of ``keywords'', i.e. strings that
that specify values relating to files.
d210 3
a212 1
the string ``/set'' followed by whitespace, followed by sets of keyword/value
d215 2
a216 1
(``=''), followed by a value, without whitespace characters.
d221 2
a222 1
``/unset'', followed by whitespace, followed by one or more keywords,
d230 10
a239 2
characters (``['', ``]'', ``?'' or ``*''), in which case files
in the hierarchy will be associated with the first pattern that
d243 1
a243 1
equals sign (``=''), followed by the keyword's value, without
d258 3
a260 1
mark (``#'') are ignored.
d270 3
a272 1
To detect system binaries that have been ``trojan horsed'', it is recommended
@


1.8
log
@add -q flag to silent messages of the type:
missing: some-file-name (not created: File exists)
which occurred of some-file-name was a path that contained a symbolic link
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.7 1997/07/18 05:46:13 millert Exp $
d287 1
a288 1
.Xr chgrp 1 ,
@


1.7
log
@Add rmd160 support.  Sheesh, you'd think this was tripwire.
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.6 1997/07/12 23:05:35 millert Exp $
d45 1
a45 1
.Op Fl cdeinrUux
d97 5
@


1.6
log
@Add sha1 digest support.
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.5 1997/01/03 21:40:50 millert Exp $
d153 2
d286 1
d291 1
@


1.5
log
@From NetBSD:
    Add a `-t' (touch) option to update time stamps.
    Only record size for regular files.
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.4 1996/12/20 18:13:42 millert Exp $
d153 2
d249 1
a249 1
.Cm md5digest
d253 1
a253 1
.Xr md5 1
d258 1
a258 1
.Xr md5 1
d284 1
d288 1
a294 1
The MD5 digest capability was added in FreeBSD.
@


1.4
log
@Add back "optional" keyword that got nuked in merge of FreeBSD mods.
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.3 1996/12/10 08:26:08 deraadt Exp $
d106 3
d117 1
a117 1
Same as
d119 2
a120 2
except a status of 2 is returned if the file hierarchy did not match
the specification.
@


1.3
log
@merge freebsd mtree diffs, plus -Wall cleanup
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.2 1996/12/08 01:13:41 niklas Exp $
d147 3
@


1.2
log
@64-bit clean + RCS tags
@
text
@d1 1
a1 1
.\"	$OpenBSD: mtree.8,v 1.4 1995/03/07 21:26:25 cgd Exp $
d45 1
a45 1
.Op Fl cderux
d73 8
d87 6
d106 1
a106 1
.It Fl u
d111 7
d140 2
a141 2
.It Cm link
The file the symbolic link is expected to reference.
a146 3
.It Cm optional
The file is optional; don't complain about the file if it's
not in the file hierarchy.
d153 2
a179 1
.Cm link ,
d183 1
d233 3
d240 2
d244 3
a246 4
The seed for the
.Fl s
option should not be an obvious value and the final checksum should not be
stored on-line under any circumstances!
d249 3
a251 2
should be run against the on-line specifications and the final checksum
compared with the previous value.
d253 3
a255 4
to conform to their modified binaries, it shouldn't be possible for them
to make it produce the same final checksum value.
If the final checksum value changes, the off-line copies of the specification
can be used to detect which of the binaries have actually been modified.
d262 4
a265 1
for distributions and other such things.
a272 1
.Xr chown 1 ,
d275 1
d278 2
d285 1
@


1.1
log
@Initial revision
@
text
@d1 1
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@
