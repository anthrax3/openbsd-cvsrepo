head	1.61;
access;
symbols
	OPENBSD_6_2:1.61.0.2
	OPENBSD_6_2_BASE:1.61
	OPENBSD_6_1:1.61.0.4
	OPENBSD_6_1_BASE:1.61
	OPENBSD_6_0:1.59.0.6
	OPENBSD_6_0_BASE:1.59
	OPENBSD_5_9:1.59.0.2
	OPENBSD_5_9_BASE:1.59
	OPENBSD_5_8:1.56.0.8
	OPENBSD_5_8_BASE:1.56
	OPENBSD_5_7:1.56.0.2
	OPENBSD_5_7_BASE:1.56
	OPENBSD_5_6:1.56.0.4
	OPENBSD_5_6_BASE:1.56
	OPENBSD_5_5:1.54.0.6
	OPENBSD_5_5_BASE:1.54
	OPENBSD_5_4:1.54.0.2
	OPENBSD_5_4_BASE:1.54
	OPENBSD_5_3:1.53.0.14
	OPENBSD_5_3_BASE:1.53
	OPENBSD_5_2:1.53.0.12
	OPENBSD_5_2_BASE:1.53
	OPENBSD_5_1_BASE:1.53
	OPENBSD_5_1:1.53.0.10
	OPENBSD_5_0:1.53.0.8
	OPENBSD_5_0_BASE:1.53
	OPENBSD_4_9:1.53.0.6
	OPENBSD_4_9_BASE:1.53
	OPENBSD_4_8:1.53.0.4
	OPENBSD_4_8_BASE:1.53
	OPENBSD_4_7:1.53.0.2
	OPENBSD_4_7_BASE:1.53
	OPENBSD_4_6:1.52.0.6
	OPENBSD_4_6_BASE:1.52
	OPENBSD_4_5:1.52.0.2
	OPENBSD_4_5_BASE:1.52
	OPENBSD_4_4:1.51.0.10
	OPENBSD_4_4_BASE:1.51
	OPENBSD_4_3:1.51.0.8
	OPENBSD_4_3_BASE:1.51
	OPENBSD_4_2:1.51.0.6
	OPENBSD_4_2_BASE:1.51
	OPENBSD_4_1:1.51.0.4
	OPENBSD_4_1_BASE:1.51
	OPENBSD_4_0:1.51.0.2
	OPENBSD_4_0_BASE:1.51
	OPENBSD_3_9:1.49.0.2
	OPENBSD_3_9_BASE:1.49
	OPENBSD_3_8:1.47.0.4
	OPENBSD_3_8_BASE:1.47
	OPENBSD_3_7:1.47.0.2
	OPENBSD_3_7_BASE:1.47
	OPENBSD_3_6:1.46.0.2
	OPENBSD_3_6_BASE:1.46
	OPENBSD_3_5:1.45.0.2
	OPENBSD_3_5_BASE:1.45
	OPENBSD_3_4:1.42.0.2
	OPENBSD_3_4_BASE:1.42
	OPENBSD_3_3:1.38.0.2
	OPENBSD_3_3_BASE:1.38
	OPENBSD_3_2:1.35.0.2
	OPENBSD_3_2_BASE:1.35
	OPENBSD_3_1:1.34.0.2
	OPENBSD_3_1_BASE:1.34
	OPENBSD_3_0:1.32.0.2
	OPENBSD_3_0_BASE:1.32
	OPENBSD_2_9_BASE:1.29
	OPENBSD_2_9:1.29.0.2
	OPENBSD_2_8:1.23.0.2
	OPENBSD_2_8_BASE:1.23
	OPENBSD_2_7:1.21.0.2
	OPENBSD_2_7_BASE:1.21
	OPENBSD_2_6:1.16.0.2
	OPENBSD_2_6_BASE:1.16
	OPENBSD_2_5:1.13.0.4
	OPENBSD_2_5_BASE:1.13
	OPENBSD_2_4:1.13.0.2
	OPENBSD_2_4_BASE:1.13
	OPENBSD_2_3:1.11.0.2
	OPENBSD_2_3_BASE:1.11
	OPENBSD_2_2:1.10.0.2
	OPENBSD_2_2_BASE:1.10
	OPENBSD_2_1:1.6.0.2
	OPENBSD_2_1_BASE:1.6
	OPENBSD_2_0:1.4.0.2
	OPENBSD_2_0_BASE:1.4
	netbsd_1_1:1.1.1.1;
locks; strict;
comment	@# @;


1.61
date	2016.11.18.17.37.03;	author reyk;	state Exp;
branches;
next	1.60;
commitid	D9iRhZUcWsZJ3TRZ;

1.60
date	2016.10.22.20.55.04;	author rzalamena;	state Exp;
branches;
next	1.59;
commitid	cnmsKk1DpJAmVheV;

1.59
date	2015.10.14.04.55.17;	author guenther;	state Exp;
branches;
next	1.58;
commitid	FoAGJDCiesKJyWSq;

1.58
date	2015.10.13.14.36.15;	author stsp;	state Exp;
branches;
next	1.57;
commitid	5m4bwYbwNdtzNwUI;

1.57
date	2015.10.10.07.52.30;	author stsp;	state Exp;
branches;
next	1.56;
commitid	6STil4vxiVtH6UKd;

1.56
date	2014.06.30.04.25.11;	author deraadt;	state Exp;
branches;
next	1.55;
commitid	MUfCbXZelRfRbmuN;

1.55
date	2014.06.20.04.01.42;	author lteo;	state Exp;
branches;
next	1.54;
commitid	aIFGWbQop2PTYFII;

1.54
date	2013.06.19.03.51.30;	author lteo;	state Exp;
branches;
next	1.53;

1.53
date	2009.11.04.09.43.11;	author jsing;	state Exp;
branches;
next	1.52;

1.52
date	2008.10.16.12.57.01;	author mpf;	state Exp;
branches;
next	1.51;

1.51
date	2006.05.23.14.20.19;	author stevesk;	state Exp;
branches;
next	1.50;

1.50
date	2006.03.28.15.48.33;	author reyk;	state Exp;
branches;
next	1.49;

1.49
date	2005.11.22.11.36.12;	author reyk;	state Exp;
branches;
next	1.48;

1.48
date	2005.10.08.19.45.15;	author canacar;	state Exp;
branches;
next	1.47;

1.47
date	2005.03.07.16.13.38;	author reyk;	state Exp;
branches;
next	1.46;

1.46
date	2004.04.28.02.17.03;	author mcbride;	state Exp;
branches;
next	1.45;

1.45
date	2004.02.02.09.43.27;	author otto;	state Exp;
branches;
next	1.44;

1.44
date	2004.01.31.15.13.03;	author otto;	state Exp;
branches;
next	1.43;

1.43
date	2004.01.28.19.44.55;	author canacar;	state Exp;
branches;
next	1.42;

1.42
date	2003.08.21.19.14.23;	author frantzen;	state Exp;
branches;
next	1.41;

1.41
date	2003.07.17.08.45.37;	author markus;	state Exp;
branches;
next	1.40;

1.40
date	2003.06.11.20.58.45;	author markus;	state Exp;
branches;
next	1.39;

1.39
date	2003.05.22.21.15.17;	author pvalchev;	state Exp;
branches;
next	1.38;

1.38
date	2002.11.30.13.56.23;	author mickey;	state Exp;
branches;
next	1.37;

1.37
date	2002.11.30.00.20.45;	author deraadt;	state Exp;
branches;
next	1.36;

1.36
date	2002.11.29.18.27.54;	author mickey;	state Exp;
branches;
next	1.35;

1.35
date	2002.09.18.08.51.17;	author jakob;	state Exp;
branches;
next	1.34;

1.34
date	2002.01.22.18.33.07;	author mickey;	state Exp;
branches;
next	1.33;

1.33
date	2001.11.06.23.03.12;	author art;	state Exp;
branches;
next	1.32;

1.32
date	2001.07.11.03.02.25;	author pvalchev;	state Exp;
branches;
next	1.31;

1.31
date	2001.06.25.23.05.16;	author provos;	state Exp;
branches;
next	1.30;

1.30
date	2001.06.25.19.56.10;	author itojun;	state Exp;
branches;
next	1.29;

1.29
date	2001.04.08.22.45.52;	author jakob;	state Exp;
branches;
next	1.28;

1.28
date	2001.03.06.16.42.08;	author jakob;	state Exp;
branches;
next	1.27;

1.27
date	2001.02.05.15.18.46;	author jason;	state Exp;
branches;
next	1.26;

1.26
date	2000.12.07.22.52.00;	author mickey;	state Exp;
branches;
next	1.25;

1.25
date	2000.12.07.22.36.45;	author mickey;	state Exp;
branches;
next	1.24;

1.24
date	2000.12.07.21.52.38;	author mickey;	state Exp;
branches;
next	1.23;

1.23
date	2000.10.19.16.31.41;	author jason;	state Exp;
branches;
next	1.22;

1.22
date	2000.10.03.14.28.21;	author ho;	state Exp;
branches;
next	1.21;

1.21
date	2000.04.26.21.35.36;	author jakob;	state Exp;
branches;
next	1.20;

1.20
date	2000.01.16.12.08.10;	author jakob;	state Exp;
branches;
next	1.19;

1.19
date	2000.01.16.11.43.57;	author jakob;	state Exp;
branches;
next	1.18;

1.18
date	2000.01.16.11.20.14;	author jakob;	state Exp;
branches;
next	1.17;

1.17
date	2000.01.16.10.54.58;	author jakob;	state Exp;
branches;
next	1.16;

1.16
date	99.09.16.17.27.59;	author brad;	state Exp;
branches;
next	1.15;

1.15
date	99.08.11.16.44.59;	author deraadt;	state Exp;
branches;
next	1.14;

1.14
date	99.07.28.20.41.34;	author jakob;	state Exp;
branches;
next	1.13;

1.13
date	98.06.25.19.42.43;	author mickey;	state Exp;
branches;
next	1.12;

1.12
date	98.06.11.00.01.22;	author provos;	state Exp;
branches;
next	1.11;

1.11
date	98.02.26.16.02.53;	author niklas;	state Exp;
branches;
next	1.10;

1.10
date	97.09.21.11.44.30;	author deraadt;	state Exp;
branches;
next	1.9;

1.9
date	97.07.31.09.49.13;	author tqbf;	state Exp;
branches;
next	1.8;

1.8
date	97.07.14.22.23.08;	author deraadt;	state Exp;
branches;
next	1.7;

1.7
date	97.07.06.14.39.50;	author niklas;	state Exp;
branches;
next	1.6;

1.6
date	96.12.12.16.23.03;	author bitblt;	state Exp;
branches;
next	1.5;

1.5
date	96.11.12.08.31.56;	author mickey;	state Exp;
branches;
next	1.4;

1.4
date	96.07.13.11.01.05;	author mickey;	state Exp;
branches;
next	1.3;

1.3
date	96.06.10.07.47.08;	author deraadt;	state Exp;
branches;
next	1.2;

1.2
date	96.03.04.15.58.53;	author mickey;	state Exp;
branches;
next	1.1;

1.1
date	95.10.18.08.48.23;	author deraadt;	state Exp;
branches
	1.1.1.1;
next	;

1.1.1.1
date	95.10.18.08.48.23;	author deraadt;	state Exp;
branches;
next	;


desc
@@


1.61
log
@Updates tcpdump's OpenFlow printer to use the string maps from switchd
(manually synced).  Also make the output a bit more like other printers.

OK rzalamena@@
@
text
@#	$OpenBSD: Makefile,v 1.60 2016/10/22 20:55:04 rzalamena Exp $
#
#  Copyright (c) 1988, 1989, 1990, 1991, 1992, 1993, 1994
# 	The Regents of the University of California.  All rights reserved.
#
#  Redistribution and use in source and binary forms, with or without
#  modification, are permitted provided that: (1) source code distributions
#  retain the above copyright notice and this paragraph in its entirety, (2)
#  distributions including binary code include the above copyright notice and
#  this paragraph in its entirety in the documentation or other materials
#  provided with the distribution, and (3) all advertising materials mentioning
#  features or use of this software display the following acknowledgement:
#  ``This product includes software developed by the University of California,
#  Lawrence Berkeley Laboratory and its contributors.'' Neither the name of
#  the University nor the names of its contributors may be used to endorse
#  or promote products derived from this software without specific prior
#  written permission.
#  THIS SOFTWARE IS PROVIDED ``AS IS'' AND WITHOUT ANY EXPRESS OR IMPLIED
#  WARRANTIES, INCLUDING, WITHOUT LIMITATION, THE IMPLIED WARRANTIES OF
#  MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.
#

PROG=	tcpdump
MAN=	tcpdump.8

CFLAGS+=-Wall -I${.CURDIR}/../../sbin/pfctl -I${.CURDIR}/../hostapd

# for pcap-int.h
CFLAGS+=-I${.CURDIR}/../../lib/libpcap

CFLAGS+=-DCSLIP -DPPP -DHAVE_FDDI -DETHER_SERVICE -DHAVE_NET_SLIP_H -DHAVE_ETHER_NTOHOST -DINET6

LDADD+=	-lpcap -ll -lcrypto
DPADD+=	${LIBL} ${LIBPCAP} ${LIBCRYPTO}

SRCS=	tcpdump.c addrtoname.c privsep.c privsep_fdpass.c privsep_pcap.c \
	print-ether.c print-ip.c print-arp.c print-tcp.c print-udp.c \
	print-atalk.c print-domain.c print-tftp.c print-bootp.c print-nfs.c \
	print-icmp.c print-sl.c print-ppp.c print-rip.c print-timed.c \
	print-snmp.c print-ntp.c print-null.c print-ospf.c print-gtp.c \
	print-fddi.c print-llc.c print-sunrpc.c print-hsrp.c print-vqp.c \
	print-vrrp.c print-wb.c print-decnet.c print-isoclns.c print-ipx.c \
	print-atm.c print-dvmrp.c print-krb.c print-pim.c print-netbios.c \
	util.c bpf_dump.c parsenfsfh.c version.c print-igrp.c \
	print-gre.c print-radius.c print-enc.c print-cnfp.c \
	print-ipsec.c print-ike.c print-raw.c print-l2tp.c print-mobile.c \
	print-ip6.c print-ip6opts.c print-icmp6.c print-dhcp6.c print-frag6.c \
	print-bgp.c print-ospf6.c print-ripng.c print-rt6.c print-stp.c \
	print-etherip.c print-lwres.c print-lldp.c print-cdp.c print-pflog.c \
	print-pfsync.c pf_print_state.c print-ofp.c ofp_map.c \
	print-udpencap.c print-carp.c \
	print-802_11.c print-iapp.c print-mpls.c print-slow.c \
	gmt2local.c savestr.c setsignal.c in_cksum.c

# TCP OS Fingerprinting
.PATH: ${.CURDIR}/../../sys/net
.PATH: ${.CURDIR}/../../sbin/pfctl
SRCS+=	pf_osfp.c pfctl_osfp.c
CFLAGS+=-I${.CURDIR}/../../sbin/pfctl
CFLAGS+=-DFAKE_PF_KERNEL

#SRCS+=	smbutil.c print-smb.c

AWKS =	atime.awk packetdat.awk send-ack.awk stime.awk

.include <bsd.prog.mk>
@


1.60
log
@Teach tcpdump(8) how to read OpenFlow packets. This initial implementation
supports the following message types: hello, error, echo request/reply,
feature request/reply, set config, packet-in, packet-out, flow removed and
flow mod.

We currently only support printing this messages for OpenFlow 1.3.5, however
it is possible to reuse some functions and get other versions working too.

ok deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.59 2015/10/14 04:55:17 guenther Exp $
d50 1
a50 1
	print-pfsync.c pf_print_state.c print-ofp.c \
@


1.59
log
@Remove conditional compilation and #defines around signal handling
Don't catch signals that were ignored on entry
Suppress SIGCHLD if our kid is stopped: we don't care and it's not an error

ok millert@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.58 2015/10/13 14:36:15 stsp Exp $
d50 1
a50 1
	print-pfsync.c pf_print_state.c \
@


1.58
log
@Don't use exp2f(), it breaks build on vax. Use a shift instead.
reported by deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.57 2015/10/10 07:52:30 stsp Exp $
d31 1
a31 1
CFLAGS+=-DCSLIP -DPPP -DHAVE_FDDI -DETHER_SERVICE -DRETSIGTYPE=void -DHAVE_NET_SLIP_H -DHAVE_ETHER_NTOHOST -DINET6
@


1.57
log
@Make tcpdump(1) print more information from the HT Capabilities element.
tweak + ok sthen@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.56 2014/06/30 04:25:11 deraadt Exp $
d33 1
a33 1
LDADD+=	-lpcap -ll -lcrypto -lm
@


1.56
log
@remove backwards compat layer for alpha osf1.  back then compilers and
the parsers sucked, so byte misalignment repair was requested. These
days it means the parsers should improve.
ok lteo
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.55 2014/06/20 04:01:42 lteo Exp $
d33 1
a33 1
LDADD+=	-lpcap -ll -lcrypto
@


1.55
log
@Import in_cksum_shouldbe() from mainline tcpdump; this is needed by my
upcoming commit which will fix and improve the display of bad checksums
for the major protocols.

ok henning@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.54 2013/06/19 03:51:30 lteo Exp $
d44 1
a44 1
	util.c bpf_dump.c parsenfsfh.c version.c machdep.c print-igrp.c \
@


1.54
log
@Do not install pcap-int.h to /usr/include as it is an internal library
header (pointed out by matthew@@).  Let only pflogd and tcpdump include
pcap-int.h directly since they need it for privilege separation.

"looks good" sthen
feedback/ok deraadt matthew millert
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.53 2009/11/04 09:43:11 jsing Exp $
d53 1
a53 1
	gmt2local.c savestr.c setsignal.c
@


1.53
log
@Add support to tcpdump for decoding the GPRS Tunnelling Protocol (GTP),
used to carry GPRS data over IP for GSM and UMTS networks. The decoder
understands GTPv0, GTPv0', GTPv1-C, GTPv1-U and GTPv1' traffic, however
at this stage not all TLV fields are fully decoded.

This work has been kindly sponsored by SystemNet AS (www.systemnet.no).

"commit" deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.51 2006/05/23 14:20:19 stevesk Exp $
d27 3
@


1.52
log
@Add support for IEEE "slow protocols" LACP, MARKER as per 802.3ad.
Code from tcpdump.org with cleanup and shrinkage by me.
Help and ideas for extra sanity checks from canacar@@
OK canacar@@
@
text
@d37 1
a37 1
	print-snmp.c print-ntp.c print-null.c print-ospf.c \
@


1.51
log
@add VLAN Query Protocol (VQP) dissector; ok canacar@@ markus@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.50 2006/03/28 15:48:33 reyk Exp $
d49 1
a49 1
	print-802_11.c print-iapp.c print-mpls.c \
@


1.50
log
@Add a simple printer for IEEE 802.1AB LLDP, the Link Layer Discovery
Protocol.

LLDP is used by some switch vendors as a replacement for the non-free
Cizzco Discovery Protocol (CDP) due to some Cisco patentry...

ok brad@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.49 2005/11/22 11:36:12 reyk Exp $
d38 1
a38 1
	print-fddi.c print-llc.c print-sunrpc.c print-hsrp.c \
@


1.49
log
@add printer for IAPP and hostapd(8) messages

ok canacar@@, tested by aanriot@@ and others
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.48 2005/10/08 19:45:15 canacar Exp $
d46 1
a46 1
	print-etherip.c print-lwres.c print-cdp.c print-pflog.c \
@


1.48
log
@Add a best effort mpls decoder. From Jason L. Wright.
Since the encapsulated protocol information is not always
available in the MPLS tag stack. The decoder attempts
to guess the protocol.
ok brad@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.47 2005/03/07 16:13:38 reyk Exp $
d26 1
a26 1
CFLAGS+=-Wall -I${.CURDIR}/../../sbin/pfctl
d49 1
a49 1
	print-802_11.c print-mpls.c \
@


1.47
log
@add a printer for 802.11 and for additional radiotap headers,
use -y IEEE802_11 or IEEE802_11_RADIO if supported by the driver.

ok canacar@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.46 2004/04/28 02:17:03 mcbride Exp $
d49 1
a49 1
	print-802_11.c \
@


1.46
log
@Make tcpdump print carp as carp. Printing vrrp can be forced with -T vrrp.

ok markus@@ pb@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.45 2004/02/02 09:43:27 otto Exp $
d49 1
@


1.45
log
@Do away with non-aligned memory accesses.
ok deraadt@@ hshoexer@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.44 2004/01/31 15:13:03 otto Exp $
d48 1
a48 1
	print-udpencap.c \
@


1.44
log
@general cleanup and better SIGCHLD handling from millert@@
ok canacar@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.43 2004/01/28 19:44:55 canacar Exp $
a28 4
.if (${MACHINE_ARCH} == "alpha") || (${MACHINE_ARCH} == "sparc") || \
    (${MACHINE_ARCH} == "sparc64")
CFLAGS+=-DLBL_ALIGN
.endif
@


1.43
log
@privilege separated tcpdump, joint work with otto@@

tested by avsm@@ vincent@@ dhartmei@@ markus@@ hshoexer@@ and others
go for it deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.42 2003/08/21 19:14:23 frantzen Exp $
a35 3

#BINMODE=4555
#BINOWN= root
@


1.42
log
@print the operating system of TCP SYN packets with the -o option
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.41 2003/07/17 08:45:37 markus Exp $
a26 1
.PATH:	${.CURDIR}/../../sbin/pfctl
d37 4
a40 1
SRCS=	tcpdump.c addrtoname.c \
@


1.41
log
@add support for ESP decryption; ok deraadt@@; feedback mickey@@;
many manpage fixes from jmc@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.40 2003/06/11 20:58:45 markus Exp $
d55 7
@


1.40
log
@support for NAT-T (draft-ietf-ipsec-udp-encaps-06.txt); ok deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.39 2003/05/22 21:15:17 pvalchev Exp $
d35 2
a36 2
LDADD+=	-lpcap -ll
DPADD+=	${LIBL} ${LIBPCAP}
@


1.39
log
@remove -Werror; ok millert
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.38 2002/11/30 13:56:23 mickey Exp $
d53 1
@


1.38
log
@pfsync support; deraadt@@ ok
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.37 2002/11/30 00:20:45 deraadt Exp $
d26 1
a26 1
CFLAGS+=-Wall -Werror -I${.CURDIR}/../../sbin/pfctl
@


1.37
log
@stop breaking the damn tree mickey
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.35 2002/09/18 08:51:17 jakob Exp $
d26 2
a27 1
CFLAGS+=-Wall -Werror
d52 1
@


1.36
log
@tcpdump support for pfsync; henning@@ ok
@
text
@d26 1
a26 2
CFLAGS+=-Wall -Werror -I${.CURDIR}/../../sbin/pfctl
.PATH:	${.CURDIR}/../../sbin/pfctl
a50 1
	print-pfsync.c pf_print_state.c \
@


1.35
log
@remove egp support; unresolved non-bsd license for a decoder of protocol that
noone uses anymore is not worth the amount of work needed to be resolved.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.34 2002/01/22 18:33:07 mickey Exp $
d26 2
a27 1
CFLAGS+=-Wall -Werror
d52 1
@


1.34
log
@HSRP dissector, from Julian Cowley <julian@@lava.net> via tcpdump.org
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.33 2001/11/06 23:03:12 art Exp $
d41 1
a41 1
	print-snmp.c print-ntp.c print-null.c print-egp.c print-ospf.c \
@


1.33
log
@sparc64 needs LBL_ALIGN.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.32 2001/07/11 03:02:25 pvalchev Exp $
d42 1
a42 1
	print-fddi.c print-llc.c print-sunrpc.c \
@


1.32
log
@remove mips leftovers; ok brad
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.31 2001/06/25 23:05:16 provos Exp $
d29 2
a30 1
.if (${MACHINE_ARCH} == "alpha") || (${MACHINE_ARCH} == "sparc")
@


1.31
log
@interpret DLT_PFLOG
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.30 2001/06/25 19:56:10 itojun Exp $
d29 1
a29 1
.if (${MACHINE_ARCH} == "alpha") || (${MACHINE_ARCH} == "mips") || (${MACHINE_ARCH} == "sparc")
@


1.30
log
@disable smb decoder, as there seems to be fewer bound checks than needed
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.29 2001/04/08 22:45:52 jakob Exp $
d49 1
a49 1
	print-etherip.c print-lwres.c print-cdp.c \
@


1.29
log
@add support for printing cdp (Cisco Discovery Protocol), from tcpdump.org
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.28 2001/03/06 16:42:08 jakob Exp $
d41 1
a41 1
	print-fddi.c print-llc.c print-smb.c smbutil.c print-sunrpc.c \
d51 2
@


1.28
log
@add lwres (BINDv9 resolver) printing. from tcpdump.org and modified by ho@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.27 2001/02/05 15:18:46 jason Exp $
d49 2
a50 1
	print-etherip.c print-lwres.c gmt2local.c savestr.c setsignal.c
@


1.27
log
@etherip printing code... handles draft (v2) and current (v3)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.26 2000/12/07 22:52:00 mickey Exp $
d49 1
a49 1
	print-etherip.c	gmt2local.c savestr.c setsignal.c
@


1.26
log
@timed printing; from Ben Smithurst <ben@@scientia.demon.co.uk>; via tcpdump.org
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.25 2000/12/07 22:36:45 mickey Exp $
d49 1
a49 1
	gmt2local.c savestr.c setsignal.c
@


1.25
log
@smb printing; from Andrew Tridgell; via tcpdump.org
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.24 2000/12/07 21:52:38 mickey Exp $
d39 1
a39 1
	print-icmp.c print-sl.c print-ppp.c print-rip.c \
@


1.24
log
@add vrrp printing; from tcpdump.org
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.23 2000/10/19 16:31:41 jason Exp $
d41 1
a41 1
	print-fddi.c print-llc.c print-sunrpc.c \
@


1.23
log
@code for printing bridge spanning tree packets
also fix a bug where llc encoded frames are hex dumped twice when -x is used
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.22 2000/10/03 14:28:21 ho Exp $
d42 1
a42 1
	print-wb.c print-decnet.c print-isoclns.c print-ipx.c \
@


1.22
log
@Add -Wall -Werror to CFLAGS. (niklas@@, jakob@@ ok)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.21 2000/04/26 21:35:36 jakob Exp $
d48 1
a48 1
	print-bgp.c print-ospf6.c print-ripng.c print-rt6.c \
@


1.21
log
@INET6
DHCP/BOOTP
tcp & udp checksum detection
numerous bugfixes
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.20 2000/01/16 12:08:10 jakob Exp $
d25 2
@


1.20
log
@enable INET6
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.19 2000/01/16 11:43:57 jakob Exp $
d45 2
a46 1
	print-bgp.c \
@


1.19
log
@BGP support (from KAME/WIDE). INET6 parts not done yet.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.18 2000/01/16 11:20:14 jakob Exp $
d26 1
a26 1
CFLAGS+=-DCSLIP -DPPP -DHAVE_FDDI -DETHER_SERVICE -DRETSIGTYPE=void -DHAVE_NET_SLIP_H -DHAVE_ETHER_NTOHOST
@


1.18
log
@Mobile IP support (from KAME/NetBSD)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.17 2000/01/16 10:54:58 jakob Exp $
d45 1
@


1.17
log
@L2TP support (from KAME)
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.16 1999/09/16 17:27:59 brad Exp $
d44 1
a44 1
	print-ipsec.c print-ike.c print-raw.c print-l2tp.c \
@


1.16
log
@add raw support
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.15 1999/08/11 16:44:59 deraadt Exp $
d44 1
a44 1
	print-ipsec.c print-ike.c print-raw.c \
@


1.15
log
@HAVE_FDDI
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.14 1999/07/28 20:41:34 jakob Exp $
d44 1
a44 1
	print-ipsec.c print-ike.c \
@


1.14
log
@-  Merge some changes from tcpdump 3.4
   -a flag; attempt to convert network and broadcast addresses to names
   Improved signal handling
   Miscellaneous fixes and typos
   OSPF MD5 authentication support

-  -X flag; emacs-hexl print (including ascii)

-  Add ECN bits to TCP and IP headers

-  IKE & IPsec (ESP & AH) support

OK deraadt@@
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.13 1998/06/25 19:42:43 mickey Exp $
d26 1
a26 1
CFLAGS+=-DCSLIP -DPPP -DFDDI -DETHER_SERVICE -DRETSIGTYPE=void -DHAVE_NET_SLIP_H -DHAVE_ETHER_NTOHOST
@


1.13
log
@add cisco netflow proto printing; not tested w/ version 5, but should work anyways
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.12 1998/06/11 00:01:22 provos Exp $
d43 3
a45 1
        print-gre.c print-radius.c print-enc.c print-cnfp.c
@


1.12
log
@handle IPSec processed packets (DLT_ENC) in libpcap, display them with
tcpdump + additional info (SPI + which type of transforms where passed).
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.11 1998/02/26 16:02:53 niklas Exp $
d43 1
a43 1
        print-gre.c print-radius.c print-enc.c
@


1.11
log
@Use YP ethers
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.10 1997/09/21 11:44:30 deraadt Exp $
d43 1
a43 1
        print-gre.c print-radius.c
@


1.10
log
@$OpenBSD$
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.9 1997/07/31 09:49:13 tqbf Exp $
d26 1
a26 1
CFLAGS+=-DCSLIP -DPPP -DFDDI -DETHER_SERVICE -DRETSIGTYPE=void -DHAVE_NET_SLIP_H
@


1.9
log
@Add RADIUS printing support. Blech.
@
text
@d1 1
a1 2
#	$OpenBSD: Makefile,v 1.8 1997/07/14 22:23:08 deraadt Exp $
#	$NetBSD: Makefile,v 1.6 1995/03/07 23:18:39 mycroft Exp $
@


1.8
log
@HAVE_NET_SLIP_H; PR286, felix@@mamba.pond.sub.org
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.7 1997/07/06 14:39:50 niklas Exp $
d44 1
a44 1
        print-gre.c
@


1.7
log
@Some architectures need strict alignment
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.6 1996/12/12 16:23:03 bitblt Exp $
d27 1
a27 1
CFLAGS+=-DCSLIP -DPPP -DFDDI -DETHER_SERVICE -DRETSIGTYPE=void
@


1.6
log
@*** empty log message ***
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.5 1996/11/12 08:31:56 mickey Exp $
d28 3
@


1.5
log
@add NetBIOS printing.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.4 1996/07/13 11:01:05 mickey Exp $
d40 2
a41 1
	util.c bpf_dump.c parsenfsfh.c version.c
@


1.4
log
@it is 3.2 now.
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.3 1996/06/10 07:47:08 deraadt Exp $
d39 1
a39 1
	print-atm.c print-dvmrp.c print-krb.c print-pim.c \
@


1.3
log
@sync to latest
@
text
@d1 1
a1 1
#	$OpenBSD: Makefile,v 1.6 1995/03/07 23:18:39 mycroft Exp $
d27 1
a27 1
CFLAGS+=-DCSLIP -DPPP -DFDDI -DETHER_SERVICE
d39 1
@


1.2
log
@Updating to the latest LBL release.
Sun's SKIP support added.
@
text
@d1 1
a1 1
#	$OpenBSD$
a22 1
# @@(#) $Header: /cvs/src/usr.sbin/tcpdump/Makefile,v 1.1.1.1 1995/10/18 08:48:23 deraadt Exp $ (LBL)
d38 1
a38 1
	print-wb.c print-decnet.c print-isoclns.c print-ipx.c print-skip.c \
@


1.1
log
@Initial revision
@
text
@d1 1
d23 1
a23 1
# @@(#) $Header: /a/cvsroot/src/usr.sbin/tcpdump/Makefile,v 1.6 1995/03/07 23:18:39 mycroft Exp $ (LBL)
d39 1
a39 1
	print-wb.c print-decnet.c print-isoclns.c print-ipx.c \
@


1.1.1.1
log
@initial import of NetBSD tree
@
text
@@

